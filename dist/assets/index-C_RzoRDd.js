function AL(e,n){for(var s=0;s<n.length;s++){const l=n[s];if(typeof l!="string"&&!Array.isArray(l)){for(const d in l)if(d!=="default"&&!(d in e)){const g=Object.getOwnPropertyDescriptor(l,d);g&&Object.defineProperty(e,d,g.get?g:{enumerable:!0,get:()=>l[d]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))l(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const x of g.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&l(x)}).observe(document,{childList:!0,subtree:!0});function s(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerPolicy&&(g.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?g.credentials="include":d.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function l(d){if(d.ep)return;d.ep=!0;const g=s(d);fetch(d.href,g)}})();var DL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function f1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var wP={exports:{}},Oy={},bP={exports:{}},an={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yp=Symbol.for("react.element"),LL=Symbol.for("react.portal"),zL=Symbol.for("react.fragment"),RL=Symbol.for("react.strict_mode"),OL=Symbol.for("react.profiler"),FL=Symbol.for("react.provider"),BL=Symbol.for("react.context"),jL=Symbol.for("react.forward_ref"),NL=Symbol.for("react.suspense"),UL=Symbol.for("react.memo"),VL=Symbol.for("react.lazy"),EE=Symbol.iterator;function $L(e){return e===null||typeof e!="object"?null:(e=EE&&e[EE]||e["@@iterator"],typeof e=="function"?e:null)}var TP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},EP=Object.assign,SP={};function Lh(e,n,s){this.props=e,this.context=n,this.refs=SP,this.updater=s||TP}Lh.prototype.isReactComponent={};Lh.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};Lh.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function CP(){}CP.prototype=Lh.prototype;function p1(e,n,s){this.props=e,this.context=n,this.refs=SP,this.updater=s||TP}var m1=p1.prototype=new CP;m1.constructor=p1;EP(m1,Lh.prototype);m1.isPureReactComponent=!0;var SE=Array.isArray,PP=Object.prototype.hasOwnProperty,g1={current:null},MP={key:!0,ref:!0,__self:!0,__source:!0};function kP(e,n,s){var l,d={},g=null,x=null;if(n!=null)for(l in n.ref!==void 0&&(x=n.ref),n.key!==void 0&&(g=""+n.key),n)PP.call(n,l)&&!MP.hasOwnProperty(l)&&(d[l]=n[l]);var E=arguments.length-2;if(E===1)d.children=s;else if(1<E){for(var a=Array(E),P=0;P<E;P++)a[P]=arguments[P+2];d.children=a}if(e&&e.defaultProps)for(l in E=e.defaultProps,E)d[l]===void 0&&(d[l]=E[l]);return{$$typeof:yp,type:e,key:g,ref:x,props:d,_owner:g1.current}}function GL(e,n){return{$$typeof:yp,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function y1(e){return typeof e=="object"&&e!==null&&e.$$typeof===yp}function WL(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return n[s]})}var CE=/\/+/g;function qv(e,n){return typeof e=="object"&&e!==null&&e.key!=null?WL(""+e.key):n.toString(36)}function Cg(e,n,s,l,d){var g=typeof e;(g==="undefined"||g==="boolean")&&(e=null);var x=!1;if(e===null)x=!0;else switch(g){case"string":case"number":x=!0;break;case"object":switch(e.$$typeof){case yp:case LL:x=!0}}if(x)return x=e,d=d(x),e=l===""?"."+qv(x,0):l,SE(d)?(s="",e!=null&&(s=e.replace(CE,"$&/")+"/"),Cg(d,n,s,"",function(P){return P})):d!=null&&(y1(d)&&(d=GL(d,s+(!d.key||x&&x.key===d.key?"":(""+d.key).replace(CE,"$&/")+"/")+e)),n.push(d)),1;if(x=0,l=l===""?".":l+":",SE(e))for(var E=0;E<e.length;E++){g=e[E];var a=l+qv(g,E);x+=Cg(g,n,s,a,d)}else if(a=$L(e),typeof a=="function")for(e=a.call(e),E=0;!(g=e.next()).done;)g=g.value,a=l+qv(g,E++),x+=Cg(g,n,s,a,d);else if(g==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return x}function eg(e,n,s){if(e==null)return e;var l=[],d=0;return Cg(e,l,"","",function(g){return n.call(s,g,d++)}),l}function ZL(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var gi={current:null},Pg={transition:null},qL={ReactCurrentDispatcher:gi,ReactCurrentBatchConfig:Pg,ReactCurrentOwner:g1};function IP(){throw Error("act(...) is not supported in production builds of React.")}an.Children={map:eg,forEach:function(e,n,s){eg(e,function(){n.apply(this,arguments)},s)},count:function(e){var n=0;return eg(e,function(){n++}),n},toArray:function(e){return eg(e,function(n){return n})||[]},only:function(e){if(!y1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};an.Component=Lh;an.Fragment=zL;an.Profiler=OL;an.PureComponent=p1;an.StrictMode=RL;an.Suspense=NL;an.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qL;an.act=IP;an.cloneElement=function(e,n,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=EP({},e.props),d=e.key,g=e.ref,x=e._owner;if(n!=null){if(n.ref!==void 0&&(g=n.ref,x=g1.current),n.key!==void 0&&(d=""+n.key),e.type&&e.type.defaultProps)var E=e.type.defaultProps;for(a in n)PP.call(n,a)&&!MP.hasOwnProperty(a)&&(l[a]=n[a]===void 0&&E!==void 0?E[a]:n[a])}var a=arguments.length-2;if(a===1)l.children=s;else if(1<a){E=Array(a);for(var P=0;P<a;P++)E[P]=arguments[P+2];l.children=E}return{$$typeof:yp,type:e.type,key:d,ref:g,props:l,_owner:x}};an.createContext=function(e){return e={$$typeof:BL,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:FL,_context:e},e.Consumer=e};an.createElement=kP;an.createFactory=function(e){var n=kP.bind(null,e);return n.type=e,n};an.createRef=function(){return{current:null}};an.forwardRef=function(e){return{$$typeof:jL,render:e}};an.isValidElement=y1;an.lazy=function(e){return{$$typeof:VL,_payload:{_status:-1,_result:e},_init:ZL}};an.memo=function(e,n){return{$$typeof:UL,type:e,compare:n===void 0?null:n}};an.startTransition=function(e){var n=Pg.transition;Pg.transition={};try{e()}finally{Pg.transition=n}};an.unstable_act=IP;an.useCallback=function(e,n){return gi.current.useCallback(e,n)};an.useContext=function(e){return gi.current.useContext(e)};an.useDebugValue=function(){};an.useDeferredValue=function(e){return gi.current.useDeferredValue(e)};an.useEffect=function(e,n){return gi.current.useEffect(e,n)};an.useId=function(){return gi.current.useId()};an.useImperativeHandle=function(e,n,s){return gi.current.useImperativeHandle(e,n,s)};an.useInsertionEffect=function(e,n){return gi.current.useInsertionEffect(e,n)};an.useLayoutEffect=function(e,n){return gi.current.useLayoutEffect(e,n)};an.useMemo=function(e,n){return gi.current.useMemo(e,n)};an.useReducer=function(e,n,s){return gi.current.useReducer(e,n,s)};an.useRef=function(e){return gi.current.useRef(e)};an.useState=function(e){return gi.current.useState(e)};an.useSyncExternalStore=function(e,n,s){return gi.current.useSyncExternalStore(e,n,s)};an.useTransition=function(){return gi.current.useTransition()};an.version="18.3.1";bP.exports=an;var Q=bP.exports;const An=f1(Q),G0=AL({__proto__:null,default:An},[Q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HL=Q,XL=Symbol.for("react.element"),KL=Symbol.for("react.fragment"),YL=Object.prototype.hasOwnProperty,JL=HL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QL={key:!0,ref:!0,__self:!0,__source:!0};function AP(e,n,s){var l,d={},g=null,x=null;s!==void 0&&(g=""+s),n.key!==void 0&&(g=""+n.key),n.ref!==void 0&&(x=n.ref);for(l in n)YL.call(n,l)&&!QL.hasOwnProperty(l)&&(d[l]=n[l]);if(e&&e.defaultProps)for(l in n=e.defaultProps,n)d[l]===void 0&&(d[l]=n[l]);return{$$typeof:XL,type:e,key:g,ref:x,props:d,_owner:JL.current}}Oy.Fragment=KL;Oy.jsx=AP;Oy.jsxs=AP;wP.exports=Oy;var ee=wP.exports,W0={},DP={exports:{}},Ki={},LP={exports:{}},zP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(st,He){var bt=st.length;st.push(He);e:for(;0<bt;){var yt=bt-1>>>1,Nt=st[yt];if(0<d(Nt,He))st[yt]=He,st[bt]=Nt,bt=yt;else break e}}function s(st){return st.length===0?null:st[0]}function l(st){if(st.length===0)return null;var He=st[0],bt=st.pop();if(bt!==He){st[0]=bt;e:for(var yt=0,Nt=st.length,ur=Nt>>>1;yt<ur;){var ln=2*(yt+1)-1,pr=st[ln],Wn=ln+1,Xn=st[Wn];if(0>d(pr,bt))Wn<Nt&&0>d(Xn,pr)?(st[yt]=Xn,st[Wn]=bt,yt=Wn):(st[yt]=pr,st[ln]=bt,yt=ln);else if(Wn<Nt&&0>d(Xn,bt))st[yt]=Xn,st[Wn]=bt,yt=Wn;else break e}}return He}function d(st,He){var bt=st.sortIndex-He.sortIndex;return bt!==0?bt:st.id-He.id}if(typeof performance=="object"&&typeof performance.now=="function"){var g=performance;e.unstable_now=function(){return g.now()}}else{var x=Date,E=x.now();e.unstable_now=function(){return x.now()-E}}var a=[],P=[],A=1,R=null,F=3,j=!1,Z=!1,se=!1,ve=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Y(st){for(var He=s(P);He!==null;){if(He.callback===null)l(P);else if(He.startTime<=st)l(P),He.sortIndex=He.expirationTime,n(a,He);else break;He=s(P)}}function fe(st){if(se=!1,Y(st),!Z)if(s(a)!==null)Z=!0,It(Ce);else{var He=s(P);He!==null&&Kt(fe,He.startTime-st)}}function Ce(st,He){Z=!1,se&&(se=!1,X(je),je=-1),j=!0;var bt=F;try{for(Y(He),R=s(a);R!==null&&(!(R.expirationTime>He)||st&&!mt());){var yt=R.callback;if(typeof yt=="function"){R.callback=null,F=R.priorityLevel;var Nt=yt(R.expirationTime<=He);He=e.unstable_now(),typeof Nt=="function"?R.callback=Nt:R===s(a)&&l(a),Y(He)}else l(a);R=s(a)}if(R!==null)var ur=!0;else{var ln=s(P);ln!==null&&Kt(fe,ln.startTime-He),ur=!1}return ur}finally{R=null,F=bt,j=!1}}var Ue=!1,Ge=null,je=-1,nt=5,Te=-1;function mt(){return!(e.unstable_now()-Te<nt)}function Dt(){if(Ge!==null){var st=e.unstable_now();Te=st;var He=!0;try{He=Ge(!0,st)}finally{He?xt():(Ue=!1,Ge=null)}}else Ue=!1}var xt;if(typeof H=="function")xt=function(){H(Dt)};else if(typeof MessageChannel<"u"){var kt=new MessageChannel,lt=kt.port2;kt.port1.onmessage=Dt,xt=function(){lt.postMessage(null)}}else xt=function(){ve(Dt,0)};function It(st){Ge=st,Ue||(Ue=!0,xt())}function Kt(st,He){je=ve(function(){st(e.unstable_now())},He)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(st){st.callback=null},e.unstable_continueExecution=function(){Z||j||(Z=!0,It(Ce))},e.unstable_forceFrameRate=function(st){0>st||125<st?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):nt=0<st?Math.floor(1e3/st):5},e.unstable_getCurrentPriorityLevel=function(){return F},e.unstable_getFirstCallbackNode=function(){return s(a)},e.unstable_next=function(st){switch(F){case 1:case 2:case 3:var He=3;break;default:He=F}var bt=F;F=He;try{return st()}finally{F=bt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(st,He){switch(st){case 1:case 2:case 3:case 4:case 5:break;default:st=3}var bt=F;F=st;try{return He()}finally{F=bt}},e.unstable_scheduleCallback=function(st,He,bt){var yt=e.unstable_now();switch(typeof bt=="object"&&bt!==null?(bt=bt.delay,bt=typeof bt=="number"&&0<bt?yt+bt:yt):bt=yt,st){case 1:var Nt=-1;break;case 2:Nt=250;break;case 5:Nt=1073741823;break;case 4:Nt=1e4;break;default:Nt=5e3}return Nt=bt+Nt,st={id:A++,callback:He,priorityLevel:st,startTime:bt,expirationTime:Nt,sortIndex:-1},bt>yt?(st.sortIndex=bt,n(P,st),s(a)===null&&st===s(P)&&(se?(X(je),je=-1):se=!0,Kt(fe,bt-yt))):(st.sortIndex=Nt,n(a,st),Z||j||(Z=!0,It(Ce))),st},e.unstable_shouldYield=mt,e.unstable_wrapCallback=function(st){var He=F;return function(){var bt=F;F=He;try{return st.apply(this,arguments)}finally{F=bt}}}})(zP);LP.exports=zP;var ez=LP.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tz=Q,Hi=ez;function ct(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var RP=new Set,qf={};function jc(e,n){Th(e,n),Th(e+"Capture",n)}function Th(e,n){for(qf[e]=n,e=0;e<n.length;e++)RP.add(n[e])}var Js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Z0=Object.prototype.hasOwnProperty,nz=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,PE={},ME={};function rz(e){return Z0.call(ME,e)?!0:Z0.call(PE,e)?!1:nz.test(e)?ME[e]=!0:(PE[e]=!0,!1)}function iz(e,n,s,l){if(s!==null&&s.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return l?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function oz(e,n,s,l){if(n===null||typeof n>"u"||iz(e,n,s,l))return!0;if(l)return!1;if(s!==null)switch(s.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function yi(e,n,s,l,d,g,x){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=l,this.attributeNamespace=d,this.mustUseProperty=s,this.propertyName=e,this.type=n,this.sanitizeURL=g,this.removeEmptyString=x}var Zr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Zr[e]=new yi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];Zr[n]=new yi(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Zr[e]=new yi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Zr[e]=new yi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Zr[e]=new yi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Zr[e]=new yi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Zr[e]=new yi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Zr[e]=new yi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Zr[e]=new yi(e,5,!1,e.toLowerCase(),null,!1,!1)});var _1=/[\-:]([a-z])/g;function v1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(_1,v1);Zr[n]=new yi(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(_1,v1);Zr[n]=new yi(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(_1,v1);Zr[n]=new yi(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Zr[e]=new yi(e,1,!1,e.toLowerCase(),null,!1,!1)});Zr.xlinkHref=new yi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Zr[e]=new yi(e,1,!1,e.toLowerCase(),null,!0,!0)});function x1(e,n,s,l){var d=Zr.hasOwnProperty(n)?Zr[n]:null;(d!==null?d.type!==0:l||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(oz(n,s,d,l)&&(s=null),l||d===null?rz(n)&&(s===null?e.removeAttribute(n):e.setAttribute(n,""+s)):d.mustUseProperty?e[d.propertyName]=s===null?d.type===3?!1:"":s:(n=d.attributeName,l=d.attributeNamespace,s===null?e.removeAttribute(n):(d=d.type,s=d===3||d===4&&s===!0?"":""+s,l?e.setAttributeNS(l,n,s):e.setAttribute(n,s))))}var ia=tz.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tg=Symbol.for("react.element"),th=Symbol.for("react.portal"),nh=Symbol.for("react.fragment"),w1=Symbol.for("react.strict_mode"),q0=Symbol.for("react.profiler"),OP=Symbol.for("react.provider"),FP=Symbol.for("react.context"),b1=Symbol.for("react.forward_ref"),H0=Symbol.for("react.suspense"),X0=Symbol.for("react.suspense_list"),T1=Symbol.for("react.memo"),$a=Symbol.for("react.lazy"),BP=Symbol.for("react.offscreen"),kE=Symbol.iterator;function mf(e){return e===null||typeof e!="object"?null:(e=kE&&e[kE]||e["@@iterator"],typeof e=="function"?e:null)}var cr=Object.assign,Hv;function Mf(e){if(Hv===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);Hv=n&&n[1]||""}return`
`+Hv+e}var Xv=!1;function Kv(e,n){if(!e||Xv)return"";Xv=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(P){var l=P}Reflect.construct(e,[],n)}else{try{n.call()}catch(P){l=P}e.call(n.prototype)}else{try{throw Error()}catch(P){l=P}e()}}catch(P){if(P&&l&&typeof P.stack=="string"){for(var d=P.stack.split(`
`),g=l.stack.split(`
`),x=d.length-1,E=g.length-1;1<=x&&0<=E&&d[x]!==g[E];)E--;for(;1<=x&&0<=E;x--,E--)if(d[x]!==g[E]){if(x!==1||E!==1)do if(x--,E--,0>E||d[x]!==g[E]){var a=`
`+d[x].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}while(1<=x&&0<=E);break}}}finally{Xv=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Mf(e):""}function sz(e){switch(e.tag){case 5:return Mf(e.type);case 16:return Mf("Lazy");case 13:return Mf("Suspense");case 19:return Mf("SuspenseList");case 0:case 2:case 15:return e=Kv(e.type,!1),e;case 11:return e=Kv(e.type.render,!1),e;case 1:return e=Kv(e.type,!0),e;default:return""}}function K0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case nh:return"Fragment";case th:return"Portal";case q0:return"Profiler";case w1:return"StrictMode";case H0:return"Suspense";case X0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case FP:return(e.displayName||"Context")+".Consumer";case OP:return(e._context.displayName||"Context")+".Provider";case b1:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case T1:return n=e.displayName||null,n!==null?n:K0(e.type)||"Memo";case $a:n=e._payload,e=e._init;try{return K0(e(n))}catch{}}return null}function az(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K0(n);case 8:return n===w1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function ul(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function jP(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function lz(e){var n=jP(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),l=""+e[n];if(!e.hasOwnProperty(n)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var d=s.get,g=s.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return d.call(this)},set:function(x){l=""+x,g.call(this,x)}}),Object.defineProperty(e,n,{enumerable:s.enumerable}),{getValue:function(){return l},setValue:function(x){l=""+x},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function ng(e){e._valueTracker||(e._valueTracker=lz(e))}function NP(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var s=n.getValue(),l="";return e&&(l=jP(e)?e.checked?"true":"false":e.value),e=l,e!==s?(n.setValue(e),!0):!1}function qg(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Y0(e,n){var s=n.checked;return cr({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function IE(e,n){var s=n.defaultValue==null?"":n.defaultValue,l=n.checked!=null?n.checked:n.defaultChecked;s=ul(n.value!=null?n.value:s),e._wrapperState={initialChecked:l,initialValue:s,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function UP(e,n){n=n.checked,n!=null&&x1(e,"checked",n,!1)}function J0(e,n){UP(e,n);var s=ul(n.value),l=n.type;if(s!=null)l==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?Q0(e,n.type,s):n.hasOwnProperty("defaultValue")&&Q0(e,n.type,ul(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function AE(e,n,s){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var l=n.type;if(!(l!=="submit"&&l!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,s||n===e.value||(e.value=n),e.defaultValue=n}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function Q0(e,n,s){(n!=="number"||qg(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var kf=Array.isArray;function yh(e,n,s,l){if(e=e.options,n){n={};for(var d=0;d<s.length;d++)n["$"+s[d]]=!0;for(s=0;s<e.length;s++)d=n.hasOwnProperty("$"+e[s].value),e[s].selected!==d&&(e[s].selected=d),d&&l&&(e[s].defaultSelected=!0)}else{for(s=""+ul(s),n=null,d=0;d<e.length;d++){if(e[d].value===s){e[d].selected=!0,l&&(e[d].defaultSelected=!0);return}n!==null||e[d].disabled||(n=e[d])}n!==null&&(n.selected=!0)}}function ex(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(ct(91));return cr({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function DE(e,n){var s=n.value;if(s==null){if(s=n.children,n=n.defaultValue,s!=null){if(n!=null)throw Error(ct(92));if(kf(s)){if(1<s.length)throw Error(ct(93));s=s[0]}n=s}n==null&&(n=""),s=n}e._wrapperState={initialValue:ul(s)}}function VP(e,n){var s=ul(n.value),l=ul(n.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),n.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),l!=null&&(e.defaultValue=""+l)}function LE(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function $P(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tx(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?$P(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var rg,GP=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,s,l,d){MSApp.execUnsafeLocalFunction(function(){return e(n,s,l,d)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(rg=rg||document.createElement("div"),rg.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=rg.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Hf(e,n){if(n){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=n;return}}e.textContent=n}var zf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cz=["Webkit","ms","Moz","O"];Object.keys(zf).forEach(function(e){cz.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),zf[n]=zf[e]})});function WP(e,n,s){return n==null||typeof n=="boolean"||n===""?"":s||typeof n!="number"||n===0||zf.hasOwnProperty(e)&&zf[e]?(""+n).trim():n+"px"}function ZP(e,n){e=e.style;for(var s in n)if(n.hasOwnProperty(s)){var l=s.indexOf("--")===0,d=WP(s,n[s],l);s==="float"&&(s="cssFloat"),l?e.setProperty(s,d):e[s]=d}}var uz=cr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nx(e,n){if(n){if(uz[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(ct(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(ct(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(ct(61))}if(n.style!=null&&typeof n.style!="object")throw Error(ct(62))}}function rx(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ix=null;function E1(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ox=null,_h=null,vh=null;function zE(e){if(e=xp(e)){if(typeof ox!="function")throw Error(ct(280));var n=e.stateNode;n&&(n=Uy(n),ox(e.stateNode,e.type,n))}}function qP(e){_h?vh?vh.push(e):vh=[e]:_h=e}function HP(){if(_h){var e=_h,n=vh;if(vh=_h=null,zE(e),n)for(e=0;e<n.length;e++)zE(n[e])}}function XP(e,n){return e(n)}function KP(){}var Yv=!1;function YP(e,n,s){if(Yv)return e(n,s);Yv=!0;try{return XP(e,n,s)}finally{Yv=!1,(_h!==null||vh!==null)&&(KP(),HP())}}function Xf(e,n){var s=e.stateNode;if(s===null)return null;var l=Uy(s);if(l===null)return null;s=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(ct(231,n,typeof s));return s}var sx=!1;if(Js)try{var gf={};Object.defineProperty(gf,"passive",{get:function(){sx=!0}}),window.addEventListener("test",gf,gf),window.removeEventListener("test",gf,gf)}catch{sx=!1}function hz(e,n,s,l,d,g,x,E,a){var P=Array.prototype.slice.call(arguments,3);try{n.apply(s,P)}catch(A){this.onError(A)}}var Rf=!1,Hg=null,Xg=!1,ax=null,dz={onError:function(e){Rf=!0,Hg=e}};function fz(e,n,s,l,d,g,x,E,a){Rf=!1,Hg=null,hz.apply(dz,arguments)}function pz(e,n,s,l,d,g,x,E,a){if(fz.apply(this,arguments),Rf){if(Rf){var P=Hg;Rf=!1,Hg=null}else throw Error(ct(198));Xg||(Xg=!0,ax=P)}}function Nc(e){var n=e,s=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(s=n.return),e=n.return;while(e)}return n.tag===3?s:null}function JP(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function RE(e){if(Nc(e)!==e)throw Error(ct(188))}function mz(e){var n=e.alternate;if(!n){if(n=Nc(e),n===null)throw Error(ct(188));return n!==e?null:e}for(var s=e,l=n;;){var d=s.return;if(d===null)break;var g=d.alternate;if(g===null){if(l=d.return,l!==null){s=l;continue}break}if(d.child===g.child){for(g=d.child;g;){if(g===s)return RE(d),e;if(g===l)return RE(d),n;g=g.sibling}throw Error(ct(188))}if(s.return!==l.return)s=d,l=g;else{for(var x=!1,E=d.child;E;){if(E===s){x=!0,s=d,l=g;break}if(E===l){x=!0,l=d,s=g;break}E=E.sibling}if(!x){for(E=g.child;E;){if(E===s){x=!0,s=g,l=d;break}if(E===l){x=!0,l=g,s=d;break}E=E.sibling}if(!x)throw Error(ct(189))}}if(s.alternate!==l)throw Error(ct(190))}if(s.tag!==3)throw Error(ct(188));return s.stateNode.current===s?e:n}function QP(e){return e=mz(e),e!==null?eM(e):null}function eM(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=eM(e);if(n!==null)return n;e=e.sibling}return null}var tM=Hi.unstable_scheduleCallback,OE=Hi.unstable_cancelCallback,gz=Hi.unstable_shouldYield,yz=Hi.unstable_requestPaint,mr=Hi.unstable_now,_z=Hi.unstable_getCurrentPriorityLevel,S1=Hi.unstable_ImmediatePriority,nM=Hi.unstable_UserBlockingPriority,Kg=Hi.unstable_NormalPriority,vz=Hi.unstable_LowPriority,rM=Hi.unstable_IdlePriority,Fy=null,ps=null;function xz(e){if(ps&&typeof ps.onCommitFiberRoot=="function")try{ps.onCommitFiberRoot(Fy,e,void 0,(e.current.flags&128)===128)}catch{}}var qo=Math.clz32?Math.clz32:Tz,wz=Math.log,bz=Math.LN2;function Tz(e){return e>>>=0,e===0?32:31-(wz(e)/bz|0)|0}var ig=64,og=4194304;function If(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yg(e,n){var s=e.pendingLanes;if(s===0)return 0;var l=0,d=e.suspendedLanes,g=e.pingedLanes,x=s&268435455;if(x!==0){var E=x&~d;E!==0?l=If(E):(g&=x,g!==0&&(l=If(g)))}else x=s&~d,x!==0?l=If(x):g!==0&&(l=If(g));if(l===0)return 0;if(n!==0&&n!==l&&!(n&d)&&(d=l&-l,g=n&-n,d>=g||d===16&&(g&4194240)!==0))return n;if(l&4&&(l|=s&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=l;0<n;)s=31-qo(n),d=1<<s,l|=e[s],n&=~d;return l}function Ez(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sz(e,n){for(var s=e.suspendedLanes,l=e.pingedLanes,d=e.expirationTimes,g=e.pendingLanes;0<g;){var x=31-qo(g),E=1<<x,a=d[x];a===-1?(!(E&s)||E&l)&&(d[x]=Ez(E,n)):a<=n&&(e.expiredLanes|=E),g&=~E}}function lx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function iM(){var e=ig;return ig<<=1,!(ig&4194240)&&(ig=64),e}function Jv(e){for(var n=[],s=0;31>s;s++)n.push(e);return n}function _p(e,n,s){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-qo(n),e[n]=s}function Cz(e,n){var s=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<s;){var d=31-qo(s),g=1<<d;n[d]=0,l[d]=-1,e[d]=-1,s&=~g}}function C1(e,n){var s=e.entangledLanes|=n;for(e=e.entanglements;s;){var l=31-qo(s),d=1<<l;d&n|e[l]&n&&(e[l]|=n),s&=~d}}var Dn=0;function oM(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sM,P1,aM,lM,cM,cx=!1,sg=[],Qa=null,el=null,tl=null,Kf=new Map,Yf=new Map,qa=[],Pz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function FE(e,n){switch(e){case"focusin":case"focusout":Qa=null;break;case"dragenter":case"dragleave":el=null;break;case"mouseover":case"mouseout":tl=null;break;case"pointerover":case"pointerout":Kf.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yf.delete(n.pointerId)}}function yf(e,n,s,l,d,g){return e===null||e.nativeEvent!==g?(e={blockedOn:n,domEventName:s,eventSystemFlags:l,nativeEvent:g,targetContainers:[d]},n!==null&&(n=xp(n),n!==null&&P1(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,d!==null&&n.indexOf(d)===-1&&n.push(d),e)}function Mz(e,n,s,l,d){switch(n){case"focusin":return Qa=yf(Qa,e,n,s,l,d),!0;case"dragenter":return el=yf(el,e,n,s,l,d),!0;case"mouseover":return tl=yf(tl,e,n,s,l,d),!0;case"pointerover":var g=d.pointerId;return Kf.set(g,yf(Kf.get(g)||null,e,n,s,l,d)),!0;case"gotpointercapture":return g=d.pointerId,Yf.set(g,yf(Yf.get(g)||null,e,n,s,l,d)),!0}return!1}function uM(e){var n=wc(e.target);if(n!==null){var s=Nc(n);if(s!==null){if(n=s.tag,n===13){if(n=JP(s),n!==null){e.blockedOn=n,cM(e.priority,function(){aM(s)});return}}else if(n===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Mg(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var s=ux(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var l=new s.constructor(s.type,s);ix=l,s.target.dispatchEvent(l),ix=null}else return n=xp(s),n!==null&&P1(n),e.blockedOn=s,!1;n.shift()}return!0}function BE(e,n,s){Mg(e)&&s.delete(n)}function kz(){cx=!1,Qa!==null&&Mg(Qa)&&(Qa=null),el!==null&&Mg(el)&&(el=null),tl!==null&&Mg(tl)&&(tl=null),Kf.forEach(BE),Yf.forEach(BE)}function _f(e,n){e.blockedOn===n&&(e.blockedOn=null,cx||(cx=!0,Hi.unstable_scheduleCallback(Hi.unstable_NormalPriority,kz)))}function Jf(e){function n(d){return _f(d,e)}if(0<sg.length){_f(sg[0],e);for(var s=1;s<sg.length;s++){var l=sg[s];l.blockedOn===e&&(l.blockedOn=null)}}for(Qa!==null&&_f(Qa,e),el!==null&&_f(el,e),tl!==null&&_f(tl,e),Kf.forEach(n),Yf.forEach(n),s=0;s<qa.length;s++)l=qa[s],l.blockedOn===e&&(l.blockedOn=null);for(;0<qa.length&&(s=qa[0],s.blockedOn===null);)uM(s),s.blockedOn===null&&qa.shift()}var xh=ia.ReactCurrentBatchConfig,Jg=!0;function Iz(e,n,s,l){var d=Dn,g=xh.transition;xh.transition=null;try{Dn=1,M1(e,n,s,l)}finally{Dn=d,xh.transition=g}}function Az(e,n,s,l){var d=Dn,g=xh.transition;xh.transition=null;try{Dn=4,M1(e,n,s,l)}finally{Dn=d,xh.transition=g}}function M1(e,n,s,l){if(Jg){var d=ux(e,n,s,l);if(d===null)l0(e,n,l,Qg,s),FE(e,l);else if(Mz(d,e,n,s,l))l.stopPropagation();else if(FE(e,l),n&4&&-1<Pz.indexOf(e)){for(;d!==null;){var g=xp(d);if(g!==null&&sM(g),g=ux(e,n,s,l),g===null&&l0(e,n,l,Qg,s),g===d)break;d=g}d!==null&&l.stopPropagation()}else l0(e,n,l,null,s)}}var Qg=null;function ux(e,n,s,l){if(Qg=null,e=E1(l),e=wc(e),e!==null)if(n=Nc(e),n===null)e=null;else if(s=n.tag,s===13){if(e=JP(n),e!==null)return e;e=null}else if(s===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Qg=e,null}function hM(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_z()){case S1:return 1;case nM:return 4;case Kg:case vz:return 16;case rM:return 536870912;default:return 16}default:return 16}}var Ka=null,k1=null,kg=null;function dM(){if(kg)return kg;var e,n=k1,s=n.length,l,d="value"in Ka?Ka.value:Ka.textContent,g=d.length;for(e=0;e<s&&n[e]===d[e];e++);var x=s-e;for(l=1;l<=x&&n[s-l]===d[g-l];l++);return kg=d.slice(e,1<l?1-l:void 0)}function Ig(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function ag(){return!0}function jE(){return!1}function Yi(e){function n(s,l,d,g,x){this._reactName=s,this._targetInst=d,this.type=l,this.nativeEvent=g,this.target=x,this.currentTarget=null;for(var E in e)e.hasOwnProperty(E)&&(s=e[E],this[E]=s?s(g):g[E]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?ag:jE,this.isPropagationStopped=jE,this}return cr(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=ag)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=ag)},persist:function(){},isPersistent:ag}),n}var zh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},I1=Yi(zh),vp=cr({},zh,{view:0,detail:0}),Dz=Yi(vp),Qv,e0,vf,By=cr({},vp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:A1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==vf&&(vf&&e.type==="mousemove"?(Qv=e.screenX-vf.screenX,e0=e.screenY-vf.screenY):e0=Qv=0,vf=e),Qv)},movementY:function(e){return"movementY"in e?e.movementY:e0}}),NE=Yi(By),Lz=cr({},By,{dataTransfer:0}),zz=Yi(Lz),Rz=cr({},vp,{relatedTarget:0}),t0=Yi(Rz),Oz=cr({},zh,{animationName:0,elapsedTime:0,pseudoElement:0}),Fz=Yi(Oz),Bz=cr({},zh,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),jz=Yi(Bz),Nz=cr({},zh,{data:0}),UE=Yi(Nz),Uz={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vz={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$z={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gz(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=$z[e])?!!n[e]:!1}function A1(){return Gz}var Wz=cr({},vp,{key:function(e){if(e.key){var n=Uz[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Ig(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Vz[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:A1,charCode:function(e){return e.type==="keypress"?Ig(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ig(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Zz=Yi(Wz),qz=cr({},By,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),VE=Yi(qz),Hz=cr({},vp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:A1}),Xz=Yi(Hz),Kz=cr({},zh,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yz=Yi(Kz),Jz=cr({},By,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Qz=Yi(Jz),eR=[9,13,27,32],D1=Js&&"CompositionEvent"in window,Of=null;Js&&"documentMode"in document&&(Of=document.documentMode);var tR=Js&&"TextEvent"in window&&!Of,fM=Js&&(!D1||Of&&8<Of&&11>=Of),$E=" ",GE=!1;function pM(e,n){switch(e){case"keyup":return eR.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mM(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var rh=!1;function nR(e,n){switch(e){case"compositionend":return mM(n);case"keypress":return n.which!==32?null:(GE=!0,$E);case"textInput":return e=n.data,e===$E&&GE?null:e;default:return null}}function rR(e,n){if(rh)return e==="compositionend"||!D1&&pM(e,n)?(e=dM(),kg=k1=Ka=null,rh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return fM&&n.locale!=="ko"?null:n.data;default:return null}}var iR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function WE(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!iR[e.type]:n==="textarea"}function gM(e,n,s,l){qP(l),n=ey(n,"onChange"),0<n.length&&(s=new I1("onChange","change",null,s,l),e.push({event:s,listeners:n}))}var Ff=null,Qf=null;function oR(e){PM(e,0)}function jy(e){var n=sh(e);if(NP(n))return e}function sR(e,n){if(e==="change")return n}var yM=!1;if(Js){var n0;if(Js){var r0="oninput"in document;if(!r0){var ZE=document.createElement("div");ZE.setAttribute("oninput","return;"),r0=typeof ZE.oninput=="function"}n0=r0}else n0=!1;yM=n0&&(!document.documentMode||9<document.documentMode)}function qE(){Ff&&(Ff.detachEvent("onpropertychange",_M),Qf=Ff=null)}function _M(e){if(e.propertyName==="value"&&jy(Qf)){var n=[];gM(n,Qf,e,E1(e)),YP(oR,n)}}function aR(e,n,s){e==="focusin"?(qE(),Ff=n,Qf=s,Ff.attachEvent("onpropertychange",_M)):e==="focusout"&&qE()}function lR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return jy(Qf)}function cR(e,n){if(e==="click")return jy(n)}function uR(e,n){if(e==="input"||e==="change")return jy(n)}function hR(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Xo=typeof Object.is=="function"?Object.is:hR;function ep(e,n){if(Xo(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var s=Object.keys(e),l=Object.keys(n);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var d=s[l];if(!Z0.call(n,d)||!Xo(e[d],n[d]))return!1}return!0}function HE(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function XE(e,n){var s=HE(e);e=0;for(var l;s;){if(s.nodeType===3){if(l=e+s.textContent.length,e<=n&&l>=n)return{node:s,offset:n-e};e=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=HE(s)}}function vM(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?vM(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function xM(){for(var e=window,n=qg();n instanceof e.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)e=n.contentWindow;else break;n=qg(e.document)}return n}function L1(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function dR(e){var n=xM(),s=e.focusedElem,l=e.selectionRange;if(n!==s&&s&&s.ownerDocument&&vM(s.ownerDocument.documentElement,s)){if(l!==null&&L1(s)){if(n=l.start,e=l.end,e===void 0&&(e=n),"selectionStart"in s)s.selectionStart=n,s.selectionEnd=Math.min(e,s.value.length);else if(e=(n=s.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var d=s.textContent.length,g=Math.min(l.start,d);l=l.end===void 0?g:Math.min(l.end,d),!e.extend&&g>l&&(d=l,l=g,g=d),d=XE(s,g);var x=XE(s,l);d&&x&&(e.rangeCount!==1||e.anchorNode!==d.node||e.anchorOffset!==d.offset||e.focusNode!==x.node||e.focusOffset!==x.offset)&&(n=n.createRange(),n.setStart(d.node,d.offset),e.removeAllRanges(),g>l?(e.addRange(n),e.extend(x.node,x.offset)):(n.setEnd(x.node,x.offset),e.addRange(n)))}}for(n=[],e=s;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<n.length;s++)e=n[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fR=Js&&"documentMode"in document&&11>=document.documentMode,ih=null,hx=null,Bf=null,dx=!1;function KE(e,n,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;dx||ih==null||ih!==qg(l)||(l=ih,"selectionStart"in l&&L1(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Bf&&ep(Bf,l)||(Bf=l,l=ey(hx,"onSelect"),0<l.length&&(n=new I1("onSelect","select",null,n,s),e.push({event:n,listeners:l}),n.target=ih)))}function lg(e,n){var s={};return s[e.toLowerCase()]=n.toLowerCase(),s["Webkit"+e]="webkit"+n,s["Moz"+e]="moz"+n,s}var oh={animationend:lg("Animation","AnimationEnd"),animationiteration:lg("Animation","AnimationIteration"),animationstart:lg("Animation","AnimationStart"),transitionend:lg("Transition","TransitionEnd")},i0={},wM={};Js&&(wM=document.createElement("div").style,"AnimationEvent"in window||(delete oh.animationend.animation,delete oh.animationiteration.animation,delete oh.animationstart.animation),"TransitionEvent"in window||delete oh.transitionend.transition);function Ny(e){if(i0[e])return i0[e];if(!oh[e])return e;var n=oh[e],s;for(s in n)if(n.hasOwnProperty(s)&&s in wM)return i0[e]=n[s];return e}var bM=Ny("animationend"),TM=Ny("animationiteration"),EM=Ny("animationstart"),SM=Ny("transitionend"),CM=new Map,YE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pl(e,n){CM.set(e,n),jc(n,[e])}for(var o0=0;o0<YE.length;o0++){var s0=YE[o0],pR=s0.toLowerCase(),mR=s0[0].toUpperCase()+s0.slice(1);pl(pR,"on"+mR)}pl(bM,"onAnimationEnd");pl(TM,"onAnimationIteration");pl(EM,"onAnimationStart");pl("dblclick","onDoubleClick");pl("focusin","onFocus");pl("focusout","onBlur");pl(SM,"onTransitionEnd");Th("onMouseEnter",["mouseout","mouseover"]);Th("onMouseLeave",["mouseout","mouseover"]);Th("onPointerEnter",["pointerout","pointerover"]);Th("onPointerLeave",["pointerout","pointerover"]);jc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));jc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));jc("onBeforeInput",["compositionend","keypress","textInput","paste"]);jc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));jc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));jc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Af="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Af));function JE(e,n,s){var l=e.type||"unknown-event";e.currentTarget=s,pz(l,n,void 0,e),e.currentTarget=null}function PM(e,n){n=(n&4)!==0;for(var s=0;s<e.length;s++){var l=e[s],d=l.event;l=l.listeners;e:{var g=void 0;if(n)for(var x=l.length-1;0<=x;x--){var E=l[x],a=E.instance,P=E.currentTarget;if(E=E.listener,a!==g&&d.isPropagationStopped())break e;JE(d,E,P),g=a}else for(x=0;x<l.length;x++){if(E=l[x],a=E.instance,P=E.currentTarget,E=E.listener,a!==g&&d.isPropagationStopped())break e;JE(d,E,P),g=a}}}if(Xg)throw e=ax,Xg=!1,ax=null,e}function Vn(e,n){var s=n[yx];s===void 0&&(s=n[yx]=new Set);var l=e+"__bubble";s.has(l)||(MM(n,e,2,!1),s.add(l))}function a0(e,n,s){var l=0;n&&(l|=4),MM(s,e,l,n)}var cg="_reactListening"+Math.random().toString(36).slice(2);function tp(e){if(!e[cg]){e[cg]=!0,RP.forEach(function(s){s!=="selectionchange"&&(gR.has(s)||a0(s,!1,e),a0(s,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[cg]||(n[cg]=!0,a0("selectionchange",!1,n))}}function MM(e,n,s,l){switch(hM(n)){case 1:var d=Iz;break;case 4:d=Az;break;default:d=M1}s=d.bind(null,n,s,e),d=void 0,!sx||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(d=!0),l?d!==void 0?e.addEventListener(n,s,{capture:!0,passive:d}):e.addEventListener(n,s,!0):d!==void 0?e.addEventListener(n,s,{passive:d}):e.addEventListener(n,s,!1)}function l0(e,n,s,l,d){var g=l;if(!(n&1)&&!(n&2)&&l!==null)e:for(;;){if(l===null)return;var x=l.tag;if(x===3||x===4){var E=l.stateNode.containerInfo;if(E===d||E.nodeType===8&&E.parentNode===d)break;if(x===4)for(x=l.return;x!==null;){var a=x.tag;if((a===3||a===4)&&(a=x.stateNode.containerInfo,a===d||a.nodeType===8&&a.parentNode===d))return;x=x.return}for(;E!==null;){if(x=wc(E),x===null)return;if(a=x.tag,a===5||a===6){l=g=x;continue e}E=E.parentNode}}l=l.return}YP(function(){var P=g,A=E1(s),R=[];e:{var F=CM.get(e);if(F!==void 0){var j=I1,Z=e;switch(e){case"keypress":if(Ig(s)===0)break e;case"keydown":case"keyup":j=Zz;break;case"focusin":Z="focus",j=t0;break;case"focusout":Z="blur",j=t0;break;case"beforeblur":case"afterblur":j=t0;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=NE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=zz;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=Xz;break;case bM:case TM:case EM:j=Fz;break;case SM:j=Yz;break;case"scroll":j=Dz;break;case"wheel":j=Qz;break;case"copy":case"cut":case"paste":j=jz;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=VE}var se=(n&4)!==0,ve=!se&&e==="scroll",X=se?F!==null?F+"Capture":null:F;se=[];for(var H=P,Y;H!==null;){Y=H;var fe=Y.stateNode;if(Y.tag===5&&fe!==null&&(Y=fe,X!==null&&(fe=Xf(H,X),fe!=null&&se.push(np(H,fe,Y)))),ve)break;H=H.return}0<se.length&&(F=new j(F,Z,null,s,A),R.push({event:F,listeners:se}))}}if(!(n&7)){e:{if(F=e==="mouseover"||e==="pointerover",j=e==="mouseout"||e==="pointerout",F&&s!==ix&&(Z=s.relatedTarget||s.fromElement)&&(wc(Z)||Z[Qs]))break e;if((j||F)&&(F=A.window===A?A:(F=A.ownerDocument)?F.defaultView||F.parentWindow:window,j?(Z=s.relatedTarget||s.toElement,j=P,Z=Z?wc(Z):null,Z!==null&&(ve=Nc(Z),Z!==ve||Z.tag!==5&&Z.tag!==6)&&(Z=null)):(j=null,Z=P),j!==Z)){if(se=NE,fe="onMouseLeave",X="onMouseEnter",H="mouse",(e==="pointerout"||e==="pointerover")&&(se=VE,fe="onPointerLeave",X="onPointerEnter",H="pointer"),ve=j==null?F:sh(j),Y=Z==null?F:sh(Z),F=new se(fe,H+"leave",j,s,A),F.target=ve,F.relatedTarget=Y,fe=null,wc(A)===P&&(se=new se(X,H+"enter",Z,s,A),se.target=Y,se.relatedTarget=ve,fe=se),ve=fe,j&&Z)t:{for(se=j,X=Z,H=0,Y=se;Y;Y=Hu(Y))H++;for(Y=0,fe=X;fe;fe=Hu(fe))Y++;for(;0<H-Y;)se=Hu(se),H--;for(;0<Y-H;)X=Hu(X),Y--;for(;H--;){if(se===X||X!==null&&se===X.alternate)break t;se=Hu(se),X=Hu(X)}se=null}else se=null;j!==null&&QE(R,F,j,se,!1),Z!==null&&ve!==null&&QE(R,ve,Z,se,!0)}}e:{if(F=P?sh(P):window,j=F.nodeName&&F.nodeName.toLowerCase(),j==="select"||j==="input"&&F.type==="file")var Ce=sR;else if(WE(F))if(yM)Ce=uR;else{Ce=lR;var Ue=aR}else(j=F.nodeName)&&j.toLowerCase()==="input"&&(F.type==="checkbox"||F.type==="radio")&&(Ce=cR);if(Ce&&(Ce=Ce(e,P))){gM(R,Ce,s,A);break e}Ue&&Ue(e,F,P),e==="focusout"&&(Ue=F._wrapperState)&&Ue.controlled&&F.type==="number"&&Q0(F,"number",F.value)}switch(Ue=P?sh(P):window,e){case"focusin":(WE(Ue)||Ue.contentEditable==="true")&&(ih=Ue,hx=P,Bf=null);break;case"focusout":Bf=hx=ih=null;break;case"mousedown":dx=!0;break;case"contextmenu":case"mouseup":case"dragend":dx=!1,KE(R,s,A);break;case"selectionchange":if(fR)break;case"keydown":case"keyup":KE(R,s,A)}var Ge;if(D1)e:{switch(e){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else rh?pM(e,s)&&(je="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(je="onCompositionStart");je&&(fM&&s.locale!=="ko"&&(rh||je!=="onCompositionStart"?je==="onCompositionEnd"&&rh&&(Ge=dM()):(Ka=A,k1="value"in Ka?Ka.value:Ka.textContent,rh=!0)),Ue=ey(P,je),0<Ue.length&&(je=new UE(je,e,null,s,A),R.push({event:je,listeners:Ue}),Ge?je.data=Ge:(Ge=mM(s),Ge!==null&&(je.data=Ge)))),(Ge=tR?nR(e,s):rR(e,s))&&(P=ey(P,"onBeforeInput"),0<P.length&&(A=new UE("onBeforeInput","beforeinput",null,s,A),R.push({event:A,listeners:P}),A.data=Ge))}PM(R,n)})}function np(e,n,s){return{instance:e,listener:n,currentTarget:s}}function ey(e,n){for(var s=n+"Capture",l=[];e!==null;){var d=e,g=d.stateNode;d.tag===5&&g!==null&&(d=g,g=Xf(e,s),g!=null&&l.unshift(np(e,g,d)),g=Xf(e,n),g!=null&&l.push(np(e,g,d))),e=e.return}return l}function Hu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function QE(e,n,s,l,d){for(var g=n._reactName,x=[];s!==null&&s!==l;){var E=s,a=E.alternate,P=E.stateNode;if(a!==null&&a===l)break;E.tag===5&&P!==null&&(E=P,d?(a=Xf(s,g),a!=null&&x.unshift(np(s,a,E))):d||(a=Xf(s,g),a!=null&&x.push(np(s,a,E)))),s=s.return}x.length!==0&&e.push({event:n,listeners:x})}var yR=/\r\n?/g,_R=/\u0000|\uFFFD/g;function eS(e){return(typeof e=="string"?e:""+e).replace(yR,`
`).replace(_R,"")}function ug(e,n,s){if(n=eS(n),eS(e)!==n&&s)throw Error(ct(425))}function ty(){}var fx=null,px=null;function mx(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var gx=typeof setTimeout=="function"?setTimeout:void 0,vR=typeof clearTimeout=="function"?clearTimeout:void 0,tS=typeof Promise=="function"?Promise:void 0,xR=typeof queueMicrotask=="function"?queueMicrotask:typeof tS<"u"?function(e){return tS.resolve(null).then(e).catch(wR)}:gx;function wR(e){setTimeout(function(){throw e})}function c0(e,n){var s=n,l=0;do{var d=s.nextSibling;if(e.removeChild(s),d&&d.nodeType===8)if(s=d.data,s==="/$"){if(l===0){e.removeChild(d),Jf(n);return}l--}else s!=="$"&&s!=="$?"&&s!=="$!"||l++;s=d}while(s);Jf(n)}function nl(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function nS(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return e;n--}else s==="/$"&&n++}e=e.previousSibling}return null}var Rh=Math.random().toString(36).slice(2),fs="__reactFiber$"+Rh,rp="__reactProps$"+Rh,Qs="__reactContainer$"+Rh,yx="__reactEvents$"+Rh,bR="__reactListeners$"+Rh,TR="__reactHandles$"+Rh;function wc(e){var n=e[fs];if(n)return n;for(var s=e.parentNode;s;){if(n=s[Qs]||s[fs]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(e=nS(e);e!==null;){if(s=e[fs])return s;e=nS(e)}return n}e=s,s=e.parentNode}return null}function xp(e){return e=e[fs]||e[Qs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function sh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ct(33))}function Uy(e){return e[rp]||null}var _x=[],ah=-1;function ml(e){return{current:e}}function $n(e){0>ah||(e.current=_x[ah],_x[ah]=null,ah--)}function jn(e,n){ah++,_x[ah]=e.current,e.current=n}var hl={},oi=ml(hl),Di=ml(!1),Lc=hl;function Eh(e,n){var s=e.type.contextTypes;if(!s)return hl;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===n)return l.__reactInternalMemoizedMaskedChildContext;var d={},g;for(g in s)d[g]=n[g];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=d),d}function Li(e){return e=e.childContextTypes,e!=null}function ny(){$n(Di),$n(oi)}function rS(e,n,s){if(oi.current!==hl)throw Error(ct(168));jn(oi,n),jn(Di,s)}function kM(e,n,s){var l=e.stateNode;if(n=n.childContextTypes,typeof l.getChildContext!="function")return s;l=l.getChildContext();for(var d in l)if(!(d in n))throw Error(ct(108,az(e)||"Unknown",d));return cr({},s,l)}function ry(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||hl,Lc=oi.current,jn(oi,e),jn(Di,Di.current),!0}function iS(e,n,s){var l=e.stateNode;if(!l)throw Error(ct(169));s?(e=kM(e,n,Lc),l.__reactInternalMemoizedMergedChildContext=e,$n(Di),$n(oi),jn(oi,e)):$n(Di),jn(Di,s)}var Gs=null,Vy=!1,u0=!1;function IM(e){Gs===null?Gs=[e]:Gs.push(e)}function ER(e){Vy=!0,IM(e)}function gl(){if(!u0&&Gs!==null){u0=!0;var e=0,n=Dn;try{var s=Gs;for(Dn=1;e<s.length;e++){var l=s[e];do l=l(!0);while(l!==null)}Gs=null,Vy=!1}catch(d){throw Gs!==null&&(Gs=Gs.slice(e+1)),tM(S1,gl),d}finally{Dn=n,u0=!1}}return null}var lh=[],ch=0,iy=null,oy=0,ho=[],fo=0,zc=null,Ws=1,Zs="";function fc(e,n){lh[ch++]=oy,lh[ch++]=iy,iy=e,oy=n}function AM(e,n,s){ho[fo++]=Ws,ho[fo++]=Zs,ho[fo++]=zc,zc=e;var l=Ws;e=Zs;var d=32-qo(l)-1;l&=~(1<<d),s+=1;var g=32-qo(n)+d;if(30<g){var x=d-d%5;g=(l&(1<<x)-1).toString(32),l>>=x,d-=x,Ws=1<<32-qo(n)+d|s<<d|l,Zs=g+e}else Ws=1<<g|s<<d|l,Zs=e}function z1(e){e.return!==null&&(fc(e,1),AM(e,1,0))}function R1(e){for(;e===iy;)iy=lh[--ch],lh[ch]=null,oy=lh[--ch],lh[ch]=null;for(;e===zc;)zc=ho[--fo],ho[fo]=null,Zs=ho[--fo],ho[fo]=null,Ws=ho[--fo],ho[fo]=null}var qi=null,Wi=null,Hn=!1,Zo=null;function DM(e,n){var s=po(5,null,null,0);s.elementType="DELETED",s.stateNode=n,s.return=e,n=e.deletions,n===null?(e.deletions=[s],e.flags|=16):n.push(s)}function oS(e,n){switch(e.tag){case 5:var s=e.type;return n=n.nodeType!==1||s.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,qi=e,Wi=nl(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,qi=e,Wi=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(s=zc!==null?{id:Ws,overflow:Zs}:null,e.memoizedState={dehydrated:n,treeContext:s,retryLane:1073741824},s=po(18,null,null,0),s.stateNode=n,s.return=e,e.child=s,qi=e,Wi=null,!0):!1;default:return!1}}function vx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function xx(e){if(Hn){var n=Wi;if(n){var s=n;if(!oS(e,n)){if(vx(e))throw Error(ct(418));n=nl(s.nextSibling);var l=qi;n&&oS(e,n)?DM(l,s):(e.flags=e.flags&-4097|2,Hn=!1,qi=e)}}else{if(vx(e))throw Error(ct(418));e.flags=e.flags&-4097|2,Hn=!1,qi=e}}}function sS(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qi=e}function hg(e){if(e!==qi)return!1;if(!Hn)return sS(e),Hn=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!mx(e.type,e.memoizedProps)),n&&(n=Wi)){if(vx(e))throw LM(),Error(ct(418));for(;n;)DM(e,n),n=nl(n.nextSibling)}if(sS(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ct(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(n===0){Wi=nl(e.nextSibling);break e}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++}e=e.nextSibling}Wi=null}}else Wi=qi?nl(e.stateNode.nextSibling):null;return!0}function LM(){for(var e=Wi;e;)e=nl(e.nextSibling)}function Sh(){Wi=qi=null,Hn=!1}function O1(e){Zo===null?Zo=[e]:Zo.push(e)}var SR=ia.ReactCurrentBatchConfig;function xf(e,n,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(ct(309));var l=s.stateNode}if(!l)throw Error(ct(147,e));var d=l,g=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===g?n.ref:(n=function(x){var E=d.refs;x===null?delete E[g]:E[g]=x},n._stringRef=g,n)}if(typeof e!="string")throw Error(ct(284));if(!s._owner)throw Error(ct(290,e))}return e}function dg(e,n){throw e=Object.prototype.toString.call(n),Error(ct(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function aS(e){var n=e._init;return n(e._payload)}function zM(e){function n(X,H){if(e){var Y=X.deletions;Y===null?(X.deletions=[H],X.flags|=16):Y.push(H)}}function s(X,H){if(!e)return null;for(;H!==null;)n(X,H),H=H.sibling;return null}function l(X,H){for(X=new Map;H!==null;)H.key!==null?X.set(H.key,H):X.set(H.index,H),H=H.sibling;return X}function d(X,H){return X=sl(X,H),X.index=0,X.sibling=null,X}function g(X,H,Y){return X.index=Y,e?(Y=X.alternate,Y!==null?(Y=Y.index,Y<H?(X.flags|=2,H):Y):(X.flags|=2,H)):(X.flags|=1048576,H)}function x(X){return e&&X.alternate===null&&(X.flags|=2),X}function E(X,H,Y,fe){return H===null||H.tag!==6?(H=y0(Y,X.mode,fe),H.return=X,H):(H=d(H,Y),H.return=X,H)}function a(X,H,Y,fe){var Ce=Y.type;return Ce===nh?A(X,H,Y.props.children,fe,Y.key):H!==null&&(H.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===$a&&aS(Ce)===H.type)?(fe=d(H,Y.props),fe.ref=xf(X,H,Y),fe.return=X,fe):(fe=Fg(Y.type,Y.key,Y.props,null,X.mode,fe),fe.ref=xf(X,H,Y),fe.return=X,fe)}function P(X,H,Y,fe){return H===null||H.tag!==4||H.stateNode.containerInfo!==Y.containerInfo||H.stateNode.implementation!==Y.implementation?(H=_0(Y,X.mode,fe),H.return=X,H):(H=d(H,Y.children||[]),H.return=X,H)}function A(X,H,Y,fe,Ce){return H===null||H.tag!==7?(H=Ic(Y,X.mode,fe,Ce),H.return=X,H):(H=d(H,Y),H.return=X,H)}function R(X,H,Y){if(typeof H=="string"&&H!==""||typeof H=="number")return H=y0(""+H,X.mode,Y),H.return=X,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case tg:return Y=Fg(H.type,H.key,H.props,null,X.mode,Y),Y.ref=xf(X,null,H),Y.return=X,Y;case th:return H=_0(H,X.mode,Y),H.return=X,H;case $a:var fe=H._init;return R(X,fe(H._payload),Y)}if(kf(H)||mf(H))return H=Ic(H,X.mode,Y,null),H.return=X,H;dg(X,H)}return null}function F(X,H,Y,fe){var Ce=H!==null?H.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Ce!==null?null:E(X,H,""+Y,fe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case tg:return Y.key===Ce?a(X,H,Y,fe):null;case th:return Y.key===Ce?P(X,H,Y,fe):null;case $a:return Ce=Y._init,F(X,H,Ce(Y._payload),fe)}if(kf(Y)||mf(Y))return Ce!==null?null:A(X,H,Y,fe,null);dg(X,Y)}return null}function j(X,H,Y,fe,Ce){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return X=X.get(Y)||null,E(H,X,""+fe,Ce);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case tg:return X=X.get(fe.key===null?Y:fe.key)||null,a(H,X,fe,Ce);case th:return X=X.get(fe.key===null?Y:fe.key)||null,P(H,X,fe,Ce);case $a:var Ue=fe._init;return j(X,H,Y,Ue(fe._payload),Ce)}if(kf(fe)||mf(fe))return X=X.get(Y)||null,A(H,X,fe,Ce,null);dg(H,fe)}return null}function Z(X,H,Y,fe){for(var Ce=null,Ue=null,Ge=H,je=H=0,nt=null;Ge!==null&&je<Y.length;je++){Ge.index>je?(nt=Ge,Ge=null):nt=Ge.sibling;var Te=F(X,Ge,Y[je],fe);if(Te===null){Ge===null&&(Ge=nt);break}e&&Ge&&Te.alternate===null&&n(X,Ge),H=g(Te,H,je),Ue===null?Ce=Te:Ue.sibling=Te,Ue=Te,Ge=nt}if(je===Y.length)return s(X,Ge),Hn&&fc(X,je),Ce;if(Ge===null){for(;je<Y.length;je++)Ge=R(X,Y[je],fe),Ge!==null&&(H=g(Ge,H,je),Ue===null?Ce=Ge:Ue.sibling=Ge,Ue=Ge);return Hn&&fc(X,je),Ce}for(Ge=l(X,Ge);je<Y.length;je++)nt=j(Ge,X,je,Y[je],fe),nt!==null&&(e&&nt.alternate!==null&&Ge.delete(nt.key===null?je:nt.key),H=g(nt,H,je),Ue===null?Ce=nt:Ue.sibling=nt,Ue=nt);return e&&Ge.forEach(function(mt){return n(X,mt)}),Hn&&fc(X,je),Ce}function se(X,H,Y,fe){var Ce=mf(Y);if(typeof Ce!="function")throw Error(ct(150));if(Y=Ce.call(Y),Y==null)throw Error(ct(151));for(var Ue=Ce=null,Ge=H,je=H=0,nt=null,Te=Y.next();Ge!==null&&!Te.done;je++,Te=Y.next()){Ge.index>je?(nt=Ge,Ge=null):nt=Ge.sibling;var mt=F(X,Ge,Te.value,fe);if(mt===null){Ge===null&&(Ge=nt);break}e&&Ge&&mt.alternate===null&&n(X,Ge),H=g(mt,H,je),Ue===null?Ce=mt:Ue.sibling=mt,Ue=mt,Ge=nt}if(Te.done)return s(X,Ge),Hn&&fc(X,je),Ce;if(Ge===null){for(;!Te.done;je++,Te=Y.next())Te=R(X,Te.value,fe),Te!==null&&(H=g(Te,H,je),Ue===null?Ce=Te:Ue.sibling=Te,Ue=Te);return Hn&&fc(X,je),Ce}for(Ge=l(X,Ge);!Te.done;je++,Te=Y.next())Te=j(Ge,X,je,Te.value,fe),Te!==null&&(e&&Te.alternate!==null&&Ge.delete(Te.key===null?je:Te.key),H=g(Te,H,je),Ue===null?Ce=Te:Ue.sibling=Te,Ue=Te);return e&&Ge.forEach(function(Dt){return n(X,Dt)}),Hn&&fc(X,je),Ce}function ve(X,H,Y,fe){if(typeof Y=="object"&&Y!==null&&Y.type===nh&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case tg:e:{for(var Ce=Y.key,Ue=H;Ue!==null;){if(Ue.key===Ce){if(Ce=Y.type,Ce===nh){if(Ue.tag===7){s(X,Ue.sibling),H=d(Ue,Y.props.children),H.return=X,X=H;break e}}else if(Ue.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===$a&&aS(Ce)===Ue.type){s(X,Ue.sibling),H=d(Ue,Y.props),H.ref=xf(X,Ue,Y),H.return=X,X=H;break e}s(X,Ue);break}else n(X,Ue);Ue=Ue.sibling}Y.type===nh?(H=Ic(Y.props.children,X.mode,fe,Y.key),H.return=X,X=H):(fe=Fg(Y.type,Y.key,Y.props,null,X.mode,fe),fe.ref=xf(X,H,Y),fe.return=X,X=fe)}return x(X);case th:e:{for(Ue=Y.key;H!==null;){if(H.key===Ue)if(H.tag===4&&H.stateNode.containerInfo===Y.containerInfo&&H.stateNode.implementation===Y.implementation){s(X,H.sibling),H=d(H,Y.children||[]),H.return=X,X=H;break e}else{s(X,H);break}else n(X,H);H=H.sibling}H=_0(Y,X.mode,fe),H.return=X,X=H}return x(X);case $a:return Ue=Y._init,ve(X,H,Ue(Y._payload),fe)}if(kf(Y))return Z(X,H,Y,fe);if(mf(Y))return se(X,H,Y,fe);dg(X,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,H!==null&&H.tag===6?(s(X,H.sibling),H=d(H,Y),H.return=X,X=H):(s(X,H),H=y0(Y,X.mode,fe),H.return=X,X=H),x(X)):s(X,H)}return ve}var Ch=zM(!0),RM=zM(!1),sy=ml(null),ay=null,uh=null,F1=null;function B1(){F1=uh=ay=null}function j1(e){var n=sy.current;$n(sy),e._currentValue=n}function wx(e,n,s){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===s)break;e=e.return}}function wh(e,n){ay=e,F1=uh=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(Ai=!0),e.firstContext=null)}function go(e){var n=e._currentValue;if(F1!==e)if(e={context:e,memoizedValue:n,next:null},uh===null){if(ay===null)throw Error(ct(308));uh=e,ay.dependencies={lanes:0,firstContext:e}}else uh=uh.next=e;return n}var bc=null;function N1(e){bc===null?bc=[e]:bc.push(e)}function OM(e,n,s,l){var d=n.interleaved;return d===null?(s.next=s,N1(n)):(s.next=d.next,d.next=s),n.interleaved=s,ea(e,l)}function ea(e,n){e.lanes|=n;var s=e.alternate;for(s!==null&&(s.lanes|=n),s=e,e=e.return;e!==null;)e.childLanes|=n,s=e.alternate,s!==null&&(s.childLanes|=n),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Ga=!1;function U1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function FM(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Xs(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function rl(e,n,s){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,dn&2){var d=l.pending;return d===null?n.next=n:(n.next=d.next,d.next=n),l.pending=n,ea(e,s)}return d=l.interleaved,d===null?(n.next=n,N1(l)):(n.next=d.next,d.next=n),l.interleaved=n,ea(e,s)}function Ag(e,n,s){if(n=n.updateQueue,n!==null&&(n=n.shared,(s&4194240)!==0)){var l=n.lanes;l&=e.pendingLanes,s|=l,n.lanes=s,C1(e,s)}}function lS(e,n){var s=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var d=null,g=null;if(s=s.firstBaseUpdate,s!==null){do{var x={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};g===null?d=g=x:g=g.next=x,s=s.next}while(s!==null);g===null?d=g=n:g=g.next=n}else d=g=n;s={baseState:l.baseState,firstBaseUpdate:d,lastBaseUpdate:g,shared:l.shared,effects:l.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=n:e.next=n,s.lastBaseUpdate=n}function ly(e,n,s,l){var d=e.updateQueue;Ga=!1;var g=d.firstBaseUpdate,x=d.lastBaseUpdate,E=d.shared.pending;if(E!==null){d.shared.pending=null;var a=E,P=a.next;a.next=null,x===null?g=P:x.next=P,x=a;var A=e.alternate;A!==null&&(A=A.updateQueue,E=A.lastBaseUpdate,E!==x&&(E===null?A.firstBaseUpdate=P:E.next=P,A.lastBaseUpdate=a))}if(g!==null){var R=d.baseState;x=0,A=P=a=null,E=g;do{var F=E.lane,j=E.eventTime;if((l&F)===F){A!==null&&(A=A.next={eventTime:j,lane:0,tag:E.tag,payload:E.payload,callback:E.callback,next:null});e:{var Z=e,se=E;switch(F=n,j=s,se.tag){case 1:if(Z=se.payload,typeof Z=="function"){R=Z.call(j,R,F);break e}R=Z;break e;case 3:Z.flags=Z.flags&-65537|128;case 0:if(Z=se.payload,F=typeof Z=="function"?Z.call(j,R,F):Z,F==null)break e;R=cr({},R,F);break e;case 2:Ga=!0}}E.callback!==null&&E.lane!==0&&(e.flags|=64,F=d.effects,F===null?d.effects=[E]:F.push(E))}else j={eventTime:j,lane:F,tag:E.tag,payload:E.payload,callback:E.callback,next:null},A===null?(P=A=j,a=R):A=A.next=j,x|=F;if(E=E.next,E===null){if(E=d.shared.pending,E===null)break;F=E,E=F.next,F.next=null,d.lastBaseUpdate=F,d.shared.pending=null}}while(!0);if(A===null&&(a=R),d.baseState=a,d.firstBaseUpdate=P,d.lastBaseUpdate=A,n=d.shared.interleaved,n!==null){d=n;do x|=d.lane,d=d.next;while(d!==n)}else g===null&&(d.shared.lanes=0);Oc|=x,e.lanes=x,e.memoizedState=R}}function cS(e,n,s){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var l=e[n],d=l.callback;if(d!==null){if(l.callback=null,l=s,typeof d!="function")throw Error(ct(191,d));d.call(l)}}}var wp={},ms=ml(wp),ip=ml(wp),op=ml(wp);function Tc(e){if(e===wp)throw Error(ct(174));return e}function V1(e,n){switch(jn(op,n),jn(ip,e),jn(ms,wp),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:tx(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=tx(n,e)}$n(ms),jn(ms,n)}function Ph(){$n(ms),$n(ip),$n(op)}function BM(e){Tc(op.current);var n=Tc(ms.current),s=tx(n,e.type);n!==s&&(jn(ip,e),jn(ms,s))}function $1(e){ip.current===e&&($n(ms),$n(ip))}var sr=ml(0);function cy(e){for(var n=e;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var h0=[];function G1(){for(var e=0;e<h0.length;e++)h0[e]._workInProgressVersionPrimary=null;h0.length=0}var Dg=ia.ReactCurrentDispatcher,d0=ia.ReactCurrentBatchConfig,Rc=0,lr=null,Ir=null,jr=null,uy=!1,jf=!1,sp=0,CR=0;function ti(){throw Error(ct(321))}function W1(e,n){if(n===null)return!1;for(var s=0;s<n.length&&s<e.length;s++)if(!Xo(e[s],n[s]))return!1;return!0}function Z1(e,n,s,l,d,g){if(Rc=g,lr=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Dg.current=e===null||e.memoizedState===null?IR:AR,e=s(l,d),jf){g=0;do{if(jf=!1,sp=0,25<=g)throw Error(ct(301));g+=1,jr=Ir=null,n.updateQueue=null,Dg.current=DR,e=s(l,d)}while(jf)}if(Dg.current=hy,n=Ir!==null&&Ir.next!==null,Rc=0,jr=Ir=lr=null,uy=!1,n)throw Error(ct(300));return e}function q1(){var e=sp!==0;return sp=0,e}function hs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jr===null?lr.memoizedState=jr=e:jr=jr.next=e,jr}function yo(){if(Ir===null){var e=lr.alternate;e=e!==null?e.memoizedState:null}else e=Ir.next;var n=jr===null?lr.memoizedState:jr.next;if(n!==null)jr=n,Ir=e;else{if(e===null)throw Error(ct(310));Ir=e,e={memoizedState:Ir.memoizedState,baseState:Ir.baseState,baseQueue:Ir.baseQueue,queue:Ir.queue,next:null},jr===null?lr.memoizedState=jr=e:jr=jr.next=e}return jr}function ap(e,n){return typeof n=="function"?n(e):n}function f0(e){var n=yo(),s=n.queue;if(s===null)throw Error(ct(311));s.lastRenderedReducer=e;var l=Ir,d=l.baseQueue,g=s.pending;if(g!==null){if(d!==null){var x=d.next;d.next=g.next,g.next=x}l.baseQueue=d=g,s.pending=null}if(d!==null){g=d.next,l=l.baseState;var E=x=null,a=null,P=g;do{var A=P.lane;if((Rc&A)===A)a!==null&&(a=a.next={lane:0,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),l=P.hasEagerState?P.eagerState:e(l,P.action);else{var R={lane:A,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null};a===null?(E=a=R,x=l):a=a.next=R,lr.lanes|=A,Oc|=A}P=P.next}while(P!==null&&P!==g);a===null?x=l:a.next=E,Xo(l,n.memoizedState)||(Ai=!0),n.memoizedState=l,n.baseState=x,n.baseQueue=a,s.lastRenderedState=l}if(e=s.interleaved,e!==null){d=e;do g=d.lane,lr.lanes|=g,Oc|=g,d=d.next;while(d!==e)}else d===null&&(s.lanes=0);return[n.memoizedState,s.dispatch]}function p0(e){var n=yo(),s=n.queue;if(s===null)throw Error(ct(311));s.lastRenderedReducer=e;var l=s.dispatch,d=s.pending,g=n.memoizedState;if(d!==null){s.pending=null;var x=d=d.next;do g=e(g,x.action),x=x.next;while(x!==d);Xo(g,n.memoizedState)||(Ai=!0),n.memoizedState=g,n.baseQueue===null&&(n.baseState=g),s.lastRenderedState=g}return[g,l]}function jM(){}function NM(e,n){var s=lr,l=yo(),d=n(),g=!Xo(l.memoizedState,d);if(g&&(l.memoizedState=d,Ai=!0),l=l.queue,H1($M.bind(null,s,l,e),[e]),l.getSnapshot!==n||g||jr!==null&&jr.memoizedState.tag&1){if(s.flags|=2048,lp(9,VM.bind(null,s,l,d,n),void 0,null),Nr===null)throw Error(ct(349));Rc&30||UM(s,n,d)}return d}function UM(e,n,s){e.flags|=16384,e={getSnapshot:n,value:s},n=lr.updateQueue,n===null?(n={lastEffect:null,stores:null},lr.updateQueue=n,n.stores=[e]):(s=n.stores,s===null?n.stores=[e]:s.push(e))}function VM(e,n,s,l){n.value=s,n.getSnapshot=l,GM(n)&&WM(e)}function $M(e,n,s){return s(function(){GM(n)&&WM(e)})}function GM(e){var n=e.getSnapshot;e=e.value;try{var s=n();return!Xo(e,s)}catch{return!0}}function WM(e){var n=ea(e,1);n!==null&&Ho(n,e,1,-1)}function uS(e){var n=hs();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ap,lastRenderedState:e},n.queue=e,e=e.dispatch=kR.bind(null,lr,e),[n.memoizedState,e]}function lp(e,n,s,l){return e={tag:e,create:n,destroy:s,deps:l,next:null},n=lr.updateQueue,n===null?(n={lastEffect:null,stores:null},lr.updateQueue=n,n.lastEffect=e.next=e):(s=n.lastEffect,s===null?n.lastEffect=e.next=e:(l=s.next,s.next=e,e.next=l,n.lastEffect=e)),e}function ZM(){return yo().memoizedState}function Lg(e,n,s,l){var d=hs();lr.flags|=e,d.memoizedState=lp(1|n,s,void 0,l===void 0?null:l)}function $y(e,n,s,l){var d=yo();l=l===void 0?null:l;var g=void 0;if(Ir!==null){var x=Ir.memoizedState;if(g=x.destroy,l!==null&&W1(l,x.deps)){d.memoizedState=lp(n,s,g,l);return}}lr.flags|=e,d.memoizedState=lp(1|n,s,g,l)}function hS(e,n){return Lg(8390656,8,e,n)}function H1(e,n){return $y(2048,8,e,n)}function qM(e,n){return $y(4,2,e,n)}function HM(e,n){return $y(4,4,e,n)}function XM(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function KM(e,n,s){return s=s!=null?s.concat([e]):null,$y(4,4,XM.bind(null,n,e),s)}function X1(){}function YM(e,n){var s=yo();n=n===void 0?null:n;var l=s.memoizedState;return l!==null&&n!==null&&W1(n,l[1])?l[0]:(s.memoizedState=[e,n],e)}function JM(e,n){var s=yo();n=n===void 0?null:n;var l=s.memoizedState;return l!==null&&n!==null&&W1(n,l[1])?l[0]:(e=e(),s.memoizedState=[e,n],e)}function QM(e,n,s){return Rc&21?(Xo(s,n)||(s=iM(),lr.lanes|=s,Oc|=s,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,Ai=!0),e.memoizedState=s)}function PR(e,n){var s=Dn;Dn=s!==0&&4>s?s:4,e(!0);var l=d0.transition;d0.transition={};try{e(!1),n()}finally{Dn=s,d0.transition=l}}function ek(){return yo().memoizedState}function MR(e,n,s){var l=ol(e);if(s={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null},tk(e))nk(n,s);else if(s=OM(e,n,s,l),s!==null){var d=mi();Ho(s,e,l,d),rk(s,n,l)}}function kR(e,n,s){var l=ol(e),d={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null};if(tk(e))nk(n,d);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=n.lastRenderedReducer,g!==null))try{var x=n.lastRenderedState,E=g(x,s);if(d.hasEagerState=!0,d.eagerState=E,Xo(E,x)){var a=n.interleaved;a===null?(d.next=d,N1(n)):(d.next=a.next,a.next=d),n.interleaved=d;return}}catch{}finally{}s=OM(e,n,d,l),s!==null&&(d=mi(),Ho(s,e,l,d),rk(s,n,l))}}function tk(e){var n=e.alternate;return e===lr||n!==null&&n===lr}function nk(e,n){jf=uy=!0;var s=e.pending;s===null?n.next=n:(n.next=s.next,s.next=n),e.pending=n}function rk(e,n,s){if(s&4194240){var l=n.lanes;l&=e.pendingLanes,s|=l,n.lanes=s,C1(e,s)}}var hy={readContext:go,useCallback:ti,useContext:ti,useEffect:ti,useImperativeHandle:ti,useInsertionEffect:ti,useLayoutEffect:ti,useMemo:ti,useReducer:ti,useRef:ti,useState:ti,useDebugValue:ti,useDeferredValue:ti,useTransition:ti,useMutableSource:ti,useSyncExternalStore:ti,useId:ti,unstable_isNewReconciler:!1},IR={readContext:go,useCallback:function(e,n){return hs().memoizedState=[e,n===void 0?null:n],e},useContext:go,useEffect:hS,useImperativeHandle:function(e,n,s){return s=s!=null?s.concat([e]):null,Lg(4194308,4,XM.bind(null,n,e),s)},useLayoutEffect:function(e,n){return Lg(4194308,4,e,n)},useInsertionEffect:function(e,n){return Lg(4,2,e,n)},useMemo:function(e,n){var s=hs();return n=n===void 0?null:n,e=e(),s.memoizedState=[e,n],e},useReducer:function(e,n,s){var l=hs();return n=s!==void 0?s(n):n,l.memoizedState=l.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},l.queue=e,e=e.dispatch=MR.bind(null,lr,e),[l.memoizedState,e]},useRef:function(e){var n=hs();return e={current:e},n.memoizedState=e},useState:uS,useDebugValue:X1,useDeferredValue:function(e){return hs().memoizedState=e},useTransition:function(){var e=uS(!1),n=e[0];return e=PR.bind(null,e[1]),hs().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,s){var l=lr,d=hs();if(Hn){if(s===void 0)throw Error(ct(407));s=s()}else{if(s=n(),Nr===null)throw Error(ct(349));Rc&30||UM(l,n,s)}d.memoizedState=s;var g={value:s,getSnapshot:n};return d.queue=g,hS($M.bind(null,l,g,e),[e]),l.flags|=2048,lp(9,VM.bind(null,l,g,s,n),void 0,null),s},useId:function(){var e=hs(),n=Nr.identifierPrefix;if(Hn){var s=Zs,l=Ws;s=(l&~(1<<32-qo(l)-1)).toString(32)+s,n=":"+n+"R"+s,s=sp++,0<s&&(n+="H"+s.toString(32)),n+=":"}else s=CR++,n=":"+n+"r"+s.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},AR={readContext:go,useCallback:YM,useContext:go,useEffect:H1,useImperativeHandle:KM,useInsertionEffect:qM,useLayoutEffect:HM,useMemo:JM,useReducer:f0,useRef:ZM,useState:function(){return f0(ap)},useDebugValue:X1,useDeferredValue:function(e){var n=yo();return QM(n,Ir.memoizedState,e)},useTransition:function(){var e=f0(ap)[0],n=yo().memoizedState;return[e,n]},useMutableSource:jM,useSyncExternalStore:NM,useId:ek,unstable_isNewReconciler:!1},DR={readContext:go,useCallback:YM,useContext:go,useEffect:H1,useImperativeHandle:KM,useInsertionEffect:qM,useLayoutEffect:HM,useMemo:JM,useReducer:p0,useRef:ZM,useState:function(){return p0(ap)},useDebugValue:X1,useDeferredValue:function(e){var n=yo();return Ir===null?n.memoizedState=e:QM(n,Ir.memoizedState,e)},useTransition:function(){var e=p0(ap)[0],n=yo().memoizedState;return[e,n]},useMutableSource:jM,useSyncExternalStore:NM,useId:ek,unstable_isNewReconciler:!1};function Go(e,n){if(e&&e.defaultProps){n=cr({},n),e=e.defaultProps;for(var s in e)n[s]===void 0&&(n[s]=e[s]);return n}return n}function bx(e,n,s,l){n=e.memoizedState,s=s(l,n),s=s==null?n:cr({},n,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Gy={isMounted:function(e){return(e=e._reactInternals)?Nc(e)===e:!1},enqueueSetState:function(e,n,s){e=e._reactInternals;var l=mi(),d=ol(e),g=Xs(l,d);g.payload=n,s!=null&&(g.callback=s),n=rl(e,g,d),n!==null&&(Ho(n,e,d,l),Ag(n,e,d))},enqueueReplaceState:function(e,n,s){e=e._reactInternals;var l=mi(),d=ol(e),g=Xs(l,d);g.tag=1,g.payload=n,s!=null&&(g.callback=s),n=rl(e,g,d),n!==null&&(Ho(n,e,d,l),Ag(n,e,d))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var s=mi(),l=ol(e),d=Xs(s,l);d.tag=2,n!=null&&(d.callback=n),n=rl(e,d,l),n!==null&&(Ho(n,e,l,s),Ag(n,e,l))}};function dS(e,n,s,l,d,g,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,g,x):n.prototype&&n.prototype.isPureReactComponent?!ep(s,l)||!ep(d,g):!0}function ik(e,n,s){var l=!1,d=hl,g=n.contextType;return typeof g=="object"&&g!==null?g=go(g):(d=Li(n)?Lc:oi.current,l=n.contextTypes,g=(l=l!=null)?Eh(e,d):hl),n=new n(s,g),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Gy,e.stateNode=n,n._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=d,e.__reactInternalMemoizedMaskedChildContext=g),n}function fS(e,n,s,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,l),n.state!==e&&Gy.enqueueReplaceState(n,n.state,null)}function Tx(e,n,s,l){var d=e.stateNode;d.props=s,d.state=e.memoizedState,d.refs={},U1(e);var g=n.contextType;typeof g=="object"&&g!==null?d.context=go(g):(g=Li(n)?Lc:oi.current,d.context=Eh(e,g)),d.state=e.memoizedState,g=n.getDerivedStateFromProps,typeof g=="function"&&(bx(e,n,g,s),d.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(n=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),n!==d.state&&Gy.enqueueReplaceState(d,d.state,null),ly(e,s,d,l),d.state=e.memoizedState),typeof d.componentDidMount=="function"&&(e.flags|=4194308)}function Mh(e,n){try{var s="",l=n;do s+=sz(l),l=l.return;while(l);var d=s}catch(g){d=`
Error generating stack: `+g.message+`
`+g.stack}return{value:e,source:n,stack:d,digest:null}}function m0(e,n,s){return{value:e,source:null,stack:s??null,digest:n??null}}function Ex(e,n){try{console.error(n.value)}catch(s){setTimeout(function(){throw s})}}var LR=typeof WeakMap=="function"?WeakMap:Map;function ok(e,n,s){s=Xs(-1,s),s.tag=3,s.payload={element:null};var l=n.value;return s.callback=function(){fy||(fy=!0,zx=l),Ex(e,n)},s}function sk(e,n,s){s=Xs(-1,s),s.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var d=n.value;s.payload=function(){return l(d)},s.callback=function(){Ex(e,n)}}var g=e.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(s.callback=function(){Ex(e,n),typeof l!="function"&&(il===null?il=new Set([this]):il.add(this));var x=n.stack;this.componentDidCatch(n.value,{componentStack:x!==null?x:""})}),s}function pS(e,n,s){var l=e.pingCache;if(l===null){l=e.pingCache=new LR;var d=new Set;l.set(n,d)}else d=l.get(n),d===void 0&&(d=new Set,l.set(n,d));d.has(s)||(d.add(s),e=qR.bind(null,e,n,s),n.then(e,e))}function mS(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function gS(e,n,s,l,d){return e.mode&1?(e.flags|=65536,e.lanes=d,e):(e===n?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(n=Xs(-1,1),n.tag=2,rl(s,n,1))),s.lanes|=1),e)}var zR=ia.ReactCurrentOwner,Ai=!1;function pi(e,n,s,l){n.child=e===null?RM(n,null,s,l):Ch(n,e.child,s,l)}function yS(e,n,s,l,d){s=s.render;var g=n.ref;return wh(n,d),l=Z1(e,n,s,l,g,d),s=q1(),e!==null&&!Ai?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~d,ta(e,n,d)):(Hn&&s&&z1(n),n.flags|=1,pi(e,n,l,d),n.child)}function _S(e,n,s,l,d){if(e===null){var g=s.type;return typeof g=="function"&&!rw(g)&&g.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(n.tag=15,n.type=g,ak(e,n,g,l,d)):(e=Fg(s.type,null,l,n,n.mode,d),e.ref=n.ref,e.return=n,n.child=e)}if(g=e.child,!(e.lanes&d)){var x=g.memoizedProps;if(s=s.compare,s=s!==null?s:ep,s(x,l)&&e.ref===n.ref)return ta(e,n,d)}return n.flags|=1,e=sl(g,l),e.ref=n.ref,e.return=n,n.child=e}function ak(e,n,s,l,d){if(e!==null){var g=e.memoizedProps;if(ep(g,l)&&e.ref===n.ref)if(Ai=!1,n.pendingProps=l=g,(e.lanes&d)!==0)e.flags&131072&&(Ai=!0);else return n.lanes=e.lanes,ta(e,n,d)}return Sx(e,n,s,l,d)}function lk(e,n,s){var l=n.pendingProps,d=l.children,g=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},jn(dh,$i),$i|=s;else{if(!(s&1073741824))return e=g!==null?g.baseLanes|s:s,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,jn(dh,$i),$i|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=g!==null?g.baseLanes:s,jn(dh,$i),$i|=l}else g!==null?(l=g.baseLanes|s,n.memoizedState=null):l=s,jn(dh,$i),$i|=l;return pi(e,n,d,s),n.child}function ck(e,n){var s=n.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(n.flags|=512,n.flags|=2097152)}function Sx(e,n,s,l,d){var g=Li(s)?Lc:oi.current;return g=Eh(n,g),wh(n,d),s=Z1(e,n,s,l,g,d),l=q1(),e!==null&&!Ai?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~d,ta(e,n,d)):(Hn&&l&&z1(n),n.flags|=1,pi(e,n,s,d),n.child)}function vS(e,n,s,l,d){if(Li(s)){var g=!0;ry(n)}else g=!1;if(wh(n,d),n.stateNode===null)zg(e,n),ik(n,s,l),Tx(n,s,l,d),l=!0;else if(e===null){var x=n.stateNode,E=n.memoizedProps;x.props=E;var a=x.context,P=s.contextType;typeof P=="object"&&P!==null?P=go(P):(P=Li(s)?Lc:oi.current,P=Eh(n,P));var A=s.getDerivedStateFromProps,R=typeof A=="function"||typeof x.getSnapshotBeforeUpdate=="function";R||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(E!==l||a!==P)&&fS(n,x,l,P),Ga=!1;var F=n.memoizedState;x.state=F,ly(n,l,x,d),a=n.memoizedState,E!==l||F!==a||Di.current||Ga?(typeof A=="function"&&(bx(n,s,A,l),a=n.memoizedState),(E=Ga||dS(n,s,E,l,F,a,P))?(R||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(n.flags|=4194308)):(typeof x.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=a),x.props=l,x.state=a,x.context=P,l=E):(typeof x.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{x=n.stateNode,FM(e,n),E=n.memoizedProps,P=n.type===n.elementType?E:Go(n.type,E),x.props=P,R=n.pendingProps,F=x.context,a=s.contextType,typeof a=="object"&&a!==null?a=go(a):(a=Li(s)?Lc:oi.current,a=Eh(n,a));var j=s.getDerivedStateFromProps;(A=typeof j=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(E!==R||F!==a)&&fS(n,x,l,a),Ga=!1,F=n.memoizedState,x.state=F,ly(n,l,x,d);var Z=n.memoizedState;E!==R||F!==Z||Di.current||Ga?(typeof j=="function"&&(bx(n,s,j,l),Z=n.memoizedState),(P=Ga||dS(n,s,P,l,F,Z,a)||!1)?(A||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(l,Z,a),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(l,Z,a)),typeof x.componentDidUpdate=="function"&&(n.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof x.componentDidUpdate!="function"||E===e.memoizedProps&&F===e.memoizedState||(n.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&F===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=Z),x.props=l,x.state=Z,x.context=a,l=P):(typeof x.componentDidUpdate!="function"||E===e.memoizedProps&&F===e.memoizedState||(n.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&F===e.memoizedState||(n.flags|=1024),l=!1)}return Cx(e,n,s,l,g,d)}function Cx(e,n,s,l,d,g){ck(e,n);var x=(n.flags&128)!==0;if(!l&&!x)return d&&iS(n,s,!1),ta(e,n,g);l=n.stateNode,zR.current=n;var E=x&&typeof s.getDerivedStateFromError!="function"?null:l.render();return n.flags|=1,e!==null&&x?(n.child=Ch(n,e.child,null,g),n.child=Ch(n,null,E,g)):pi(e,n,E,g),n.memoizedState=l.state,d&&iS(n,s,!0),n.child}function uk(e){var n=e.stateNode;n.pendingContext?rS(e,n.pendingContext,n.pendingContext!==n.context):n.context&&rS(e,n.context,!1),V1(e,n.containerInfo)}function xS(e,n,s,l,d){return Sh(),O1(d),n.flags|=256,pi(e,n,s,l),n.child}var Px={dehydrated:null,treeContext:null,retryLane:0};function Mx(e){return{baseLanes:e,cachePool:null,transitions:null}}function hk(e,n,s){var l=n.pendingProps,d=sr.current,g=!1,x=(n.flags&128)!==0,E;if((E=x)||(E=e!==null&&e.memoizedState===null?!1:(d&2)!==0),E?(g=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(d|=1),jn(sr,d&1),e===null)return xx(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(x=l.children,e=l.fallback,g?(l=n.mode,g=n.child,x={mode:"hidden",children:x},!(l&1)&&g!==null?(g.childLanes=0,g.pendingProps=x):g=qy(x,l,0,null),e=Ic(e,l,s,null),g.return=n,e.return=n,g.sibling=e,n.child=g,n.child.memoizedState=Mx(s),n.memoizedState=Px,e):K1(n,x));if(d=e.memoizedState,d!==null&&(E=d.dehydrated,E!==null))return RR(e,n,x,l,E,d,s);if(g){g=l.fallback,x=n.mode,d=e.child,E=d.sibling;var a={mode:"hidden",children:l.children};return!(x&1)&&n.child!==d?(l=n.child,l.childLanes=0,l.pendingProps=a,n.deletions=null):(l=sl(d,a),l.subtreeFlags=d.subtreeFlags&14680064),E!==null?g=sl(E,g):(g=Ic(g,x,s,null),g.flags|=2),g.return=n,l.return=n,l.sibling=g,n.child=l,l=g,g=n.child,x=e.child.memoizedState,x=x===null?Mx(s):{baseLanes:x.baseLanes|s,cachePool:null,transitions:x.transitions},g.memoizedState=x,g.childLanes=e.childLanes&~s,n.memoizedState=Px,l}return g=e.child,e=g.sibling,l=sl(g,{mode:"visible",children:l.children}),!(n.mode&1)&&(l.lanes=s),l.return=n,l.sibling=null,e!==null&&(s=n.deletions,s===null?(n.deletions=[e],n.flags|=16):s.push(e)),n.child=l,n.memoizedState=null,l}function K1(e,n){return n=qy({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function fg(e,n,s,l){return l!==null&&O1(l),Ch(n,e.child,null,s),e=K1(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function RR(e,n,s,l,d,g,x){if(s)return n.flags&256?(n.flags&=-257,l=m0(Error(ct(422))),fg(e,n,x,l)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(g=l.fallback,d=n.mode,l=qy({mode:"visible",children:l.children},d,0,null),g=Ic(g,d,x,null),g.flags|=2,l.return=n,g.return=n,l.sibling=g,n.child=l,n.mode&1&&Ch(n,e.child,null,x),n.child.memoizedState=Mx(x),n.memoizedState=Px,g);if(!(n.mode&1))return fg(e,n,x,null);if(d.data==="$!"){if(l=d.nextSibling&&d.nextSibling.dataset,l)var E=l.dgst;return l=E,g=Error(ct(419)),l=m0(g,l,void 0),fg(e,n,x,l)}if(E=(x&e.childLanes)!==0,Ai||E){if(l=Nr,l!==null){switch(x&-x){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(l.suspendedLanes|x)?0:d,d!==0&&d!==g.retryLane&&(g.retryLane=d,ea(e,d),Ho(l,e,d,-1))}return nw(),l=m0(Error(ct(421))),fg(e,n,x,l)}return d.data==="$?"?(n.flags|=128,n.child=e.child,n=HR.bind(null,e),d._reactRetry=n,null):(e=g.treeContext,Wi=nl(d.nextSibling),qi=n,Hn=!0,Zo=null,e!==null&&(ho[fo++]=Ws,ho[fo++]=Zs,ho[fo++]=zc,Ws=e.id,Zs=e.overflow,zc=n),n=K1(n,l.children),n.flags|=4096,n)}function wS(e,n,s){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),wx(e.return,n,s)}function g0(e,n,s,l,d){var g=e.memoizedState;g===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:d}:(g.isBackwards=n,g.rendering=null,g.renderingStartTime=0,g.last=l,g.tail=s,g.tailMode=d)}function dk(e,n,s){var l=n.pendingProps,d=l.revealOrder,g=l.tail;if(pi(e,n,l.children,s),l=sr.current,l&2)l=l&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wS(e,s,n);else if(e.tag===19)wS(e,s,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(jn(sr,l),!(n.mode&1))n.memoizedState=null;else switch(d){case"forwards":for(s=n.child,d=null;s!==null;)e=s.alternate,e!==null&&cy(e)===null&&(d=s),s=s.sibling;s=d,s===null?(d=n.child,n.child=null):(d=s.sibling,s.sibling=null),g0(n,!1,d,s,g);break;case"backwards":for(s=null,d=n.child,n.child=null;d!==null;){if(e=d.alternate,e!==null&&cy(e)===null){n.child=d;break}e=d.sibling,d.sibling=s,s=d,d=e}g0(n,!0,s,null,g);break;case"together":g0(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function zg(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function ta(e,n,s){if(e!==null&&(n.dependencies=e.dependencies),Oc|=n.lanes,!(s&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(ct(153));if(n.child!==null){for(e=n.child,s=sl(e,e.pendingProps),n.child=s,s.return=n;e.sibling!==null;)e=e.sibling,s=s.sibling=sl(e,e.pendingProps),s.return=n;s.sibling=null}return n.child}function OR(e,n,s){switch(n.tag){case 3:uk(n),Sh();break;case 5:BM(n);break;case 1:Li(n.type)&&ry(n);break;case 4:V1(n,n.stateNode.containerInfo);break;case 10:var l=n.type._context,d=n.memoizedProps.value;jn(sy,l._currentValue),l._currentValue=d;break;case 13:if(l=n.memoizedState,l!==null)return l.dehydrated!==null?(jn(sr,sr.current&1),n.flags|=128,null):s&n.child.childLanes?hk(e,n,s):(jn(sr,sr.current&1),e=ta(e,n,s),e!==null?e.sibling:null);jn(sr,sr.current&1);break;case 19:if(l=(s&n.childLanes)!==0,e.flags&128){if(l)return dk(e,n,s);n.flags|=128}if(d=n.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),jn(sr,sr.current),l)break;return null;case 22:case 23:return n.lanes=0,lk(e,n,s)}return ta(e,n,s)}var fk,kx,pk,mk;fk=function(e,n){for(var s=n.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};kx=function(){};pk=function(e,n,s,l){var d=e.memoizedProps;if(d!==l){e=n.stateNode,Tc(ms.current);var g=null;switch(s){case"input":d=Y0(e,d),l=Y0(e,l),g=[];break;case"select":d=cr({},d,{value:void 0}),l=cr({},l,{value:void 0}),g=[];break;case"textarea":d=ex(e,d),l=ex(e,l),g=[];break;default:typeof d.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=ty)}nx(s,l);var x;s=null;for(P in d)if(!l.hasOwnProperty(P)&&d.hasOwnProperty(P)&&d[P]!=null)if(P==="style"){var E=d[P];for(x in E)E.hasOwnProperty(x)&&(s||(s={}),s[x]="")}else P!=="dangerouslySetInnerHTML"&&P!=="children"&&P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(qf.hasOwnProperty(P)?g||(g=[]):(g=g||[]).push(P,null));for(P in l){var a=l[P];if(E=d!=null?d[P]:void 0,l.hasOwnProperty(P)&&a!==E&&(a!=null||E!=null))if(P==="style")if(E){for(x in E)!E.hasOwnProperty(x)||a&&a.hasOwnProperty(x)||(s||(s={}),s[x]="");for(x in a)a.hasOwnProperty(x)&&E[x]!==a[x]&&(s||(s={}),s[x]=a[x])}else s||(g||(g=[]),g.push(P,s)),s=a;else P==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,E=E?E.__html:void 0,a!=null&&E!==a&&(g=g||[]).push(P,a)):P==="children"?typeof a!="string"&&typeof a!="number"||(g=g||[]).push(P,""+a):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&(qf.hasOwnProperty(P)?(a!=null&&P==="onScroll"&&Vn("scroll",e),g||E===a||(g=[])):(g=g||[]).push(P,a))}s&&(g=g||[]).push("style",s);var P=g;(n.updateQueue=P)&&(n.flags|=4)}};mk=function(e,n,s,l){s!==l&&(n.flags|=4)};function wf(e,n){if(!Hn)switch(e.tailMode){case"hidden":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function ni(e){var n=e.alternate!==null&&e.alternate.child===e.child,s=0,l=0;if(n)for(var d=e.child;d!==null;)s|=d.lanes|d.childLanes,l|=d.subtreeFlags&14680064,l|=d.flags&14680064,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)s|=d.lanes|d.childLanes,l|=d.subtreeFlags,l|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=l,e.childLanes=s,n}function FR(e,n,s){var l=n.pendingProps;switch(R1(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ni(n),null;case 1:return Li(n.type)&&ny(),ni(n),null;case 3:return l=n.stateNode,Ph(),$n(Di),$n(oi),G1(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(hg(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Zo!==null&&(Fx(Zo),Zo=null))),kx(e,n),ni(n),null;case 5:$1(n);var d=Tc(op.current);if(s=n.type,e!==null&&n.stateNode!=null)pk(e,n,s,l,d),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!l){if(n.stateNode===null)throw Error(ct(166));return ni(n),null}if(e=Tc(ms.current),hg(n)){l=n.stateNode,s=n.type;var g=n.memoizedProps;switch(l[fs]=n,l[rp]=g,e=(n.mode&1)!==0,s){case"dialog":Vn("cancel",l),Vn("close",l);break;case"iframe":case"object":case"embed":Vn("load",l);break;case"video":case"audio":for(d=0;d<Af.length;d++)Vn(Af[d],l);break;case"source":Vn("error",l);break;case"img":case"image":case"link":Vn("error",l),Vn("load",l);break;case"details":Vn("toggle",l);break;case"input":IE(l,g),Vn("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!g.multiple},Vn("invalid",l);break;case"textarea":DE(l,g),Vn("invalid",l)}nx(s,g),d=null;for(var x in g)if(g.hasOwnProperty(x)){var E=g[x];x==="children"?typeof E=="string"?l.textContent!==E&&(g.suppressHydrationWarning!==!0&&ug(l.textContent,E,e),d=["children",E]):typeof E=="number"&&l.textContent!==""+E&&(g.suppressHydrationWarning!==!0&&ug(l.textContent,E,e),d=["children",""+E]):qf.hasOwnProperty(x)&&E!=null&&x==="onScroll"&&Vn("scroll",l)}switch(s){case"input":ng(l),AE(l,g,!0);break;case"textarea":ng(l),LE(l);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(l.onclick=ty)}l=d,n.updateQueue=l,l!==null&&(n.flags|=4)}else{x=d.nodeType===9?d:d.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$P(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=x.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=x.createElement(s,{is:l.is}):(e=x.createElement(s),s==="select"&&(x=e,l.multiple?x.multiple=!0:l.size&&(x.size=l.size))):e=x.createElementNS(e,s),e[fs]=n,e[rp]=l,fk(e,n,!1,!1),n.stateNode=e;e:{switch(x=rx(s,l),s){case"dialog":Vn("cancel",e),Vn("close",e),d=l;break;case"iframe":case"object":case"embed":Vn("load",e),d=l;break;case"video":case"audio":for(d=0;d<Af.length;d++)Vn(Af[d],e);d=l;break;case"source":Vn("error",e),d=l;break;case"img":case"image":case"link":Vn("error",e),Vn("load",e),d=l;break;case"details":Vn("toggle",e),d=l;break;case"input":IE(e,l),d=Y0(e,l),Vn("invalid",e);break;case"option":d=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},d=cr({},l,{value:void 0}),Vn("invalid",e);break;case"textarea":DE(e,l),d=ex(e,l),Vn("invalid",e);break;default:d=l}nx(s,d),E=d;for(g in E)if(E.hasOwnProperty(g)){var a=E[g];g==="style"?ZP(e,a):g==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&GP(e,a)):g==="children"?typeof a=="string"?(s!=="textarea"||a!=="")&&Hf(e,a):typeof a=="number"&&Hf(e,""+a):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(qf.hasOwnProperty(g)?a!=null&&g==="onScroll"&&Vn("scroll",e):a!=null&&x1(e,g,a,x))}switch(s){case"input":ng(e),AE(e,l,!1);break;case"textarea":ng(e),LE(e);break;case"option":l.value!=null&&e.setAttribute("value",""+ul(l.value));break;case"select":e.multiple=!!l.multiple,g=l.value,g!=null?yh(e,!!l.multiple,g,!1):l.defaultValue!=null&&yh(e,!!l.multiple,l.defaultValue,!0);break;default:typeof d.onClick=="function"&&(e.onclick=ty)}switch(s){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return ni(n),null;case 6:if(e&&n.stateNode!=null)mk(e,n,e.memoizedProps,l);else{if(typeof l!="string"&&n.stateNode===null)throw Error(ct(166));if(s=Tc(op.current),Tc(ms.current),hg(n)){if(l=n.stateNode,s=n.memoizedProps,l[fs]=n,(g=l.nodeValue!==s)&&(e=qi,e!==null))switch(e.tag){case 3:ug(l.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ug(l.nodeValue,s,(e.mode&1)!==0)}g&&(n.flags|=4)}else l=(s.nodeType===9?s:s.ownerDocument).createTextNode(l),l[fs]=n,n.stateNode=l}return ni(n),null;case 13:if($n(sr),l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Hn&&Wi!==null&&n.mode&1&&!(n.flags&128))LM(),Sh(),n.flags|=98560,g=!1;else if(g=hg(n),l!==null&&l.dehydrated!==null){if(e===null){if(!g)throw Error(ct(318));if(g=n.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(ct(317));g[fs]=n}else Sh(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;ni(n),g=!1}else Zo!==null&&(Fx(Zo),Zo=null),g=!0;if(!g)return n.flags&65536?n:null}return n.flags&128?(n.lanes=s,n):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(n.child.flags|=8192,n.mode&1&&(e===null||sr.current&1?Dr===0&&(Dr=3):nw())),n.updateQueue!==null&&(n.flags|=4),ni(n),null);case 4:return Ph(),kx(e,n),e===null&&tp(n.stateNode.containerInfo),ni(n),null;case 10:return j1(n.type._context),ni(n),null;case 17:return Li(n.type)&&ny(),ni(n),null;case 19:if($n(sr),g=n.memoizedState,g===null)return ni(n),null;if(l=(n.flags&128)!==0,x=g.rendering,x===null)if(l)wf(g,!1);else{if(Dr!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(x=cy(e),x!==null){for(n.flags|=128,wf(g,!1),l=x.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),n.subtreeFlags=0,l=s,s=n.child;s!==null;)g=s,e=l,g.flags&=14680066,x=g.alternate,x===null?(g.childLanes=0,g.lanes=e,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=x.childLanes,g.lanes=x.lanes,g.child=x.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=x.memoizedProps,g.memoizedState=x.memoizedState,g.updateQueue=x.updateQueue,g.type=x.type,e=x.dependencies,g.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return jn(sr,sr.current&1|2),n.child}e=e.sibling}g.tail!==null&&mr()>kh&&(n.flags|=128,l=!0,wf(g,!1),n.lanes=4194304)}else{if(!l)if(e=cy(x),e!==null){if(n.flags|=128,l=!0,s=e.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),wf(g,!0),g.tail===null&&g.tailMode==="hidden"&&!x.alternate&&!Hn)return ni(n),null}else 2*mr()-g.renderingStartTime>kh&&s!==1073741824&&(n.flags|=128,l=!0,wf(g,!1),n.lanes=4194304);g.isBackwards?(x.sibling=n.child,n.child=x):(s=g.last,s!==null?s.sibling=x:n.child=x,g.last=x)}return g.tail!==null?(n=g.tail,g.rendering=n,g.tail=n.sibling,g.renderingStartTime=mr(),n.sibling=null,s=sr.current,jn(sr,l?s&1|2:s&1),n):(ni(n),null);case 22:case 23:return tw(),l=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(n.flags|=8192),l&&n.mode&1?$i&1073741824&&(ni(n),n.subtreeFlags&6&&(n.flags|=8192)):ni(n),null;case 24:return null;case 25:return null}throw Error(ct(156,n.tag))}function BR(e,n){switch(R1(n),n.tag){case 1:return Li(n.type)&&ny(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Ph(),$n(Di),$n(oi),G1(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return $1(n),null;case 13:if($n(sr),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(ct(340));Sh()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return $n(sr),null;case 4:return Ph(),null;case 10:return j1(n.type._context),null;case 22:case 23:return tw(),null;case 24:return null;default:return null}}var pg=!1,ii=!1,jR=typeof WeakSet=="function"?WeakSet:Set,St=null;function hh(e,n){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(l){fr(e,n,l)}else s.current=null}function Ix(e,n,s){try{s()}catch(l){fr(e,n,l)}}var bS=!1;function NR(e,n){if(fx=Jg,e=xM(),L1(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var d=l.anchorOffset,g=l.focusNode;l=l.focusOffset;try{s.nodeType,g.nodeType}catch{s=null;break e}var x=0,E=-1,a=-1,P=0,A=0,R=e,F=null;t:for(;;){for(var j;R!==s||d!==0&&R.nodeType!==3||(E=x+d),R!==g||l!==0&&R.nodeType!==3||(a=x+l),R.nodeType===3&&(x+=R.nodeValue.length),(j=R.firstChild)!==null;)F=R,R=j;for(;;){if(R===e)break t;if(F===s&&++P===d&&(E=x),F===g&&++A===l&&(a=x),(j=R.nextSibling)!==null)break;R=F,F=R.parentNode}R=j}s=E===-1||a===-1?null:{start:E,end:a}}else s=null}s=s||{start:0,end:0}}else s=null;for(px={focusedElem:e,selectionRange:s},Jg=!1,St=n;St!==null;)if(n=St,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,St=e;else for(;St!==null;){n=St;try{var Z=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(Z!==null){var se=Z.memoizedProps,ve=Z.memoizedState,X=n.stateNode,H=X.getSnapshotBeforeUpdate(n.elementType===n.type?se:Go(n.type,se),ve);X.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var Y=n.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ct(163))}}catch(fe){fr(n,n.return,fe)}if(e=n.sibling,e!==null){e.return=n.return,St=e;break}St=n.return}return Z=bS,bS=!1,Z}function Nf(e,n,s){var l=n.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var d=l=l.next;do{if((d.tag&e)===e){var g=d.destroy;d.destroy=void 0,g!==void 0&&Ix(n,s,g)}d=d.next}while(d!==l)}}function Wy(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var l=s.create;s.destroy=l()}s=s.next}while(s!==n)}}function Ax(e){var n=e.ref;if(n!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof n=="function"?n(e):n.current=e}}function gk(e){var n=e.alternate;n!==null&&(e.alternate=null,gk(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[fs],delete n[rp],delete n[yx],delete n[bR],delete n[TR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function yk(e){return e.tag===5||e.tag===3||e.tag===4}function TS(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||yk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Dx(e,n,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?s.nodeType===8?s.parentNode.insertBefore(e,n):s.insertBefore(e,n):(s.nodeType===8?(n=s.parentNode,n.insertBefore(e,s)):(n=s,n.appendChild(e)),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=ty));else if(l!==4&&(e=e.child,e!==null))for(Dx(e,n,s),e=e.sibling;e!==null;)Dx(e,n,s),e=e.sibling}function Lx(e,n,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?s.insertBefore(e,n):s.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(Lx(e,n,s),e=e.sibling;e!==null;)Lx(e,n,s),e=e.sibling}var $r=null,Wo=!1;function ja(e,n,s){for(s=s.child;s!==null;)_k(e,n,s),s=s.sibling}function _k(e,n,s){if(ps&&typeof ps.onCommitFiberUnmount=="function")try{ps.onCommitFiberUnmount(Fy,s)}catch{}switch(s.tag){case 5:ii||hh(s,n);case 6:var l=$r,d=Wo;$r=null,ja(e,n,s),$r=l,Wo=d,$r!==null&&(Wo?(e=$r,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):$r.removeChild(s.stateNode));break;case 18:$r!==null&&(Wo?(e=$r,s=s.stateNode,e.nodeType===8?c0(e.parentNode,s):e.nodeType===1&&c0(e,s),Jf(e)):c0($r,s.stateNode));break;case 4:l=$r,d=Wo,$r=s.stateNode.containerInfo,Wo=!0,ja(e,n,s),$r=l,Wo=d;break;case 0:case 11:case 14:case 15:if(!ii&&(l=s.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){d=l=l.next;do{var g=d,x=g.destroy;g=g.tag,x!==void 0&&(g&2||g&4)&&Ix(s,n,x),d=d.next}while(d!==l)}ja(e,n,s);break;case 1:if(!ii&&(hh(s,n),l=s.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=s.memoizedProps,l.state=s.memoizedState,l.componentWillUnmount()}catch(E){fr(s,n,E)}ja(e,n,s);break;case 21:ja(e,n,s);break;case 22:s.mode&1?(ii=(l=ii)||s.memoizedState!==null,ja(e,n,s),ii=l):ja(e,n,s);break;default:ja(e,n,s)}}function ES(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new jR),n.forEach(function(l){var d=XR.bind(null,e,l);s.has(l)||(s.add(l),l.then(d,d))})}}function Vo(e,n){var s=n.deletions;if(s!==null)for(var l=0;l<s.length;l++){var d=s[l];try{var g=e,x=n,E=x;e:for(;E!==null;){switch(E.tag){case 5:$r=E.stateNode,Wo=!1;break e;case 3:$r=E.stateNode.containerInfo,Wo=!0;break e;case 4:$r=E.stateNode.containerInfo,Wo=!0;break e}E=E.return}if($r===null)throw Error(ct(160));_k(g,x,d),$r=null,Wo=!1;var a=d.alternate;a!==null&&(a.return=null),d.return=null}catch(P){fr(d,n,P)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)vk(n,e),n=n.sibling}function vk(e,n){var s=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Vo(n,e),us(e),l&4){try{Nf(3,e,e.return),Wy(3,e)}catch(se){fr(e,e.return,se)}try{Nf(5,e,e.return)}catch(se){fr(e,e.return,se)}}break;case 1:Vo(n,e),us(e),l&512&&s!==null&&hh(s,s.return);break;case 5:if(Vo(n,e),us(e),l&512&&s!==null&&hh(s,s.return),e.flags&32){var d=e.stateNode;try{Hf(d,"")}catch(se){fr(e,e.return,se)}}if(l&4&&(d=e.stateNode,d!=null)){var g=e.memoizedProps,x=s!==null?s.memoizedProps:g,E=e.type,a=e.updateQueue;if(e.updateQueue=null,a!==null)try{E==="input"&&g.type==="radio"&&g.name!=null&&UP(d,g),rx(E,x);var P=rx(E,g);for(x=0;x<a.length;x+=2){var A=a[x],R=a[x+1];A==="style"?ZP(d,R):A==="dangerouslySetInnerHTML"?GP(d,R):A==="children"?Hf(d,R):x1(d,A,R,P)}switch(E){case"input":J0(d,g);break;case"textarea":VP(d,g);break;case"select":var F=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!g.multiple;var j=g.value;j!=null?yh(d,!!g.multiple,j,!1):F!==!!g.multiple&&(g.defaultValue!=null?yh(d,!!g.multiple,g.defaultValue,!0):yh(d,!!g.multiple,g.multiple?[]:"",!1))}d[rp]=g}catch(se){fr(e,e.return,se)}}break;case 6:if(Vo(n,e),us(e),l&4){if(e.stateNode===null)throw Error(ct(162));d=e.stateNode,g=e.memoizedProps;try{d.nodeValue=g}catch(se){fr(e,e.return,se)}}break;case 3:if(Vo(n,e),us(e),l&4&&s!==null&&s.memoizedState.isDehydrated)try{Jf(n.containerInfo)}catch(se){fr(e,e.return,se)}break;case 4:Vo(n,e),us(e);break;case 13:Vo(n,e),us(e),d=e.child,d.flags&8192&&(g=d.memoizedState!==null,d.stateNode.isHidden=g,!g||d.alternate!==null&&d.alternate.memoizedState!==null||(Q1=mr())),l&4&&ES(e);break;case 22:if(A=s!==null&&s.memoizedState!==null,e.mode&1?(ii=(P=ii)||A,Vo(n,e),ii=P):Vo(n,e),us(e),l&8192){if(P=e.memoizedState!==null,(e.stateNode.isHidden=P)&&!A&&e.mode&1)for(St=e,A=e.child;A!==null;){for(R=St=A;St!==null;){switch(F=St,j=F.child,F.tag){case 0:case 11:case 14:case 15:Nf(4,F,F.return);break;case 1:hh(F,F.return);var Z=F.stateNode;if(typeof Z.componentWillUnmount=="function"){l=F,s=F.return;try{n=l,Z.props=n.memoizedProps,Z.state=n.memoizedState,Z.componentWillUnmount()}catch(se){fr(l,s,se)}}break;case 5:hh(F,F.return);break;case 22:if(F.memoizedState!==null){CS(R);continue}}j!==null?(j.return=F,St=j):CS(R)}A=A.sibling}e:for(A=null,R=e;;){if(R.tag===5){if(A===null){A=R;try{d=R.stateNode,P?(g=d.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(E=R.stateNode,a=R.memoizedProps.style,x=a!=null&&a.hasOwnProperty("display")?a.display:null,E.style.display=WP("display",x))}catch(se){fr(e,e.return,se)}}}else if(R.tag===6){if(A===null)try{R.stateNode.nodeValue=P?"":R.memoizedProps}catch(se){fr(e,e.return,se)}}else if((R.tag!==22&&R.tag!==23||R.memoizedState===null||R===e)&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===e)break e;for(;R.sibling===null;){if(R.return===null||R.return===e)break e;A===R&&(A=null),R=R.return}A===R&&(A=null),R.sibling.return=R.return,R=R.sibling}}break;case 19:Vo(n,e),us(e),l&4&&ES(e);break;case 21:break;default:Vo(n,e),us(e)}}function us(e){var n=e.flags;if(n&2){try{e:{for(var s=e.return;s!==null;){if(yk(s)){var l=s;break e}s=s.return}throw Error(ct(160))}switch(l.tag){case 5:var d=l.stateNode;l.flags&32&&(Hf(d,""),l.flags&=-33);var g=TS(e);Lx(e,g,d);break;case 3:case 4:var x=l.stateNode.containerInfo,E=TS(e);Dx(e,E,x);break;default:throw Error(ct(161))}}catch(a){fr(e,e.return,a)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function UR(e,n,s){St=e,xk(e)}function xk(e,n,s){for(var l=(e.mode&1)!==0;St!==null;){var d=St,g=d.child;if(d.tag===22&&l){var x=d.memoizedState!==null||pg;if(!x){var E=d.alternate,a=E!==null&&E.memoizedState!==null||ii;E=pg;var P=ii;if(pg=x,(ii=a)&&!P)for(St=d;St!==null;)x=St,a=x.child,x.tag===22&&x.memoizedState!==null?PS(d):a!==null?(a.return=x,St=a):PS(d);for(;g!==null;)St=g,xk(g),g=g.sibling;St=d,pg=E,ii=P}SS(e)}else d.subtreeFlags&8772&&g!==null?(g.return=d,St=g):SS(e)}}function SS(e){for(;St!==null;){var n=St;if(n.flags&8772){var s=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:ii||Wy(5,n);break;case 1:var l=n.stateNode;if(n.flags&4&&!ii)if(s===null)l.componentDidMount();else{var d=n.elementType===n.type?s.memoizedProps:Go(n.type,s.memoizedProps);l.componentDidUpdate(d,s.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var g=n.updateQueue;g!==null&&cS(n,g,l);break;case 3:var x=n.updateQueue;if(x!==null){if(s=null,n.child!==null)switch(n.child.tag){case 5:s=n.child.stateNode;break;case 1:s=n.child.stateNode}cS(n,x,s)}break;case 5:var E=n.stateNode;if(s===null&&n.flags&4){s=E;var a=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&s.focus();break;case"img":a.src&&(s.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var P=n.alternate;if(P!==null){var A=P.memoizedState;if(A!==null){var R=A.dehydrated;R!==null&&Jf(R)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ct(163))}ii||n.flags&512&&Ax(n)}catch(F){fr(n,n.return,F)}}if(n===e){St=null;break}if(s=n.sibling,s!==null){s.return=n.return,St=s;break}St=n.return}}function CS(e){for(;St!==null;){var n=St;if(n===e){St=null;break}var s=n.sibling;if(s!==null){s.return=n.return,St=s;break}St=n.return}}function PS(e){for(;St!==null;){var n=St;try{switch(n.tag){case 0:case 11:case 15:var s=n.return;try{Wy(4,n)}catch(a){fr(n,s,a)}break;case 1:var l=n.stateNode;if(typeof l.componentDidMount=="function"){var d=n.return;try{l.componentDidMount()}catch(a){fr(n,d,a)}}var g=n.return;try{Ax(n)}catch(a){fr(n,g,a)}break;case 5:var x=n.return;try{Ax(n)}catch(a){fr(n,x,a)}}}catch(a){fr(n,n.return,a)}if(n===e){St=null;break}var E=n.sibling;if(E!==null){E.return=n.return,St=E;break}St=n.return}}var VR=Math.ceil,dy=ia.ReactCurrentDispatcher,Y1=ia.ReactCurrentOwner,mo=ia.ReactCurrentBatchConfig,dn=0,Nr=null,Er=null,Wr=0,$i=0,dh=ml(0),Dr=0,cp=null,Oc=0,Zy=0,J1=0,Uf=null,Ii=null,Q1=0,kh=1/0,$s=null,fy=!1,zx=null,il=null,mg=!1,Ya=null,py=0,Vf=0,Rx=null,Rg=-1,Og=0;function mi(){return dn&6?mr():Rg!==-1?Rg:Rg=mr()}function ol(e){return e.mode&1?dn&2&&Wr!==0?Wr&-Wr:SR.transition!==null?(Og===0&&(Og=iM()),Og):(e=Dn,e!==0||(e=window.event,e=e===void 0?16:hM(e.type)),e):1}function Ho(e,n,s,l){if(50<Vf)throw Vf=0,Rx=null,Error(ct(185));_p(e,s,l),(!(dn&2)||e!==Nr)&&(e===Nr&&(!(dn&2)&&(Zy|=s),Dr===4&&Ha(e,Wr)),zi(e,l),s===1&&dn===0&&!(n.mode&1)&&(kh=mr()+500,Vy&&gl()))}function zi(e,n){var s=e.callbackNode;Sz(e,n);var l=Yg(e,e===Nr?Wr:0);if(l===0)s!==null&&OE(s),e.callbackNode=null,e.callbackPriority=0;else if(n=l&-l,e.callbackPriority!==n){if(s!=null&&OE(s),n===1)e.tag===0?ER(MS.bind(null,e)):IM(MS.bind(null,e)),xR(function(){!(dn&6)&&gl()}),s=null;else{switch(oM(l)){case 1:s=S1;break;case 4:s=nM;break;case 16:s=Kg;break;case 536870912:s=rM;break;default:s=Kg}s=Mk(s,wk.bind(null,e))}e.callbackPriority=n,e.callbackNode=s}}function wk(e,n){if(Rg=-1,Og=0,dn&6)throw Error(ct(327));var s=e.callbackNode;if(bh()&&e.callbackNode!==s)return null;var l=Yg(e,e===Nr?Wr:0);if(l===0)return null;if(l&30||l&e.expiredLanes||n)n=my(e,l);else{n=l;var d=dn;dn|=2;var g=Tk();(Nr!==e||Wr!==n)&&($s=null,kh=mr()+500,kc(e,n));do try{WR();break}catch(E){bk(e,E)}while(!0);B1(),dy.current=g,dn=d,Er!==null?n=0:(Nr=null,Wr=0,n=Dr)}if(n!==0){if(n===2&&(d=lx(e),d!==0&&(l=d,n=Ox(e,d))),n===1)throw s=cp,kc(e,0),Ha(e,l),zi(e,mr()),s;if(n===6)Ha(e,l);else{if(d=e.current.alternate,!(l&30)&&!$R(d)&&(n=my(e,l),n===2&&(g=lx(e),g!==0&&(l=g,n=Ox(e,g))),n===1))throw s=cp,kc(e,0),Ha(e,l),zi(e,mr()),s;switch(e.finishedWork=d,e.finishedLanes=l,n){case 0:case 1:throw Error(ct(345));case 2:pc(e,Ii,$s);break;case 3:if(Ha(e,l),(l&130023424)===l&&(n=Q1+500-mr(),10<n)){if(Yg(e,0)!==0)break;if(d=e.suspendedLanes,(d&l)!==l){mi(),e.pingedLanes|=e.suspendedLanes&d;break}e.timeoutHandle=gx(pc.bind(null,e,Ii,$s),n);break}pc(e,Ii,$s);break;case 4:if(Ha(e,l),(l&4194240)===l)break;for(n=e.eventTimes,d=-1;0<l;){var x=31-qo(l);g=1<<x,x=n[x],x>d&&(d=x),l&=~g}if(l=d,l=mr()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*VR(l/1960))-l,10<l){e.timeoutHandle=gx(pc.bind(null,e,Ii,$s),l);break}pc(e,Ii,$s);break;case 5:pc(e,Ii,$s);break;default:throw Error(ct(329))}}}return zi(e,mr()),e.callbackNode===s?wk.bind(null,e):null}function Ox(e,n){var s=Uf;return e.current.memoizedState.isDehydrated&&(kc(e,n).flags|=256),e=my(e,n),e!==2&&(n=Ii,Ii=s,n!==null&&Fx(n)),e}function Fx(e){Ii===null?Ii=e:Ii.push.apply(Ii,e)}function $R(e){for(var n=e;;){if(n.flags&16384){var s=n.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var l=0;l<s.length;l++){var d=s[l],g=d.getSnapshot;d=d.value;try{if(!Xo(g(),d))return!1}catch{return!1}}}if(s=n.child,n.subtreeFlags&16384&&s!==null)s.return=n,n=s;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ha(e,n){for(n&=~J1,n&=~Zy,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var s=31-qo(n),l=1<<s;e[s]=-1,n&=~l}}function MS(e){if(dn&6)throw Error(ct(327));bh();var n=Yg(e,0);if(!(n&1))return zi(e,mr()),null;var s=my(e,n);if(e.tag!==0&&s===2){var l=lx(e);l!==0&&(n=l,s=Ox(e,l))}if(s===1)throw s=cp,kc(e,0),Ha(e,n),zi(e,mr()),s;if(s===6)throw Error(ct(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,pc(e,Ii,$s),zi(e,mr()),null}function ew(e,n){var s=dn;dn|=1;try{return e(n)}finally{dn=s,dn===0&&(kh=mr()+500,Vy&&gl())}}function Fc(e){Ya!==null&&Ya.tag===0&&!(dn&6)&&bh();var n=dn;dn|=1;var s=mo.transition,l=Dn;try{if(mo.transition=null,Dn=1,e)return e()}finally{Dn=l,mo.transition=s,dn=n,!(dn&6)&&gl()}}function tw(){$i=dh.current,$n(dh)}function kc(e,n){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,vR(s)),Er!==null)for(s=Er.return;s!==null;){var l=s;switch(R1(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&ny();break;case 3:Ph(),$n(Di),$n(oi),G1();break;case 5:$1(l);break;case 4:Ph();break;case 13:$n(sr);break;case 19:$n(sr);break;case 10:j1(l.type._context);break;case 22:case 23:tw()}s=s.return}if(Nr=e,Er=e=sl(e.current,null),Wr=$i=n,Dr=0,cp=null,J1=Zy=Oc=0,Ii=Uf=null,bc!==null){for(n=0;n<bc.length;n++)if(s=bc[n],l=s.interleaved,l!==null){s.interleaved=null;var d=l.next,g=s.pending;if(g!==null){var x=g.next;g.next=d,l.next=x}s.pending=l}bc=null}return e}function bk(e,n){do{var s=Er;try{if(B1(),Dg.current=hy,uy){for(var l=lr.memoizedState;l!==null;){var d=l.queue;d!==null&&(d.pending=null),l=l.next}uy=!1}if(Rc=0,jr=Ir=lr=null,jf=!1,sp=0,Y1.current=null,s===null||s.return===null){Dr=1,cp=n,Er=null;break}e:{var g=e,x=s.return,E=s,a=n;if(n=Wr,E.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var P=a,A=E,R=A.tag;if(!(A.mode&1)&&(R===0||R===11||R===15)){var F=A.alternate;F?(A.updateQueue=F.updateQueue,A.memoizedState=F.memoizedState,A.lanes=F.lanes):(A.updateQueue=null,A.memoizedState=null)}var j=mS(x);if(j!==null){j.flags&=-257,gS(j,x,E,g,n),j.mode&1&&pS(g,P,n),n=j,a=P;var Z=n.updateQueue;if(Z===null){var se=new Set;se.add(a),n.updateQueue=se}else Z.add(a);break e}else{if(!(n&1)){pS(g,P,n),nw();break e}a=Error(ct(426))}}else if(Hn&&E.mode&1){var ve=mS(x);if(ve!==null){!(ve.flags&65536)&&(ve.flags|=256),gS(ve,x,E,g,n),O1(Mh(a,E));break e}}g=a=Mh(a,E),Dr!==4&&(Dr=2),Uf===null?Uf=[g]:Uf.push(g),g=x;do{switch(g.tag){case 3:g.flags|=65536,n&=-n,g.lanes|=n;var X=ok(g,a,n);lS(g,X);break e;case 1:E=a;var H=g.type,Y=g.stateNode;if(!(g.flags&128)&&(typeof H.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(il===null||!il.has(Y)))){g.flags|=65536,n&=-n,g.lanes|=n;var fe=sk(g,E,n);lS(g,fe);break e}}g=g.return}while(g!==null)}Sk(s)}catch(Ce){n=Ce,Er===s&&s!==null&&(Er=s=s.return);continue}break}while(!0)}function Tk(){var e=dy.current;return dy.current=hy,e===null?hy:e}function nw(){(Dr===0||Dr===3||Dr===2)&&(Dr=4),Nr===null||!(Oc&268435455)&&!(Zy&268435455)||Ha(Nr,Wr)}function my(e,n){var s=dn;dn|=2;var l=Tk();(Nr!==e||Wr!==n)&&($s=null,kc(e,n));do try{GR();break}catch(d){bk(e,d)}while(!0);if(B1(),dn=s,dy.current=l,Er!==null)throw Error(ct(261));return Nr=null,Wr=0,Dr}function GR(){for(;Er!==null;)Ek(Er)}function WR(){for(;Er!==null&&!gz();)Ek(Er)}function Ek(e){var n=Pk(e.alternate,e,$i);e.memoizedProps=e.pendingProps,n===null?Sk(e):Er=n,Y1.current=null}function Sk(e){var n=e;do{var s=n.alternate;if(e=n.return,n.flags&32768){if(s=BR(s,n),s!==null){s.flags&=32767,Er=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Dr=6,Er=null;return}}else if(s=FR(s,n,$i),s!==null){Er=s;return}if(n=n.sibling,n!==null){Er=n;return}Er=n=e}while(n!==null);Dr===0&&(Dr=5)}function pc(e,n,s){var l=Dn,d=mo.transition;try{mo.transition=null,Dn=1,ZR(e,n,s,l)}finally{mo.transition=d,Dn=l}return null}function ZR(e,n,s,l){do bh();while(Ya!==null);if(dn&6)throw Error(ct(327));s=e.finishedWork;var d=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(ct(177));e.callbackNode=null,e.callbackPriority=0;var g=s.lanes|s.childLanes;if(Cz(e,g),e===Nr&&(Er=Nr=null,Wr=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||mg||(mg=!0,Mk(Kg,function(){return bh(),null})),g=(s.flags&15990)!==0,s.subtreeFlags&15990||g){g=mo.transition,mo.transition=null;var x=Dn;Dn=1;var E=dn;dn|=4,Y1.current=null,NR(e,s),vk(s,e),dR(px),Jg=!!fx,px=fx=null,e.current=s,UR(s),yz(),dn=E,Dn=x,mo.transition=g}else e.current=s;if(mg&&(mg=!1,Ya=e,py=d),g=e.pendingLanes,g===0&&(il=null),xz(s.stateNode),zi(e,mr()),n!==null)for(l=e.onRecoverableError,s=0;s<n.length;s++)d=n[s],l(d.value,{componentStack:d.stack,digest:d.digest});if(fy)throw fy=!1,e=zx,zx=null,e;return py&1&&e.tag!==0&&bh(),g=e.pendingLanes,g&1?e===Rx?Vf++:(Vf=0,Rx=e):Vf=0,gl(),null}function bh(){if(Ya!==null){var e=oM(py),n=mo.transition,s=Dn;try{if(mo.transition=null,Dn=16>e?16:e,Ya===null)var l=!1;else{if(e=Ya,Ya=null,py=0,dn&6)throw Error(ct(331));var d=dn;for(dn|=4,St=e.current;St!==null;){var g=St,x=g.child;if(St.flags&16){var E=g.deletions;if(E!==null){for(var a=0;a<E.length;a++){var P=E[a];for(St=P;St!==null;){var A=St;switch(A.tag){case 0:case 11:case 15:Nf(8,A,g)}var R=A.child;if(R!==null)R.return=A,St=R;else for(;St!==null;){A=St;var F=A.sibling,j=A.return;if(gk(A),A===P){St=null;break}if(F!==null){F.return=j,St=F;break}St=j}}}var Z=g.alternate;if(Z!==null){var se=Z.child;if(se!==null){Z.child=null;do{var ve=se.sibling;se.sibling=null,se=ve}while(se!==null)}}St=g}}if(g.subtreeFlags&2064&&x!==null)x.return=g,St=x;else e:for(;St!==null;){if(g=St,g.flags&2048)switch(g.tag){case 0:case 11:case 15:Nf(9,g,g.return)}var X=g.sibling;if(X!==null){X.return=g.return,St=X;break e}St=g.return}}var H=e.current;for(St=H;St!==null;){x=St;var Y=x.child;if(x.subtreeFlags&2064&&Y!==null)Y.return=x,St=Y;else e:for(x=H;St!==null;){if(E=St,E.flags&2048)try{switch(E.tag){case 0:case 11:case 15:Wy(9,E)}}catch(Ce){fr(E,E.return,Ce)}if(E===x){St=null;break e}var fe=E.sibling;if(fe!==null){fe.return=E.return,St=fe;break e}St=E.return}}if(dn=d,gl(),ps&&typeof ps.onPostCommitFiberRoot=="function")try{ps.onPostCommitFiberRoot(Fy,e)}catch{}l=!0}return l}finally{Dn=s,mo.transition=n}}return!1}function kS(e,n,s){n=Mh(s,n),n=ok(e,n,1),e=rl(e,n,1),n=mi(),e!==null&&(_p(e,1,n),zi(e,n))}function fr(e,n,s){if(e.tag===3)kS(e,e,s);else for(;n!==null;){if(n.tag===3){kS(n,e,s);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(il===null||!il.has(l))){e=Mh(s,e),e=sk(n,e,1),n=rl(n,e,1),e=mi(),n!==null&&(_p(n,1,e),zi(n,e));break}}n=n.return}}function qR(e,n,s){var l=e.pingCache;l!==null&&l.delete(n),n=mi(),e.pingedLanes|=e.suspendedLanes&s,Nr===e&&(Wr&s)===s&&(Dr===4||Dr===3&&(Wr&130023424)===Wr&&500>mr()-Q1?kc(e,0):J1|=s),zi(e,n)}function Ck(e,n){n===0&&(e.mode&1?(n=og,og<<=1,!(og&130023424)&&(og=4194304)):n=1);var s=mi();e=ea(e,n),e!==null&&(_p(e,n,s),zi(e,s))}function HR(e){var n=e.memoizedState,s=0;n!==null&&(s=n.retryLane),Ck(e,s)}function XR(e,n){var s=0;switch(e.tag){case 13:var l=e.stateNode,d=e.memoizedState;d!==null&&(s=d.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(ct(314))}l!==null&&l.delete(n),Ck(e,s)}var Pk;Pk=function(e,n,s){if(e!==null)if(e.memoizedProps!==n.pendingProps||Di.current)Ai=!0;else{if(!(e.lanes&s)&&!(n.flags&128))return Ai=!1,OR(e,n,s);Ai=!!(e.flags&131072)}else Ai=!1,Hn&&n.flags&1048576&&AM(n,oy,n.index);switch(n.lanes=0,n.tag){case 2:var l=n.type;zg(e,n),e=n.pendingProps;var d=Eh(n,oi.current);wh(n,s),d=Z1(null,n,l,e,d,s);var g=q1();return n.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Li(l)?(g=!0,ry(n)):g=!1,n.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,U1(n),d.updater=Gy,n.stateNode=d,d._reactInternals=n,Tx(n,l,e,s),n=Cx(null,n,l,!0,g,s)):(n.tag=0,Hn&&g&&z1(n),pi(null,n,d,s),n=n.child),n;case 16:l=n.elementType;e:{switch(zg(e,n),e=n.pendingProps,d=l._init,l=d(l._payload),n.type=l,d=n.tag=YR(l),e=Go(l,e),d){case 0:n=Sx(null,n,l,e,s);break e;case 1:n=vS(null,n,l,e,s);break e;case 11:n=yS(null,n,l,e,s);break e;case 14:n=_S(null,n,l,Go(l.type,e),s);break e}throw Error(ct(306,l,""))}return n;case 0:return l=n.type,d=n.pendingProps,d=n.elementType===l?d:Go(l,d),Sx(e,n,l,d,s);case 1:return l=n.type,d=n.pendingProps,d=n.elementType===l?d:Go(l,d),vS(e,n,l,d,s);case 3:e:{if(uk(n),e===null)throw Error(ct(387));l=n.pendingProps,g=n.memoizedState,d=g.element,FM(e,n),ly(n,l,null,s);var x=n.memoizedState;if(l=x.element,g.isDehydrated)if(g={element:l,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},n.updateQueue.baseState=g,n.memoizedState=g,n.flags&256){d=Mh(Error(ct(423)),n),n=xS(e,n,l,s,d);break e}else if(l!==d){d=Mh(Error(ct(424)),n),n=xS(e,n,l,s,d);break e}else for(Wi=nl(n.stateNode.containerInfo.firstChild),qi=n,Hn=!0,Zo=null,s=RM(n,null,l,s),n.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Sh(),l===d){n=ta(e,n,s);break e}pi(e,n,l,s)}n=n.child}return n;case 5:return BM(n),e===null&&xx(n),l=n.type,d=n.pendingProps,g=e!==null?e.memoizedProps:null,x=d.children,mx(l,d)?x=null:g!==null&&mx(l,g)&&(n.flags|=32),ck(e,n),pi(e,n,x,s),n.child;case 6:return e===null&&xx(n),null;case 13:return hk(e,n,s);case 4:return V1(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=Ch(n,null,l,s):pi(e,n,l,s),n.child;case 11:return l=n.type,d=n.pendingProps,d=n.elementType===l?d:Go(l,d),yS(e,n,l,d,s);case 7:return pi(e,n,n.pendingProps,s),n.child;case 8:return pi(e,n,n.pendingProps.children,s),n.child;case 12:return pi(e,n,n.pendingProps.children,s),n.child;case 10:e:{if(l=n.type._context,d=n.pendingProps,g=n.memoizedProps,x=d.value,jn(sy,l._currentValue),l._currentValue=x,g!==null)if(Xo(g.value,x)){if(g.children===d.children&&!Di.current){n=ta(e,n,s);break e}}else for(g=n.child,g!==null&&(g.return=n);g!==null;){var E=g.dependencies;if(E!==null){x=g.child;for(var a=E.firstContext;a!==null;){if(a.context===l){if(g.tag===1){a=Xs(-1,s&-s),a.tag=2;var P=g.updateQueue;if(P!==null){P=P.shared;var A=P.pending;A===null?a.next=a:(a.next=A.next,A.next=a),P.pending=a}}g.lanes|=s,a=g.alternate,a!==null&&(a.lanes|=s),wx(g.return,s,n),E.lanes|=s;break}a=a.next}}else if(g.tag===10)x=g.type===n.type?null:g.child;else if(g.tag===18){if(x=g.return,x===null)throw Error(ct(341));x.lanes|=s,E=x.alternate,E!==null&&(E.lanes|=s),wx(x,s,n),x=g.sibling}else x=g.child;if(x!==null)x.return=g;else for(x=g;x!==null;){if(x===n){x=null;break}if(g=x.sibling,g!==null){g.return=x.return,x=g;break}x=x.return}g=x}pi(e,n,d.children,s),n=n.child}return n;case 9:return d=n.type,l=n.pendingProps.children,wh(n,s),d=go(d),l=l(d),n.flags|=1,pi(e,n,l,s),n.child;case 14:return l=n.type,d=Go(l,n.pendingProps),d=Go(l.type,d),_S(e,n,l,d,s);case 15:return ak(e,n,n.type,n.pendingProps,s);case 17:return l=n.type,d=n.pendingProps,d=n.elementType===l?d:Go(l,d),zg(e,n),n.tag=1,Li(l)?(e=!0,ry(n)):e=!1,wh(n,s),ik(n,l,d),Tx(n,l,d,s),Cx(null,n,l,!0,e,s);case 19:return dk(e,n,s);case 22:return lk(e,n,s)}throw Error(ct(156,n.tag))};function Mk(e,n){return tM(e,n)}function KR(e,n,s,l){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function po(e,n,s,l){return new KR(e,n,s,l)}function rw(e){return e=e.prototype,!(!e||!e.isReactComponent)}function YR(e){if(typeof e=="function")return rw(e)?1:0;if(e!=null){if(e=e.$$typeof,e===b1)return 11;if(e===T1)return 14}return 2}function sl(e,n){var s=e.alternate;return s===null?(s=po(e.tag,n,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=n,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,n=e.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Fg(e,n,s,l,d,g){var x=2;if(l=e,typeof e=="function")rw(e)&&(x=1);else if(typeof e=="string")x=5;else e:switch(e){case nh:return Ic(s.children,d,g,n);case w1:x=8,d|=8;break;case q0:return e=po(12,s,n,d|2),e.elementType=q0,e.lanes=g,e;case H0:return e=po(13,s,n,d),e.elementType=H0,e.lanes=g,e;case X0:return e=po(19,s,n,d),e.elementType=X0,e.lanes=g,e;case BP:return qy(s,d,g,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case OP:x=10;break e;case FP:x=9;break e;case b1:x=11;break e;case T1:x=14;break e;case $a:x=16,l=null;break e}throw Error(ct(130,e==null?e:typeof e,""))}return n=po(x,s,n,d),n.elementType=e,n.type=l,n.lanes=g,n}function Ic(e,n,s,l){return e=po(7,e,l,n),e.lanes=s,e}function qy(e,n,s,l){return e=po(22,e,l,n),e.elementType=BP,e.lanes=s,e.stateNode={isHidden:!1},e}function y0(e,n,s){return e=po(6,e,null,n),e.lanes=s,e}function _0(e,n,s){return n=po(4,e.children!==null?e.children:[],e.key,n),n.lanes=s,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function JR(e,n,s,l,d){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jv(0),this.expirationTimes=Jv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jv(0),this.identifierPrefix=l,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function iw(e,n,s,l,d,g,x,E,a){return e=new JR(e,n,s,E,a),n===1?(n=1,g===!0&&(n|=8)):n=0,g=po(3,null,null,n),e.current=g,g.stateNode=e,g.memoizedState={element:l,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},U1(g),e}function QR(e,n,s){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:th,key:l==null?null:""+l,children:e,containerInfo:n,implementation:s}}function kk(e){if(!e)return hl;e=e._reactInternals;e:{if(Nc(e)!==e||e.tag!==1)throw Error(ct(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Li(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(ct(171))}if(e.tag===1){var s=e.type;if(Li(s))return kM(e,s,n)}return n}function Ik(e,n,s,l,d,g,x,E,a){return e=iw(s,l,!0,e,d,g,x,E,a),e.context=kk(null),s=e.current,l=mi(),d=ol(s),g=Xs(l,d),g.callback=n??null,rl(s,g,d),e.current.lanes=d,_p(e,d,l),zi(e,l),e}function Hy(e,n,s,l){var d=n.current,g=mi(),x=ol(d);return s=kk(s),n.context===null?n.context=s:n.pendingContext=s,n=Xs(g,x),n.payload={element:e},l=l===void 0?null:l,l!==null&&(n.callback=l),e=rl(d,n,x),e!==null&&(Ho(e,d,x,g),Ag(e,d,x)),x}function gy(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function IS(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<n?s:n}}function ow(e,n){IS(e,n),(e=e.alternate)&&IS(e,n)}function e5(){return null}var Ak=typeof reportError=="function"?reportError:function(e){console.error(e)};function sw(e){this._internalRoot=e}Xy.prototype.render=sw.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(ct(409));Hy(e,n,null,null)};Xy.prototype.unmount=sw.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Fc(function(){Hy(null,e,null,null)}),n[Qs]=null}};function Xy(e){this._internalRoot=e}Xy.prototype.unstable_scheduleHydration=function(e){if(e){var n=lM();e={blockedOn:null,target:e,priority:n};for(var s=0;s<qa.length&&n!==0&&n<qa[s].priority;s++);qa.splice(s,0,e),s===0&&uM(e)}};function aw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ky(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function AS(){}function t5(e,n,s,l,d){if(d){if(typeof l=="function"){var g=l;l=function(){var P=gy(x);g.call(P)}}var x=Ik(n,l,e,0,null,!1,!1,"",AS);return e._reactRootContainer=x,e[Qs]=x.current,tp(e.nodeType===8?e.parentNode:e),Fc(),x}for(;d=e.lastChild;)e.removeChild(d);if(typeof l=="function"){var E=l;l=function(){var P=gy(a);E.call(P)}}var a=iw(e,0,!1,null,null,!1,!1,"",AS);return e._reactRootContainer=a,e[Qs]=a.current,tp(e.nodeType===8?e.parentNode:e),Fc(function(){Hy(n,a,s,l)}),a}function Yy(e,n,s,l,d){var g=s._reactRootContainer;if(g){var x=g;if(typeof d=="function"){var E=d;d=function(){var a=gy(x);E.call(a)}}Hy(n,x,e,d)}else x=t5(s,n,e,d,l);return gy(x)}sM=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var s=If(n.pendingLanes);s!==0&&(C1(n,s|1),zi(n,mr()),!(dn&6)&&(kh=mr()+500,gl()))}break;case 13:Fc(function(){var l=ea(e,1);if(l!==null){var d=mi();Ho(l,e,1,d)}}),ow(e,1)}};P1=function(e){if(e.tag===13){var n=ea(e,134217728);if(n!==null){var s=mi();Ho(n,e,134217728,s)}ow(e,134217728)}};aM=function(e){if(e.tag===13){var n=ol(e),s=ea(e,n);if(s!==null){var l=mi();Ho(s,e,n,l)}ow(e,n)}};lM=function(){return Dn};cM=function(e,n){var s=Dn;try{return Dn=e,n()}finally{Dn=s}};ox=function(e,n,s){switch(n){case"input":if(J0(e,s),n=s.name,s.type==="radio"&&n!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<s.length;n++){var l=s[n];if(l!==e&&l.form===e.form){var d=Uy(l);if(!d)throw Error(ct(90));NP(l),J0(l,d)}}}break;case"textarea":VP(e,s);break;case"select":n=s.value,n!=null&&yh(e,!!s.multiple,n,!1)}};XP=ew;KP=Fc;var n5={usingClientEntryPoint:!1,Events:[xp,sh,Uy,qP,HP,ew]},bf={findFiberByHostInstance:wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},r5={bundleType:bf.bundleType,version:bf.version,rendererPackageName:bf.rendererPackageName,rendererConfig:bf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ia.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=QP(e),e===null?null:e.stateNode},findFiberByHostInstance:bf.findFiberByHostInstance||e5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gg.isDisabled&&gg.supportsFiber)try{Fy=gg.inject(r5),ps=gg}catch{}}Ki.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=n5;Ki.createPortal=function(e,n){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!aw(n))throw Error(ct(200));return QR(e,n,null,s)};Ki.createRoot=function(e,n){if(!aw(e))throw Error(ct(299));var s=!1,l="",d=Ak;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(d=n.onRecoverableError)),n=iw(e,1,!1,null,null,s,!1,l,d),e[Qs]=n.current,tp(e.nodeType===8?e.parentNode:e),new sw(n)};Ki.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(ct(188)):(e=Object.keys(e).join(","),Error(ct(268,e)));return e=QP(n),e=e===null?null:e.stateNode,e};Ki.flushSync=function(e){return Fc(e)};Ki.hydrate=function(e,n,s){if(!Ky(n))throw Error(ct(200));return Yy(null,e,n,!0,s)};Ki.hydrateRoot=function(e,n,s){if(!aw(e))throw Error(ct(405));var l=s!=null&&s.hydratedSources||null,d=!1,g="",x=Ak;if(s!=null&&(s.unstable_strictMode===!0&&(d=!0),s.identifierPrefix!==void 0&&(g=s.identifierPrefix),s.onRecoverableError!==void 0&&(x=s.onRecoverableError)),n=Ik(n,null,e,1,s??null,d,!1,g,x),e[Qs]=n.current,tp(e),l)for(e=0;e<l.length;e++)s=l[e],d=s._getVersion,d=d(s._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[s,d]:n.mutableSourceEagerHydrationData.push(s,d);return new Xy(n)};Ki.render=function(e,n,s){if(!Ky(n))throw Error(ct(200));return Yy(null,e,n,!1,s)};Ki.unmountComponentAtNode=function(e){if(!Ky(e))throw Error(ct(40));return e._reactRootContainer?(Fc(function(){Yy(null,null,e,!1,function(){e._reactRootContainer=null,e[Qs]=null})}),!0):!1};Ki.unstable_batchedUpdates=ew;Ki.unstable_renderSubtreeIntoContainer=function(e,n,s,l){if(!Ky(s))throw Error(ct(200));if(e==null||e._reactInternals===void 0)throw Error(ct(38));return Yy(e,n,s,!1,l)};Ki.version="18.3.1-next-f1338f8080-20240426";function Dk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Dk)}catch(e){console.error(e)}}Dk(),DP.exports=Ki;var lw=DP.exports;const i5=f1(lw);var DS=lw;W0.createRoot=DS.createRoot,W0.hydrateRoot=DS.hydrateRoot;/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function up(){return up=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},up.apply(this,arguments)}var Ja;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ja||(Ja={}));const LS="popstate";function o5(e){e===void 0&&(e={});function n(l,d){let{pathname:g,search:x,hash:E}=l.location;return Bx("",{pathname:g,search:x,hash:E},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function s(l,d){return typeof d=="string"?d:yy(d)}return a5(n,s,null,e)}function Sr(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Lk(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function s5(){return Math.random().toString(36).substr(2,8)}function zS(e,n){return{usr:e.state,key:e.key,idx:n}}function Bx(e,n,s,l){return s===void 0&&(s=null),up({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?Oh(n):n,{state:s,key:n&&n.key||l||s5()})}function yy(e){let{pathname:n="/",search:s="",hash:l=""}=e;return s&&s!=="?"&&(n+=s.charAt(0)==="?"?s:"?"+s),l&&l!=="#"&&(n+=l.charAt(0)==="#"?l:"#"+l),n}function Oh(e){let n={};if(e){let s=e.indexOf("#");s>=0&&(n.hash=e.substr(s),e=e.substr(0,s));let l=e.indexOf("?");l>=0&&(n.search=e.substr(l),e=e.substr(0,l)),e&&(n.pathname=e)}return n}function a5(e,n,s,l){l===void 0&&(l={});let{window:d=document.defaultView,v5Compat:g=!1}=l,x=d.history,E=Ja.Pop,a=null,P=A();P==null&&(P=0,x.replaceState(up({},x.state,{idx:P}),""));function A(){return(x.state||{idx:null}).idx}function R(){E=Ja.Pop;let ve=A(),X=ve==null?null:ve-P;P=ve,a&&a({action:E,location:se.location,delta:X})}function F(ve,X){E=Ja.Push;let H=Bx(se.location,ve,X);P=A()+1;let Y=zS(H,P),fe=se.createHref(H);try{x.pushState(Y,"",fe)}catch(Ce){if(Ce instanceof DOMException&&Ce.name==="DataCloneError")throw Ce;d.location.assign(fe)}g&&a&&a({action:E,location:se.location,delta:1})}function j(ve,X){E=Ja.Replace;let H=Bx(se.location,ve,X);P=A();let Y=zS(H,P),fe=se.createHref(H);x.replaceState(Y,"",fe),g&&a&&a({action:E,location:se.location,delta:0})}function Z(ve){let X=d.location.origin!=="null"?d.location.origin:d.location.href,H=typeof ve=="string"?ve:yy(ve);return H=H.replace(/ $/,"%20"),Sr(X,"No window.location.(origin|href) available to create URL for href: "+H),new URL(H,X)}let se={get action(){return E},get location(){return e(d,x)},listen(ve){if(a)throw new Error("A history only accepts one active listener");return d.addEventListener(LS,R),a=ve,()=>{d.removeEventListener(LS,R),a=null}},createHref(ve){return n(d,ve)},createURL:Z,encodeLocation(ve){let X=Z(ve);return{pathname:X.pathname,search:X.search,hash:X.hash}},push:F,replace:j,go(ve){return x.go(ve)}};return se}var RS;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(RS||(RS={}));function l5(e,n,s){return s===void 0&&(s="/"),c5(e,n,s,!1)}function c5(e,n,s,l){let d=typeof n=="string"?Oh(n):n,g=cw(d.pathname||"/",s);if(g==null)return null;let x=zk(e);u5(x);let E=null;for(let a=0;E==null&&a<x.length;++a){let P=w5(g);E=v5(x[a],P,l)}return E}function zk(e,n,s,l){n===void 0&&(n=[]),s===void 0&&(s=[]),l===void 0&&(l="");let d=(g,x,E)=>{let a={relativePath:E===void 0?g.path||"":E,caseSensitive:g.caseSensitive===!0,childrenIndex:x,route:g};a.relativePath.startsWith("/")&&(Sr(a.relativePath.startsWith(l),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(l.length));let P=al([l,a.relativePath]),A=s.concat(a);g.children&&g.children.length>0&&(Sr(g.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+P+'".')),zk(g.children,n,A,P)),!(g.path==null&&!g.index)&&n.push({path:P,score:y5(P,g.index),routesMeta:A})};return e.forEach((g,x)=>{var E;if(g.path===""||!((E=g.path)!=null&&E.includes("?")))d(g,x);else for(let a of Rk(g.path))d(g,x,a)}),n}function Rk(e){let n=e.split("/");if(n.length===0)return[];let[s,...l]=n,d=s.endsWith("?"),g=s.replace(/\?$/,"");if(l.length===0)return d?[g,""]:[g];let x=Rk(l.join("/")),E=[];return E.push(...x.map(a=>a===""?g:[g,a].join("/"))),d&&E.push(...x),E.map(a=>e.startsWith("/")&&a===""?"/":a)}function u5(e){e.sort((n,s)=>n.score!==s.score?s.score-n.score:_5(n.routesMeta.map(l=>l.childrenIndex),s.routesMeta.map(l=>l.childrenIndex)))}const h5=/^:[\w-]+$/,d5=3,f5=2,p5=1,m5=10,g5=-2,OS=e=>e==="*";function y5(e,n){let s=e.split("/"),l=s.length;return s.some(OS)&&(l+=g5),n&&(l+=f5),s.filter(d=>!OS(d)).reduce((d,g)=>d+(h5.test(g)?d5:g===""?p5:m5),l)}function _5(e,n){return e.length===n.length&&e.slice(0,-1).every((l,d)=>l===n[d])?e[e.length-1]-n[n.length-1]:0}function v5(e,n,s){let{routesMeta:l}=e,d={},g="/",x=[];for(let E=0;E<l.length;++E){let a=l[E],P=E===l.length-1,A=g==="/"?n:n.slice(g.length)||"/",R=FS({path:a.relativePath,caseSensitive:a.caseSensitive,end:P},A),F=a.route;if(!R&&P&&s&&!l[l.length-1].route.index&&(R=FS({path:a.relativePath,caseSensitive:a.caseSensitive,end:!1},A)),!R)return null;Object.assign(d,R.params),x.push({params:d,pathname:al([g,R.pathname]),pathnameBase:S5(al([g,R.pathnameBase])),route:F}),R.pathnameBase!=="/"&&(g=al([g,R.pathnameBase]))}return x}function FS(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,l]=x5(e.path,e.caseSensitive,e.end),d=n.match(s);if(!d)return null;let g=d[0],x=g.replace(/(.)\/+$/,"$1"),E=d.slice(1);return{params:l.reduce((P,A,R)=>{let{paramName:F,isOptional:j}=A;if(F==="*"){let se=E[R]||"";x=g.slice(0,g.length-se.length).replace(/(.)\/+$/,"$1")}const Z=E[R];return j&&!Z?P[F]=void 0:P[F]=(Z||"").replace(/%2F/g,"/"),P},{}),pathname:g,pathnameBase:x,pattern:e}}function x5(e,n,s){n===void 0&&(n=!1),s===void 0&&(s=!0),Lk(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let l=[],d="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(x,E,a)=>(l.push({paramName:E,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(l.push({paramName:"*"}),d+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?d+="\\/*$":e!==""&&e!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,n?void 0:"i"),l]}function w5(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Lk(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function cw(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let s=n.endsWith("/")?n.length-1:n.length,l=e.charAt(s);return l&&l!=="/"?null:e.slice(s)||"/"}function b5(e,n){n===void 0&&(n="/");let{pathname:s,search:l="",hash:d=""}=typeof e=="string"?Oh(e):e;return{pathname:s?s.startsWith("/")?s:T5(s,n):n,search:C5(l),hash:P5(d)}}function T5(e,n){let s=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(d=>{d===".."?s.length>1&&s.pop():d!=="."&&s.push(d)}),s.length>1?s.join("/"):"/"}function v0(e,n,s,l){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function E5(e){return e.filter((n,s)=>s===0||n.route.path&&n.route.path.length>0)}function Ok(e,n){let s=E5(e);return n?s.map((l,d)=>d===s.length-1?l.pathname:l.pathnameBase):s.map(l=>l.pathnameBase)}function Fk(e,n,s,l){l===void 0&&(l=!1);let d;typeof e=="string"?d=Oh(e):(d=up({},e),Sr(!d.pathname||!d.pathname.includes("?"),v0("?","pathname","search",d)),Sr(!d.pathname||!d.pathname.includes("#"),v0("#","pathname","hash",d)),Sr(!d.search||!d.search.includes("#"),v0("#","search","hash",d)));let g=e===""||d.pathname==="",x=g?"/":d.pathname,E;if(x==null)E=s;else{let R=n.length-1;if(!l&&x.startsWith("..")){let F=x.split("/");for(;F[0]==="..";)F.shift(),R-=1;d.pathname=F.join("/")}E=R>=0?n[R]:"/"}let a=b5(d,E),P=x&&x!=="/"&&x.endsWith("/"),A=(g||x===".")&&s.endsWith("/");return!a.pathname.endsWith("/")&&(P||A)&&(a.pathname+="/"),a}const al=e=>e.join("/").replace(/\/\/+/g,"/"),S5=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),C5=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,P5=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function M5(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Bk=["post","put","patch","delete"];new Set(Bk);const k5=["get",...Bk];new Set(k5);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hp(){return hp=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},hp.apply(this,arguments)}const uw=Q.createContext(null),I5=Q.createContext(null),Uc=Q.createContext(null),Jy=Q.createContext(null),yl=Q.createContext({outlet:null,matches:[],isDataRoute:!1}),jk=Q.createContext(null);function A5(e,n){let{relative:s}=n===void 0?{}:n;bp()||Sr(!1);let{basename:l,navigator:d}=Q.useContext(Uc),{hash:g,pathname:x,search:E}=$k(e,{relative:s}),a=x;return l!=="/"&&(a=x==="/"?l:al([l,x])),d.createHref({pathname:a,search:E,hash:g})}function bp(){return Q.useContext(Jy)!=null}function Qy(){return bp()||Sr(!1),Q.useContext(Jy).location}function Nk(e){Q.useContext(Uc).static||Q.useLayoutEffect(e)}function Uk(){let{isDataRoute:e}=Q.useContext(yl);return e?G5():D5()}function D5(){bp()||Sr(!1);let e=Q.useContext(uw),{basename:n,future:s,navigator:l}=Q.useContext(Uc),{matches:d}=Q.useContext(yl),{pathname:g}=Qy(),x=JSON.stringify(Ok(d,s.v7_relativeSplatPath)),E=Q.useRef(!1);return Nk(()=>{E.current=!0}),Q.useCallback(function(P,A){if(A===void 0&&(A={}),!E.current)return;if(typeof P=="number"){l.go(P);return}let R=Fk(P,JSON.parse(x),g,A.relative==="path");e==null&&n!=="/"&&(R.pathname=R.pathname==="/"?n:al([n,R.pathname])),(A.replace?l.replace:l.push)(R,A.state,A)},[n,l,x,g,e])}function Vk(){let{matches:e}=Q.useContext(yl),n=e[e.length-1];return n?n.params:{}}function $k(e,n){let{relative:s}=n===void 0?{}:n,{future:l}=Q.useContext(Uc),{matches:d}=Q.useContext(yl),{pathname:g}=Qy(),x=JSON.stringify(Ok(d,l.v7_relativeSplatPath));return Q.useMemo(()=>Fk(e,JSON.parse(x),g,s==="path"),[e,x,g,s])}function L5(e,n){return z5(e,n)}function z5(e,n,s,l){bp()||Sr(!1);let{navigator:d}=Q.useContext(Uc),{matches:g}=Q.useContext(yl),x=g[g.length-1],E=x?x.params:{};x&&x.pathname;let a=x?x.pathnameBase:"/";x&&x.route;let P=Qy(),A;if(n){var R;let ve=typeof n=="string"?Oh(n):n;a==="/"||(R=ve.pathname)!=null&&R.startsWith(a)||Sr(!1),A=ve}else A=P;let F=A.pathname||"/",j=F;if(a!=="/"){let ve=a.replace(/^\//,"").split("/");j="/"+F.replace(/^\//,"").split("/").slice(ve.length).join("/")}let Z=l5(e,{pathname:j}),se=j5(Z&&Z.map(ve=>Object.assign({},ve,{params:Object.assign({},E,ve.params),pathname:al([a,d.encodeLocation?d.encodeLocation(ve.pathname).pathname:ve.pathname]),pathnameBase:ve.pathnameBase==="/"?a:al([a,d.encodeLocation?d.encodeLocation(ve.pathnameBase).pathname:ve.pathnameBase])})),g,s,l);return n&&se?Q.createElement(Jy.Provider,{value:{location:hp({pathname:"/",search:"",hash:"",state:null,key:"default"},A),navigationType:Ja.Pop}},se):se}function R5(){let e=$5(),n=M5(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Q.createElement(Q.Fragment,null,Q.createElement("h2",null,"Unexpected Application Error!"),Q.createElement("h3",{style:{fontStyle:"italic"}},n),s?Q.createElement("pre",{style:d},s):null,null)}const O5=Q.createElement(R5,null);class F5 extends Q.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,s){return s.location!==n.location||s.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:s.error,location:s.location,revalidation:n.revalidation||s.revalidation}}componentDidCatch(n,s){console.error("React Router caught the following error during render",n,s)}render(){return this.state.error!==void 0?Q.createElement(yl.Provider,{value:this.props.routeContext},Q.createElement(jk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function B5(e){let{routeContext:n,match:s,children:l}=e,d=Q.useContext(uw);return d&&d.static&&d.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=s.route.id),Q.createElement(yl.Provider,{value:n},l)}function j5(e,n,s,l){var d;if(n===void 0&&(n=[]),s===void 0&&(s=null),l===void 0&&(l=null),e==null){var g;if(!s)return null;if(s.errors)e=s.matches;else if((g=l)!=null&&g.v7_partialHydration&&n.length===0&&!s.initialized&&s.matches.length>0)e=s.matches;else return null}let x=e,E=(d=s)==null?void 0:d.errors;if(E!=null){let A=x.findIndex(R=>R.route.id&&(E==null?void 0:E[R.route.id])!==void 0);A>=0||Sr(!1),x=x.slice(0,Math.min(x.length,A+1))}let a=!1,P=-1;if(s&&l&&l.v7_partialHydration)for(let A=0;A<x.length;A++){let R=x[A];if((R.route.HydrateFallback||R.route.hydrateFallbackElement)&&(P=A),R.route.id){let{loaderData:F,errors:j}=s,Z=R.route.loader&&F[R.route.id]===void 0&&(!j||j[R.route.id]===void 0);if(R.route.lazy||Z){a=!0,P>=0?x=x.slice(0,P+1):x=[x[0]];break}}}return x.reduceRight((A,R,F)=>{let j,Z=!1,se=null,ve=null;s&&(j=E&&R.route.id?E[R.route.id]:void 0,se=R.route.errorElement||O5,a&&(P<0&&F===0?(Z=!0,ve=null):P===F&&(Z=!0,ve=R.route.hydrateFallbackElement||null)));let X=n.concat(x.slice(0,F+1)),H=()=>{let Y;return j?Y=se:Z?Y=ve:R.route.Component?Y=Q.createElement(R.route.Component,null):R.route.element?Y=R.route.element:Y=A,Q.createElement(B5,{match:R,routeContext:{outlet:A,matches:X,isDataRoute:s!=null},children:Y})};return s&&(R.route.ErrorBoundary||R.route.errorElement||F===0)?Q.createElement(F5,{location:s.location,revalidation:s.revalidation,component:se,error:j,children:H(),routeContext:{outlet:null,matches:X,isDataRoute:!0}}):H()},null)}var Gk=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Gk||{}),_y=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(_y||{});function N5(e){let n=Q.useContext(uw);return n||Sr(!1),n}function U5(e){let n=Q.useContext(I5);return n||Sr(!1),n}function V5(e){let n=Q.useContext(yl);return n||Sr(!1),n}function Wk(e){let n=V5(),s=n.matches[n.matches.length-1];return s.route.id||Sr(!1),s.route.id}function $5(){var e;let n=Q.useContext(jk),s=U5(_y.UseRouteError),l=Wk(_y.UseRouteError);return n!==void 0?n:(e=s.errors)==null?void 0:e[l]}function G5(){let{router:e}=N5(Gk.UseNavigateStable),n=Wk(_y.UseNavigateStable),s=Q.useRef(!1);return Nk(()=>{s.current=!0}),Q.useCallback(function(d,g){g===void 0&&(g={}),s.current&&(typeof d=="number"?e.navigate(d):e.navigate(d,hp({fromRouteId:n},g)))},[e,n])}function Ua(e){Sr(!1)}function W5(e){let{basename:n="/",children:s=null,location:l,navigationType:d=Ja.Pop,navigator:g,static:x=!1,future:E}=e;bp()&&Sr(!1);let a=n.replace(/^\/*/,"/"),P=Q.useMemo(()=>({basename:a,navigator:g,static:x,future:hp({v7_relativeSplatPath:!1},E)}),[a,E,g,x]);typeof l=="string"&&(l=Oh(l));let{pathname:A="/",search:R="",hash:F="",state:j=null,key:Z="default"}=l,se=Q.useMemo(()=>{let ve=cw(A,a);return ve==null?null:{location:{pathname:ve,search:R,hash:F,state:j,key:Z},navigationType:d}},[a,A,R,F,j,Z,d]);return se==null?null:Q.createElement(Uc.Provider,{value:P},Q.createElement(Jy.Provider,{children:s,value:se}))}function Z5(e){let{children:n,location:s}=e;return L5(jx(n),s)}new Promise(()=>{});function jx(e,n){n===void 0&&(n=[]);let s=[];return Q.Children.forEach(e,(l,d)=>{if(!Q.isValidElement(l))return;let g=[...n,d];if(l.type===Q.Fragment){s.push.apply(s,jx(l.props.children,g));return}l.type!==Ua&&Sr(!1),!l.props.index||!l.props.children||Sr(!1);let x={id:l.props.id||g.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(x.children=jx(l.props.children,g)),s.push(x)}),s}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nx(){return Nx=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},Nx.apply(this,arguments)}function q5(e,n){if(e==null)return{};var s={},l=Object.keys(e),d,g;for(g=0;g<l.length;g++)d=l[g],!(n.indexOf(d)>=0)&&(s[d]=e[d]);return s}function H5(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function X5(e,n){return e.button===0&&(!n||n==="_self")&&!H5(e)}const K5=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Y5="6";try{window.__reactRouterVersion=Y5}catch{}const J5="startTransition",BS=G0[J5];function Q5(e){let{basename:n,children:s,future:l,window:d}=e,g=Q.useRef();g.current==null&&(g.current=o5({window:d,v5Compat:!0}));let x=g.current,[E,a]=Q.useState({action:x.action,location:x.location}),{v7_startTransition:P}=l||{},A=Q.useCallback(R=>{P&&BS?BS(()=>a(R)):a(R)},[a,P]);return Q.useLayoutEffect(()=>x.listen(A),[x,A]),Q.createElement(W5,{basename:n,children:s,location:E.location,navigationType:E.action,navigator:x,future:l})}const eO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",tO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bg=Q.forwardRef(function(n,s){let{onClick:l,relative:d,reloadDocument:g,replace:x,state:E,target:a,to:P,preventScrollReset:A,viewTransition:R}=n,F=q5(n,K5),{basename:j}=Q.useContext(Uc),Z,se=!1;if(typeof P=="string"&&tO.test(P)&&(Z=P,eO))try{let Y=new URL(window.location.href),fe=P.startsWith("//")?new URL(Y.protocol+P):new URL(P),Ce=cw(fe.pathname,j);fe.origin===Y.origin&&Ce!=null?P=Ce+fe.search+fe.hash:se=!0}catch{}let ve=A5(P,{relative:d}),X=nO(P,{replace:x,state:E,target:a,preventScrollReset:A,relative:d,viewTransition:R});function H(Y){l&&l(Y),Y.defaultPrevented||X(Y)}return Q.createElement("a",Nx({},F,{href:Z||ve,onClick:se||g?l:H,ref:s,target:a}))});var jS;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(jS||(jS={}));var NS;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(NS||(NS={}));function nO(e,n){let{target:s,replace:l,state:d,preventScrollReset:g,relative:x,viewTransition:E}=n===void 0?{}:n,a=Uk(),P=Qy(),A=$k(e,{relative:x});return Q.useCallback(R=>{if(X5(R,s)){R.preventDefault();let F=l!==void 0?l:yy(P)===yy(A);a(e,{replace:F,state:d,preventScrollReset:g,relative:x,viewTransition:E})}},[P,a,A,l,d,s,e,g,x,E])}function Ux(e,n){return Ux=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,l){return s.__proto__=l,s},Ux(e,n)}function e_(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,Ux(e,n)}var t_=function(){function e(){this.listeners=[]}var n=e.prototype;return n.subscribe=function(l){var d=this,g=l||function(){};return this.listeners.push(g),this.onSubscribe(),function(){d.listeners=d.listeners.filter(function(x){return x!==g}),d.onUnsubscribe()}},n.hasListeners=function(){return this.listeners.length>0},n.onSubscribe=function(){},n.onUnsubscribe=function(){},e}();function In(){return In=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var l in s)({}).hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},In.apply(null,arguments)}var Zk=typeof window>"u";function di(){}function rO(e,n){return typeof e=="function"?e(n):e}function iO(e){return typeof e=="number"&&e>=0&&e!==1/0}function vy(e){return Array.isArray(e)?e:[e]}function oO(e,n){return Math.max(e+(n||0)-Date.now(),0)}function x0(e,n,s){return n_(e)?typeof n=="function"?In({},s,{queryKey:e,queryFn:n}):In({},n,{queryKey:e}):e}function Wa(e,n,s){return n_(e)?[In({},n,{queryKey:e}),s]:[e||{},n]}function sO(e,n){if(e===!0&&n===!0||e==null&&n==null)return"all";if(e===!1&&n===!1)return"none";var s=e??!n;return s?"active":"inactive"}function US(e,n){var s=e.active,l=e.exact,d=e.fetching,g=e.inactive,x=e.predicate,E=e.queryKey,a=e.stale;if(n_(E)){if(l){if(n.queryHash!==hw(E,n.options))return!1}else if(!xy(n.queryKey,E))return!1}var P=sO(s,g);if(P==="none")return!1;if(P!=="all"){var A=n.isActive();if(P==="active"&&!A||P==="inactive"&&A)return!1}return!(typeof a=="boolean"&&n.isStale()!==a||typeof d=="boolean"&&n.isFetching()!==d||x&&!x(n))}function VS(e,n){var s=e.exact,l=e.fetching,d=e.predicate,g=e.mutationKey;if(n_(g)){if(!n.options.mutationKey)return!1;if(s){if(Ec(n.options.mutationKey)!==Ec(g))return!1}else if(!xy(n.options.mutationKey,g))return!1}return!(typeof l=="boolean"&&n.state.status==="loading"!==l||d&&!d(n))}function hw(e,n){var s=(n==null?void 0:n.queryKeyHashFn)||Ec;return s(e)}function Ec(e){var n=vy(e);return aO(n)}function aO(e){return JSON.stringify(e,function(n,s){return Vx(s)?Object.keys(s).sort().reduce(function(l,d){return l[d]=s[d],l},{}):s})}function xy(e,n){return qk(vy(e),vy(n))}function qk(e,n){return e===n?!0:typeof e!=typeof n?!1:e&&n&&typeof e=="object"&&typeof n=="object"?!Object.keys(n).some(function(s){return!qk(e[s],n[s])}):!1}function Hk(e,n){if(e===n)return e;var s=Array.isArray(e)&&Array.isArray(n);if(s||Vx(e)&&Vx(n)){for(var l=s?e.length:Object.keys(e).length,d=s?n:Object.keys(n),g=d.length,x=s?[]:{},E=0,a=0;a<g;a++){var P=s?a:d[a];x[P]=Hk(e[P],n[P]),x[P]===e[P]&&E++}return l===g&&E===l?e:x}return n}function Vx(e){if(!$S(e))return!1;var n=e.constructor;if(typeof n>"u")return!0;var s=n.prototype;return!(!$S(s)||!s.hasOwnProperty("isPrototypeOf"))}function $S(e){return Object.prototype.toString.call(e)==="[object Object]"}function n_(e){return typeof e=="string"||Array.isArray(e)}function lO(e){return new Promise(function(n){setTimeout(n,e)})}function GS(e){Promise.resolve().then(e).catch(function(n){return setTimeout(function(){throw n})})}function Xk(){if(typeof AbortController=="function")return new AbortController}var cO=function(e){e_(n,e);function n(){var l;return l=e.call(this)||this,l.setup=function(d){var g;if(!Zk&&((g=window)!=null&&g.addEventListener)){var x=function(){return d()};return window.addEventListener("visibilitychange",x,!1),window.addEventListener("focus",x,!1),function(){window.removeEventListener("visibilitychange",x),window.removeEventListener("focus",x)}}},l}var s=n.prototype;return s.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},s.onUnsubscribe=function(){if(!this.hasListeners()){var d;(d=this.cleanup)==null||d.call(this),this.cleanup=void 0}},s.setEventListener=function(d){var g,x=this;this.setup=d,(g=this.cleanup)==null||g.call(this),this.cleanup=d(function(E){typeof E=="boolean"?x.setFocused(E):x.onFocus()})},s.setFocused=function(d){this.focused=d,d&&this.onFocus()},s.onFocus=function(){this.listeners.forEach(function(d){d()})},s.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},n}(t_),jg=new cO,uO=function(e){e_(n,e);function n(){var l;return l=e.call(this)||this,l.setup=function(d){var g;if(!Zk&&((g=window)!=null&&g.addEventListener)){var x=function(){return d()};return window.addEventListener("online",x,!1),window.addEventListener("offline",x,!1),function(){window.removeEventListener("online",x),window.removeEventListener("offline",x)}}},l}var s=n.prototype;return s.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},s.onUnsubscribe=function(){if(!this.hasListeners()){var d;(d=this.cleanup)==null||d.call(this),this.cleanup=void 0}},s.setEventListener=function(d){var g,x=this;this.setup=d,(g=this.cleanup)==null||g.call(this),this.cleanup=d(function(E){typeof E=="boolean"?x.setOnline(E):x.onOnline()})},s.setOnline=function(d){this.online=d,d&&this.onOnline()},s.onOnline=function(){this.listeners.forEach(function(d){d()})},s.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},n}(t_),Ng=new uO;function hO(e){return Math.min(1e3*Math.pow(2,e),3e4)}function wy(e){return typeof(e==null?void 0:e.cancel)=="function"}var Kk=function(n){this.revert=n==null?void 0:n.revert,this.silent=n==null?void 0:n.silent};function w0(e){return e instanceof Kk}var Yk=function(n){var s=this,l=!1,d,g,x,E;this.abort=n.abort,this.cancel=function(F){return d==null?void 0:d(F)},this.cancelRetry=function(){l=!0},this.continueRetry=function(){l=!1},this.continue=function(){return g==null?void 0:g()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(F,j){x=F,E=j});var a=function(j){s.isResolved||(s.isResolved=!0,n.onSuccess==null||n.onSuccess(j),g==null||g(),x(j))},P=function(j){s.isResolved||(s.isResolved=!0,n.onError==null||n.onError(j),g==null||g(),E(j))},A=function(){return new Promise(function(j){g=j,s.isPaused=!0,n.onPause==null||n.onPause()}).then(function(){g=void 0,s.isPaused=!1,n.onContinue==null||n.onContinue()})},R=function F(){if(!s.isResolved){var j;try{j=n.fn()}catch(Z){j=Promise.reject(Z)}d=function(se){if(!s.isResolved&&(P(new Kk(se)),s.abort==null||s.abort(),wy(j)))try{j.cancel()}catch{}},s.isTransportCancelable=wy(j),Promise.resolve(j).then(a).catch(function(Z){var se,ve;if(!s.isResolved){var X=(se=n.retry)!=null?se:3,H=(ve=n.retryDelay)!=null?ve:hO,Y=typeof H=="function"?H(s.failureCount,Z):H,fe=X===!0||typeof X=="number"&&s.failureCount<X||typeof X=="function"&&X(s.failureCount,Z);if(l||!fe){P(Z);return}s.failureCount++,n.onFail==null||n.onFail(s.failureCount,Z),lO(Y).then(function(){if(!jg.isFocused()||!Ng.isOnline())return A()}).then(function(){l?P(Z):F()})}})}};R()},dO=function(){function e(){this.queue=[],this.transactions=0,this.notifyFn=function(s){s()},this.batchNotifyFn=function(s){s()}}var n=e.prototype;return n.batch=function(l){var d;this.transactions++;try{d=l()}finally{this.transactions--,this.transactions||this.flush()}return d},n.schedule=function(l){var d=this;this.transactions?this.queue.push(l):GS(function(){d.notifyFn(l)})},n.batchCalls=function(l){var d=this;return function(){for(var g=arguments.length,x=new Array(g),E=0;E<g;E++)x[E]=arguments[E];d.schedule(function(){l.apply(void 0,x)})}},n.flush=function(){var l=this,d=this.queue;this.queue=[],d.length&&GS(function(){l.batchNotifyFn(function(){d.forEach(function(g){l.notifyFn(g)})})})},n.setNotifyFunction=function(l){this.notifyFn=l},n.setBatchNotifyFunction=function(l){this.batchNotifyFn=l},e}(),Gr=new dO,Jk=console;function Qk(){return Jk}function fO(e){Jk=e}var pO=function(){function e(s){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=s.defaultOptions,this.setOptions(s.options),this.observers=[],this.cache=s.cache,this.queryKey=s.queryKey,this.queryHash=s.queryHash,this.initialState=s.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=s.meta,this.scheduleGc()}var n=e.prototype;return n.setOptions=function(l){var d;this.options=In({},this.defaultOptions,l),this.meta=l==null?void 0:l.meta,this.cacheTime=Math.max(this.cacheTime||0,(d=this.options.cacheTime)!=null?d:5*60*1e3)},n.setDefaultOptions=function(l){this.defaultOptions=l},n.scheduleGc=function(){var l=this;this.clearGcTimeout(),iO(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){l.optionalRemove()},this.cacheTime))},n.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},n.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},n.setData=function(l,d){var g,x,E=this.state.data,a=rO(l,E);return(g=(x=this.options).isDataEqual)!=null&&g.call(x,E,a)?a=E:this.options.structuralSharing!==!1&&(a=Hk(E,a)),this.dispatch({data:a,type:"success",dataUpdatedAt:d==null?void 0:d.updatedAt}),a},n.setState=function(l,d){this.dispatch({type:"setState",state:l,setStateOptions:d})},n.cancel=function(l){var d,g=this.promise;return(d=this.retryer)==null||d.cancel(l),g?g.then(di).catch(di):Promise.resolve()},n.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},n.reset=function(){this.destroy(),this.setState(this.initialState)},n.isActive=function(){return this.observers.some(function(l){return l.options.enabled!==!1})},n.isFetching=function(){return this.state.isFetching},n.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(l){return l.getCurrentResult().isStale})},n.isStaleByTime=function(l){return l===void 0&&(l=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!oO(this.state.dataUpdatedAt,l)},n.onFocus=function(){var l,d=this.observers.find(function(g){return g.shouldFetchOnWindowFocus()});d&&d.refetch(),(l=this.retryer)==null||l.continue()},n.onOnline=function(){var l,d=this.observers.find(function(g){return g.shouldFetchOnReconnect()});d&&d.refetch(),(l=this.retryer)==null||l.continue()},n.addObserver=function(l){this.observers.indexOf(l)===-1&&(this.observers.push(l),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:l}))},n.removeObserver=function(l){this.observers.indexOf(l)!==-1&&(this.observers=this.observers.filter(function(d){return d!==l}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:l}))},n.getObserversCount=function(){return this.observers.length},n.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},n.fetch=function(l,d){var g=this,x,E,a;if(this.state.isFetching){if(this.state.dataUpdatedAt&&(d!=null&&d.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var P;return(P=this.retryer)==null||P.continueRetry(),this.promise}}if(l&&this.setOptions(l),!this.options.queryFn){var A=this.observers.find(function(H){return H.options.queryFn});A&&this.setOptions(A.options)}var R=vy(this.queryKey),F=Xk(),j={queryKey:R,pageParam:void 0,meta:this.meta};Object.defineProperty(j,"signal",{enumerable:!0,get:function(){if(F)return g.abortSignalConsumed=!0,F.signal}});var Z=function(){return g.options.queryFn?(g.abortSignalConsumed=!1,g.options.queryFn(j)):Promise.reject("Missing queryFn")},se={fetchOptions:d,options:this.options,queryKey:R,state:this.state,fetchFn:Z,meta:this.meta};if((x=this.options.behavior)!=null&&x.onFetch){var ve;(ve=this.options.behavior)==null||ve.onFetch(se)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((E=se.fetchOptions)==null?void 0:E.meta)){var X;this.dispatch({type:"fetch",meta:(X=se.fetchOptions)==null?void 0:X.meta})}return this.retryer=new Yk({fn:se.fetchFn,abort:F==null||(a=F.abort)==null?void 0:a.bind(F),onSuccess:function(Y){g.setData(Y),g.cache.config.onSuccess==null||g.cache.config.onSuccess(Y,g),g.cacheTime===0&&g.optionalRemove()},onError:function(Y){w0(Y)&&Y.silent||g.dispatch({type:"error",error:Y}),w0(Y)||(g.cache.config.onError==null||g.cache.config.onError(Y,g),Qk().error(Y)),g.cacheTime===0&&g.optionalRemove()},onFail:function(){g.dispatch({type:"failed"})},onPause:function(){g.dispatch({type:"pause"})},onContinue:function(){g.dispatch({type:"continue"})},retry:se.options.retry,retryDelay:se.options.retryDelay}),this.promise=this.retryer.promise,this.promise},n.dispatch=function(l){var d=this;this.state=this.reducer(this.state,l),Gr.batch(function(){d.observers.forEach(function(g){g.onQueryUpdate(l)}),d.cache.notify({query:d,type:"queryUpdated",action:l})})},n.getDefaultState=function(l){var d=typeof l.initialData=="function"?l.initialData():l.initialData,g=typeof l.initialData<"u",x=g?typeof l.initialDataUpdatedAt=="function"?l.initialDataUpdatedAt():l.initialDataUpdatedAt:0,E=typeof d<"u";return{data:d,dataUpdateCount:0,dataUpdatedAt:E?x??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:E?"success":"idle"}},n.reducer=function(l,d){var g,x;switch(d.type){case"failed":return In({},l,{fetchFailureCount:l.fetchFailureCount+1});case"pause":return In({},l,{isPaused:!0});case"continue":return In({},l,{isPaused:!1});case"fetch":return In({},l,{fetchFailureCount:0,fetchMeta:(g=d.meta)!=null?g:null,isFetching:!0,isPaused:!1},!l.dataUpdatedAt&&{error:null,status:"loading"});case"success":return In({},l,{data:d.data,dataUpdateCount:l.dataUpdateCount+1,dataUpdatedAt:(x=d.dataUpdatedAt)!=null?x:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var E=d.error;return w0(E)&&E.revert&&this.revertState?In({},this.revertState):In({},l,{error:E,errorUpdateCount:l.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:l.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return In({},l,{isInvalidated:!0});case"setState":return In({},l,d.state);default:return l}},e}(),mO=function(e){e_(n,e);function n(l){var d;return d=e.call(this)||this,d.config=l||{},d.queries=[],d.queriesMap={},d}var s=n.prototype;return s.build=function(d,g,x){var E,a=g.queryKey,P=(E=g.queryHash)!=null?E:hw(a,g),A=this.get(P);return A||(A=new pO({cache:this,queryKey:a,queryHash:P,options:d.defaultQueryOptions(g),state:x,defaultOptions:d.getQueryDefaults(a),meta:g.meta}),this.add(A)),A},s.add=function(d){this.queriesMap[d.queryHash]||(this.queriesMap[d.queryHash]=d,this.queries.push(d),this.notify({type:"queryAdded",query:d}))},s.remove=function(d){var g=this.queriesMap[d.queryHash];g&&(d.destroy(),this.queries=this.queries.filter(function(x){return x!==d}),g===d&&delete this.queriesMap[d.queryHash],this.notify({type:"queryRemoved",query:d}))},s.clear=function(){var d=this;Gr.batch(function(){d.queries.forEach(function(g){d.remove(g)})})},s.get=function(d){return this.queriesMap[d]},s.getAll=function(){return this.queries},s.find=function(d,g){var x=Wa(d,g),E=x[0];return typeof E.exact>"u"&&(E.exact=!0),this.queries.find(function(a){return US(E,a)})},s.findAll=function(d,g){var x=Wa(d,g),E=x[0];return Object.keys(E).length>0?this.queries.filter(function(a){return US(E,a)}):this.queries},s.notify=function(d){var g=this;Gr.batch(function(){g.listeners.forEach(function(x){x(d)})})},s.onFocus=function(){var d=this;Gr.batch(function(){d.queries.forEach(function(g){g.onFocus()})})},s.onOnline=function(){var d=this;Gr.batch(function(){d.queries.forEach(function(g){g.onOnline()})})},n}(t_),gO=function(){function e(s){this.options=In({},s.defaultOptions,s.options),this.mutationId=s.mutationId,this.mutationCache=s.mutationCache,this.observers=[],this.state=s.state||yO(),this.meta=s.meta}var n=e.prototype;return n.setState=function(l){this.dispatch({type:"setState",state:l})},n.addObserver=function(l){this.observers.indexOf(l)===-1&&this.observers.push(l)},n.removeObserver=function(l){this.observers=this.observers.filter(function(d){return d!==l})},n.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(di).catch(di)):Promise.resolve()},n.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},n.execute=function(){var l=this,d,g=this.state.status==="loading",x=Promise.resolve();return g||(this.dispatch({type:"loading",variables:this.options.variables}),x=x.then(function(){l.mutationCache.config.onMutate==null||l.mutationCache.config.onMutate(l.state.variables,l)}).then(function(){return l.options.onMutate==null?void 0:l.options.onMutate(l.state.variables)}).then(function(E){E!==l.state.context&&l.dispatch({type:"loading",context:E,variables:l.state.variables})})),x.then(function(){return l.executeMutation()}).then(function(E){d=E,l.mutationCache.config.onSuccess==null||l.mutationCache.config.onSuccess(d,l.state.variables,l.state.context,l)}).then(function(){return l.options.onSuccess==null?void 0:l.options.onSuccess(d,l.state.variables,l.state.context)}).then(function(){return l.options.onSettled==null?void 0:l.options.onSettled(d,null,l.state.variables,l.state.context)}).then(function(){return l.dispatch({type:"success",data:d}),d}).catch(function(E){return l.mutationCache.config.onError==null||l.mutationCache.config.onError(E,l.state.variables,l.state.context,l),Qk().error(E),Promise.resolve().then(function(){return l.options.onError==null?void 0:l.options.onError(E,l.state.variables,l.state.context)}).then(function(){return l.options.onSettled==null?void 0:l.options.onSettled(void 0,E,l.state.variables,l.state.context)}).then(function(){throw l.dispatch({type:"error",error:E}),E})})},n.executeMutation=function(){var l=this,d;return this.retryer=new Yk({fn:function(){return l.options.mutationFn?l.options.mutationFn(l.state.variables):Promise.reject("No mutationFn found")},onFail:function(){l.dispatch({type:"failed"})},onPause:function(){l.dispatch({type:"pause"})},onContinue:function(){l.dispatch({type:"continue"})},retry:(d=this.options.retry)!=null?d:0,retryDelay:this.options.retryDelay}),this.retryer.promise},n.dispatch=function(l){var d=this;this.state=_O(this.state,l),Gr.batch(function(){d.observers.forEach(function(g){g.onMutationUpdate(l)}),d.mutationCache.notify(d)})},e}();function yO(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function _O(e,n){switch(n.type){case"failed":return In({},e,{failureCount:e.failureCount+1});case"pause":return In({},e,{isPaused:!0});case"continue":return In({},e,{isPaused:!1});case"loading":return In({},e,{context:n.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:n.variables});case"success":return In({},e,{data:n.data,error:null,status:"success",isPaused:!1});case"error":return In({},e,{data:void 0,error:n.error,failureCount:e.failureCount+1,isPaused:!1,status:"error"});case"setState":return In({},e,n.state);default:return e}}var vO=function(e){e_(n,e);function n(l){var d;return d=e.call(this)||this,d.config=l||{},d.mutations=[],d.mutationId=0,d}var s=n.prototype;return s.build=function(d,g,x){var E=new gO({mutationCache:this,mutationId:++this.mutationId,options:d.defaultMutationOptions(g),state:x,defaultOptions:g.mutationKey?d.getMutationDefaults(g.mutationKey):void 0,meta:g.meta});return this.add(E),E},s.add=function(d){this.mutations.push(d),this.notify(d)},s.remove=function(d){this.mutations=this.mutations.filter(function(g){return g!==d}),d.cancel(),this.notify(d)},s.clear=function(){var d=this;Gr.batch(function(){d.mutations.forEach(function(g){d.remove(g)})})},s.getAll=function(){return this.mutations},s.find=function(d){return typeof d.exact>"u"&&(d.exact=!0),this.mutations.find(function(g){return VS(d,g)})},s.findAll=function(d){return this.mutations.filter(function(g){return VS(d,g)})},s.notify=function(d){var g=this;Gr.batch(function(){g.listeners.forEach(function(x){x(d)})})},s.onFocus=function(){this.resumePausedMutations()},s.onOnline=function(){this.resumePausedMutations()},s.resumePausedMutations=function(){var d=this.mutations.filter(function(g){return g.state.isPaused});return Gr.batch(function(){return d.reduce(function(g,x){return g.then(function(){return x.continue().catch(di)})},Promise.resolve())})},n}(t_);function xO(){return{onFetch:function(n){n.fetchFn=function(){var s,l,d,g,x,E,a=(s=n.fetchOptions)==null||(l=s.meta)==null?void 0:l.refetchPage,P=(d=n.fetchOptions)==null||(g=d.meta)==null?void 0:g.fetchMore,A=P==null?void 0:P.pageParam,R=(P==null?void 0:P.direction)==="forward",F=(P==null?void 0:P.direction)==="backward",j=((x=n.state.data)==null?void 0:x.pages)||[],Z=((E=n.state.data)==null?void 0:E.pageParams)||[],se=Xk(),ve=se==null?void 0:se.signal,X=Z,H=!1,Y=n.options.queryFn||function(){return Promise.reject("Missing queryFn")},fe=function(kt,lt,It,Kt){return X=Kt?[lt].concat(X):[].concat(X,[lt]),Kt?[It].concat(kt):[].concat(kt,[It])},Ce=function(kt,lt,It,Kt){if(H)return Promise.reject("Cancelled");if(typeof It>"u"&&!lt&&kt.length)return Promise.resolve(kt);var st={queryKey:n.queryKey,signal:ve,pageParam:It,meta:n.meta},He=Y(st),bt=Promise.resolve(He).then(function(Nt){return fe(kt,It,Nt,Kt)});if(wy(He)){var yt=bt;yt.cancel=He.cancel}return bt},Ue;if(!j.length)Ue=Ce([]);else if(R){var Ge=typeof A<"u",je=Ge?A:WS(n.options,j);Ue=Ce(j,Ge,je)}else if(F){var nt=typeof A<"u",Te=nt?A:wO(n.options,j);Ue=Ce(j,nt,Te,!0)}else(function(){X=[];var xt=typeof n.options.getNextPageParam>"u",kt=a&&j[0]?a(j[0],0,j):!0;Ue=kt?Ce([],xt,Z[0]):Promise.resolve(fe([],Z[0],j[0]));for(var lt=function(st){Ue=Ue.then(function(He){var bt=a&&j[st]?a(j[st],st,j):!0;if(bt){var yt=xt?Z[st]:WS(n.options,He);return Ce(He,xt,yt)}return Promise.resolve(fe(He,Z[st],j[st]))})},It=1;It<j.length;It++)lt(It)})();var mt=Ue.then(function(xt){return{pages:xt,pageParams:X}}),Dt=mt;return Dt.cancel=function(){H=!0,se==null||se.abort(),wy(Ue)&&Ue.cancel()},mt}}}}function WS(e,n){return e.getNextPageParam==null?void 0:e.getNextPageParam(n[n.length-1],n)}function wO(e,n){return e.getPreviousPageParam==null?void 0:e.getPreviousPageParam(n[0],n)}var bO=function(){function e(s){s===void 0&&(s={}),this.queryCache=s.queryCache||new mO,this.mutationCache=s.mutationCache||new vO,this.defaultOptions=s.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var n=e.prototype;return n.mount=function(){var l=this;this.unsubscribeFocus=jg.subscribe(function(){jg.isFocused()&&Ng.isOnline()&&(l.mutationCache.onFocus(),l.queryCache.onFocus())}),this.unsubscribeOnline=Ng.subscribe(function(){jg.isFocused()&&Ng.isOnline()&&(l.mutationCache.onOnline(),l.queryCache.onOnline())})},n.unmount=function(){var l,d;(l=this.unsubscribeFocus)==null||l.call(this),(d=this.unsubscribeOnline)==null||d.call(this)},n.isFetching=function(l,d){var g=Wa(l,d),x=g[0];return x.fetching=!0,this.queryCache.findAll(x).length},n.isMutating=function(l){return this.mutationCache.findAll(In({},l,{fetching:!0})).length},n.getQueryData=function(l,d){var g;return(g=this.queryCache.find(l,d))==null?void 0:g.state.data},n.getQueriesData=function(l){return this.getQueryCache().findAll(l).map(function(d){var g=d.queryKey,x=d.state,E=x.data;return[g,E]})},n.setQueryData=function(l,d,g){var x=x0(l),E=this.defaultQueryOptions(x);return this.queryCache.build(this,E).setData(d,g)},n.setQueriesData=function(l,d,g){var x=this;return Gr.batch(function(){return x.getQueryCache().findAll(l).map(function(E){var a=E.queryKey;return[a,x.setQueryData(a,d,g)]})})},n.getQueryState=function(l,d){var g;return(g=this.queryCache.find(l,d))==null?void 0:g.state},n.removeQueries=function(l,d){var g=Wa(l,d),x=g[0],E=this.queryCache;Gr.batch(function(){E.findAll(x).forEach(function(a){E.remove(a)})})},n.resetQueries=function(l,d,g){var x=this,E=Wa(l,d,g),a=E[0],P=E[1],A=this.queryCache,R=In({},a,{active:!0});return Gr.batch(function(){return A.findAll(a).forEach(function(F){F.reset()}),x.refetchQueries(R,P)})},n.cancelQueries=function(l,d,g){var x=this,E=Wa(l,d,g),a=E[0],P=E[1],A=P===void 0?{}:P;typeof A.revert>"u"&&(A.revert=!0);var R=Gr.batch(function(){return x.queryCache.findAll(a).map(function(F){return F.cancel(A)})});return Promise.all(R).then(di).catch(di)},n.invalidateQueries=function(l,d,g){var x,E,a,P=this,A=Wa(l,d,g),R=A[0],F=A[1],j=In({},R,{active:(x=(E=R.refetchActive)!=null?E:R.active)!=null?x:!0,inactive:(a=R.refetchInactive)!=null?a:!1});return Gr.batch(function(){return P.queryCache.findAll(R).forEach(function(Z){Z.invalidate()}),P.refetchQueries(j,F)})},n.refetchQueries=function(l,d,g){var x=this,E=Wa(l,d,g),a=E[0],P=E[1],A=Gr.batch(function(){return x.queryCache.findAll(a).map(function(F){return F.fetch(void 0,In({},P,{meta:{refetchPage:a==null?void 0:a.refetchPage}}))})}),R=Promise.all(A).then(di);return P!=null&&P.throwOnError||(R=R.catch(di)),R},n.fetchQuery=function(l,d,g){var x=x0(l,d,g),E=this.defaultQueryOptions(x);typeof E.retry>"u"&&(E.retry=!1);var a=this.queryCache.build(this,E);return a.isStaleByTime(E.staleTime)?a.fetch(E):Promise.resolve(a.state.data)},n.prefetchQuery=function(l,d,g){return this.fetchQuery(l,d,g).then(di).catch(di)},n.fetchInfiniteQuery=function(l,d,g){var x=x0(l,d,g);return x.behavior=xO(),this.fetchQuery(x)},n.prefetchInfiniteQuery=function(l,d,g){return this.fetchInfiniteQuery(l,d,g).then(di).catch(di)},n.cancelMutations=function(){var l=this,d=Gr.batch(function(){return l.mutationCache.getAll().map(function(g){return g.cancel()})});return Promise.all(d).then(di).catch(di)},n.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},n.executeMutation=function(l){return this.mutationCache.build(this,l).execute()},n.getQueryCache=function(){return this.queryCache},n.getMutationCache=function(){return this.mutationCache},n.getDefaultOptions=function(){return this.defaultOptions},n.setDefaultOptions=function(l){this.defaultOptions=l},n.setQueryDefaults=function(l,d){var g=this.queryDefaults.find(function(x){return Ec(l)===Ec(x.queryKey)});g?g.defaultOptions=d:this.queryDefaults.push({queryKey:l,defaultOptions:d})},n.getQueryDefaults=function(l){var d;return l?(d=this.queryDefaults.find(function(g){return xy(l,g.queryKey)}))==null?void 0:d.defaultOptions:void 0},n.setMutationDefaults=function(l,d){var g=this.mutationDefaults.find(function(x){return Ec(l)===Ec(x.mutationKey)});g?g.defaultOptions=d:this.mutationDefaults.push({mutationKey:l,defaultOptions:d})},n.getMutationDefaults=function(l){var d;return l?(d=this.mutationDefaults.find(function(g){return xy(l,g.mutationKey)}))==null?void 0:d.defaultOptions:void 0},n.defaultQueryOptions=function(l){if(l!=null&&l._defaulted)return l;var d=In({},this.defaultOptions.queries,this.getQueryDefaults(l==null?void 0:l.queryKey),l,{_defaulted:!0});return!d.queryHash&&d.queryKey&&(d.queryHash=hw(d.queryKey,d)),d},n.defaultQueryObserverOptions=function(l){return this.defaultQueryOptions(l)},n.defaultMutationOptions=function(l){return l!=null&&l._defaulted?l:In({},this.defaultOptions.mutations,this.getMutationDefaults(l==null?void 0:l.mutationKey),l,{_defaulted:!0})},n.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},e}(),TO=i5.unstable_batchedUpdates;Gr.setBatchNotifyFunction(TO);var EO=console;fO(EO);var ZS=An.createContext(void 0),SO=An.createContext(!1);function CO(e){return e&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=ZS),window.ReactQueryClientContext):ZS}var PO=function(n){var s=n.client,l=n.contextSharing,d=l===void 0?!1:l,g=n.children;An.useEffect(function(){return s.mount(),function(){s.unmount()}},[s]);var x=CO(d);return An.createElement(SO.Provider,{value:d},An.createElement(x.Provider,{value:s},g))},$x=function(e,n){return $x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&(s[d]=l[d])},$x(e,n)};function MO(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");$x(e,n);function s(){this.constructor=e}e.prototype=n===null?Object.create(n):(s.prototype=n.prototype,new s)}var Br=function(){return Br=Object.assign||function(n){for(var s,l=1,d=arguments.length;l<d;l++){s=arguments[l];for(var g in s)Object.prototype.hasOwnProperty.call(s,g)&&(n[g]=s[g])}return n},Br.apply(this,arguments)};function kO(e,n){var s={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&n.indexOf(l)<0&&(s[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,l=Object.getOwnPropertySymbols(e);d<l.length;d++)n.indexOf(l[d])<0&&Object.prototype.propertyIsEnumerable.call(e,l[d])&&(s[l[d]]=e[l[d]]);return s}function Xu(e,n,s,l){function d(g){return g instanceof s?g:new s(function(x){x(g)})}return new(s||(s=Promise))(function(g,x){function E(A){try{P(l.next(A))}catch(R){x(R)}}function a(A){try{P(l.throw(A))}catch(R){x(R)}}function P(A){A.done?g(A.value):d(A.value).then(E,a)}P((l=l.apply(e,[])).next())})}function Ku(e,n){var s={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},l,d,g,x;return x={next:E(0),throw:E(1),return:E(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function E(P){return function(A){return a([P,A])}}function a(P){if(l)throw new TypeError("Generator is already executing.");for(;x&&(x=0,P[0]&&(s=0)),s;)try{if(l=1,d&&(g=P[0]&2?d.return:P[0]?d.throw||((g=d.return)&&g.call(d),0):d.next)&&!(g=g.call(d,P[1])).done)return g;switch(d=0,g&&(P=[P[0]&2,g.value]),P[0]){case 0:case 1:g=P;break;case 4:return s.label++,{value:P[1],done:!1};case 5:s.label++,d=P[1],P=[0];continue;case 7:P=s.ops.pop(),s.trys.pop();continue;default:if(g=s.trys,!(g=g.length>0&&g[g.length-1])&&(P[0]===6||P[0]===2)){s=0;continue}if(P[0]===3&&(!g||P[1]>g[0]&&P[1]<g[3])){s.label=P[1];break}if(P[0]===6&&s.label<g[1]){s.label=g[1],g=P;break}if(g&&s.label<g[2]){s.label=g[2],s.ops.push(P);break}g[2]&&s.ops.pop(),s.trys.pop();continue}P=n.call(e,s)}catch(A){P=[6,A],d=0}finally{l=g=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}function ds(e,n){var s={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&n.indexOf(l)<0&&(s[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var d=0;for(l=Object.getOwnPropertySymbols(e);d<l.length;d++)n.indexOf(l[d])<0&&Object.prototype.propertyIsEnumerable.call(e,l[d])&&(s[l[d]]=e[l[d]])}return s}var vc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function fw(e,n){return e(n={exports:{}},n.exports),n.exports}var mc=fw(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function l(){var d=this;this.locked=new Map,this.addToLocked=function(g,x){var E=d.locked.get(g);E===void 0?x===void 0?d.locked.set(g,[]):d.locked.set(g,[x]):x!==void 0&&(E.unshift(x),d.locked.set(g,E))},this.isLocked=function(g){return d.locked.has(g)},this.lock=function(g){return new Promise(function(x,E){d.isLocked(g)?d.addToLocked(g,x):(d.addToLocked(g),x())})},this.unlock=function(g){var x=d.locked.get(g);if(x!==void 0&&x.length!==0){var E=x.pop();d.locked.set(g,x),E!==void 0&&setTimeout(E,0)}else d.locked.delete(g)}}return l.getInstance=function(){return l.instance===void 0&&(l.instance=new l),l.instance},l}();n.default=function(){return s.getInstance()}});dw(mc);var IO=dw(fw(function(e,n){var s=vc&&vc.__awaiter||function(A,R,F,j){return new(F||(F=Promise))(function(Z,se){function ve(Y){try{H(j.next(Y))}catch(fe){se(fe)}}function X(Y){try{H(j.throw(Y))}catch(fe){se(fe)}}function H(Y){Y.done?Z(Y.value):new F(function(fe){fe(Y.value)}).then(ve,X)}H((j=j.apply(A,R||[])).next())})},l=vc&&vc.__generator||function(A,R){var F,j,Z,se,ve={label:0,sent:function(){if(1&Z[0])throw Z[1];return Z[1]},trys:[],ops:[]};return se={next:X(0),throw:X(1),return:X(2)},typeof Symbol=="function"&&(se[Symbol.iterator]=function(){return this}),se;function X(H){return function(Y){return function(fe){if(F)throw new TypeError("Generator is already executing.");for(;ve;)try{if(F=1,j&&(Z=2&fe[0]?j.return:fe[0]?j.throw||((Z=j.return)&&Z.call(j),0):j.next)&&!(Z=Z.call(j,fe[1])).done)return Z;switch(j=0,Z&&(fe=[2&fe[0],Z.value]),fe[0]){case 0:case 1:Z=fe;break;case 4:return ve.label++,{value:fe[1],done:!1};case 5:ve.label++,j=fe[1],fe=[0];continue;case 7:fe=ve.ops.pop(),ve.trys.pop();continue;default:if(Z=ve.trys,!((Z=Z.length>0&&Z[Z.length-1])||fe[0]!==6&&fe[0]!==2)){ve=0;continue}if(fe[0]===3&&(!Z||fe[1]>Z[0]&&fe[1]<Z[3])){ve.label=fe[1];break}if(fe[0]===6&&ve.label<Z[1]){ve.label=Z[1],Z=fe;break}if(Z&&ve.label<Z[2]){ve.label=Z[2],ve.ops.push(fe);break}Z[2]&&ve.ops.pop(),ve.trys.pop();continue}fe=R.call(A,ve)}catch(Ce){fe=[6,Ce],j=0}finally{F=Z=0}if(5&fe[0])throw fe[1];return{value:fe[0]?fe[1]:void 0,done:!0}}([H,Y])}}},d=vc;Object.defineProperty(n,"__esModule",{value:!0});var g="browser-tabs-lock-key",x={key:function(A){return s(d,void 0,void 0,function(){return l(this,function(R){throw new Error("Unsupported")})})},getItem:function(A){return s(d,void 0,void 0,function(){return l(this,function(R){throw new Error("Unsupported")})})},clear:function(){return s(d,void 0,void 0,function(){return l(this,function(A){return[2,window.localStorage.clear()]})})},removeItem:function(A){return s(d,void 0,void 0,function(){return l(this,function(R){throw new Error("Unsupported")})})},setItem:function(A,R){return s(d,void 0,void 0,function(){return l(this,function(F){throw new Error("Unsupported")})})},keySync:function(A){return window.localStorage.key(A)},getItemSync:function(A){return window.localStorage.getItem(A)},clearSync:function(){return window.localStorage.clear()},removeItemSync:function(A){return window.localStorage.removeItem(A)},setItemSync:function(A,R){return window.localStorage.setItem(A,R)}};function E(A){return new Promise(function(R){return setTimeout(R,A)})}function a(A){for(var R="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",F="",j=0;j<A;j++)F+=R[Math.floor(Math.random()*R.length)];return F}var P=function(){function A(R){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=Date.now().toString()+a(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=R,A.waiters===void 0&&(A.waiters=[])}return A.prototype.acquireLock=function(R,F){return F===void 0&&(F=5e3),s(this,void 0,void 0,function(){var j,Z,se,ve,X,H,Y;return l(this,function(fe){switch(fe.label){case 0:j=Date.now()+a(4),Z=Date.now()+F,se=g+"-"+R,ve=this.storageHandler===void 0?x:this.storageHandler,fe.label=1;case 1:return Date.now()<Z?[4,E(30)]:[3,8];case 2:return fe.sent(),ve.getItemSync(se)!==null?[3,5]:(X=this.id+"-"+R+"-"+j,[4,E(Math.floor(25*Math.random()))]);case 3:return fe.sent(),ve.setItemSync(se,JSON.stringify({id:this.id,iat:j,timeoutKey:X,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,E(30)];case 4:return fe.sent(),(H=ve.getItemSync(se))!==null&&(Y=JSON.parse(H)).id===this.id&&Y.iat===j?(this.acquiredIatSet.add(j),this.refreshLockWhileAcquired(se,j),[2,!0]):[3,7];case 5:return A.lockCorrector(this.storageHandler===void 0?x:this.storageHandler),[4,this.waitForSomethingToChange(Z)];case 6:fe.sent(),fe.label=7;case 7:return j=Date.now()+a(4),[3,1];case 8:return[2,!1]}})})},A.prototype.refreshLockWhileAcquired=function(R,F){return s(this,void 0,void 0,function(){var j=this;return l(this,function(Z){return setTimeout(function(){return s(j,void 0,void 0,function(){var se,ve,X;return l(this,function(H){switch(H.label){case 0:return[4,mc.default().lock(F)];case 1:return H.sent(),this.acquiredIatSet.has(F)?(se=this.storageHandler===void 0?x:this.storageHandler,(ve=se.getItemSync(R))===null?(mc.default().unlock(F),[2]):((X=JSON.parse(ve)).timeRefreshed=Date.now(),se.setItemSync(R,JSON.stringify(X)),mc.default().unlock(F),this.refreshLockWhileAcquired(R,F),[2])):(mc.default().unlock(F),[2])}})})},1e3),[2]})})},A.prototype.waitForSomethingToChange=function(R){return s(this,void 0,void 0,function(){return l(this,function(F){switch(F.label){case 0:return[4,new Promise(function(j){var Z=!1,se=Date.now(),ve=!1;function X(){if(ve||(window.removeEventListener("storage",X),A.removeFromWaiting(X),clearTimeout(H),ve=!0),!Z){Z=!0;var Y=50-(Date.now()-se);Y>0?setTimeout(j,Y):j(null)}}window.addEventListener("storage",X),A.addToWaiting(X);var H=setTimeout(X,Math.max(0,R-Date.now()))})];case 1:return F.sent(),[2]}})})},A.addToWaiting=function(R){this.removeFromWaiting(R),A.waiters!==void 0&&A.waiters.push(R)},A.removeFromWaiting=function(R){A.waiters!==void 0&&(A.waiters=A.waiters.filter(function(F){return F!==R}))},A.notifyWaiters=function(){A.waiters!==void 0&&A.waiters.slice().forEach(function(R){return R()})},A.prototype.releaseLock=function(R){return s(this,void 0,void 0,function(){return l(this,function(F){switch(F.label){case 0:return[4,this.releaseLock__private__(R)];case 1:return[2,F.sent()]}})})},A.prototype.releaseLock__private__=function(R){return s(this,void 0,void 0,function(){var F,j,Z,se;return l(this,function(ve){switch(ve.label){case 0:return F=this.storageHandler===void 0?x:this.storageHandler,j=g+"-"+R,(Z=F.getItemSync(j))===null?[2]:(se=JSON.parse(Z)).id!==this.id?[3,2]:[4,mc.default().lock(se.iat)];case 1:ve.sent(),this.acquiredIatSet.delete(se.iat),F.removeItemSync(j),mc.default().unlock(se.iat),A.notifyWaiters(),ve.label=2;case 2:return[2]}})})},A.lockCorrector=function(R){for(var F=Date.now()-5e3,j=R,Z=[],se=0;;){var ve=j.keySync(se);if(ve===null)break;Z.push(ve),se++}for(var X=!1,H=0;H<Z.length;H++){var Y=Z[H];if(Y.includes(g)){var fe=j.getItemSync(Y);if(fe!==null){var Ce=JSON.parse(fe);(Ce.timeRefreshed===void 0&&Ce.timeAcquired<F||Ce.timeRefreshed!==void 0&&Ce.timeRefreshed<F)&&(j.removeItemSync(Y),X=!0)}}}X&&A.notifyWaiters()},A.waiters=void 0,A}();n.default=P}));const AO={timeoutInSeconds:60},eI={name:"auth0-spa-js",version:"2.1.3"},tI=()=>Date.now();let Gi=class Gx extends Error{constructor(n,s){super(s),this.error=n,this.error_description=s,Object.setPrototypeOf(this,Gx.prototype)}static fromPayload({error:n,error_description:s}){return new Gx(n,s)}},DO=class nI extends Gi{constructor(n,s,l,d=null){super(n,s),this.state=l,this.appState=d,Object.setPrototypeOf(this,nI.prototype)}},Wx=class rI extends Gi{constructor(){super("timeout","Timeout"),Object.setPrototypeOf(this,rI.prototype)}},LO=class iI extends Wx{constructor(n){super(),this.popup=n,Object.setPrototypeOf(this,iI.prototype)}},zO=class oI extends Gi{constructor(n){super("cancelled","Popup closed"),this.popup=n,Object.setPrototypeOf(this,oI.prototype)}},RO=class sI extends Gi{constructor(n,s,l){super(n,s),this.mfa_token=l,Object.setPrototypeOf(this,sI.prototype)}},aI=class lI extends Gi{constructor(n,s){super("missing_refresh_token",`Missing Refresh Token (audience: '${qS(n,["default"])}', scope: '${qS(s)}')`),this.audience=n,this.scope=s,Object.setPrototypeOf(this,lI.prototype)}};function qS(e,n=[]){return e&&!n.includes(e)?e:""}const Ug=()=>window.crypto,b0=()=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.";let n="";return Array.from(Ug().getRandomValues(new Uint8Array(43))).forEach(s=>n+=e[s%e.length]),n},HS=e=>btoa(e),Zx=e=>{var{clientId:n}=e,s=ds(e,["clientId"]);return new URLSearchParams((l=>Object.keys(l).filter(d=>l[d]!==void 0).reduce((d,g)=>Object.assign(Object.assign({},d),{[g]:l[g]}),{}))(Object.assign({client_id:n},s))).toString()},XS=e=>(n=>decodeURIComponent(atob(n).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join("")))(e.replace(/_/g,"/").replace(/-/g,"+")),OO=async(e,n)=>{const s=await fetch(e,n);return{ok:s.ok,json:await s.json()}},FO=async(e,n,s)=>{const l=new AbortController;let d;return n.signal=l.signal,Promise.race([OO(e,n),new Promise((g,x)=>{d=setTimeout(()=>{l.abort(),x(new Error("Timeout when executing 'fetch'"))},s)})]).finally(()=>{clearTimeout(d)})},BO=async(e,n,s,l,d,g,x)=>{return E={auth:{audience:n,scope:s},timeout:d,fetchUrl:e,fetchOptions:l,useFormData:x},a=g,new Promise(function(P,A){const R=new MessageChannel;R.port1.onmessage=function(F){F.data.error?A(new Error(F.data.error)):P(F.data),R.port1.close()},a.postMessage(E,[R.port2])});var E,a},jO=async(e,n,s,l,d,g,x=1e4)=>d?BO(e,n,s,l,x,d,g):FO(e,l,x);async function NO(e,n){var{baseUrl:s,timeout:l,audience:d,scope:g,auth0Client:x,useFormData:E}=e,a=ds(e,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);const P=E?Zx(a):JSON.stringify(a);return await async function(A,R,F,j,Z,se,ve){let X,H=null;for(let je=0;je<3;je++)try{X=await jO(A,F,j,Z,se,ve,R),H=null;break}catch(nt){H=nt}if(H)throw H;const Y=X.json,{error:fe,error_description:Ce}=Y,Ue=ds(Y,["error","error_description"]),{ok:Ge}=X;if(!Ge){const je=Ce||`HTTP error. Unable to fetch ${A}`;throw fe==="mfa_required"?new RO(fe,je,Ue.mfa_token):fe==="missing_refresh_token"?new aI(F,j):new Gi(fe||"request_error",je)}return Ue}(`${s}/oauth/token`,l,d||"default",g,{method:"POST",body:P,headers:{"Content-Type":E?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(x||eI))}},n,E)}const yg=(...e)=>{return(n=e.filter(Boolean).join(" ").trim().split(/\s+/),Array.from(new Set(n))).join(" ");var n};let Sc=class qx{constructor(n,s="@@auth0spajs@@",l){this.prefix=s,this.suffix=l,this.clientId=n.clientId,this.scope=n.scope,this.audience=n.audience}toKey(){return[this.prefix,this.clientId,this.audience,this.scope,this.suffix].filter(Boolean).join("::")}static fromKey(n){const[s,l,d,g]=n.split("::");return new qx({clientId:l,scope:g,audience:d},s)}static fromCacheEntry(n){const{scope:s,audience:l,client_id:d}=n;return new qx({scope:s,audience:l,clientId:d})}};class UO{set(n,s){localStorage.setItem(n,JSON.stringify(s))}get(n){const s=window.localStorage.getItem(n);if(s)try{return JSON.parse(s)}catch{return}}remove(n){localStorage.removeItem(n)}allKeys(){return Object.keys(window.localStorage).filter(n=>n.startsWith("@@auth0spajs@@"))}}let cI=class{constructor(){this.enclosedCache=function(){let n={};return{set(s,l){n[s]=l},get(s){const l=n[s];if(l)return l},remove(s){delete n[s]},allKeys:()=>Object.keys(n)}}()}},VO=class{constructor(n,s,l){this.cache=n,this.keyManifest=s,this.nowProvider=l||tI}async setIdToken(n,s,l){var d;const g=this.getIdTokenCacheKey(n);await this.cache.set(g,{id_token:s,decodedToken:l}),await((d=this.keyManifest)===null||d===void 0?void 0:d.add(g))}async getIdToken(n){const s=await this.cache.get(this.getIdTokenCacheKey(n.clientId));if(!s&&n.scope&&n.audience){const l=await this.get(n);return!l||!l.id_token||!l.decodedToken?void 0:{id_token:l.id_token,decodedToken:l.decodedToken}}if(s)return{id_token:s.id_token,decodedToken:s.decodedToken}}async get(n,s=0){var l;let d=await this.cache.get(n.toKey());if(!d){const E=await this.getCacheKeys();if(!E)return;const a=this.matchExistingCacheKey(n,E);a&&(d=await this.cache.get(a))}if(!d)return;const g=await this.nowProvider(),x=Math.floor(g/1e3);return d.expiresAt-s<x?d.body.refresh_token?(d.body={refresh_token:d.body.refresh_token},await this.cache.set(n.toKey(),d),d.body):(await this.cache.remove(n.toKey()),void await((l=this.keyManifest)===null||l===void 0?void 0:l.remove(n.toKey()))):d.body}async set(n){var s;const l=new Sc({clientId:n.client_id,scope:n.scope,audience:n.audience}),d=await this.wrapCacheEntry(n);await this.cache.set(l.toKey(),d),await((s=this.keyManifest)===null||s===void 0?void 0:s.add(l.toKey()))}async clear(n){var s;const l=await this.getCacheKeys();l&&(await l.filter(d=>!n||d.includes(n)).reduce(async(d,g)=>{await d,await this.cache.remove(g)},Promise.resolve()),await((s=this.keyManifest)===null||s===void 0?void 0:s.clear()))}async wrapCacheEntry(n){const s=await this.nowProvider();return{body:n,expiresAt:Math.floor(s/1e3)+n.expires_in}}async getCacheKeys(){var n;return this.keyManifest?(n=await this.keyManifest.get())===null||n===void 0?void 0:n.keys:this.cache.allKeys?this.cache.allKeys():void 0}getIdTokenCacheKey(n){return new Sc({clientId:n},"@@auth0spajs@@","@@user@@").toKey()}matchExistingCacheKey(n,s){return s.filter(l=>{var d;const g=Sc.fromKey(l),x=new Set(g.scope&&g.scope.split(" ")),E=((d=n.scope)===null||d===void 0?void 0:d.split(" "))||[],a=g.scope&&E.reduce((P,A)=>P&&x.has(A),!0);return g.prefix==="@@auth0spajs@@"&&g.clientId===n.clientId&&g.audience===n.audience&&a})[0]}},$O=class{constructor(n,s,l){this.storage=n,this.clientId=s,this.cookieDomain=l,this.storageKey=`a0.spajs.txs.${this.clientId}`}create(n){this.storage.save(this.storageKey,n,{daysUntilExpire:1,cookieDomain:this.cookieDomain})}get(){return this.storage.get(this.storageKey)}remove(){this.storage.remove(this.storageKey,{cookieDomain:this.cookieDomain})}};const Tf=e=>typeof e=="number",GO=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"],WO=e=>{if(!e.id_token)throw new Error("ID token is required but missing");const n=(g=>{const x=g.split("."),[E,a,P]=x;if(x.length!==3||!E||!a||!P)throw new Error("ID token could not be decoded");const A=JSON.parse(XS(a)),R={__raw:g},F={};return Object.keys(A).forEach(j=>{R[j]=A[j],GO.includes(j)||(F[j]=A[j])}),{encoded:{header:E,payload:a,signature:P},header:JSON.parse(XS(E)),claims:R,user:F}})(e.id_token);if(!n.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(n.claims.iss!==e.iss)throw new Error(`Issuer (iss) claim mismatch in the ID token; expected "${e.iss}", found "${n.claims.iss}"`);if(!n.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if(n.header.alg!=="RS256")throw new Error(`Signature algorithm of "${n.header.alg}" is not supported. Expected the ID token to be signed with "RS256".`);if(!n.claims.aud||typeof n.claims.aud!="string"&&!Array.isArray(n.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(n.claims.aud)){if(!n.claims.aud.includes(e.aud))throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${e.aud}" but was not one of "${n.claims.aud.join(", ")}"`);if(n.claims.aud.length>1){if(!n.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(n.claims.azp!==e.aud)throw new Error(`Authorized Party (azp) claim mismatch in the ID token; expected "${e.aud}", found "${n.claims.azp}"`)}}else if(n.claims.aud!==e.aud)throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${e.aud}" but found "${n.claims.aud}"`);if(e.nonce){if(!n.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(n.claims.nonce!==e.nonce)throw new Error(`Nonce (nonce) claim mismatch in the ID token; expected "${e.nonce}", found "${n.claims.nonce}"`)}if(e.max_age&&!Tf(n.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(n.claims.exp==null||!Tf(n.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!Tf(n.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");const s=e.leeway||60,l=new Date(e.now||Date.now()),d=new Date(0);if(d.setUTCSeconds(n.claims.exp+s),l>d)throw new Error(`Expiration Time (exp) claim error in the ID token; current time (${l}) is after expiration time (${d})`);if(n.claims.nbf!=null&&Tf(n.claims.nbf)){const g=new Date(0);if(g.setUTCSeconds(n.claims.nbf-s),l<g)throw new Error(`Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Current time (${l}) is before ${g}`)}if(n.claims.auth_time!=null&&Tf(n.claims.auth_time)){const g=new Date(0);if(g.setUTCSeconds(parseInt(n.claims.auth_time)+e.max_age+s),l>g)throw new Error(`Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Current time (${l}) is after last auth at ${g}`)}if(e.organization){const g=e.organization.trim();if(g.startsWith("org_")){const x=g;if(!n.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(x!==n.claims.org_id)throw new Error(`Organization ID (org_id) claim mismatch in the ID token; expected "${x}", found "${n.claims.org_id}"`)}else{const x=g.toLowerCase();if(!n.claims.org_name)throw new Error("Organization Name (org_name) claim must be a string present in the ID token");if(x!==n.claims.org_name)throw new Error(`Organization Name (org_name) claim mismatch in the ID token; expected "${x}", found "${n.claims.org_name}"`)}}return n};var Cc=fw(function(e,n){var s=vc&&vc.__assign||function(){return s=Object.assign||function(a){for(var P,A=1,R=arguments.length;A<R;A++)for(var F in P=arguments[A])Object.prototype.hasOwnProperty.call(P,F)&&(a[F]=P[F]);return a},s.apply(this,arguments)};function l(a,P){if(!P)return"";var A="; "+a;return P===!0?A:A+"="+P}function d(a,P,A){return encodeURIComponent(a).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(P).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(R){if(typeof R.expires=="number"){var F=new Date;F.setMilliseconds(F.getMilliseconds()+864e5*R.expires),R.expires=F}return l("Expires",R.expires?R.expires.toUTCString():"")+l("Domain",R.domain)+l("Path",R.path)+l("Secure",R.secure)+l("SameSite",R.sameSite)}(A)}function g(a){for(var P={},A=a?a.split("; "):[],R=/(%[\dA-F]{2})+/gi,F=0;F<A.length;F++){var j=A[F].split("="),Z=j.slice(1).join("=");Z.charAt(0)==='"'&&(Z=Z.slice(1,-1));try{P[j[0].replace(R,decodeURIComponent)]=Z.replace(R,decodeURIComponent)}catch{}}return P}function x(){return g(document.cookie)}function E(a,P,A){document.cookie=d(a,P,s({path:"/"},A))}n.__esModule=!0,n.encode=d,n.parse=g,n.getAll=x,n.get=function(a){return x()[a]},n.set=E,n.remove=function(a,P){E(a,"",s(s({},P),{expires:-1}))}});dw(Cc),Cc.encode,Cc.parse,Cc.getAll;var ZO=Cc.get,uI=Cc.set,hI=Cc.remove;const eh={get(e){const n=ZO(e);if(n!==void 0)return JSON.parse(n)},save(e,n,s){let l={};window.location.protocol==="https:"&&(l={secure:!0,sameSite:"none"}),s!=null&&s.daysUntilExpire&&(l.expires=s.daysUntilExpire),s!=null&&s.cookieDomain&&(l.domain=s.cookieDomain),uI(e,JSON.stringify(n),l)},remove(e,n){let s={};n!=null&&n.cookieDomain&&(s.domain=n.cookieDomain),hI(e,s)}},qO={get(e){return eh.get(e)||eh.get(`_legacy_${e}`)},save(e,n,s){let l={};window.location.protocol==="https:"&&(l={secure:!0}),s!=null&&s.daysUntilExpire&&(l.expires=s.daysUntilExpire),s!=null&&s.cookieDomain&&(l.domain=s.cookieDomain),uI(`_legacy_${e}`,JSON.stringify(n),l),eh.save(e,n,s)},remove(e,n){let s={};n!=null&&n.cookieDomain&&(s.domain=n.cookieDomain),hI(e,s),eh.remove(e,n),eh.remove(`_legacy_${e}`,n)}},HO={get(e){if(typeof sessionStorage>"u")return;const n=sessionStorage.getItem(e);return n!=null?JSON.parse(n):void 0},save(e,n){sessionStorage.setItem(e,JSON.stringify(n))},remove(e){sessionStorage.removeItem(e)}};function XO(e,n,s){var l=n===void 0?null:n,d=function(a,P){var A=atob(a);if(P){for(var R=new Uint8Array(A.length),F=0,j=A.length;F<j;++F)R[F]=A.charCodeAt(F);return String.fromCharCode.apply(null,new Uint16Array(R.buffer))}return A}(e,s!==void 0&&s),g=d.indexOf(`
`,10)+1,x=d.substring(g)+(l?"//# sourceMappingURL="+l:""),E=new Blob([x],{type:"application/javascript"});return URL.createObjectURL(E)}var KS,YS,JS,T0,KO=(KS="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9ImZ1bmN0aW9uIj09dHlwZW9mIFN1cHByZXNzZWRFcnJvciYmU3VwcHJlc3NlZEVycm9yO2NvbnN0IHM9ZT0+e3ZhcntjbGllbnRJZDp0fT1lLHI9ZnVuY3Rpb24oZSx0KXt2YXIgcj17fTtmb3IodmFyIHMgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxzKSYmdC5pbmRleE9mKHMpPDAmJihyW3NdPWVbc10pO2lmKG51bGwhPWUmJiJmdW5jdGlvbiI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihzPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxzLmxlbmd0aDtvKyspdC5pbmRleE9mKHNbb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLHNbb10pJiYocltzW29dXT1lW3Nbb11dKX1yZXR1cm4gcn0oZSxbImNsaWVudElkIl0pO3JldHVybiBuZXcgVVJMU2VhcmNoUGFyYW1zKChlPT5PYmplY3Qua2V5cyhlKS5maWx0ZXIoKHQ9PnZvaWQgMCE9PWVbdF0pKS5yZWR1Y2UoKCh0LHIpPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1tyXTplW3JdfSkpLHt9KSkoT2JqZWN0LmFzc2lnbih7Y2xpZW50X2lkOnR9LHIpKSkudG9TdHJpbmcoKX07bGV0IG89e307Y29uc3Qgbj0oZSx0KT0+YCR7ZX18JHt0fWA7YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGFzeW5jKHtkYXRhOnt0aW1lb3V0OmUsYXV0aDpyLGZldGNoVXJsOmksZmV0Y2hPcHRpb25zOmMsdXNlRm9ybURhdGE6YX0scG9ydHM6W3BdfSk9PntsZXQgZjtjb25zdHthdWRpZW5jZTp1LHNjb3BlOmx9PXJ8fHt9O3RyeXtjb25zdCByPWE/KGU9Pntjb25zdCB0PW5ldyBVUkxTZWFyY2hQYXJhbXMoZSkscj17fTtyZXR1cm4gdC5mb3JFYWNoKCgoZSx0KT0+e3JbdF09ZX0pKSxyfSkoYy5ib2R5KTpKU09OLnBhcnNlKGMuYm9keSk7aWYoIXIucmVmcmVzaF90b2tlbiYmInJlZnJlc2hfdG9rZW4iPT09ci5ncmFudF90eXBlKXtjb25zdCBlPSgoZSx0KT0+b1tuKGUsdCldKSh1LGwpO2lmKCFlKXRocm93IG5ldyB0KHUsbCk7Yy5ib2R5PWE/cyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKTpKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JlZnJlc2hfdG9rZW46ZX0pKX1sZXQgaCxnOyJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihoPW5ldyBBYm9ydENvbnRyb2xsZXIsYy5zaWduYWw9aC5zaWduYWwpO3RyeXtnPWF3YWl0IFByb21pc2UucmFjZShbKGQ9ZSxuZXcgUHJvbWlzZSgoZT0+c2V0VGltZW91dChlLGQpKSkpLGZldGNoKGksT2JqZWN0LmFzc2lnbih7fSxjKSldKX1jYXRjaChlKXtyZXR1cm4gdm9pZCBwLnBvc3RNZXNzYWdlKHtlcnJvcjplLm1lc3NhZ2V9KX1pZighZylyZXR1cm4gaCYmaC5hYm9ydCgpLHZvaWQgcC5wb3N0TWVzc2FnZSh7ZXJyb3I6IlRpbWVvdXQgd2hlbiBleGVjdXRpbmcgJ2ZldGNoJyJ9KTtmPWF3YWl0IGcuanNvbigpLGYucmVmcmVzaF90b2tlbj8oKChlLHQscik9PntvW24odCxyKV09ZX0pKGYucmVmcmVzaF90b2tlbix1LGwpLGRlbGV0ZSBmLnJlZnJlc2hfdG9rZW4pOigoZSx0KT0+e2RlbGV0ZSBvW24oZSx0KV19KSh1LGwpLHAucG9zdE1lc3NhZ2Uoe29rOmcub2ssanNvbjpmfSl9Y2F0Y2goZSl7cC5wb3N0TWVzc2FnZSh7b2s6ITEsanNvbjp7ZXJyb3I6ZS5lcnJvcixlcnJvcl9kZXNjcmlwdGlvbjplLm1lc3NhZ2V9fSl9dmFyIGR9KSl9KCk7Cgo=",YS=null,JS=!1,function(e){return T0=T0||XO(KS,YS,JS),new Worker(T0,e)});const E0={};class YO{constructor(n,s){this.cache=n,this.clientId=s,this.manifestKey=this.createManifestKeyFrom(this.clientId)}async add(n){var s;const l=new Set(((s=await this.cache.get(this.manifestKey))===null||s===void 0?void 0:s.keys)||[]);l.add(n),await this.cache.set(this.manifestKey,{keys:[...l]})}async remove(n){const s=await this.cache.get(this.manifestKey);if(s){const l=new Set(s.keys);return l.delete(n),l.size>0?await this.cache.set(this.manifestKey,{keys:[...l]}):await this.cache.remove(this.manifestKey)}}get(){return this.cache.get(this.manifestKey)}clear(){return this.cache.remove(this.manifestKey)}createManifestKeyFrom(n){return`@@auth0spajs@@::${n}`}}const JO={memory:()=>new cI().enclosedCache,localstorage:()=>new UO},QS=e=>JO[e],eC=e=>{const{openUrl:n,onRedirect:s}=e,l=ds(e,["openUrl","onRedirect"]);return Object.assign(Object.assign({},l),{openUrl:n===!1||n?n:s})},S0=new IO;class QO{constructor(n){let s,l;if(this.userCache=new cI().enclosedCache,this.defaultOptions={authorizationParams:{scope:"openid profile email"},useRefreshTokensFallback:!1,useFormData:!0},this._releaseLockOnPageHide=async()=>{await S0.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)},this.options=Object.assign(Object.assign(Object.assign({},this.defaultOptions),n),{authorizationParams:Object.assign(Object.assign({},this.defaultOptions.authorizationParams),n.authorizationParams)}),typeof window<"u"&&(()=>{if(!Ug())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(Ug().subtle===void 0)throw new Error(`
      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/main/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.
    `)})(),n.cache&&n.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),n.cache)l=n.cache;else{if(s=n.cacheLocation||"memory",!QS(s))throw new Error(`Invalid cache location "${s}"`);l=QS(s)()}this.httpTimeoutMs=n.httpTimeoutInSeconds?1e3*n.httpTimeoutInSeconds:1e4,this.cookieStorage=n.legacySameSiteCookie===!1?eh:qO,this.orgHintCookieName=`auth0.${this.options.clientId}.organization_hint`,this.isAuthenticatedCookieName=(x=>`auth0.${x}.is.authenticated`)(this.options.clientId),this.sessionCheckExpiryDays=n.sessionCheckExpiryDays||1;const d=n.useCookiesForTransactions?this.cookieStorage:HO;var g;this.scope=yg("openid",this.options.authorizationParams.scope,this.options.useRefreshTokens?"offline_access":""),this.transactionManager=new $O(d,this.options.clientId,this.options.cookieDomain),this.nowProvider=this.options.nowProvider||tI,this.cacheManager=new VO(l,l.allKeys?void 0:new YO(l,this.options.clientId),this.nowProvider),this.domainUrl=(g=this.options.domain,/^https?:\/\//.test(g)?g:`https://${g}`),this.tokenIssuer=((x,E)=>x?x.startsWith("https://")?x:`https://${x}/`:`${E}/`)(this.options.issuer,this.domainUrl),typeof window<"u"&&window.Worker&&this.options.useRefreshTokens&&s==="memory"&&(this.options.workerUrl?this.worker=new Worker(this.options.workerUrl):this.worker=new KO)}_url(n){const s=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||eI)));return`${this.domainUrl}${n}&auth0Client=${s}`}_authorizeUrl(n){return this._url(`/authorize?${Zx(n)}`)}async _verifyIdToken(n,s,l){const d=await this.nowProvider();return WO({iss:this.tokenIssuer,aud:this.options.clientId,id_token:n,nonce:s,organization:l,leeway:this.options.leeway,max_age:(g=this.options.authorizationParams.max_age,typeof g!="string"?g:parseInt(g,10)||void 0),now:d});var g}_processOrgHint(n){n?this.cookieStorage.save(this.orgHintCookieName,n,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}):this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain})}async _prepareAuthorizeUrl(n,s,l){const d=HS(b0()),g=HS(b0()),x=b0(),E=(A=>{const R=new Uint8Array(A);return(F=>{const j={"+":"-","/":"_","=":""};return F.replace(/[+/=]/g,Z=>j[Z])})(window.btoa(String.fromCharCode(...Array.from(R))))})(await(async A=>await Ug().subtle.digest({name:"SHA-256"},new TextEncoder().encode(A)))(x)),a=((A,R,F,j,Z,se,ve,X)=>Object.assign(Object.assign(Object.assign({client_id:A.clientId},A.authorizationParams),F),{scope:yg(R,F.scope),response_type:"code",response_mode:X||"query",state:j,nonce:Z,redirect_uri:ve||A.authorizationParams.redirect_uri,code_challenge:se,code_challenge_method:"S256"}))(this.options,this.scope,n,d,g,E,n.redirect_uri||this.options.authorizationParams.redirect_uri||l,s==null?void 0:s.response_mode),P=this._authorizeUrl(a);return{nonce:g,code_verifier:x,scope:a.scope,audience:a.audience||"default",redirect_uri:a.redirect_uri,state:d,url:P}}async loginWithPopup(n,s){var l;if(n=n||{},!(s=s||{}).popup&&(s.popup=(E=>{const a=window.screenX+(window.innerWidth-400)/2,P=window.screenY+(window.innerHeight-600)/2;return window.open(E,"auth0:authorize:popup",`left=${a},top=${P},width=400,height=600,resizable,scrollbars=yes,status=1`)})(""),!s.popup))throw new Error("Unable to open a popup for loginWithPopup - window.open returned `null`");const d=await this._prepareAuthorizeUrl(n.authorizationParams||{},{response_mode:"web_message"},window.location.origin);s.popup.location.href=d.url;const g=await(E=>new Promise((a,P)=>{let A;const R=setInterval(()=>{E.popup&&E.popup.closed&&(clearInterval(R),clearTimeout(F),window.removeEventListener("message",A,!1),P(new zO(E.popup)))},1e3),F=setTimeout(()=>{clearInterval(R),P(new LO(E.popup)),window.removeEventListener("message",A,!1)},1e3*(E.timeoutInSeconds||60));A=function(j){if(j.data&&j.data.type==="authorization_response"){if(clearTimeout(F),clearInterval(R),window.removeEventListener("message",A,!1),E.popup.close(),j.data.response.error)return P(Gi.fromPayload(j.data.response));a(j.data.response)}},window.addEventListener("message",A)}))(Object.assign(Object.assign({},s),{timeoutInSeconds:s.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}));if(d.state!==g.state)throw new Gi("state_mismatch","Invalid state");const x=((l=n.authorizationParams)===null||l===void 0?void 0:l.organization)||this.options.authorizationParams.organization;await this._requestToken({audience:d.audience,scope:d.scope,code_verifier:d.code_verifier,grant_type:"authorization_code",code:g.code,redirect_uri:d.redirect_uri},{nonceIn:d.nonce,organization:x})}async getUser(){var n;const s=await this._getIdTokenFromCache();return(n=s==null?void 0:s.decodedToken)===null||n===void 0?void 0:n.user}async getIdTokenClaims(){var n;const s=await this._getIdTokenFromCache();return(n=s==null?void 0:s.decodedToken)===null||n===void 0?void 0:n.claims}async loginWithRedirect(n={}){var s;const l=eC(n),{openUrl:d,fragment:g,appState:x}=l,E=ds(l,["openUrl","fragment","appState"]),a=((s=E.authorizationParams)===null||s===void 0?void 0:s.organization)||this.options.authorizationParams.organization,P=await this._prepareAuthorizeUrl(E.authorizationParams||{}),{url:A}=P,R=ds(P,["url"]);this.transactionManager.create(Object.assign(Object.assign(Object.assign({},R),{appState:x}),a&&{organization:a}));const F=g?`${A}#${g}`:A;d?await d(F):window.location.assign(F)}async handleRedirectCallback(n=window.location.href){const s=n.split("?").slice(1);if(s.length===0)throw new Error("There are no query params available for parsing.");const{state:l,code:d,error:g,error_description:x}=(R=>{R.indexOf("#")>-1&&(R=R.substring(0,R.indexOf("#")));const F=new URLSearchParams(R);return{state:F.get("state"),code:F.get("code")||void 0,error:F.get("error")||void 0,error_description:F.get("error_description")||void 0}})(s.join("")),E=this.transactionManager.get();if(!E)throw new Gi("missing_transaction","Invalid state");if(this.transactionManager.remove(),g)throw new DO(g,x||g,l,E.appState);if(!E.code_verifier||E.state&&E.state!==l)throw new Gi("state_mismatch","Invalid state");const a=E.organization,P=E.nonce,A=E.redirect_uri;return await this._requestToken(Object.assign({audience:E.audience,scope:E.scope,code_verifier:E.code_verifier,grant_type:"authorization_code",code:d},A?{redirect_uri:A}:{}),{nonceIn:P,organization:a}),{appState:E.appState}}async checkSession(n){if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return;this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove("auth0.is.authenticated")}try{await this.getTokenSilently(n)}catch{}}async getTokenSilently(n={}){var s;const l=Object.assign(Object.assign({cacheMode:"on"},n),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),n.authorizationParams),{scope:yg(this.scope,(s=n.authorizationParams)===null||s===void 0?void 0:s.scope)})}),d=await((g,x)=>{let E=E0[x];return E||(E=g().finally(()=>{delete E0[x],E=null}),E0[x]=E),E})(()=>this._getTokenSilently(l),`${this.options.clientId}::${l.authorizationParams.audience}::${l.authorizationParams.scope}`);return n.detailedResponse?d:d==null?void 0:d.access_token}async _getTokenSilently(n){const{cacheMode:s}=n,l=ds(n,["cacheMode"]);if(s!=="off"){const d=await this._getEntryFromCache({scope:l.authorizationParams.scope,audience:l.authorizationParams.audience||"default",clientId:this.options.clientId});if(d)return d}if(s!=="cache-only"){if(!await(async(d,g=3)=>{for(let x=0;x<g;x++)if(await d())return!0;return!1})(()=>S0.acquireLock("auth0.lock.getTokenSilently",5e3),10))throw new Wx;try{if(window.addEventListener("pagehide",this._releaseLockOnPageHide),s!=="off"){const P=await this._getEntryFromCache({scope:l.authorizationParams.scope,audience:l.authorizationParams.audience||"default",clientId:this.options.clientId});if(P)return P}const d=this.options.useRefreshTokens?await this._getTokenUsingRefreshToken(l):await this._getTokenFromIFrame(l),{id_token:g,access_token:x,oauthTokenScope:E,expires_in:a}=d;return Object.assign(Object.assign({id_token:g,access_token:x},E?{scope:E}:null),{expires_in:a})}finally{await S0.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)}}}async getTokenWithPopup(n={},s={}){var l;const d=Object.assign(Object.assign({},n),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),n.authorizationParams),{scope:yg(this.scope,(l=n.authorizationParams)===null||l===void 0?void 0:l.scope)})});return s=Object.assign(Object.assign({},AO),s),await this.loginWithPopup(d,s),(await this.cacheManager.get(new Sc({scope:d.authorizationParams.scope,audience:d.authorizationParams.audience||"default",clientId:this.options.clientId}))).access_token}async isAuthenticated(){return!!await this.getUser()}_buildLogoutUrl(n){n.clientId!==null?n.clientId=n.clientId||this.options.clientId:delete n.clientId;const s=n.logoutParams||{},{federated:l}=s,d=ds(s,["federated"]),g=l?"&federated":"";return this._url(`/v2/logout?${Zx(Object.assign({clientId:n.clientId},d))}`)+g}async logout(n={}){const s=eC(n),{openUrl:l}=s,d=ds(s,["openUrl"]);n.clientId===null?await this.cacheManager.clear():await this.cacheManager.clear(n.clientId||this.options.clientId),this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove(this.isAuthenticatedCookieName,{cookieDomain:this.options.cookieDomain}),this.userCache.remove("@@user@@");const g=this._buildLogoutUrl(d);l?await l(g):l!==!1&&window.location.assign(g)}async _getTokenFromIFrame(n){const s=Object.assign(Object.assign({},n.authorizationParams),{prompt:"none"}),l=this.cookieStorage.get(this.orgHintCookieName);l&&!s.organization&&(s.organization=l);const{url:d,state:g,nonce:x,code_verifier:E,redirect_uri:a,scope:P,audience:A}=await this._prepareAuthorizeUrl(s,{response_mode:"web_message"},window.location.origin);try{if(window.crossOriginIsolated)throw new Gi("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");const R=n.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,F=await((Z,se,ve=60)=>new Promise((X,H)=>{const Y=window.document.createElement("iframe");Y.setAttribute("width","0"),Y.setAttribute("height","0"),Y.style.display="none";const fe=()=>{window.document.body.contains(Y)&&(window.document.body.removeChild(Y),window.removeEventListener("message",Ce,!1))};let Ce;const Ue=setTimeout(()=>{H(new Wx),fe()},1e3*ve);Ce=function(Ge){if(Ge.origin!=se||!Ge.data||Ge.data.type!=="authorization_response")return;const je=Ge.source;je&&je.close(),Ge.data.response.error?H(Gi.fromPayload(Ge.data.response)):X(Ge.data.response),clearTimeout(Ue),window.removeEventListener("message",Ce,!1),setTimeout(fe,2e3)},window.addEventListener("message",Ce,!1),window.document.body.appendChild(Y),Y.setAttribute("src",Z)}))(d,this.domainUrl,R);if(g!==F.state)throw new Gi("state_mismatch","Invalid state");const j=await this._requestToken(Object.assign(Object.assign({},n.authorizationParams),{code_verifier:E,code:F.code,grant_type:"authorization_code",redirect_uri:a,timeout:n.authorizationParams.timeout||this.httpTimeoutMs}),{nonceIn:x,organization:s.organization});return Object.assign(Object.assign({},j),{scope:P,oauthTokenScope:j.scope,audience:A})}catch(R){throw R.error==="login_required"&&this.logout({openUrl:!1}),R}}async _getTokenUsingRefreshToken(n){const s=await this.cacheManager.get(new Sc({scope:n.authorizationParams.scope,audience:n.authorizationParams.audience||"default",clientId:this.options.clientId}));if(!(s&&s.refresh_token||this.worker)){if(this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(n);throw new aI(n.authorizationParams.audience||"default",n.authorizationParams.scope)}const l=n.authorizationParams.redirect_uri||this.options.authorizationParams.redirect_uri||window.location.origin,d=typeof n.timeoutInSeconds=="number"?1e3*n.timeoutInSeconds:null;try{const g=await this._requestToken(Object.assign(Object.assign(Object.assign({},n.authorizationParams),{grant_type:"refresh_token",refresh_token:s&&s.refresh_token,redirect_uri:l}),d&&{timeout:d}));return Object.assign(Object.assign({},g),{scope:n.authorizationParams.scope,oauthTokenScope:g.scope,audience:n.authorizationParams.audience||"default"})}catch(g){if((g.message.indexOf("Missing Refresh Token")>-1||g.message&&g.message.indexOf("invalid refresh token")>-1)&&this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(n);throw g}}async _saveEntryInCache(n){const{id_token:s,decodedToken:l}=n,d=ds(n,["id_token","decodedToken"]);this.userCache.set("@@user@@",{id_token:s,decodedToken:l}),await this.cacheManager.setIdToken(this.options.clientId,n.id_token,n.decodedToken),await this.cacheManager.set(d)}async _getIdTokenFromCache(){const n=this.options.authorizationParams.audience||"default",s=await this.cacheManager.getIdToken(new Sc({clientId:this.options.clientId,audience:n,scope:this.scope})),l=this.userCache.get("@@user@@");return s&&s.id_token===(l==null?void 0:l.id_token)?l:(this.userCache.set("@@user@@",s),s)}async _getEntryFromCache({scope:n,audience:s,clientId:l}){const d=await this.cacheManager.get(new Sc({scope:n,audience:s,clientId:l}),60);if(d&&d.access_token){const{access_token:g,oauthTokenScope:x,expires_in:E}=d,a=await this._getIdTokenFromCache();return a&&Object.assign(Object.assign({id_token:a.id_token,access_token:g},x?{scope:x}:null),{expires_in:E})}}async _requestToken(n,s){const{nonceIn:l,organization:d}=s||{},g=await NO(Object.assign({baseUrl:this.domainUrl,client_id:this.options.clientId,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},n),this.worker),x=await this._verifyIdToken(g.id_token,l,d);return await this._saveEntryInCache(Object.assign(Object.assign(Object.assign(Object.assign({},g),{decodedToken:x,scope:n.scope,audience:n.audience||"default"}),g.scope?{oauthTokenScope:g.scope}:null),{client_id:this.options.clientId})),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this._processOrgHint(d||x.claims.org_id),Object.assign(Object.assign({},g),{decodedToken:x})}}var dI={isAuthenticated:!1,isLoading:!0},Us=function(){throw new Error("You forgot to wrap your component in <Auth0Provider>.")},e4=Br(Br({},dI),{buildAuthorizeUrl:Us,buildLogoutUrl:Us,getAccessTokenSilently:Us,getAccessTokenWithPopup:Us,getIdTokenClaims:Us,loginWithRedirect:Us,loginWithPopup:Us,logout:Us,handleRedirectCallback:Us}),fI=Q.createContext(e4),tC=function(e){MO(n,e);function n(s,l){var d=e.call(this,l||s)||this;return d.error=s,d.error_description=l,Object.setPrototypeOf(d,n.prototype),d}return n}(Error),t4=/[?&]code=[^&]+/,n4=/[?&]state=[^&]+/,r4=/[?&]error=[^&]+/,i4=function(e){return e===void 0&&(e=window.location.search),(t4.test(e)||r4.test(e))&&n4.test(e)},pI=function(e){return function(n){return n instanceof Error?n:n!==null&&typeof n=="object"&&"error"in n&&typeof n.error=="string"?"error_description"in n&&typeof n.error_description=="string"?new tC(n.error,n.error_description):new tC(n.error):new Error(e)}},nC=pI("Login failed"),C0=pI("Get access token failed"),mI=function(e){var n;e!=null&&e.redirectUri&&(console.warn("Using `redirectUri` has been deprecated, please use `authorizationParams.redirect_uri` instead as `redirectUri` will be no longer supported in a future version"),e.authorizationParams=e.authorizationParams||{},e.authorizationParams.redirect_uri=e.redirectUri,delete e.redirectUri),!((n=e==null?void 0:e.authorizationParams)===null||n===void 0)&&n.redirectUri&&(console.warn("Using `authorizationParams.redirectUri` has been deprecated, please use `authorizationParams.redirect_uri` instead as `authorizationParams.redirectUri` will be removed in a future version"),e.authorizationParams.redirect_uri=e.authorizationParams.redirectUri,delete e.authorizationParams.redirectUri)},o4=function(e,n){switch(n.type){case"LOGIN_POPUP_STARTED":return Br(Br({},e),{isLoading:!0});case"LOGIN_POPUP_COMPLETE":case"INITIALISED":return Br(Br({},e),{isAuthenticated:!!n.user,user:n.user,isLoading:!1,error:void 0});case"HANDLE_REDIRECT_COMPLETE":case"GET_ACCESS_TOKEN_COMPLETE":return e.user===n.user?e:Br(Br({},e),{isAuthenticated:!!n.user,user:n.user});case"LOGOUT":return Br(Br({},e),{isAuthenticated:!1,user:void 0});case"ERROR":return Br(Br({},e),{isLoading:!1,error:n.error})}},s4=function(e){return mI(e),Br(Br({},e),{auth0Client:{name:"auth0-react",version:"2.2.4"}})},a4=function(e){window.history.replaceState({},document.title,(e==null?void 0:e.returnTo)||window.location.pathname)},l4=function(e){var n=e.children,s=e.skipRedirectCallback,l=e.onRedirectCallback,d=l===void 0?a4:l,g=e.context,x=g===void 0?fI:g,E=kO(e,["children","skipRedirectCallback","onRedirectCallback","context"]),a=Q.useState(function(){return new QO(s4(E))})[0],P=Q.useReducer(o4,dI),A=P[0],R=P[1],F=Q.useRef(!1);Q.useEffect(function(){F.current||(F.current=!0,function(){return Xu(void 0,void 0,void 0,function(){var Ce,Ue,Ge;return Ku(this,function(je){switch(je.label){case 0:return je.trys.push([0,7,,8]),Ce=void 0,i4()&&!s?[4,a.handleRedirectCallback()]:[3,3];case 1:return Ue=je.sent().appState,[4,a.getUser()];case 2:return Ce=je.sent(),d(Ue,Ce),[3,6];case 3:return[4,a.checkSession()];case 4:return je.sent(),[4,a.getUser()];case 5:Ce=je.sent(),je.label=6;case 6:return R({type:"INITIALISED",user:Ce}),[3,8];case 7:return Ge=je.sent(),R({type:"ERROR",error:nC(Ge)}),[3,8];case 8:return[2]}})})}())},[a,d,s]);var j=Q.useCallback(function(Ce){return mI(Ce),a.loginWithRedirect(Ce)},[a]),Z=Q.useCallback(function(Ce,Ue){return Xu(void 0,void 0,void 0,function(){var Ge,je;return Ku(this,function(nt){switch(nt.label){case 0:R({type:"LOGIN_POPUP_STARTED"}),nt.label=1;case 1:return nt.trys.push([1,3,,4]),[4,a.loginWithPopup(Ce,Ue)];case 2:return nt.sent(),[3,4];case 3:return Ge=nt.sent(),R({type:"ERROR",error:nC(Ge)}),[2];case 4:return[4,a.getUser()];case 5:return je=nt.sent(),R({type:"LOGIN_POPUP_COMPLETE",user:je}),[2]}})})},[a]),se=Q.useCallback(function(Ce){return Ce===void 0&&(Ce={}),Xu(void 0,void 0,void 0,function(){return Ku(this,function(Ue){switch(Ue.label){case 0:return[4,a.logout(Ce)];case 1:return Ue.sent(),(Ce.openUrl||Ce.openUrl===!1)&&R({type:"LOGOUT"}),[2]}})})},[a]),ve=Q.useCallback(function(Ce){return Xu(void 0,void 0,void 0,function(){var Ue,Ge,je,nt;return Ku(this,function(Te){switch(Te.label){case 0:return Te.trys.push([0,2,3,5]),[4,a.getTokenSilently(Ce)];case 1:return Ue=Te.sent(),[3,5];case 2:throw Ge=Te.sent(),C0(Ge);case 3:return je=R,nt={type:"GET_ACCESS_TOKEN_COMPLETE"},[4,a.getUser()];case 4:return je.apply(void 0,[(nt.user=Te.sent(),nt)]),[7];case 5:return[2,Ue]}})})},[a]),X=Q.useCallback(function(Ce,Ue){return Xu(void 0,void 0,void 0,function(){var Ge,je,nt,Te;return Ku(this,function(mt){switch(mt.label){case 0:return mt.trys.push([0,2,3,5]),[4,a.getTokenWithPopup(Ce,Ue)];case 1:return Ge=mt.sent(),[3,5];case 2:throw je=mt.sent(),C0(je);case 3:return nt=R,Te={type:"GET_ACCESS_TOKEN_COMPLETE"},[4,a.getUser()];case 4:return nt.apply(void 0,[(Te.user=mt.sent(),Te)]),[7];case 5:return[2,Ge]}})})},[a]),H=Q.useCallback(function(){return a.getIdTokenClaims()},[a]),Y=Q.useCallback(function(Ce){return Xu(void 0,void 0,void 0,function(){var Ue,Ge,je;return Ku(this,function(nt){switch(nt.label){case 0:return nt.trys.push([0,2,3,5]),[4,a.handleRedirectCallback(Ce)];case 1:return[2,nt.sent()];case 2:throw Ue=nt.sent(),C0(Ue);case 3:return Ge=R,je={type:"HANDLE_REDIRECT_COMPLETE"},[4,a.getUser()];case 4:return Ge.apply(void 0,[(je.user=nt.sent(),je)]),[7];case 5:return[2]}})})},[a]),fe=Q.useMemo(function(){return Br(Br({},A),{getAccessTokenSilently:ve,getAccessTokenWithPopup:X,getIdTokenClaims:H,loginWithRedirect:j,loginWithPopup:Z,logout:se,handleRedirectCallback:Y})},[A,ve,X,H,j,Z,se,Y]);return An.createElement(x.Provider,{value:fe},n)},r_=function(e){return e===void 0&&(e=fI),Q.useContext(e)};let c4={data:""},u4=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||c4,h4=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,d4=/\/\*[^]*?\*\/|  +/g,rC=/\n+/g,Xa=(e,n)=>{let s="",l="",d="";for(let g in e){let x=e[g];g[0]=="@"?g[1]=="i"?s=g+" "+x+";":l+=g[1]=="f"?Xa(x,g):g+"{"+Xa(x,g[1]=="k"?"":n)+"}":typeof x=="object"?l+=Xa(x,n?n.replace(/([^,])+/g,E=>g.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,a=>/&/.test(a)?a.replace(/&/g,E):E?E+" "+a:a)):g):x!=null&&(g=/^--/.test(g)?g:g.replace(/[A-Z]/g,"-$&").toLowerCase(),d+=Xa.p?Xa.p(g,x):g+":"+x+";")}return s+(n&&d?n+"{"+d+"}":d)+l},Vs={},gI=e=>{if(typeof e=="object"){let n="";for(let s in e)n+=s+gI(e[s]);return n}return e},f4=(e,n,s,l,d)=>{let g=gI(e),x=Vs[g]||(Vs[g]=(a=>{let P=0,A=11;for(;P<a.length;)A=101*A+a.charCodeAt(P++)>>>0;return"go"+A})(g));if(!Vs[x]){let a=g!==e?e:(P=>{let A,R,F=[{}];for(;A=h4.exec(P.replace(d4,""));)A[4]?F.shift():A[3]?(R=A[3].replace(rC," ").trim(),F.unshift(F[0][R]=F[0][R]||{})):F[0][A[1]]=A[2].replace(rC," ").trim();return F[0]})(e);Vs[x]=Xa(d?{["@keyframes "+x]:a}:a,s?"":"."+x)}let E=s&&Vs.g?Vs.g:null;return s&&(Vs.g=Vs[x]),((a,P,A,R)=>{R?P.data=P.data.replace(R,a):P.data.indexOf(a)===-1&&(P.data=A?a+P.data:P.data+a)})(Vs[x],n,l,E),x},p4=(e,n,s)=>e.reduce((l,d,g)=>{let x=n[g];if(x&&x.call){let E=x(s),a=E&&E.props&&E.props.className||/^go/.test(E)&&E;x=a?"."+a:E&&typeof E=="object"?E.props?"":Xa(E,""):E===!1?"":E}return l+d+(x??"")},"");function i_(e){let n=this||{},s=e.call?e(n.p):e;return f4(s.unshift?s.raw?p4(s,[].slice.call(arguments,1),n.p):s.reduce((l,d)=>Object.assign(l,d&&d.call?d(n.p):d),{}):s,u4(n.target),n.g,n.o,n.k)}let yI,Hx,Xx;i_.bind({g:1});let na=i_.bind({k:1});function m4(e,n,s,l){Xa.p=n,yI=e,Hx=s,Xx=l}function _l(e,n){let s=this||{};return function(){let l=arguments;function d(g,x){let E=Object.assign({},g),a=E.className||d.className;s.p=Object.assign({theme:Hx&&Hx()},E),s.o=/ *go\d+/.test(a),E.className=i_.apply(s,l)+(a?" "+a:"");let P=e;return e[0]&&(P=E.as||e,delete E.as),Xx&&P[0]&&Xx(E),yI(P,E)}return d}}var g4=e=>typeof e=="function",by=(e,n)=>g4(e)?e(n):e,y4=(()=>{let e=0;return()=>(++e).toString()})(),_I=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),_4=20,Vg=new Map,v4=1e3,iC=e=>{if(Vg.has(e))return;let n=setTimeout(()=>{Vg.delete(e),Vc({type:4,toastId:e})},v4);Vg.set(e,n)},x4=e=>{let n=Vg.get(e);n&&clearTimeout(n)},Kx=(e,n)=>{switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,_4)};case 1:return n.toast.id&&x4(n.toast.id),{...e,toasts:e.toasts.map(g=>g.id===n.toast.id?{...g,...n.toast}:g)};case 2:let{toast:s}=n;return e.toasts.find(g=>g.id===s.id)?Kx(e,{type:1,toast:s}):Kx(e,{type:0,toast:s});case 3:let{toastId:l}=n;return l?iC(l):e.toasts.forEach(g=>{iC(g.id)}),{...e,toasts:e.toasts.map(g=>g.id===l||l===void 0?{...g,visible:!1}:g)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(g=>g.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let d=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(g=>({...g,pauseDuration:g.pauseDuration+d}))}}},$g=[],Gg={toasts:[],pausedAt:void 0},Vc=e=>{Gg=Kx(Gg,e),$g.forEach(n=>{n(Gg)})},w4={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},b4=(e={})=>{let[n,s]=Q.useState(Gg);Q.useEffect(()=>($g.push(s),()=>{let d=$g.indexOf(s);d>-1&&$g.splice(d,1)}),[n]);let l=n.toasts.map(d=>{var g,x;return{...e,...e[d.type],...d,duration:d.duration||((g=e[d.type])==null?void 0:g.duration)||(e==null?void 0:e.duration)||w4[d.type],style:{...e.style,...(x=e[d.type])==null?void 0:x.style,...d.style}}});return{...n,toasts:l}},T4=(e,n="blank",s)=>({createdAt:Date.now(),visible:!0,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...s,id:(s==null?void 0:s.id)||y4()}),Tp=e=>(n,s)=>{let l=T4(n,e,s);return Vc({type:2,toast:l}),l.id},Zi=(e,n)=>Tp("blank")(e,n);Zi.error=Tp("error");Zi.success=Tp("success");Zi.loading=Tp("loading");Zi.custom=Tp("custom");Zi.dismiss=e=>{Vc({type:3,toastId:e})};Zi.remove=e=>Vc({type:4,toastId:e});Zi.promise=(e,n,s)=>{let l=Zi.loading(n.loading,{...s,...s==null?void 0:s.loading});return e.then(d=>(Zi.success(by(n.success,d),{id:l,...s,...s==null?void 0:s.success}),d)).catch(d=>{Zi.error(by(n.error,d),{id:l,...s,...s==null?void 0:s.error})}),e};var E4=(e,n)=>{Vc({type:1,toast:{id:e,height:n}})},S4=()=>{Vc({type:5,time:Date.now()})},C4=e=>{let{toasts:n,pausedAt:s}=b4(e);Q.useEffect(()=>{if(s)return;let g=Date.now(),x=n.map(E=>{if(E.duration===1/0)return;let a=(E.duration||0)+E.pauseDuration-(g-E.createdAt);if(a<0){E.visible&&Zi.dismiss(E.id);return}return setTimeout(()=>Zi.dismiss(E.id),a)});return()=>{x.forEach(E=>E&&clearTimeout(E))}},[n,s]);let l=Q.useCallback(()=>{s&&Vc({type:6,time:Date.now()})},[s]),d=Q.useCallback((g,x)=>{let{reverseOrder:E=!1,gutter:a=8,defaultPosition:P}=x||{},A=n.filter(j=>(j.position||P)===(g.position||P)&&j.height),R=A.findIndex(j=>j.id===g.id),F=A.filter((j,Z)=>Z<R&&j.visible).length;return A.filter(j=>j.visible).slice(...E?[F+1]:[0,F]).reduce((j,Z)=>j+(Z.height||0)+a,0)},[n]);return{toasts:n,handlers:{updateHeight:E4,startPause:S4,endPause:l,calculateOffset:d}}},P4=na`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,M4=na`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,k4=na`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,I4=_l("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${P4} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${M4} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${k4} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,A4=na`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,D4=_l("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${A4} 1s linear infinite;
`,L4=na`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,z4=na`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,R4=_l("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${L4} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${z4} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,O4=_l("div")`
  position: absolute;
`,F4=_l("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,B4=na`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,j4=_l("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${B4} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,N4=({toast:e})=>{let{icon:n,type:s,iconTheme:l}=e;return n!==void 0?typeof n=="string"?Q.createElement(j4,null,n):n:s==="blank"?null:Q.createElement(F4,null,Q.createElement(D4,{...l}),s!=="loading"&&Q.createElement(O4,null,s==="error"?Q.createElement(I4,{...l}):Q.createElement(R4,{...l})))},U4=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,V4=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,$4="0%{opacity:0;} 100%{opacity:1;}",G4="0%{opacity:1;} 100%{opacity:0;}",W4=_l("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Z4=_l("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,q4=(e,n)=>{let s=e.includes("top")?1:-1,[l,d]=_I()?[$4,G4]:[U4(s),V4(s)];return{animation:n?`${na(l)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${na(d)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},H4=Q.memo(({toast:e,position:n,style:s,children:l})=>{let d=e.height?q4(e.position||n||"top-center",e.visible):{opacity:0},g=Q.createElement(N4,{toast:e}),x=Q.createElement(Z4,{...e.ariaProps},by(e.message,e));return Q.createElement(W4,{className:e.className,style:{...d,...s,...e.style}},typeof l=="function"?l({icon:g,message:x}):Q.createElement(Q.Fragment,null,g,x))});m4(Q.createElement);var X4=({id:e,className:n,style:s,onHeightUpdate:l,children:d})=>{let g=Q.useCallback(x=>{if(x){let E=()=>{let a=x.getBoundingClientRect().height;l(e,a)};E(),new MutationObserver(E).observe(x,{subtree:!0,childList:!0,characterData:!0})}},[e,l]);return Q.createElement("div",{ref:g,className:n,style:s},d)},K4=(e,n)=>{let s=e.includes("top"),l=s?{top:0}:{bottom:0},d=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:_I()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(s?1:-1)}px)`,...l,...d}},Y4=i_`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,_g=16,J4=({reverseOrder:e,position:n="top-center",toastOptions:s,gutter:l,children:d,containerStyle:g,containerClassName:x})=>{let{toasts:E,handlers:a}=C4(s);return Q.createElement("div",{style:{position:"fixed",zIndex:9999,top:_g,left:_g,right:_g,bottom:_g,pointerEvents:"none",...g},className:x,onMouseEnter:a.startPause,onMouseLeave:a.endPause},E.map(P=>{let A=P.position||n,R=a.calculateOffset(P,{reverseOrder:e,gutter:l,defaultPosition:n}),F=K4(A,R);return Q.createElement(X4,{id:P.id,key:P.id,onHeightUpdate:a.updateHeight,className:P.visible?Y4:"",style:F},P.type==="custom"?by(P.message,P):d?d(P):Q.createElement(H4,{toast:P,position:A}))}))},Q4=Zi;function eF(){return ee.jsx("nav",{className:"bg-white shadow-lg",children:ee.jsx("div",{className:"container mx-auto px-6 py-4",children:ee.jsxs("div",{className:"flex justify-between items-center",children:[ee.jsx(Bg,{to:"/",className:"text-2xl font-bold text-blue-600",children:"YourBrand"}),ee.jsxs("div",{className:"space-x-6",children:[ee.jsx(Bg,{to:"/",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Home"}),ee.jsx(Bg,{to:"/contact",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Contact"})]})]})})})}function tF(){return ee.jsx("footer",{className:"bg-gray-800 text-white py-8",children:ee.jsx("div",{className:"container mx-auto px-6",children:ee.jsx("div",{className:"text-center",children:ee.jsxs("p",{children:[" ",new Date().getFullYear()," YourBrand. All rights reserved."]})})})})}const vI=Q.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),o_=Q.createContext({}),pw=Q.createContext(null),s_=typeof document<"u",nF=s_?Q.useLayoutEffect:Q.useEffect,xI=Q.createContext({strict:!1}),mw=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),rF="framerAppearId",wI="data-"+mw(rF);function iF(e,n,s,l){const{visualElement:d}=Q.useContext(o_),g=Q.useContext(xI),x=Q.useContext(pw),E=Q.useContext(vI).reducedMotion,a=Q.useRef();l=l||g.renderer,!a.current&&l&&(a.current=l(e,{visualState:n,parent:d,props:s,presenceContext:x,blockInitialAnimation:x?x.initial===!1:!1,reducedMotionConfig:E}));const P=a.current;Q.useInsertionEffect(()=>{P&&P.update(s,x)});const A=Q.useRef(!!(s[wI]&&!window.HandoffComplete));return nF(()=>{P&&(P.render(),A.current&&P.animationState&&P.animationState.animateChanges())}),Q.useEffect(()=>{P&&(P.updateFeatures(),!A.current&&P.animationState&&P.animationState.animateChanges(),A.current&&(A.current=!1,window.HandoffComplete=!0))}),P}function fh(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function oF(e,n,s){return Q.useCallback(l=>{l&&e.mount&&e.mount(l),n&&(l?n.mount(l):n.unmount()),s&&(typeof s=="function"?s(l):fh(s)&&(s.current=l))},[n])}function dp(e){return typeof e=="string"||Array.isArray(e)}function a_(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const gw=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],yw=["initial",...gw];function l_(e){return a_(e.animate)||yw.some(n=>dp(e[n]))}function bI(e){return!!(l_(e)||e.variants)}function sF(e,n){if(l_(e)){const{initial:s,animate:l}=e;return{initial:s===!1||dp(s)?s:void 0,animate:dp(l)?l:void 0}}return e.inherit!==!1?n:{}}function aF(e){const{initial:n,animate:s}=sF(e,Q.useContext(o_));return Q.useMemo(()=>({initial:n,animate:s}),[oC(n),oC(s)])}function oC(e){return Array.isArray(e)?e.join(" "):e}const sC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},fp={};for(const e in sC)fp[e]={isEnabled:n=>sC[e].some(s=>!!n[s])};function lF(e){for(const n in e)fp[n]={...fp[n],...e[n]}}const TI=Q.createContext({}),EI=Q.createContext({}),cF=Symbol.for("motionComponentSymbol");function uF({preloadedFeatures:e,createVisualElement:n,useRender:s,useVisualState:l,Component:d}){e&&lF(e);function g(E,a){let P;const A={...Q.useContext(vI),...E,layoutId:hF(E)},{isStatic:R}=A,F=aF(E),j=l(E,R);if(!R&&s_){F.visualElement=iF(d,j,A,n);const Z=Q.useContext(EI),se=Q.useContext(xI).strict;F.visualElement&&(P=F.visualElement.loadFeatures(A,se,e,Z))}return Q.createElement(o_.Provider,{value:F},P&&F.visualElement?Q.createElement(P,{visualElement:F.visualElement,...A}):null,s(d,E,oF(j,F.visualElement,a),j,R,F.visualElement))}const x=Q.forwardRef(g);return x[cF]=d,x}function hF({layoutId:e}){const n=Q.useContext(TI).id;return n&&e!==void 0?n+"-"+e:e}function dF(e){function n(l,d={}){return uF(e(l,d))}if(typeof Proxy>"u")return n;const s=new Map;return new Proxy(n,{get:(l,d)=>(s.has(d)||s.set(d,n(d)),s.get(d))})}const fF=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function _w(e){return typeof e!="string"||e.includes("-")?!1:!!(fF.indexOf(e)>-1||/[A-Z]/.test(e))}const Ty={};function pF(e){Object.assign(Ty,e)}const Ep=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],$c=new Set(Ep);function SI(e,{layout:n,layoutId:s}){return $c.has(e)||e.startsWith("origin")||(n||s!==void 0)&&(!!Ty[e]||e==="opacity")}const Oi=e=>!!(e&&e.getVelocity),mF={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},gF=Ep.length;function yF(e,{enableHardwareAcceleration:n=!0,allowTransformNone:s=!0},l,d){let g="";for(let x=0;x<gF;x++){const E=Ep[x];if(e[E]!==void 0){const a=mF[E]||E;g+=`${a}(${e[E]}) `}}return n&&!e.z&&(g+="translateZ(0)"),g=g.trim(),d?g=d(e,l?"":g):s&&l&&(g="none"),g}const CI=e=>n=>typeof n=="string"&&n.startsWith(e),PI=CI("--"),Yx=CI("var(--"),_F=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,vF=(e,n)=>n&&typeof e=="number"?n.transform(e):e,dl=(e,n,s)=>Math.min(Math.max(s,e),n),Gc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},$f={...Gc,transform:e=>dl(0,1,e)},vg={...Gc,default:1},Gf=e=>Math.round(e*1e5)/1e5,c_=/(-)?([\d]*\.?[\d])+/g,MI=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,xF=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Sp(e){return typeof e=="string"}const Cp=e=>({test:n=>Sp(n)&&n.endsWith(e)&&n.split(" ").length===1,parse:parseFloat,transform:n=>`${n}${e}`}),Va=Cp("deg"),gs=Cp("%"),Ut=Cp("px"),wF=Cp("vh"),bF=Cp("vw"),aC={...gs,parse:e=>gs.parse(e)/100,transform:e=>gs.transform(e*100)},lC={...Gc,transform:Math.round},kI={borderWidth:Ut,borderTopWidth:Ut,borderRightWidth:Ut,borderBottomWidth:Ut,borderLeftWidth:Ut,borderRadius:Ut,radius:Ut,borderTopLeftRadius:Ut,borderTopRightRadius:Ut,borderBottomRightRadius:Ut,borderBottomLeftRadius:Ut,width:Ut,maxWidth:Ut,height:Ut,maxHeight:Ut,size:Ut,top:Ut,right:Ut,bottom:Ut,left:Ut,padding:Ut,paddingTop:Ut,paddingRight:Ut,paddingBottom:Ut,paddingLeft:Ut,margin:Ut,marginTop:Ut,marginRight:Ut,marginBottom:Ut,marginLeft:Ut,rotate:Va,rotateX:Va,rotateY:Va,rotateZ:Va,scale:vg,scaleX:vg,scaleY:vg,scaleZ:vg,skew:Va,skewX:Va,skewY:Va,distance:Ut,translateX:Ut,translateY:Ut,translateZ:Ut,x:Ut,y:Ut,z:Ut,perspective:Ut,transformPerspective:Ut,opacity:$f,originX:aC,originY:aC,originZ:Ut,zIndex:lC,fillOpacity:$f,strokeOpacity:$f,numOctaves:lC};function vw(e,n,s,l){const{style:d,vars:g,transform:x,transformOrigin:E}=e;let a=!1,P=!1,A=!0;for(const R in n){const F=n[R];if(PI(R)){g[R]=F;continue}const j=kI[R],Z=vF(F,j);if($c.has(R)){if(a=!0,x[R]=Z,!A)continue;F!==(j.default||0)&&(A=!1)}else R.startsWith("origin")?(P=!0,E[R]=Z):d[R]=Z}if(n.transform||(a||l?d.transform=yF(e.transform,s,A,l):d.transform&&(d.transform="none")),P){const{originX:R="50%",originY:F="50%",originZ:j=0}=E;d.transformOrigin=`${R} ${F} ${j}`}}const xw=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function II(e,n,s){for(const l in n)!Oi(n[l])&&!SI(l,s)&&(e[l]=n[l])}function TF({transformTemplate:e},n,s){return Q.useMemo(()=>{const l=xw();return vw(l,n,{enableHardwareAcceleration:!s},e),Object.assign({},l.vars,l.style)},[n])}function EF(e,n,s){const l=e.style||{},d={};return II(d,l,e),Object.assign(d,TF(e,n,s)),e.transformValues?e.transformValues(d):d}function SF(e,n,s){const l={},d=EF(e,n,s);return e.drag&&e.dragListener!==!1&&(l.draggable=!1,d.userSelect=d.WebkitUserSelect=d.WebkitTouchCallout="none",d.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(l.tabIndex=0),l.style=d,l}const CF=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ey(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||CF.has(e)}let AI=e=>!Ey(e);function PF(e){e&&(AI=n=>n.startsWith("on")?!Ey(n):e(n))}try{PF(require("@emotion/is-prop-valid").default)}catch{}function MF(e,n,s){const l={};for(const d in e)d==="values"&&typeof e.values=="object"||(AI(d)||s===!0&&Ey(d)||!n&&!Ey(d)||e.draggable&&d.startsWith("onDrag"))&&(l[d]=e[d]);return l}function cC(e,n,s){return typeof e=="string"?e:Ut.transform(n+s*e)}function kF(e,n,s){const l=cC(n,e.x,e.width),d=cC(s,e.y,e.height);return`${l} ${d}`}const IF={offset:"stroke-dashoffset",array:"stroke-dasharray"},AF={offset:"strokeDashoffset",array:"strokeDasharray"};function DF(e,n,s=1,l=0,d=!0){e.pathLength=1;const g=d?IF:AF;e[g.offset]=Ut.transform(-l);const x=Ut.transform(n),E=Ut.transform(s);e[g.array]=`${x} ${E}`}function ww(e,{attrX:n,attrY:s,attrScale:l,originX:d,originY:g,pathLength:x,pathSpacing:E=1,pathOffset:a=0,...P},A,R,F){if(vw(e,P,A,F),R){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:j,style:Z,dimensions:se}=e;j.transform&&(se&&(Z.transform=j.transform),delete j.transform),se&&(d!==void 0||g!==void 0||Z.transform)&&(Z.transformOrigin=kF(se,d!==void 0?d:.5,g!==void 0?g:.5)),n!==void 0&&(j.x=n),s!==void 0&&(j.y=s),l!==void 0&&(j.scale=l),x!==void 0&&DF(j,x,E,a,!1)}const DI=()=>({...xw(),attrs:{}}),bw=e=>typeof e=="string"&&e.toLowerCase()==="svg";function LF(e,n,s,l){const d=Q.useMemo(()=>{const g=DI();return ww(g,n,{enableHardwareAcceleration:!1},bw(l),e.transformTemplate),{...g.attrs,style:{...g.style}}},[n]);if(e.style){const g={};II(g,e.style,e),d.style={...g,...d.style}}return d}function zF(e=!1){return(s,l,d,{latestValues:g},x)=>{const a=(_w(s)?LF:SF)(l,g,x,s),A={...MF(l,typeof s=="string",e),...a,ref:d},{children:R}=l,F=Q.useMemo(()=>Oi(R)?R.get():R,[R]);return Q.createElement(s,{...A,children:F})}}function LI(e,{style:n,vars:s},l,d){Object.assign(e.style,n,d&&d.getProjectionStyles(l));for(const g in s)e.style.setProperty(g,s[g])}const zI=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function RI(e,n,s,l){LI(e,n,void 0,l);for(const d in n.attrs)e.setAttribute(zI.has(d)?d:mw(d),n.attrs[d])}function Tw(e,n){const{style:s}=e,l={};for(const d in s)(Oi(s[d])||n.style&&Oi(n.style[d])||SI(d,e))&&(l[d]=s[d]);return l}function OI(e,n){const s=Tw(e,n);for(const l in e)if(Oi(e[l])||Oi(n[l])){const d=Ep.indexOf(l)!==-1?"attr"+l.charAt(0).toUpperCase()+l.substring(1):l;s[d]=e[l]}return s}function Ew(e,n,s,l={},d={}){return typeof n=="function"&&(n=n(s!==void 0?s:e.custom,l,d)),typeof n=="string"&&(n=e.variants&&e.variants[n]),typeof n=="function"&&(n=n(s!==void 0?s:e.custom,l,d)),n}function RF(e){const n=Q.useRef(null);return n.current===null&&(n.current=e()),n.current}const Sy=e=>Array.isArray(e),OF=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),FF=e=>Sy(e)?e[e.length-1]||0:e;function Wg(e){const n=Oi(e)?e.get():e;return OF(n)?n.toValue():n}function BF({scrapeMotionValuesFromProps:e,createRenderState:n,onMount:s},l,d,g){const x={latestValues:jF(l,d,g,e),renderState:n()};return s&&(x.mount=E=>s(l,E,x)),x}const FI=e=>(n,s)=>{const l=Q.useContext(o_),d=Q.useContext(pw),g=()=>BF(e,n,l,d);return s?g():RF(g)};function jF(e,n,s,l){const d={},g=l(e,{});for(const F in g)d[F]=Wg(g[F]);let{initial:x,animate:E}=e;const a=l_(e),P=bI(e);n&&P&&!a&&e.inherit!==!1&&(x===void 0&&(x=n.initial),E===void 0&&(E=n.animate));let A=s?s.initial===!1:!1;A=A||x===!1;const R=A?E:x;return R&&typeof R!="boolean"&&!a_(R)&&(Array.isArray(R)?R:[R]).forEach(j=>{const Z=Ew(e,j);if(!Z)return;const{transitionEnd:se,transition:ve,...X}=Z;for(const H in X){let Y=X[H];if(Array.isArray(Y)){const fe=A?Y.length-1:0;Y=Y[fe]}Y!==null&&(d[H]=Y)}for(const H in se)d[H]=se[H]}),d}const gr=e=>e;class uC{constructor(){this.order=[],this.scheduled=new Set}add(n){if(!this.scheduled.has(n))return this.scheduled.add(n),this.order.push(n),!0}remove(n){const s=this.order.indexOf(n);s!==-1&&(this.order.splice(s,1),this.scheduled.delete(n))}clear(){this.order.length=0,this.scheduled.clear()}}function NF(e){let n=new uC,s=new uC,l=0,d=!1,g=!1;const x=new WeakSet,E={schedule:(a,P=!1,A=!1)=>{const R=A&&d,F=R?n:s;return P&&x.add(a),F.add(a)&&R&&d&&(l=n.order.length),a},cancel:a=>{s.remove(a),x.delete(a)},process:a=>{if(d){g=!0;return}if(d=!0,[n,s]=[s,n],s.clear(),l=n.order.length,l)for(let P=0;P<l;P++){const A=n.order[P];A(a),x.has(A)&&(E.schedule(A),e())}d=!1,g&&(g=!1,E.process(a))}};return E}const xg=["prepare","read","update","preRender","render","postRender"],UF=40;function VF(e,n){let s=!1,l=!0;const d={delta:0,timestamp:0,isProcessing:!1},g=xg.reduce((R,F)=>(R[F]=NF(()=>s=!0),R),{}),x=R=>g[R].process(d),E=()=>{const R=performance.now();s=!1,d.delta=l?1e3/60:Math.max(Math.min(R-d.timestamp,UF),1),d.timestamp=R,d.isProcessing=!0,xg.forEach(x),d.isProcessing=!1,s&&n&&(l=!1,e(E))},a=()=>{s=!0,l=!0,d.isProcessing||e(E)};return{schedule:xg.reduce((R,F)=>{const j=g[F];return R[F]=(Z,se=!1,ve=!1)=>(s||a(),j.schedule(Z,se,ve)),R},{}),cancel:R=>xg.forEach(F=>g[F].cancel(R)),state:d,steps:g}}const{schedule:Gn,cancel:ra,state:ri,steps:P0}=VF(typeof requestAnimationFrame<"u"?requestAnimationFrame:gr,!0),$F={useVisualState:FI({scrapeMotionValuesFromProps:OI,createRenderState:DI,onMount:(e,n,{renderState:s,latestValues:l})=>{Gn.read(()=>{try{s.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{s.dimensions={x:0,y:0,width:0,height:0}}}),Gn.render(()=>{ww(s,l,{enableHardwareAcceleration:!1},bw(n.tagName),e.transformTemplate),RI(n,s)})}})},GF={useVisualState:FI({scrapeMotionValuesFromProps:Tw,createRenderState:xw})};function WF(e,{forwardMotionProps:n=!1},s,l){return{..._w(e)?$F:GF,preloadedFeatures:s,useRender:zF(n),createVisualElement:l,Component:e}}function qs(e,n,s,l={passive:!0}){return e.addEventListener(n,s,l),()=>e.removeEventListener(n,s)}const BI=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function u_(e,n="page"){return{point:{x:e[n+"X"],y:e[n+"Y"]}}}const ZF=e=>n=>BI(n)&&e(n,u_(n));function Ks(e,n,s,l){return qs(e,n,ZF(s),l)}const qF=(e,n)=>s=>n(e(s)),ll=(...e)=>e.reduce(qF);function jI(e){let n=null;return()=>{const s=()=>{n=null};return n===null?(n=e,s):!1}}const hC=jI("dragHorizontal"),dC=jI("dragVertical");function NI(e){let n=!1;if(e==="y")n=dC();else if(e==="x")n=hC();else{const s=hC(),l=dC();s&&l?n=()=>{s(),l()}:(s&&s(),l&&l())}return n}function UI(){const e=NI(!0);return e?(e(),!1):!0}class vl{constructor(n){this.isMounted=!1,this.node=n}update(){}}function fC(e,n){const s="pointer"+(n?"enter":"leave"),l="onHover"+(n?"Start":"End"),d=(g,x)=>{if(g.pointerType==="touch"||UI())return;const E=e.getProps();e.animationState&&E.whileHover&&e.animationState.setActive("whileHover",n),E[l]&&Gn.update(()=>E[l](g,x))};return Ks(e.current,s,d,{passive:!e.getProps()[l]})}class HF extends vl{mount(){this.unmount=ll(fC(this.node,!0),fC(this.node,!1))}unmount(){}}class XF extends vl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let n=!1;try{n=this.node.current.matches(":focus-visible")}catch{n=!0}!n||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ll(qs(this.node.current,"focus",()=>this.onFocus()),qs(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const VI=(e,n)=>n?e===n?!0:VI(e,n.parentElement):!1;function M0(e,n){if(!n)return;const s=new PointerEvent("pointer"+e);n(s,u_(s))}class KF extends vl{constructor(){super(...arguments),this.removeStartListeners=gr,this.removeEndListeners=gr,this.removeAccessibleListeners=gr,this.startPointerPress=(n,s)=>{if(this.isPressing)return;this.removeEndListeners();const l=this.node.getProps(),g=Ks(window,"pointerup",(E,a)=>{if(!this.checkPressEnd())return;const{onTap:P,onTapCancel:A,globalTapTarget:R}=this.node.getProps();Gn.update(()=>{!R&&!VI(this.node.current,E.target)?A&&A(E,a):P&&P(E,a)})},{passive:!(l.onTap||l.onPointerUp)}),x=Ks(window,"pointercancel",(E,a)=>this.cancelPress(E,a),{passive:!(l.onTapCancel||l.onPointerCancel)});this.removeEndListeners=ll(g,x),this.startPress(n,s)},this.startAccessiblePress=()=>{const n=g=>{if(g.key!=="Enter"||this.isPressing)return;const x=E=>{E.key!=="Enter"||!this.checkPressEnd()||M0("up",(a,P)=>{const{onTap:A}=this.node.getProps();A&&Gn.update(()=>A(a,P))})};this.removeEndListeners(),this.removeEndListeners=qs(this.node.current,"keyup",x),M0("down",(E,a)=>{this.startPress(E,a)})},s=qs(this.node.current,"keydown",n),l=()=>{this.isPressing&&M0("cancel",(g,x)=>this.cancelPress(g,x))},d=qs(this.node.current,"blur",l);this.removeAccessibleListeners=ll(s,d)}}startPress(n,s){this.isPressing=!0;const{onTapStart:l,whileTap:d}=this.node.getProps();d&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),l&&Gn.update(()=>l(n,s))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!UI()}cancelPress(n,s){if(!this.checkPressEnd())return;const{onTapCancel:l}=this.node.getProps();l&&Gn.update(()=>l(n,s))}mount(){const n=this.node.getProps(),s=Ks(n.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(n.onTapStart||n.onPointerStart)}),l=qs(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=ll(s,l)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Jx=new WeakMap,k0=new WeakMap,YF=e=>{const n=Jx.get(e.target);n&&n(e)},JF=e=>{e.forEach(YF)};function QF({root:e,...n}){const s=e||document;k0.has(s)||k0.set(s,{});const l=k0.get(s),d=JSON.stringify(n);return l[d]||(l[d]=new IntersectionObserver(JF,{root:e,...n})),l[d]}function eB(e,n,s){const l=QF(n);return Jx.set(e,s),l.observe(e),()=>{Jx.delete(e),l.unobserve(e)}}const tB={some:0,all:1};class nB extends vl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:n={}}=this.node.getProps(),{root:s,margin:l,amount:d="some",once:g}=n,x={root:s?s.current:void 0,rootMargin:l,threshold:typeof d=="number"?d:tB[d]},E=a=>{const{isIntersecting:P}=a;if(this.isInView===P||(this.isInView=P,g&&!P&&this.hasEnteredView))return;P&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",P);const{onViewportEnter:A,onViewportLeave:R}=this.node.getProps(),F=P?A:R;F&&F(a)};return eB(this.node.current,x,E)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:n,prevProps:s}=this.node;["amount","margin","root"].some(rB(n,s))&&this.startObserver()}unmount(){}}function rB({viewport:e={}},{viewport:n={}}={}){return s=>e[s]!==n[s]}const iB={inView:{Feature:nB},tap:{Feature:KF},focus:{Feature:XF},hover:{Feature:HF}};function $I(e,n){if(!Array.isArray(n))return!1;const s=n.length;if(s!==e.length)return!1;for(let l=0;l<s;l++)if(n[l]!==e[l])return!1;return!0}function oB(e){const n={};return e.values.forEach((s,l)=>n[l]=s.get()),n}function sB(e){const n={};return e.values.forEach((s,l)=>n[l]=s.getVelocity()),n}function h_(e,n,s){const l=e.getProps();return Ew(l,n,s!==void 0?s:l.custom,oB(e),sB(e))}let Cy=gr;const Ac=e=>e*1e3,Ys=e=>e/1e3,aB={current:!1},GI=e=>Array.isArray(e)&&typeof e[0]=="number";function WI(e){return!!(!e||typeof e=="string"&&ZI[e]||GI(e)||Array.isArray(e)&&e.every(WI))}const Df=([e,n,s,l])=>`cubic-bezier(${e}, ${n}, ${s}, ${l})`,ZI={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Df([0,.65,.55,1]),circOut:Df([.55,0,1,.45]),backIn:Df([.31,.01,.66,-.59]),backOut:Df([.33,1.53,.69,.99])};function qI(e){if(e)return GI(e)?Df(e):Array.isArray(e)?e.map(qI):ZI[e]}function lB(e,n,s,{delay:l=0,duration:d,repeat:g=0,repeatType:x="loop",ease:E,times:a}={}){const P={[n]:s};a&&(P.offset=a);const A=qI(E);return Array.isArray(A)&&(P.easing=A),e.animate(P,{delay:l,duration:d,easing:Array.isArray(A)?"linear":A,fill:"both",iterations:g+1,direction:x==="reverse"?"alternate":"normal"})}function cB(e,{repeat:n,repeatType:s="loop"}){const l=n&&s!=="loop"&&n%2===1?0:e.length-1;return e[l]}const HI=(e,n,s)=>(((1-3*s+3*n)*e+(3*s-6*n))*e+3*n)*e,uB=1e-7,hB=12;function dB(e,n,s,l,d){let g,x,E=0;do x=n+(s-n)/2,g=HI(x,l,d)-e,g>0?s=x:n=x;while(Math.abs(g)>uB&&++E<hB);return x}function Pp(e,n,s,l){if(e===n&&s===l)return gr;const d=g=>dB(g,0,1,e,s);return g=>g===0||g===1?g:HI(d(g),n,l)}const fB=Pp(.42,0,1,1),pB=Pp(0,0,.58,1),XI=Pp(.42,0,.58,1),mB=e=>Array.isArray(e)&&typeof e[0]!="number",KI=e=>n=>n<=.5?e(2*n)/2:(2-e(2*(1-n)))/2,YI=e=>n=>1-e(1-n),Sw=e=>1-Math.sin(Math.acos(e)),JI=YI(Sw),gB=KI(Sw),QI=Pp(.33,1.53,.69,.99),Cw=YI(QI),yB=KI(Cw),_B=e=>(e*=2)<1?.5*Cw(e):.5*(2-Math.pow(2,-10*(e-1))),pC={linear:gr,easeIn:fB,easeInOut:XI,easeOut:pB,circIn:Sw,circInOut:gB,circOut:JI,backIn:Cw,backInOut:yB,backOut:QI,anticipate:_B},mC=e=>{if(Array.isArray(e)){Cy(e.length===4);const[n,s,l,d]=e;return Pp(n,s,l,d)}else if(typeof e=="string")return Cy(pC[e]!==void 0),pC[e];return e},Pw=(e,n)=>s=>!!(Sp(s)&&xF.test(s)&&s.startsWith(e)||n&&Object.prototype.hasOwnProperty.call(s,n)),eA=(e,n,s)=>l=>{if(!Sp(l))return l;const[d,g,x,E]=l.match(c_);return{[e]:parseFloat(d),[n]:parseFloat(g),[s]:parseFloat(x),alpha:E!==void 0?parseFloat(E):1}},vB=e=>dl(0,255,e),I0={...Gc,transform:e=>Math.round(vB(e))},Pc={test:Pw("rgb","red"),parse:eA("red","green","blue"),transform:({red:e,green:n,blue:s,alpha:l=1})=>"rgba("+I0.transform(e)+", "+I0.transform(n)+", "+I0.transform(s)+", "+Gf($f.transform(l))+")"};function xB(e){let n="",s="",l="",d="";return e.length>5?(n=e.substring(1,3),s=e.substring(3,5),l=e.substring(5,7),d=e.substring(7,9)):(n=e.substring(1,2),s=e.substring(2,3),l=e.substring(3,4),d=e.substring(4,5),n+=n,s+=s,l+=l,d+=d),{red:parseInt(n,16),green:parseInt(s,16),blue:parseInt(l,16),alpha:d?parseInt(d,16)/255:1}}const Qx={test:Pw("#"),parse:xB,transform:Pc.transform},ph={test:Pw("hsl","hue"),parse:eA("hue","saturation","lightness"),transform:({hue:e,saturation:n,lightness:s,alpha:l=1})=>"hsla("+Math.round(e)+", "+gs.transform(Gf(n))+", "+gs.transform(Gf(s))+", "+Gf($f.transform(l))+")"},fi={test:e=>Pc.test(e)||Qx.test(e)||ph.test(e),parse:e=>Pc.test(e)?Pc.parse(e):ph.test(e)?ph.parse(e):Qx.parse(e),transform:e=>Sp(e)?e:e.hasOwnProperty("red")?Pc.transform(e):ph.transform(e)},ar=(e,n,s)=>-s*e+s*n+e;function A0(e,n,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(n-e)*6*s:s<1/2?n:s<2/3?e+(n-e)*(2/3-s)*6:e}function wB({hue:e,saturation:n,lightness:s,alpha:l}){e/=360,n/=100,s/=100;let d=0,g=0,x=0;if(!n)d=g=x=s;else{const E=s<.5?s*(1+n):s+n-s*n,a=2*s-E;d=A0(a,E,e+1/3),g=A0(a,E,e),x=A0(a,E,e-1/3)}return{red:Math.round(d*255),green:Math.round(g*255),blue:Math.round(x*255),alpha:l}}const D0=(e,n,s)=>{const l=e*e;return Math.sqrt(Math.max(0,s*(n*n-l)+l))},bB=[Qx,Pc,ph],TB=e=>bB.find(n=>n.test(e));function gC(e){const n=TB(e);let s=n.parse(e);return n===ph&&(s=wB(s)),s}const tA=(e,n)=>{const s=gC(e),l=gC(n),d={...s};return g=>(d.red=D0(s.red,l.red,g),d.green=D0(s.green,l.green,g),d.blue=D0(s.blue,l.blue,g),d.alpha=ar(s.alpha,l.alpha,g),Pc.transform(d))};function EB(e){var n,s;return isNaN(e)&&Sp(e)&&(((n=e.match(c_))===null||n===void 0?void 0:n.length)||0)+(((s=e.match(MI))===null||s===void 0?void 0:s.length)||0)>0}const nA={regex:_F,countKey:"Vars",token:"${v}",parse:gr},rA={regex:MI,countKey:"Colors",token:"${c}",parse:fi.parse},iA={regex:c_,countKey:"Numbers",token:"${n}",parse:Gc.parse};function L0(e,{regex:n,countKey:s,token:l,parse:d}){const g=e.tokenised.match(n);g&&(e["num"+s]=g.length,e.tokenised=e.tokenised.replace(n,l),e.values.push(...g.map(d)))}function Py(e){const n=e.toString(),s={value:n,tokenised:n,values:[],numVars:0,numColors:0,numNumbers:0};return s.value.includes("var(--")&&L0(s,nA),L0(s,rA),L0(s,iA),s}function oA(e){return Py(e).values}function sA(e){const{values:n,numColors:s,numVars:l,tokenised:d}=Py(e),g=n.length;return x=>{let E=d;for(let a=0;a<g;a++)a<l?E=E.replace(nA.token,x[a]):a<l+s?E=E.replace(rA.token,fi.transform(x[a])):E=E.replace(iA.token,Gf(x[a]));return E}}const SB=e=>typeof e=="number"?0:e;function CB(e){const n=oA(e);return sA(e)(n.map(SB))}const fl={test:EB,parse:oA,createTransformer:sA,getAnimatableNone:CB},aA=(e,n)=>s=>`${s>0?n:e}`;function lA(e,n){return typeof e=="number"?s=>ar(e,n,s):fi.test(e)?tA(e,n):e.startsWith("var(")?aA(e,n):uA(e,n)}const cA=(e,n)=>{const s=[...e],l=s.length,d=e.map((g,x)=>lA(g,n[x]));return g=>{for(let x=0;x<l;x++)s[x]=d[x](g);return s}},PB=(e,n)=>{const s={...e,...n},l={};for(const d in s)e[d]!==void 0&&n[d]!==void 0&&(l[d]=lA(e[d],n[d]));return d=>{for(const g in l)s[g]=l[g](d);return s}},uA=(e,n)=>{const s=fl.createTransformer(n),l=Py(e),d=Py(n);return l.numVars===d.numVars&&l.numColors===d.numColors&&l.numNumbers>=d.numNumbers?ll(cA(l.values,d.values),s):aA(e,n)},pp=(e,n,s)=>{const l=n-e;return l===0?1:(s-e)/l},yC=(e,n)=>s=>ar(e,n,s);function MB(e){return typeof e=="number"?yC:typeof e=="string"?fi.test(e)?tA:uA:Array.isArray(e)?cA:typeof e=="object"?PB:yC}function kB(e,n,s){const l=[],d=s||MB(e[0]),g=e.length-1;for(let x=0;x<g;x++){let E=d(e[x],e[x+1]);if(n){const a=Array.isArray(n)?n[x]||gr:n;E=ll(a,E)}l.push(E)}return l}function hA(e,n,{clamp:s=!0,ease:l,mixer:d}={}){const g=e.length;if(Cy(g===n.length),g===1)return()=>n[0];e[0]>e[g-1]&&(e=[...e].reverse(),n=[...n].reverse());const x=kB(n,l,d),E=x.length,a=P=>{let A=0;if(E>1)for(;A<e.length-2&&!(P<e[A+1]);A++);const R=pp(e[A],e[A+1],P);return x[A](R)};return s?P=>a(dl(e[0],e[g-1],P)):a}function IB(e,n){const s=e[e.length-1];for(let l=1;l<=n;l++){const d=pp(0,n,l);e.push(ar(s,1,d))}}function AB(e){const n=[0];return IB(n,e.length-1),n}function DB(e,n){return e.map(s=>s*n)}function LB(e,n){return e.map(()=>n||XI).splice(0,e.length-1)}function My({duration:e=300,keyframes:n,times:s,ease:l="easeInOut"}){const d=mB(l)?l.map(mC):mC(l),g={done:!1,value:n[0]},x=DB(s&&s.length===n.length?s:AB(n),e),E=hA(x,n,{ease:Array.isArray(d)?d:LB(n,d)});return{calculatedDuration:e,next:a=>(g.value=E(a),g.done=a>=e,g)}}function dA(e,n){return n?e*(1e3/n):0}const zB=5;function fA(e,n,s){const l=Math.max(n-zB,0);return dA(s-e(l),n-l)}const z0=.001,RB=.01,OB=10,FB=.05,BB=1;function jB({duration:e=800,bounce:n=.25,velocity:s=0,mass:l=1}){let d,g,x=1-n;x=dl(FB,BB,x),e=dl(RB,OB,Ys(e)),x<1?(d=P=>{const A=P*x,R=A*e,F=A-s,j=e1(P,x),Z=Math.exp(-R);return z0-F/j*Z},g=P=>{const R=P*x*e,F=R*s+s,j=Math.pow(x,2)*Math.pow(P,2)*e,Z=Math.exp(-R),se=e1(Math.pow(P,2),x);return(-d(P)+z0>0?-1:1)*((F-j)*Z)/se}):(d=P=>{const A=Math.exp(-P*e),R=(P-s)*e+1;return-z0+A*R},g=P=>{const A=Math.exp(-P*e),R=(s-P)*(e*e);return A*R});const E=5/e,a=UB(d,g,E);if(e=Ac(e),isNaN(a))return{stiffness:100,damping:10,duration:e};{const P=Math.pow(a,2)*l;return{stiffness:P,damping:x*2*Math.sqrt(l*P),duration:e}}}const NB=12;function UB(e,n,s){let l=s;for(let d=1;d<NB;d++)l=l-e(l)/n(l);return l}function e1(e,n){return e*Math.sqrt(1-n*n)}const VB=["duration","bounce"],$B=["stiffness","damping","mass"];function _C(e,n){return n.some(s=>e[s]!==void 0)}function GB(e){let n={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!_C(e,$B)&&_C(e,VB)){const s=jB(e);n={...n,...s,mass:1},n.isResolvedFromDuration=!0}return n}function pA({keyframes:e,restDelta:n,restSpeed:s,...l}){const d=e[0],g=e[e.length-1],x={done:!1,value:d},{stiffness:E,damping:a,mass:P,duration:A,velocity:R,isResolvedFromDuration:F}=GB({...l,velocity:-Ys(l.velocity||0)}),j=R||0,Z=a/(2*Math.sqrt(E*P)),se=g-d,ve=Ys(Math.sqrt(E/P)),X=Math.abs(se)<5;s||(s=X?.01:2),n||(n=X?.005:.5);let H;if(Z<1){const Y=e1(ve,Z);H=fe=>{const Ce=Math.exp(-Z*ve*fe);return g-Ce*((j+Z*ve*se)/Y*Math.sin(Y*fe)+se*Math.cos(Y*fe))}}else if(Z===1)H=Y=>g-Math.exp(-ve*Y)*(se+(j+ve*se)*Y);else{const Y=ve*Math.sqrt(Z*Z-1);H=fe=>{const Ce=Math.exp(-Z*ve*fe),Ue=Math.min(Y*fe,300);return g-Ce*((j+Z*ve*se)*Math.sinh(Ue)+Y*se*Math.cosh(Ue))/Y}}return{calculatedDuration:F&&A||null,next:Y=>{const fe=H(Y);if(F)x.done=Y>=A;else{let Ce=j;Y!==0&&(Z<1?Ce=fA(H,Y,fe):Ce=0);const Ue=Math.abs(Ce)<=s,Ge=Math.abs(g-fe)<=n;x.done=Ue&&Ge}return x.value=x.done?g:fe,x}}}function vC({keyframes:e,velocity:n=0,power:s=.8,timeConstant:l=325,bounceDamping:d=10,bounceStiffness:g=500,modifyTarget:x,min:E,max:a,restDelta:P=.5,restSpeed:A}){const R=e[0],F={done:!1,value:R},j=je=>E!==void 0&&je<E||a!==void 0&&je>a,Z=je=>E===void 0?a:a===void 0||Math.abs(E-je)<Math.abs(a-je)?E:a;let se=s*n;const ve=R+se,X=x===void 0?ve:x(ve);X!==ve&&(se=X-R);const H=je=>-se*Math.exp(-je/l),Y=je=>X+H(je),fe=je=>{const nt=H(je),Te=Y(je);F.done=Math.abs(nt)<=P,F.value=F.done?X:Te};let Ce,Ue;const Ge=je=>{j(F.value)&&(Ce=je,Ue=pA({keyframes:[F.value,Z(F.value)],velocity:fA(Y,je,F.value),damping:d,stiffness:g,restDelta:P,restSpeed:A}))};return Ge(0),{calculatedDuration:null,next:je=>{let nt=!1;return!Ue&&Ce===void 0&&(nt=!0,fe(je),Ge(je)),Ce!==void 0&&je>Ce?Ue.next(je-Ce):(!nt&&fe(je),F)}}}const WB=e=>{const n=({timestamp:s})=>e(s);return{start:()=>Gn.update(n,!0),stop:()=>ra(n),now:()=>ri.isProcessing?ri.timestamp:performance.now()}},xC=2e4;function wC(e){let n=0;const s=50;let l=e.next(n);for(;!l.done&&n<xC;)n+=s,l=e.next(n);return n>=xC?1/0:n}const ZB={decay:vC,inertia:vC,tween:My,keyframes:My,spring:pA};function ky({autoplay:e=!0,delay:n=0,driver:s=WB,keyframes:l,type:d="keyframes",repeat:g=0,repeatDelay:x=0,repeatType:E="loop",onPlay:a,onStop:P,onComplete:A,onUpdate:R,...F}){let j=1,Z=!1,se,ve;const X=()=>{ve=new Promise(yt=>{se=yt})};X();let H;const Y=ZB[d]||My;let fe;Y!==My&&typeof l[0]!="number"&&(fe=hA([0,100],l,{clamp:!1}),l=[0,100]);const Ce=Y({...F,keyframes:l});let Ue;E==="mirror"&&(Ue=Y({...F,keyframes:[...l].reverse(),velocity:-(F.velocity||0)}));let Ge="idle",je=null,nt=null,Te=null;Ce.calculatedDuration===null&&g&&(Ce.calculatedDuration=wC(Ce));const{calculatedDuration:mt}=Ce;let Dt=1/0,xt=1/0;mt!==null&&(Dt=mt+x,xt=Dt*(g+1)-x);let kt=0;const lt=yt=>{if(nt===null)return;j>0&&(nt=Math.min(nt,yt)),j<0&&(nt=Math.min(yt-xt/j,nt)),je!==null?kt=je:kt=Math.round(yt-nt)*j;const Nt=kt-n*(j>=0?1:-1),ur=j>=0?Nt<0:Nt>xt;kt=Math.max(Nt,0),Ge==="finished"&&je===null&&(kt=xt);let ln=kt,pr=Ce;if(g){const $t=Math.min(kt,xt)/Dt;let Qt=Math.floor($t),Sn=$t%1;!Sn&&$t>=1&&(Sn=1),Sn===1&&Qt--,Qt=Math.min(Qt,g+1),!!(Qt%2)&&(E==="reverse"?(Sn=1-Sn,x&&(Sn-=x/Dt)):E==="mirror"&&(pr=Ue)),ln=dl(0,1,Sn)*Dt}const Wn=ur?{done:!1,value:l[0]}:pr.next(ln);fe&&(Wn.value=fe(Wn.value));let{done:Xn}=Wn;!ur&&mt!==null&&(Xn=j>=0?kt>=xt:kt<=0);const si=je===null&&(Ge==="finished"||Ge==="running"&&Xn);return R&&R(Wn.value),si&&st(),Wn},It=()=>{H&&H.stop(),H=void 0},Kt=()=>{Ge="idle",It(),se(),X(),nt=Te=null},st=()=>{Ge="finished",A&&A(),It(),se()},He=()=>{if(Z)return;H||(H=s(lt));const yt=H.now();a&&a(),je!==null?nt=yt-je:(!nt||Ge==="finished")&&(nt=yt),Ge==="finished"&&X(),Te=nt,je=null,Ge="running",H.start()};e&&He();const bt={then(yt,Nt){return ve.then(yt,Nt)},get time(){return Ys(kt)},set time(yt){yt=Ac(yt),kt=yt,je!==null||!H||j===0?je=yt:nt=H.now()-yt/j},get duration(){const yt=Ce.calculatedDuration===null?wC(Ce):Ce.calculatedDuration;return Ys(yt)},get speed(){return j},set speed(yt){yt===j||!H||(j=yt,bt.time=Ys(kt))},get state(){return Ge},play:He,pause:()=>{Ge="paused",je=kt},stop:()=>{Z=!0,Ge!=="idle"&&(Ge="idle",P&&P(),Kt())},cancel:()=>{Te!==null&&lt(Te),Kt()},complete:()=>{Ge="finished"},sample:yt=>(nt=0,lt(yt))};return bt}function qB(e){let n;return()=>(n===void 0&&(n=e()),n)}const HB=qB(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),XB=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),wg=10,KB=2e4,YB=(e,n)=>n.type==="spring"||e==="backgroundColor"||!WI(n.ease);function JB(e,n,{onUpdate:s,onComplete:l,...d}){if(!(HB()&&XB.has(n)&&!d.repeatDelay&&d.repeatType!=="mirror"&&d.damping!==0&&d.type!=="inertia"))return!1;let x=!1,E,a,P=!1;const A=()=>{a=new Promise(Y=>{E=Y})};A();let{keyframes:R,duration:F=300,ease:j,times:Z}=d;if(YB(n,d)){const Y=ky({...d,repeat:0,delay:0});let fe={done:!1,value:R[0]};const Ce=[];let Ue=0;for(;!fe.done&&Ue<KB;)fe=Y.sample(Ue),Ce.push(fe.value),Ue+=wg;Z=void 0,R=Ce,F=Ue-wg,j="linear"}const se=lB(e.owner.current,n,R,{...d,duration:F,ease:j,times:Z}),ve=()=>{P=!1,se.cancel()},X=()=>{P=!0,Gn.update(ve),E(),A()};return se.onfinish=()=>{P||(e.set(cB(R,d)),l&&l(),X())},{then(Y,fe){return a.then(Y,fe)},attachTimeline(Y){return se.timeline=Y,se.onfinish=null,gr},get time(){return Ys(se.currentTime||0)},set time(Y){se.currentTime=Ac(Y)},get speed(){return se.playbackRate},set speed(Y){se.playbackRate=Y},get duration(){return Ys(F)},play:()=>{x||(se.play(),ra(ve))},pause:()=>se.pause(),stop:()=>{if(x=!0,se.playState==="idle")return;const{currentTime:Y}=se;if(Y){const fe=ky({...d,autoplay:!1});e.setWithVelocity(fe.sample(Y-wg).value,fe.sample(Y).value,wg)}X()},complete:()=>{P||se.finish()},cancel:X}}function QB({keyframes:e,delay:n,onUpdate:s,onComplete:l}){const d=()=>(s&&s(e[e.length-1]),l&&l(),{time:0,speed:1,duration:0,play:gr,pause:gr,stop:gr,then:g=>(g(),Promise.resolve()),cancel:gr,complete:gr});return n?ky({keyframes:[0,1],duration:0,delay:n,onComplete:d}):d()}const ej={type:"spring",stiffness:500,damping:25,restSpeed:10},tj=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),nj={type:"keyframes",duration:.8},rj={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ij=(e,{keyframes:n})=>n.length>2?nj:$c.has(e)?e.startsWith("scale")?tj(n[1]):ej:rj,t1=(e,n)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(fl.test(n)||n==="0")&&!n.startsWith("url(")),oj=new Set(["brightness","contrast","saturate","opacity"]);function sj(e){const[n,s]=e.slice(0,-1).split("(");if(n==="drop-shadow")return e;const[l]=s.match(c_)||[];if(!l)return e;const d=s.replace(l,"");let g=oj.has(n)?1:0;return l!==s&&(g*=100),n+"("+g+d+")"}const aj=/([a-z-]*)\(.*?\)/g,n1={...fl,getAnimatableNone:e=>{const n=e.match(aj);return n?n.map(sj).join(" "):e}},lj={...kI,color:fi,backgroundColor:fi,outlineColor:fi,fill:fi,stroke:fi,borderColor:fi,borderTopColor:fi,borderRightColor:fi,borderBottomColor:fi,borderLeftColor:fi,filter:n1,WebkitFilter:n1},Mw=e=>lj[e];function mA(e,n){let s=Mw(e);return s!==n1&&(s=fl),s.getAnimatableNone?s.getAnimatableNone(n):void 0}const gA=e=>/^0[^.\s]+$/.test(e);function cj(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||gA(e)}function uj(e,n,s,l){const d=t1(n,s);let g;Array.isArray(s)?g=[...s]:g=[null,s];const x=l.from!==void 0?l.from:e.get();let E;const a=[];for(let P=0;P<g.length;P++)g[P]===null&&(g[P]=P===0?x:g[P-1]),cj(g[P])&&a.push(P),typeof g[P]=="string"&&g[P]!=="none"&&g[P]!=="0"&&(E=g[P]);if(d&&a.length&&E)for(let P=0;P<a.length;P++){const A=a[P];g[A]=mA(n,E)}return g}function hj({when:e,delay:n,delayChildren:s,staggerChildren:l,staggerDirection:d,repeat:g,repeatType:x,repeatDelay:E,from:a,elapsed:P,...A}){return!!Object.keys(A).length}function kw(e,n){return e[n]||e.default||e}const dj={skipAnimations:!1},Iw=(e,n,s,l={})=>d=>{const g=kw(l,e)||{},x=g.delay||l.delay||0;let{elapsed:E=0}=l;E=E-Ac(x);const a=uj(n,e,s,g),P=a[0],A=a[a.length-1],R=t1(e,P),F=t1(e,A);let j={keyframes:a,velocity:n.getVelocity(),ease:"easeOut",...g,delay:-E,onUpdate:Z=>{n.set(Z),g.onUpdate&&g.onUpdate(Z)},onComplete:()=>{d(),g.onComplete&&g.onComplete()}};if(hj(g)||(j={...j,...ij(e,j)}),j.duration&&(j.duration=Ac(j.duration)),j.repeatDelay&&(j.repeatDelay=Ac(j.repeatDelay)),!R||!F||aB.current||g.type===!1||dj.skipAnimations)return QB(j);if(!l.isHandoff&&n.owner&&n.owner.current instanceof HTMLElement&&!n.owner.getProps().onUpdate){const Z=JB(n,e,j);if(Z)return Z}return ky(j)};function Iy(e){return!!(Oi(e)&&e.add)}const yA=e=>/^\-?\d*\.?\d+$/.test(e);function Aw(e,n){e.indexOf(n)===-1&&e.push(n)}function Dw(e,n){const s=e.indexOf(n);s>-1&&e.splice(s,1)}class Lw{constructor(){this.subscriptions=[]}add(n){return Aw(this.subscriptions,n),()=>Dw(this.subscriptions,n)}notify(n,s,l){const d=this.subscriptions.length;if(d)if(d===1)this.subscriptions[0](n,s,l);else for(let g=0;g<d;g++){const x=this.subscriptions[g];x&&x(n,s,l)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const fj=e=>!isNaN(parseFloat(e));class pj{constructor(n,s={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(l,d=!0)=>{this.prev=this.current,this.current=l;const{delta:g,timestamp:x}=ri;this.lastUpdated!==x&&(this.timeDelta=g,this.lastUpdated=x,Gn.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),d&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Gn.postRender(this.velocityCheck),this.velocityCheck=({timestamp:l})=>{l!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=n,this.canTrackVelocity=fj(this.current),this.owner=s.owner}onChange(n){return this.on("change",n)}on(n,s){this.events[n]||(this.events[n]=new Lw);const l=this.events[n].add(s);return n==="change"?()=>{l(),Gn.read(()=>{this.events.change.getSize()||this.stop()})}:l}clearListeners(){for(const n in this.events)this.events[n].clear()}attach(n,s){this.passiveEffect=n,this.stopPassiveEffect=s}set(n,s=!0){!s||!this.passiveEffect?this.updateAndNotify(n,s):this.passiveEffect(n,this.updateAndNotify)}setWithVelocity(n,s,l){this.set(s),this.prev=n,this.timeDelta=l}jump(n){this.updateAndNotify(n),this.prev=n,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?dA(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(n){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=n(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ih(e,n){return new pj(e,n)}const _A=e=>n=>n.test(e),mj={test:e=>e==="auto",parse:e=>e},vA=[Gc,Ut,gs,Va,bF,wF,mj],Ef=e=>vA.find(_A(e)),gj=[...vA,fi,fl],yj=e=>gj.find(_A(e));function _j(e,n,s){e.hasValue(n)?e.getValue(n).set(s):e.addValue(n,Ih(s))}function vj(e,n){const s=h_(e,n);let{transitionEnd:l={},transition:d={},...g}=s?e.makeTargetAnimatable(s,!1):{};g={...g,...l};for(const x in g){const E=FF(g[x]);_j(e,x,E)}}function xj(e,n,s){var l,d;const g=Object.keys(n).filter(E=>!e.hasValue(E)),x=g.length;if(x)for(let E=0;E<x;E++){const a=g[E],P=n[a];let A=null;Array.isArray(P)&&(A=P[0]),A===null&&(A=(d=(l=s[a])!==null&&l!==void 0?l:e.readValue(a))!==null&&d!==void 0?d:n[a]),A!=null&&(typeof A=="string"&&(yA(A)||gA(A))?A=parseFloat(A):!yj(A)&&fl.test(P)&&(A=mA(a,P)),e.addValue(a,Ih(A,{owner:e})),s[a]===void 0&&(s[a]=A),A!==null&&e.setBaseTarget(a,A))}}function wj(e,n){return n?(n[e]||n.default||n).from:void 0}function bj(e,n,s){const l={};for(const d in e){const g=wj(d,n);if(g!==void 0)l[d]=g;else{const x=s.getValue(d);x&&(l[d]=x.get())}}return l}function Tj({protectedKeys:e,needsAnimating:n},s){const l=e.hasOwnProperty(s)&&n[s]!==!0;return n[s]=!1,l}function Ej(e,n){const s=e.get();if(Array.isArray(n)){for(let l=0;l<n.length;l++)if(n[l]!==s)return!0}else return s!==n}function xA(e,n,{delay:s=0,transitionOverride:l,type:d}={}){let{transition:g=e.getDefaultTransition(),transitionEnd:x,...E}=e.makeTargetAnimatable(n);const a=e.getValue("willChange");l&&(g=l);const P=[],A=d&&e.animationState&&e.animationState.getState()[d];for(const R in E){const F=e.getValue(R),j=E[R];if(!F||j===void 0||A&&Tj(A,R))continue;const Z={delay:s,elapsed:0,...kw(g||{},R)};if(window.HandoffAppearAnimations){const X=e.getProps()[wI];if(X){const H=window.HandoffAppearAnimations(X,R,F,Gn);H!==null&&(Z.elapsed=H,Z.isHandoff=!0)}}let se=!Z.isHandoff&&!Ej(F,j);if(Z.type==="spring"&&(F.getVelocity()||Z.velocity)&&(se=!1),F.animation&&(se=!1),se)continue;F.start(Iw(R,F,j,e.shouldReduceMotion&&$c.has(R)?{type:!1}:Z));const ve=F.animation;Iy(a)&&(a.add(R),ve.then(()=>a.remove(R))),P.push(ve)}return x&&Promise.all(P).then(()=>{x&&vj(e,x)}),P}function r1(e,n,s={}){const l=h_(e,n,s.custom);let{transition:d=e.getDefaultTransition()||{}}=l||{};s.transitionOverride&&(d=s.transitionOverride);const g=l?()=>Promise.all(xA(e,l,s)):()=>Promise.resolve(),x=e.variantChildren&&e.variantChildren.size?(a=0)=>{const{delayChildren:P=0,staggerChildren:A,staggerDirection:R}=d;return Sj(e,n,P+a,A,R,s)}:()=>Promise.resolve(),{when:E}=d;if(E){const[a,P]=E==="beforeChildren"?[g,x]:[x,g];return a().then(()=>P())}else return Promise.all([g(),x(s.delay)])}function Sj(e,n,s=0,l=0,d=1,g){const x=[],E=(e.variantChildren.size-1)*l,a=d===1?(P=0)=>P*l:(P=0)=>E-P*l;return Array.from(e.variantChildren).sort(Cj).forEach((P,A)=>{P.notify("AnimationStart",n),x.push(r1(P,n,{...g,delay:s+a(A)}).then(()=>P.notify("AnimationComplete",n)))}),Promise.all(x)}function Cj(e,n){return e.sortNodePosition(n)}function Pj(e,n,s={}){e.notify("AnimationStart",n);let l;if(Array.isArray(n)){const d=n.map(g=>r1(e,g,s));l=Promise.all(d)}else if(typeof n=="string")l=r1(e,n,s);else{const d=typeof n=="function"?h_(e,n,s.custom):n;l=Promise.all(xA(e,d,s))}return l.then(()=>e.notify("AnimationComplete",n))}const Mj=[...gw].reverse(),kj=gw.length;function Ij(e){return n=>Promise.all(n.map(({animation:s,options:l})=>Pj(e,s,l)))}function Aj(e){let n=Ij(e);const s=Lj();let l=!0;const d=(a,P)=>{const A=h_(e,P);if(A){const{transition:R,transitionEnd:F,...j}=A;a={...a,...j,...F}}return a};function g(a){n=a(e)}function x(a,P){const A=e.getProps(),R=e.getVariantContext(!0)||{},F=[],j=new Set;let Z={},se=1/0;for(let X=0;X<kj;X++){const H=Mj[X],Y=s[H],fe=A[H]!==void 0?A[H]:R[H],Ce=dp(fe),Ue=H===P?Y.isActive:null;Ue===!1&&(se=X);let Ge=fe===R[H]&&fe!==A[H]&&Ce;if(Ge&&l&&e.manuallyAnimateOnMount&&(Ge=!1),Y.protectedKeys={...Z},!Y.isActive&&Ue===null||!fe&&!Y.prevProp||a_(fe)||typeof fe=="boolean")continue;let nt=Dj(Y.prevProp,fe)||H===P&&Y.isActive&&!Ge&&Ce||X>se&&Ce,Te=!1;const mt=Array.isArray(fe)?fe:[fe];let Dt=mt.reduce(d,{});Ue===!1&&(Dt={});const{prevResolvedValues:xt={}}=Y,kt={...xt,...Dt},lt=It=>{nt=!0,j.has(It)&&(Te=!0,j.delete(It)),Y.needsAnimating[It]=!0};for(const It in kt){const Kt=Dt[It],st=xt[It];if(Z.hasOwnProperty(It))continue;let He=!1;Sy(Kt)&&Sy(st)?He=!$I(Kt,st):He=Kt!==st,He?Kt!==void 0?lt(It):j.add(It):Kt!==void 0&&j.has(It)?lt(It):Y.protectedKeys[It]=!0}Y.prevProp=fe,Y.prevResolvedValues=Dt,Y.isActive&&(Z={...Z,...Dt}),l&&e.blockInitialAnimation&&(nt=!1),nt&&(!Ge||Te)&&F.push(...mt.map(It=>({animation:It,options:{type:H,...a}})))}if(j.size){const X={};j.forEach(H=>{const Y=e.getBaseTarget(H);Y!==void 0&&(X[H]=Y)}),F.push({animation:X})}let ve=!!F.length;return l&&(A.initial===!1||A.initial===A.animate)&&!e.manuallyAnimateOnMount&&(ve=!1),l=!1,ve?n(F):Promise.resolve()}function E(a,P,A){var R;if(s[a].isActive===P)return Promise.resolve();(R=e.variantChildren)===null||R===void 0||R.forEach(j=>{var Z;return(Z=j.animationState)===null||Z===void 0?void 0:Z.setActive(a,P)}),s[a].isActive=P;const F=x(A,a);for(const j in s)s[j].protectedKeys={};return F}return{animateChanges:x,setActive:E,setAnimateFunction:g,getState:()=>s}}function Dj(e,n){return typeof n=="string"?n!==e:Array.isArray(n)?!$I(n,e):!1}function dc(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Lj(){return{animate:dc(!0),whileInView:dc(),whileHover:dc(),whileTap:dc(),whileDrag:dc(),whileFocus:dc(),exit:dc()}}class zj extends vl{constructor(n){super(n),n.animationState||(n.animationState=Aj(n))}updateAnimationControlsSubscription(){const{animate:n}=this.node.getProps();this.unmount(),a_(n)&&(this.unmount=n.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:n}=this.node.getProps(),{animate:s}=this.node.prevProps||{};n!==s&&this.updateAnimationControlsSubscription()}unmount(){}}let Rj=0;class Oj extends vl{constructor(){super(...arguments),this.id=Rj++}update(){if(!this.node.presenceContext)return;const{isPresent:n,onExitComplete:s,custom:l}=this.node.presenceContext,{isPresent:d}=this.node.prevPresenceContext||{};if(!this.node.animationState||n===d)return;const g=this.node.animationState.setActive("exit",!n,{custom:l??this.node.getProps().custom});s&&!n&&g.then(()=>s(this.id))}mount(){const{register:n}=this.node.presenceContext||{};n&&(this.unmount=n(this.id))}unmount(){}}const Fj={animation:{Feature:zj},exit:{Feature:Oj}},bC=(e,n)=>Math.abs(e-n);function Bj(e,n){const s=bC(e.x,n.x),l=bC(e.y,n.y);return Math.sqrt(s**2+l**2)}class wA{constructor(n,s,{transformPagePoint:l,contextWindow:d,dragSnapToOrigin:g=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const R=O0(this.lastMoveEventInfo,this.history),F=this.startEvent!==null,j=Bj(R.offset,{x:0,y:0})>=3;if(!F&&!j)return;const{point:Z}=R,{timestamp:se}=ri;this.history.push({...Z,timestamp:se});const{onStart:ve,onMove:X}=this.handlers;F||(ve&&ve(this.lastMoveEvent,R),this.startEvent=this.lastMoveEvent),X&&X(this.lastMoveEvent,R)},this.handlePointerMove=(R,F)=>{this.lastMoveEvent=R,this.lastMoveEventInfo=R0(F,this.transformPagePoint),Gn.update(this.updatePoint,!0)},this.handlePointerUp=(R,F)=>{this.end();const{onEnd:j,onSessionEnd:Z,resumeAnimation:se}=this.handlers;if(this.dragSnapToOrigin&&se&&se(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ve=O0(R.type==="pointercancel"?this.lastMoveEventInfo:R0(F,this.transformPagePoint),this.history);this.startEvent&&j&&j(R,ve),Z&&Z(R,ve)},!BI(n))return;this.dragSnapToOrigin=g,this.handlers=s,this.transformPagePoint=l,this.contextWindow=d||window;const x=u_(n),E=R0(x,this.transformPagePoint),{point:a}=E,{timestamp:P}=ri;this.history=[{...a,timestamp:P}];const{onSessionStart:A}=s;A&&A(n,O0(E,this.history)),this.removeListeners=ll(Ks(this.contextWindow,"pointermove",this.handlePointerMove),Ks(this.contextWindow,"pointerup",this.handlePointerUp),Ks(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(n){this.handlers=n}end(){this.removeListeners&&this.removeListeners(),ra(this.updatePoint)}}function R0(e,n){return n?{point:n(e.point)}:e}function TC(e,n){return{x:e.x-n.x,y:e.y-n.y}}function O0({point:e},n){return{point:e,delta:TC(e,bA(n)),offset:TC(e,jj(n)),velocity:Nj(n,.1)}}function jj(e){return e[0]}function bA(e){return e[e.length-1]}function Nj(e,n){if(e.length<2)return{x:0,y:0};let s=e.length-1,l=null;const d=bA(e);for(;s>=0&&(l=e[s],!(d.timestamp-l.timestamp>Ac(n)));)s--;if(!l)return{x:0,y:0};const g=Ys(d.timestamp-l.timestamp);if(g===0)return{x:0,y:0};const x={x:(d.x-l.x)/g,y:(d.y-l.y)/g};return x.x===1/0&&(x.x=0),x.y===1/0&&(x.y=0),x}function Xi(e){return e.max-e.min}function i1(e,n=0,s=.01){return Math.abs(e-n)<=s}function EC(e,n,s,l=.5){e.origin=l,e.originPoint=ar(n.min,n.max,e.origin),e.scale=Xi(s)/Xi(n),(i1(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=ar(s.min,s.max,e.origin)-e.originPoint,(i1(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Wf(e,n,s,l){EC(e.x,n.x,s.x,l?l.originX:void 0),EC(e.y,n.y,s.y,l?l.originY:void 0)}function SC(e,n,s){e.min=s.min+n.min,e.max=e.min+Xi(n)}function Uj(e,n,s){SC(e.x,n.x,s.x),SC(e.y,n.y,s.y)}function CC(e,n,s){e.min=n.min-s.min,e.max=e.min+Xi(n)}function Zf(e,n,s){CC(e.x,n.x,s.x),CC(e.y,n.y,s.y)}function Vj(e,{min:n,max:s},l){return n!==void 0&&e<n?e=l?ar(n,e,l.min):Math.max(e,n):s!==void 0&&e>s&&(e=l?ar(s,e,l.max):Math.min(e,s)),e}function PC(e,n,s){return{min:n!==void 0?e.min+n:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function $j(e,{top:n,left:s,bottom:l,right:d}){return{x:PC(e.x,s,d),y:PC(e.y,n,l)}}function MC(e,n){let s=n.min-e.min,l=n.max-e.max;return n.max-n.min<e.max-e.min&&([s,l]=[l,s]),{min:s,max:l}}function Gj(e,n){return{x:MC(e.x,n.x),y:MC(e.y,n.y)}}function Wj(e,n){let s=.5;const l=Xi(e),d=Xi(n);return d>l?s=pp(n.min,n.max-l,e.min):l>d&&(s=pp(e.min,e.max-d,n.min)),dl(0,1,s)}function Zj(e,n){const s={};return n.min!==void 0&&(s.min=n.min-e.min),n.max!==void 0&&(s.max=n.max-e.min),s}const o1=.35;function qj(e=o1){return e===!1?e=0:e===!0&&(e=o1),{x:kC(e,"left","right"),y:kC(e,"top","bottom")}}function kC(e,n,s){return{min:IC(e,n),max:IC(e,s)}}function IC(e,n){return typeof e=="number"?e:e[n]||0}const AC=()=>({translate:0,scale:1,origin:0,originPoint:0}),mh=()=>({x:AC(),y:AC()}),DC=()=>({min:0,max:0}),Tr=()=>({x:DC(),y:DC()});function uo(e){return[e("x"),e("y")]}function TA({top:e,left:n,right:s,bottom:l}){return{x:{min:n,max:s},y:{min:e,max:l}}}function Hj({x:e,y:n}){return{top:n.min,right:e.max,bottom:n.max,left:e.min}}function Xj(e,n){if(!n)return e;const s=n({x:e.left,y:e.top}),l=n({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:l.y,right:l.x}}function F0(e){return e===void 0||e===1}function s1({scale:e,scaleX:n,scaleY:s}){return!F0(e)||!F0(n)||!F0(s)}function gc(e){return s1(e)||EA(e)||e.z||e.rotate||e.rotateX||e.rotateY}function EA(e){return LC(e.x)||LC(e.y)}function LC(e){return e&&e!=="0%"}function Ay(e,n,s){const l=e-s,d=n*l;return s+d}function zC(e,n,s,l,d){return d!==void 0&&(e=Ay(e,d,l)),Ay(e,s,l)+n}function a1(e,n=0,s=1,l,d){e.min=zC(e.min,n,s,l,d),e.max=zC(e.max,n,s,l,d)}function SA(e,{x:n,y:s}){a1(e.x,n.translate,n.scale,n.originPoint),a1(e.y,s.translate,s.scale,s.originPoint)}function Kj(e,n,s,l=!1){const d=s.length;if(!d)return;n.x=n.y=1;let g,x;for(let E=0;E<d;E++){g=s[E],x=g.projectionDelta;const a=g.instance;a&&a.style&&a.style.display==="contents"||(l&&g.options.layoutScroll&&g.scroll&&g!==g.root&&gh(e,{x:-g.scroll.offset.x,y:-g.scroll.offset.y}),x&&(n.x*=x.x.scale,n.y*=x.y.scale,SA(e,x)),l&&gc(g.latestValues)&&gh(e,g.latestValues))}n.x=RC(n.x),n.y=RC(n.y)}function RC(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Za(e,n){e.min=e.min+n,e.max=e.max+n}function OC(e,n,[s,l,d]){const g=n[d]!==void 0?n[d]:.5,x=ar(e.min,e.max,g);a1(e,n[s],n[l],x,n.scale)}const Yj=["x","scaleX","originX"],Jj=["y","scaleY","originY"];function gh(e,n){OC(e.x,n,Yj),OC(e.y,n,Jj)}function CA(e,n){return TA(Xj(e.getBoundingClientRect(),n))}function Qj(e,n,s){const l=CA(e,s),{scroll:d}=n;return d&&(Za(l.x,d.offset.x),Za(l.y,d.offset.y)),l}const PA=({current:e})=>e?e.ownerDocument.defaultView:null,eN=new WeakMap;class tN{constructor(n){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Tr(),this.visualElement=n}start(n,{snapToCursor:s=!1}={}){const{presenceContext:l}=this.visualElement;if(l&&l.isPresent===!1)return;const d=A=>{const{dragSnapToOrigin:R}=this.getProps();R?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(u_(A,"page").point)},g=(A,R)=>{const{drag:F,dragPropagation:j,onDragStart:Z}=this.getProps();if(F&&!j&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=NI(F),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),uo(ve=>{let X=this.getAxisMotionValue(ve).get()||0;if(gs.test(X)){const{projection:H}=this.visualElement;if(H&&H.layout){const Y=H.layout.layoutBox[ve];Y&&(X=Xi(Y)*(parseFloat(X)/100))}}this.originPoint[ve]=X}),Z&&Gn.update(()=>Z(A,R),!1,!0);const{animationState:se}=this.visualElement;se&&se.setActive("whileDrag",!0)},x=(A,R)=>{const{dragPropagation:F,dragDirectionLock:j,onDirectionLock:Z,onDrag:se}=this.getProps();if(!F&&!this.openGlobalLock)return;const{offset:ve}=R;if(j&&this.currentDirection===null){this.currentDirection=nN(ve),this.currentDirection!==null&&Z&&Z(this.currentDirection);return}this.updateAxis("x",R.point,ve),this.updateAxis("y",R.point,ve),this.visualElement.render(),se&&se(A,R)},E=(A,R)=>this.stop(A,R),a=()=>uo(A=>{var R;return this.getAnimationState(A)==="paused"&&((R=this.getAxisMotionValue(A).animation)===null||R===void 0?void 0:R.play())}),{dragSnapToOrigin:P}=this.getProps();this.panSession=new wA(n,{onSessionStart:d,onStart:g,onMove:x,onSessionEnd:E,resumeAnimation:a},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:P,contextWindow:PA(this.visualElement)})}stop(n,s){const l=this.isDragging;if(this.cancel(),!l)return;const{velocity:d}=s;this.startAnimation(d);const{onDragEnd:g}=this.getProps();g&&Gn.update(()=>g(n,s))}cancel(){this.isDragging=!1;const{projection:n,animationState:s}=this.visualElement;n&&(n.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:l}=this.getProps();!l&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(n,s,l){const{drag:d}=this.getProps();if(!l||!bg(n,d,this.currentDirection))return;const g=this.getAxisMotionValue(n);let x=this.originPoint[n]+l[n];this.constraints&&this.constraints[n]&&(x=Vj(x,this.constraints[n],this.elastic[n])),g.set(x)}resolveConstraints(){var n;const{dragConstraints:s,dragElastic:l}=this.getProps(),d=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(n=this.visualElement.projection)===null||n===void 0?void 0:n.layout,g=this.constraints;s&&fh(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&d?this.constraints=$j(d.layoutBox,s):this.constraints=!1,this.elastic=qj(l),g!==this.constraints&&d&&this.constraints&&!this.hasMutatedConstraints&&uo(x=>{this.getAxisMotionValue(x)&&(this.constraints[x]=Zj(d.layoutBox[x],this.constraints[x]))})}resolveRefConstraints(){const{dragConstraints:n,onMeasureDragConstraints:s}=this.getProps();if(!n||!fh(n))return!1;const l=n.current,{projection:d}=this.visualElement;if(!d||!d.layout)return!1;const g=Qj(l,d.root,this.visualElement.getTransformPagePoint());let x=Gj(d.layout.layoutBox,g);if(s){const E=s(Hj(x));this.hasMutatedConstraints=!!E,E&&(x=TA(E))}return x}startAnimation(n){const{drag:s,dragMomentum:l,dragElastic:d,dragTransition:g,dragSnapToOrigin:x,onDragTransitionEnd:E}=this.getProps(),a=this.constraints||{},P=uo(A=>{if(!bg(A,s,this.currentDirection))return;let R=a&&a[A]||{};x&&(R={min:0,max:0});const F=d?200:1e6,j=d?40:1e7,Z={type:"inertia",velocity:l?n[A]:0,bounceStiffness:F,bounceDamping:j,timeConstant:750,restDelta:1,restSpeed:10,...g,...R};return this.startAxisValueAnimation(A,Z)});return Promise.all(P).then(E)}startAxisValueAnimation(n,s){const l=this.getAxisMotionValue(n);return l.start(Iw(n,l,0,s))}stopAnimation(){uo(n=>this.getAxisMotionValue(n).stop())}pauseAnimation(){uo(n=>{var s;return(s=this.getAxisMotionValue(n).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(n){var s;return(s=this.getAxisMotionValue(n).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(n){const s="_drag"+n.toUpperCase(),l=this.visualElement.getProps(),d=l[s];return d||this.visualElement.getValue(n,(l.initial?l.initial[n]:void 0)||0)}snapToCursor(n){uo(s=>{const{drag:l}=this.getProps();if(!bg(s,l,this.currentDirection))return;const{projection:d}=this.visualElement,g=this.getAxisMotionValue(s);if(d&&d.layout){const{min:x,max:E}=d.layout.layoutBox[s];g.set(n[s]-ar(x,E,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:n,dragConstraints:s}=this.getProps(),{projection:l}=this.visualElement;if(!fh(s)||!l||!this.constraints)return;this.stopAnimation();const d={x:0,y:0};uo(x=>{const E=this.getAxisMotionValue(x);if(E){const a=E.get();d[x]=Wj({min:a,max:a},this.constraints[x])}});const{transformTemplate:g}=this.visualElement.getProps();this.visualElement.current.style.transform=g?g({},""):"none",l.root&&l.root.updateScroll(),l.updateLayout(),this.resolveConstraints(),uo(x=>{if(!bg(x,n,null))return;const E=this.getAxisMotionValue(x),{min:a,max:P}=this.constraints[x];E.set(ar(a,P,d[x]))})}addListeners(){if(!this.visualElement.current)return;eN.set(this.visualElement,this);const n=this.visualElement.current,s=Ks(n,"pointerdown",a=>{const{drag:P,dragListener:A=!0}=this.getProps();P&&A&&this.start(a)}),l=()=>{const{dragConstraints:a}=this.getProps();fh(a)&&(this.constraints=this.resolveRefConstraints())},{projection:d}=this.visualElement,g=d.addEventListener("measure",l);d&&!d.layout&&(d.root&&d.root.updateScroll(),d.updateLayout()),l();const x=qs(window,"resize",()=>this.scalePositionWithinConstraints()),E=d.addEventListener("didUpdate",({delta:a,hasLayoutChanged:P})=>{this.isDragging&&P&&(uo(A=>{const R=this.getAxisMotionValue(A);R&&(this.originPoint[A]+=a[A].translate,R.set(R.get()+a[A].translate))}),this.visualElement.render())});return()=>{x(),s(),g(),E&&E()}}getProps(){const n=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:l=!1,dragPropagation:d=!1,dragConstraints:g=!1,dragElastic:x=o1,dragMomentum:E=!0}=n;return{...n,drag:s,dragDirectionLock:l,dragPropagation:d,dragConstraints:g,dragElastic:x,dragMomentum:E}}}function bg(e,n,s){return(n===!0||n===e)&&(s===null||s===e)}function nN(e,n=10){let s=null;return Math.abs(e.y)>n?s="y":Math.abs(e.x)>n&&(s="x"),s}class rN extends vl{constructor(n){super(n),this.removeGroupControls=gr,this.removeListeners=gr,this.controls=new tN(n)}mount(){const{dragControls:n}=this.node.getProps();n&&(this.removeGroupControls=n.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||gr}unmount(){this.removeGroupControls(),this.removeListeners()}}const FC=e=>(n,s)=>{e&&Gn.update(()=>e(n,s))};class iN extends vl{constructor(){super(...arguments),this.removePointerDownListener=gr}onPointerDown(n){this.session=new wA(n,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:PA(this.node)})}createPanHandlers(){const{onPanSessionStart:n,onPanStart:s,onPan:l,onPanEnd:d}=this.node.getProps();return{onSessionStart:FC(n),onStart:FC(s),onMove:l,onEnd:(g,x)=>{delete this.session,d&&Gn.update(()=>d(g,x))}}}mount(){this.removePointerDownListener=Ks(this.node.current,"pointerdown",n=>this.onPointerDown(n))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function oN(){const e=Q.useContext(pw);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:l}=e,d=Q.useId();return Q.useEffect(()=>l(d),[]),!n&&s?[!1,()=>s&&s(d)]:[!0]}const Zg={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function BC(e,n){return n.max===n.min?0:e/(n.max-n.min)*100}const Sf={correct:(e,n)=>{if(!n.target)return e;if(typeof e=="string")if(Ut.test(e))e=parseFloat(e);else return e;const s=BC(e,n.target.x),l=BC(e,n.target.y);return`${s}% ${l}%`}},sN={correct:(e,{treeScale:n,projectionDelta:s})=>{const l=e,d=fl.parse(e);if(d.length>5)return l;const g=fl.createTransformer(e),x=typeof d[0]!="number"?1:0,E=s.x.scale*n.x,a=s.y.scale*n.y;d[0+x]/=E,d[1+x]/=a;const P=ar(E,a,.5);return typeof d[2+x]=="number"&&(d[2+x]/=P),typeof d[3+x]=="number"&&(d[3+x]/=P),g(d)}};class aN extends An.Component{componentDidMount(){const{visualElement:n,layoutGroup:s,switchLayoutGroup:l,layoutId:d}=this.props,{projection:g}=n;pF(lN),g&&(s.group&&s.group.add(g),l&&l.register&&d&&l.register(g),g.root.didUpdate(),g.addEventListener("animationComplete",()=>{this.safeToRemove()}),g.setOptions({...g.options,onExitComplete:()=>this.safeToRemove()})),Zg.hasEverUpdated=!0}getSnapshotBeforeUpdate(n){const{layoutDependency:s,visualElement:l,drag:d,isPresent:g}=this.props,x=l.projection;return x&&(x.isPresent=g,d||n.layoutDependency!==s||s===void 0?x.willUpdate():this.safeToRemove(),n.isPresent!==g&&(g?x.promote():x.relegate()||Gn.postRender(()=>{const E=x.getStack();(!E||!E.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:n}=this.props.visualElement;n&&(n.root.didUpdate(),queueMicrotask(()=>{!n.currentAnimation&&n.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:n,layoutGroup:s,switchLayoutGroup:l}=this.props,{projection:d}=n;d&&(d.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(d),l&&l.deregister&&l.deregister(d))}safeToRemove(){const{safeToRemove:n}=this.props;n&&n()}render(){return null}}function MA(e){const[n,s]=oN(),l=Q.useContext(TI);return An.createElement(aN,{...e,layoutGroup:l,switchLayoutGroup:Q.useContext(EI),isPresent:n,safeToRemove:s})}const lN={borderRadius:{...Sf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Sf,borderTopRightRadius:Sf,borderBottomLeftRadius:Sf,borderBottomRightRadius:Sf,boxShadow:sN},kA=["TopLeft","TopRight","BottomLeft","BottomRight"],cN=kA.length,jC=e=>typeof e=="string"?parseFloat(e):e,NC=e=>typeof e=="number"||Ut.test(e);function uN(e,n,s,l,d,g){d?(e.opacity=ar(0,s.opacity!==void 0?s.opacity:1,hN(l)),e.opacityExit=ar(n.opacity!==void 0?n.opacity:1,0,dN(l))):g&&(e.opacity=ar(n.opacity!==void 0?n.opacity:1,s.opacity!==void 0?s.opacity:1,l));for(let x=0;x<cN;x++){const E=`border${kA[x]}Radius`;let a=UC(n,E),P=UC(s,E);if(a===void 0&&P===void 0)continue;a||(a=0),P||(P=0),a===0||P===0||NC(a)===NC(P)?(e[E]=Math.max(ar(jC(a),jC(P),l),0),(gs.test(P)||gs.test(a))&&(e[E]+="%")):e[E]=P}(n.rotate||s.rotate)&&(e.rotate=ar(n.rotate||0,s.rotate||0,l))}function UC(e,n){return e[n]!==void 0?e[n]:e.borderRadius}const hN=IA(0,.5,JI),dN=IA(.5,.95,gr);function IA(e,n,s){return l=>l<e?0:l>n?1:s(pp(e,n,l))}function VC(e,n){e.min=n.min,e.max=n.max}function co(e,n){VC(e.x,n.x),VC(e.y,n.y)}function $C(e,n,s,l,d){return e-=n,e=Ay(e,1/s,l),d!==void 0&&(e=Ay(e,1/d,l)),e}function fN(e,n=0,s=1,l=.5,d,g=e,x=e){if(gs.test(n)&&(n=parseFloat(n),n=ar(x.min,x.max,n/100)-x.min),typeof n!="number")return;let E=ar(g.min,g.max,l);e===g&&(E-=n),e.min=$C(e.min,n,s,E,d),e.max=$C(e.max,n,s,E,d)}function GC(e,n,[s,l,d],g,x){fN(e,n[s],n[l],n[d],n.scale,g,x)}const pN=["x","scaleX","originX"],mN=["y","scaleY","originY"];function WC(e,n,s,l){GC(e.x,n,pN,s?s.x:void 0,l?l.x:void 0),GC(e.y,n,mN,s?s.y:void 0,l?l.y:void 0)}function ZC(e){return e.translate===0&&e.scale===1}function AA(e){return ZC(e.x)&&ZC(e.y)}function gN(e,n){return e.x.min===n.x.min&&e.x.max===n.x.max&&e.y.min===n.y.min&&e.y.max===n.y.max}function DA(e,n){return Math.round(e.x.min)===Math.round(n.x.min)&&Math.round(e.x.max)===Math.round(n.x.max)&&Math.round(e.y.min)===Math.round(n.y.min)&&Math.round(e.y.max)===Math.round(n.y.max)}function qC(e){return Xi(e.x)/Xi(e.y)}class yN{constructor(){this.members=[]}add(n){Aw(this.members,n),n.scheduleRender()}remove(n){if(Dw(this.members,n),n===this.prevLead&&(this.prevLead=void 0),n===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(n){const s=this.members.findIndex(d=>n===d);if(s===0)return!1;let l;for(let d=s;d>=0;d--){const g=this.members[d];if(g.isPresent!==!1){l=g;break}}return l?(this.promote(l),!0):!1}promote(n,s){const l=this.lead;if(n!==l&&(this.prevLead=l,this.lead=n,n.show(),l)){l.instance&&l.scheduleRender(),n.scheduleRender(),n.resumeFrom=l,s&&(n.resumeFrom.preserveOpacity=!0),l.snapshot&&(n.snapshot=l.snapshot,n.snapshot.latestValues=l.animationValues||l.latestValues),n.root&&n.root.isUpdating&&(n.isLayoutDirty=!0);const{crossfade:d}=n.options;d===!1&&l.hide()}}exitAnimationComplete(){this.members.forEach(n=>{const{options:s,resumingFrom:l}=n;s.onExitComplete&&s.onExitComplete(),l&&l.options.onExitComplete&&l.options.onExitComplete()})}scheduleRender(){this.members.forEach(n=>{n.instance&&n.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function HC(e,n,s){let l="";const d=e.x.translate/n.x,g=e.y.translate/n.y;if((d||g)&&(l=`translate3d(${d}px, ${g}px, 0) `),(n.x!==1||n.y!==1)&&(l+=`scale(${1/n.x}, ${1/n.y}) `),s){const{rotate:a,rotateX:P,rotateY:A}=s;a&&(l+=`rotate(${a}deg) `),P&&(l+=`rotateX(${P}deg) `),A&&(l+=`rotateY(${A}deg) `)}const x=e.x.scale*n.x,E=e.y.scale*n.y;return(x!==1||E!==1)&&(l+=`scale(${x}, ${E})`),l||"none"}const _N=(e,n)=>e.depth-n.depth;class vN{constructor(){this.children=[],this.isDirty=!1}add(n){Aw(this.children,n),this.isDirty=!0}remove(n){Dw(this.children,n),this.isDirty=!0}forEach(n){this.isDirty&&this.children.sort(_N),this.isDirty=!1,this.children.forEach(n)}}function xN(e,n){const s=performance.now(),l=({timestamp:d})=>{const g=d-s;g>=n&&(ra(l),e(g-n))};return Gn.read(l,!0),()=>ra(l)}function wN(e){window.MotionDebug&&window.MotionDebug.record(e)}function bN(e){return e instanceof SVGElement&&e.tagName!=="svg"}function TN(e,n,s){const l=Oi(e)?e:Ih(e);return l.start(Iw("",l,n,s)),l.animation}const XC=["","X","Y","Z"],EN={visibility:"hidden"},KC=1e3;let SN=0;const yc={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function LA({attachResizeListener:e,defaultParent:n,measureScroll:s,checkIsScrollRoot:l,resetTransform:d}){return class{constructor(x={},E=n==null?void 0:n()){this.id=SN++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,yc.totalNodes=yc.resolvedTargetDeltas=yc.recalculatedProjection=0,this.nodes.forEach(MN),this.nodes.forEach(LN),this.nodes.forEach(zN),this.nodes.forEach(kN),wN(yc)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=x,this.root=E?E.root||E:this,this.path=E?[...E.path,E]:[],this.parent=E,this.depth=E?E.depth+1:0;for(let a=0;a<this.path.length;a++)this.path[a].shouldResetTransform=!0;this.root===this&&(this.nodes=new vN)}addEventListener(x,E){return this.eventHandlers.has(x)||this.eventHandlers.set(x,new Lw),this.eventHandlers.get(x).add(E)}notifyListeners(x,...E){const a=this.eventHandlers.get(x);a&&a.notify(...E)}hasListeners(x){return this.eventHandlers.has(x)}mount(x,E=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=bN(x),this.instance=x;const{layoutId:a,layout:P,visualElement:A}=this.options;if(A&&!A.current&&A.mount(x),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),E&&(P||a)&&(this.isLayoutDirty=!0),e){let R;const F=()=>this.root.updateBlockedByResize=!1;e(x,()=>{this.root.updateBlockedByResize=!0,R&&R(),R=xN(F,250),Zg.hasAnimatedSinceResize&&(Zg.hasAnimatedSinceResize=!1,this.nodes.forEach(JC))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&A&&(a||P)&&this.addEventListener("didUpdate",({delta:R,hasLayoutChanged:F,hasRelativeTargetChanged:j,layout:Z})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const se=this.options.transition||A.getDefaultTransition()||jN,{onLayoutAnimationStart:ve,onLayoutAnimationComplete:X}=A.getProps(),H=!this.targetLayout||!DA(this.targetLayout,Z)||j,Y=!F&&j;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||Y||F&&(H||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(R,Y);const fe={...kw(se,"layout"),onPlay:ve,onComplete:X};(A.shouldReduceMotion||this.options.layoutRoot)&&(fe.delay=0,fe.type=!1),this.startAnimation(fe)}else F||JC(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=Z})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const x=this.getStack();x&&x.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ra(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(RN),this.animationId++)}getTransformTemplate(){const{visualElement:x}=this.options;return x&&x.getProps().transformTemplate}willUpdate(x=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let A=0;A<this.path.length;A++){const R=this.path[A];R.shouldResetTransform=!0,R.updateScroll("snapshot"),R.options.layoutRoot&&R.willUpdate(!1)}const{layoutId:E,layout:a}=this.options;if(E===void 0&&!a)return;const P=this.getTransformTemplate();this.prevTransformTemplateValue=P?P(this.latestValues,""):void 0,this.updateSnapshot(),x&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(YC);return}this.isUpdating||this.nodes.forEach(AN),this.isUpdating=!1,this.nodes.forEach(DN),this.nodes.forEach(CN),this.nodes.forEach(PN),this.clearAllSnapshots();const E=performance.now();ri.delta=dl(0,1e3/60,E-ri.timestamp),ri.timestamp=E,ri.isProcessing=!0,P0.update.process(ri),P0.preRender.process(ri),P0.render.process(ri),ri.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(IN),this.sharedNodes.forEach(ON)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Gn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Gn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let a=0;a<this.path.length;a++)this.path[a].updateScroll();const x=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Tr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:E}=this.options;E&&E.notify("LayoutMeasure",this.layout.layoutBox,x?x.layoutBox:void 0)}updateScroll(x="measure"){let E=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===x&&(E=!1),E&&(this.scroll={animationId:this.root.animationId,phase:x,isRoot:l(this.instance),offset:s(this.instance)})}resetTransform(){if(!d)return;const x=this.isLayoutDirty||this.shouldResetTransform,E=this.projectionDelta&&!AA(this.projectionDelta),a=this.getTransformTemplate(),P=a?a(this.latestValues,""):void 0,A=P!==this.prevTransformTemplateValue;x&&(E||gc(this.latestValues)||A)&&(d(this.instance,P),this.shouldResetTransform=!1,this.scheduleRender())}measure(x=!0){const E=this.measurePageBox();let a=this.removeElementScroll(E);return x&&(a=this.removeTransform(a)),NN(a),{animationId:this.root.animationId,measuredBox:E,layoutBox:a,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:x}=this.options;if(!x)return Tr();const E=x.measureViewportBox(),{scroll:a}=this.root;return a&&(Za(E.x,a.offset.x),Za(E.y,a.offset.y)),E}removeElementScroll(x){const E=Tr();co(E,x);for(let a=0;a<this.path.length;a++){const P=this.path[a],{scroll:A,options:R}=P;if(P!==this.root&&A&&R.layoutScroll){if(A.isRoot){co(E,x);const{scroll:F}=this.root;F&&(Za(E.x,-F.offset.x),Za(E.y,-F.offset.y))}Za(E.x,A.offset.x),Za(E.y,A.offset.y)}}return E}applyTransform(x,E=!1){const a=Tr();co(a,x);for(let P=0;P<this.path.length;P++){const A=this.path[P];!E&&A.options.layoutScroll&&A.scroll&&A!==A.root&&gh(a,{x:-A.scroll.offset.x,y:-A.scroll.offset.y}),gc(A.latestValues)&&gh(a,A.latestValues)}return gc(this.latestValues)&&gh(a,this.latestValues),a}removeTransform(x){const E=Tr();co(E,x);for(let a=0;a<this.path.length;a++){const P=this.path[a];if(!P.instance||!gc(P.latestValues))continue;s1(P.latestValues)&&P.updateSnapshot();const A=Tr(),R=P.measurePageBox();co(A,R),WC(E,P.latestValues,P.snapshot?P.snapshot.layoutBox:void 0,A)}return gc(this.latestValues)&&WC(E,this.latestValues),E}setTargetDelta(x){this.targetDelta=x,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(x){this.options={...this.options,...x,crossfade:x.crossfade!==void 0?x.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ri.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(x=!1){var E;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const P=!!this.resumingFrom||this!==a;if(!(x||P&&this.isSharedProjectionDirty||this.isProjectionDirty||!((E=this.parent)===null||E===void 0)&&E.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:R,layoutId:F}=this.options;if(!(!this.layout||!(R||F))){if(this.resolvedRelativeTargetAt=ri.timestamp,!this.targetDelta&&!this.relativeTarget){const j=this.getClosestProjectingParent();j&&j.layout&&this.animationProgress!==1?(this.relativeParent=j,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tr(),this.relativeTargetOrigin=Tr(),Zf(this.relativeTargetOrigin,this.layout.layoutBox,j.layout.layoutBox),co(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Tr(),this.targetWithTransforms=Tr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Uj(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):co(this.target,this.layout.layoutBox),SA(this.target,this.targetDelta)):co(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const j=this.getClosestProjectingParent();j&&!!j.resumingFrom==!!this.resumingFrom&&!j.options.layoutScroll&&j.target&&this.animationProgress!==1?(this.relativeParent=j,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tr(),this.relativeTargetOrigin=Tr(),Zf(this.relativeTargetOrigin,this.target,j.target),co(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}yc.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||s1(this.parent.latestValues)||EA(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var x;const E=this.getLead(),a=!!this.resumingFrom||this!==E;let P=!0;if((this.isProjectionDirty||!((x=this.parent)===null||x===void 0)&&x.isProjectionDirty)&&(P=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(P=!1),this.resolvedRelativeTargetAt===ri.timestamp&&(P=!1),P)return;const{layout:A,layoutId:R}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(A||R))return;co(this.layoutCorrected,this.layout.layoutBox);const F=this.treeScale.x,j=this.treeScale.y;Kj(this.layoutCorrected,this.treeScale,this.path,a),E.layout&&!E.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(E.target=E.layout.layoutBox);const{target:Z}=E;if(!Z){this.projectionTransform&&(this.projectionDelta=mh(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=mh(),this.projectionDeltaWithTransform=mh());const se=this.projectionTransform;Wf(this.projectionDelta,this.layoutCorrected,Z,this.latestValues),this.projectionTransform=HC(this.projectionDelta,this.treeScale),(this.projectionTransform!==se||this.treeScale.x!==F||this.treeScale.y!==j)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",Z)),yc.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(x=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),x){const E=this.getStack();E&&E.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(x,E=!1){const a=this.snapshot,P=a?a.latestValues:{},A={...this.latestValues},R=mh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!E;const F=Tr(),j=a?a.source:void 0,Z=this.layout?this.layout.source:void 0,se=j!==Z,ve=this.getStack(),X=!ve||ve.members.length<=1,H=!!(se&&!X&&this.options.crossfade===!0&&!this.path.some(BN));this.animationProgress=0;let Y;this.mixTargetDelta=fe=>{const Ce=fe/1e3;QC(R.x,x.x,Ce),QC(R.y,x.y,Ce),this.setTargetDelta(R),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Zf(F,this.layout.layoutBox,this.relativeParent.layout.layoutBox),FN(this.relativeTarget,this.relativeTargetOrigin,F,Ce),Y&&gN(this.relativeTarget,Y)&&(this.isProjectionDirty=!1),Y||(Y=Tr()),co(Y,this.relativeTarget)),se&&(this.animationValues=A,uN(A,P,this.latestValues,Ce,H,X)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Ce},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(x){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ra(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Gn.update(()=>{Zg.hasAnimatedSinceResize=!0,this.currentAnimation=TN(0,KC,{...x,onUpdate:E=>{this.mixTargetDelta(E),x.onUpdate&&x.onUpdate(E)},onComplete:()=>{x.onComplete&&x.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const x=this.getStack();x&&x.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(KC),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const x=this.getLead();let{targetWithTransforms:E,target:a,layout:P,latestValues:A}=x;if(!(!E||!a||!P)){if(this!==x&&this.layout&&P&&zA(this.options.animationType,this.layout.layoutBox,P.layoutBox)){a=this.target||Tr();const R=Xi(this.layout.layoutBox.x);a.x.min=x.target.x.min,a.x.max=a.x.min+R;const F=Xi(this.layout.layoutBox.y);a.y.min=x.target.y.min,a.y.max=a.y.min+F}co(E,a),gh(E,A),Wf(this.projectionDeltaWithTransform,this.layoutCorrected,E,A)}}registerSharedNode(x,E){this.sharedNodes.has(x)||this.sharedNodes.set(x,new yN),this.sharedNodes.get(x).add(E);const P=E.options.initialPromotionConfig;E.promote({transition:P?P.transition:void 0,preserveFollowOpacity:P&&P.shouldPreserveFollowOpacity?P.shouldPreserveFollowOpacity(E):void 0})}isLead(){const x=this.getStack();return x?x.lead===this:!0}getLead(){var x;const{layoutId:E}=this.options;return E?((x=this.getStack())===null||x===void 0?void 0:x.lead)||this:this}getPrevLead(){var x;const{layoutId:E}=this.options;return E?(x=this.getStack())===null||x===void 0?void 0:x.prevLead:void 0}getStack(){const{layoutId:x}=this.options;if(x)return this.root.sharedNodes.get(x)}promote({needsReset:x,transition:E,preserveFollowOpacity:a}={}){const P=this.getStack();P&&P.promote(this,a),x&&(this.projectionDelta=void 0,this.needsReset=!0),E&&this.setOptions({transition:E})}relegate(){const x=this.getStack();return x?x.relegate(this):!1}resetRotation(){const{visualElement:x}=this.options;if(!x)return;let E=!1;const{latestValues:a}=x;if((a.rotate||a.rotateX||a.rotateY||a.rotateZ)&&(E=!0),!E)return;const P={};for(let A=0;A<XC.length;A++){const R="rotate"+XC[A];a[R]&&(P[R]=a[R],x.setStaticValue(R,0))}x.render();for(const A in P)x.setStaticValue(A,P[A]);x.scheduleRender()}getProjectionStyles(x){var E,a;if(!this.instance||this.isSVG)return;if(!this.isVisible)return EN;const P={visibility:""},A=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,P.opacity="",P.pointerEvents=Wg(x==null?void 0:x.pointerEvents)||"",P.transform=A?A(this.latestValues,""):"none",P;const R=this.getLead();if(!this.projectionDelta||!this.layout||!R.target){const se={};return this.options.layoutId&&(se.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,se.pointerEvents=Wg(x==null?void 0:x.pointerEvents)||""),this.hasProjected&&!gc(this.latestValues)&&(se.transform=A?A({},""):"none",this.hasProjected=!1),se}const F=R.animationValues||R.latestValues;this.applyTransformsToTarget(),P.transform=HC(this.projectionDeltaWithTransform,this.treeScale,F),A&&(P.transform=A(F,P.transform));const{x:j,y:Z}=this.projectionDelta;P.transformOrigin=`${j.origin*100}% ${Z.origin*100}% 0`,R.animationValues?P.opacity=R===this?(a=(E=F.opacity)!==null&&E!==void 0?E:this.latestValues.opacity)!==null&&a!==void 0?a:1:this.preserveOpacity?this.latestValues.opacity:F.opacityExit:P.opacity=R===this?F.opacity!==void 0?F.opacity:"":F.opacityExit!==void 0?F.opacityExit:0;for(const se in Ty){if(F[se]===void 0)continue;const{correct:ve,applyTo:X}=Ty[se],H=P.transform==="none"?F[se]:ve(F[se],R);if(X){const Y=X.length;for(let fe=0;fe<Y;fe++)P[X[fe]]=H}else P[se]=H}return this.options.layoutId&&(P.pointerEvents=R===this?Wg(x==null?void 0:x.pointerEvents)||"":"none"),P}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(x=>{var E;return(E=x.currentAnimation)===null||E===void 0?void 0:E.stop()}),this.root.nodes.forEach(YC),this.root.sharedNodes.clear()}}}function CN(e){e.updateLayout()}function PN(e){var n;const s=((n=e.resumeFrom)===null||n===void 0?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:l,measuredBox:d}=e.layout,{animationType:g}=e.options,x=s.source!==e.layout.source;g==="size"?uo(R=>{const F=x?s.measuredBox[R]:s.layoutBox[R],j=Xi(F);F.min=l[R].min,F.max=F.min+j}):zA(g,s.layoutBox,l)&&uo(R=>{const F=x?s.measuredBox[R]:s.layoutBox[R],j=Xi(l[R]);F.max=F.min+j,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[R].max=e.relativeTarget[R].min+j)});const E=mh();Wf(E,l,s.layoutBox);const a=mh();x?Wf(a,e.applyTransform(d,!0),s.measuredBox):Wf(a,l,s.layoutBox);const P=!AA(E);let A=!1;if(!e.resumeFrom){const R=e.getClosestProjectingParent();if(R&&!R.resumeFrom){const{snapshot:F,layout:j}=R;if(F&&j){const Z=Tr();Zf(Z,s.layoutBox,F.layoutBox);const se=Tr();Zf(se,l,j.layoutBox),DA(Z,se)||(A=!0),R.options.layoutRoot&&(e.relativeTarget=se,e.relativeTargetOrigin=Z,e.relativeParent=R)}}}e.notifyListeners("didUpdate",{layout:l,snapshot:s,delta:a,layoutDelta:E,hasLayoutChanged:P,hasRelativeTargetChanged:A})}else if(e.isLead()){const{onExitComplete:l}=e.options;l&&l()}e.options.transition=void 0}function MN(e){yc.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function kN(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function IN(e){e.clearSnapshot()}function YC(e){e.clearMeasurements()}function AN(e){e.isLayoutDirty=!1}function DN(e){const{visualElement:n}=e.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),e.resetTransform()}function JC(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function LN(e){e.resolveTargetDelta()}function zN(e){e.calcProjection()}function RN(e){e.resetRotation()}function ON(e){e.removeLeadSnapshot()}function QC(e,n,s){e.translate=ar(n.translate,0,s),e.scale=ar(n.scale,1,s),e.origin=n.origin,e.originPoint=n.originPoint}function eP(e,n,s,l){e.min=ar(n.min,s.min,l),e.max=ar(n.max,s.max,l)}function FN(e,n,s,l){eP(e.x,n.x,s.x,l),eP(e.y,n.y,s.y,l)}function BN(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const jN={duration:.45,ease:[.4,0,.1,1]},tP=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),nP=tP("applewebkit/")&&!tP("chrome/")?Math.round:gr;function rP(e){e.min=nP(e.min),e.max=nP(e.max)}function NN(e){rP(e.x),rP(e.y)}function zA(e,n,s){return e==="position"||e==="preserve-aspect"&&!i1(qC(n),qC(s),.2)}const UN=LA({attachResizeListener:(e,n)=>qs(e,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),B0={current:void 0},RA=LA({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!B0.current){const e=new UN({});e.mount(window),e.setOptions({layoutScroll:!0}),B0.current=e}return B0.current},resetTransform:(e,n)=>{e.style.transform=n!==void 0?n:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),VN={pan:{Feature:iN},drag:{Feature:rN,ProjectionNode:RA,MeasureLayout:MA}},$N=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function GN(e){const n=$N.exec(e);if(!n)return[,];const[,s,l]=n;return[s,l]}function l1(e,n,s=1){const[l,d]=GN(e);if(!l)return;const g=window.getComputedStyle(n).getPropertyValue(l);if(g){const x=g.trim();return yA(x)?parseFloat(x):x}else return Yx(d)?l1(d,n,s+1):d}function WN(e,{...n},s){const l=e.current;if(!(l instanceof Element))return{target:n,transitionEnd:s};s&&(s={...s}),e.values.forEach(d=>{const g=d.get();if(!Yx(g))return;const x=l1(g,l);x&&d.set(x)});for(const d in n){const g=n[d];if(!Yx(g))continue;const x=l1(g,l);x&&(n[d]=x,s||(s={}),s[d]===void 0&&(s[d]=g))}return{target:n,transitionEnd:s}}const ZN=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),OA=e=>ZN.has(e),qN=e=>Object.keys(e).some(OA),iP=e=>e===Gc||e===Ut,oP=(e,n)=>parseFloat(e.split(", ")[n]),sP=(e,n)=>(s,{transform:l})=>{if(l==="none"||!l)return 0;const d=l.match(/^matrix3d\((.+)\)$/);if(d)return oP(d[1],n);{const g=l.match(/^matrix\((.+)\)$/);return g?oP(g[1],e):0}},HN=new Set(["x","y","z"]),XN=Ep.filter(e=>!HN.has(e));function KN(e){const n=[];return XN.forEach(s=>{const l=e.getValue(s);l!==void 0&&(n.push([s,l.get()]),l.set(s.startsWith("scale")?1:0))}),n.length&&e.render(),n}const Ah={width:({x:e},{paddingLeft:n="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(n)-parseFloat(s),height:({y:e},{paddingTop:n="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(n)-parseFloat(s),top:(e,{top:n})=>parseFloat(n),left:(e,{left:n})=>parseFloat(n),bottom:({y:e},{top:n})=>parseFloat(n)+(e.max-e.min),right:({x:e},{left:n})=>parseFloat(n)+(e.max-e.min),x:sP(4,13),y:sP(5,14)};Ah.translateX=Ah.x;Ah.translateY=Ah.y;const YN=(e,n,s)=>{const l=n.measureViewportBox(),d=n.current,g=getComputedStyle(d),{display:x}=g,E={};x==="none"&&n.setStaticValue("display",e.display||"block"),s.forEach(P=>{E[P]=Ah[P](l,g)}),n.render();const a=n.measureViewportBox();return s.forEach(P=>{const A=n.getValue(P);A&&A.jump(E[P]),e[P]=Ah[P](a,g)}),e},JN=(e,n,s={},l={})=>{n={...n},l={...l};const d=Object.keys(n).filter(OA);let g=[],x=!1;const E=[];if(d.forEach(a=>{const P=e.getValue(a);if(!e.hasValue(a))return;let A=s[a],R=Ef(A);const F=n[a];let j;if(Sy(F)){const Z=F.length,se=F[0]===null?1:0;A=F[se],R=Ef(A);for(let ve=se;ve<Z&&F[ve]!==null;ve++)j?Cy(Ef(F[ve])===j):j=Ef(F[ve])}else j=Ef(F);if(R!==j)if(iP(R)&&iP(j)){const Z=P.get();typeof Z=="string"&&P.set(parseFloat(Z)),typeof F=="string"?n[a]=parseFloat(F):Array.isArray(F)&&j===Ut&&(n[a]=F.map(parseFloat))}else R!=null&&R.transform&&(j!=null&&j.transform)&&(A===0||F===0)?A===0?P.set(j.transform(A)):n[a]=R.transform(F):(x||(g=KN(e),x=!0),E.push(a),l[a]=l[a]!==void 0?l[a]:n[a],P.jump(F))}),E.length){const a=E.indexOf("height")>=0?window.pageYOffset:null,P=YN(n,e,E);return g.length&&g.forEach(([A,R])=>{e.getValue(A).set(R)}),e.render(),s_&&a!==null&&window.scrollTo({top:a}),{target:P,transitionEnd:l}}else return{target:n,transitionEnd:l}};function QN(e,n,s,l){return qN(n)?JN(e,n,s,l):{target:n,transitionEnd:l}}const e6=(e,n,s,l)=>{const d=WN(e,n,l);return n=d.target,l=d.transitionEnd,QN(e,n,s,l)},c1={current:null},FA={current:!1};function t6(){if(FA.current=!0,!!s_)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),n=()=>c1.current=e.matches;e.addListener(n),n()}else c1.current=!1}function n6(e,n,s){const{willChange:l}=n;for(const d in n){const g=n[d],x=s[d];if(Oi(g))e.addValue(d,g),Iy(l)&&l.add(d);else if(Oi(x))e.addValue(d,Ih(g,{owner:e})),Iy(l)&&l.remove(d);else if(x!==g)if(e.hasValue(d)){const E=e.getValue(d);!E.hasAnimated&&E.set(g)}else{const E=e.getStaticValue(d);e.addValue(d,Ih(E!==void 0?E:g,{owner:e}))}}for(const d in s)n[d]===void 0&&e.removeValue(d);return n}const aP=new WeakMap,BA=Object.keys(fp),r6=BA.length,lP=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],i6=yw.length;class o6{constructor({parent:n,props:s,presenceContext:l,reducedMotionConfig:d,visualState:g},x={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Gn.render(this.render,!1,!0);const{latestValues:E,renderState:a}=g;this.latestValues=E,this.baseTarget={...E},this.initialValues=s.initial?{...E}:{},this.renderState=a,this.parent=n,this.props=s,this.presenceContext=l,this.depth=n?n.depth+1:0,this.reducedMotionConfig=d,this.options=x,this.isControllingVariants=l_(s),this.isVariantNode=bI(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(n&&n.current);const{willChange:P,...A}=this.scrapeMotionValuesFromProps(s,{});for(const R in A){const F=A[R];E[R]!==void 0&&Oi(F)&&(F.set(E[R],!1),Iy(P)&&P.add(R))}}scrapeMotionValuesFromProps(n,s){return{}}mount(n){this.current=n,aP.set(n,this),this.projection&&!this.projection.instance&&this.projection.mount(n),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,l)=>this.bindToMotionValue(l,s)),FA.current||t6(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:c1.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){aP.delete(this.current),this.projection&&this.projection.unmount(),ra(this.notifyUpdate),ra(this.render),this.valueSubscriptions.forEach(n=>n()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const n in this.events)this.events[n].clear();for(const n in this.features)this.features[n].unmount();this.current=null}bindToMotionValue(n,s){const l=$c.has(n),d=s.on("change",x=>{this.latestValues[n]=x,this.props.onUpdate&&Gn.update(this.notifyUpdate,!1,!0),l&&this.projection&&(this.projection.isTransformDirty=!0)}),g=s.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(n,()=>{d(),g()})}sortNodePosition(n){return!this.current||!this.sortInstanceNodePosition||this.type!==n.type?0:this.sortInstanceNodePosition(this.current,n.current)}loadFeatures({children:n,...s},l,d,g){let x,E;for(let a=0;a<r6;a++){const P=BA[a],{isEnabled:A,Feature:R,ProjectionNode:F,MeasureLayout:j}=fp[P];F&&(x=F),A(s)&&(!this.features[P]&&R&&(this.features[P]=new R(this)),j&&(E=j))}if((this.type==="html"||this.type==="svg")&&!this.projection&&x){this.projection=new x(this.latestValues,this.parent&&this.parent.projection);const{layoutId:a,layout:P,drag:A,dragConstraints:R,layoutScroll:F,layoutRoot:j}=s;this.projection.setOptions({layoutId:a,layout:P,alwaysMeasureLayout:!!A||R&&fh(R),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof P=="string"?P:"both",initialPromotionConfig:g,layoutScroll:F,layoutRoot:j})}return E}updateFeatures(){for(const n in this.features){const s=this.features[n];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Tr()}getStaticValue(n){return this.latestValues[n]}setStaticValue(n,s){this.latestValues[n]=s}makeTargetAnimatable(n,s=!0){return this.makeTargetAnimatableFromInstance(n,this.props,s)}update(n,s){(n.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=n,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let l=0;l<lP.length;l++){const d=lP[l];this.propEventSubscriptions[d]&&(this.propEventSubscriptions[d](),delete this.propEventSubscriptions[d]);const g=n["on"+d];g&&(this.propEventSubscriptions[d]=this.on(d,g))}this.prevMotionValues=n6(this,this.scrapeMotionValuesFromProps(n,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(n){return this.props.variants?this.props.variants[n]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(n=!1){if(n)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const l=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(l.initial=this.props.initial),l}const s={};for(let l=0;l<i6;l++){const d=yw[l],g=this.props[d];(dp(g)||g===!1)&&(s[d]=g)}return s}addVariantChild(n){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(n),()=>s.variantChildren.delete(n)}addValue(n,s){s!==this.values.get(n)&&(this.removeValue(n),this.bindToMotionValue(n,s)),this.values.set(n,s),this.latestValues[n]=s.get()}removeValue(n){this.values.delete(n);const s=this.valueSubscriptions.get(n);s&&(s(),this.valueSubscriptions.delete(n)),delete this.latestValues[n],this.removeValueFromRenderState(n,this.renderState)}hasValue(n){return this.values.has(n)}getValue(n,s){if(this.props.values&&this.props.values[n])return this.props.values[n];let l=this.values.get(n);return l===void 0&&s!==void 0&&(l=Ih(s,{owner:this}),this.addValue(n,l)),l}readValue(n){var s;return this.latestValues[n]!==void 0||!this.current?this.latestValues[n]:(s=this.getBaseTargetFromProps(this.props,n))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,n,this.options)}setBaseTarget(n,s){this.baseTarget[n]=s}getBaseTarget(n){var s;const{initial:l}=this.props,d=typeof l=="string"||typeof l=="object"?(s=Ew(this.props,l))===null||s===void 0?void 0:s[n]:void 0;if(l&&d!==void 0)return d;const g=this.getBaseTargetFromProps(this.props,n);return g!==void 0&&!Oi(g)?g:this.initialValues[n]!==void 0&&d===void 0?void 0:this.baseTarget[n]}on(n,s){return this.events[n]||(this.events[n]=new Lw),this.events[n].add(s)}notify(n,...s){this.events[n]&&this.events[n].notify(...s)}}class jA extends o6{sortInstanceNodePosition(n,s){return n.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(n,s){return n.style?n.style[s]:void 0}removeValueFromRenderState(n,{vars:s,style:l}){delete s[n],delete l[n]}makeTargetAnimatableFromInstance({transition:n,transitionEnd:s,...l},{transformValues:d},g){let x=bj(l,n||{},this);if(d&&(s&&(s=d(s)),l&&(l=d(l)),x&&(x=d(x))),g){xj(this,l,x);const E=e6(this,l,x,s);s=E.transitionEnd,l=E.target}return{transition:n,transitionEnd:s,...l}}}function s6(e){return window.getComputedStyle(e)}class a6 extends jA{constructor(){super(...arguments),this.type="html"}readValueFromInstance(n,s){if($c.has(s)){const l=Mw(s);return l&&l.default||0}else{const l=s6(n),d=(PI(s)?l.getPropertyValue(s):l[s])||0;return typeof d=="string"?d.trim():d}}measureInstanceViewportBox(n,{transformPagePoint:s}){return CA(n,s)}build(n,s,l,d){vw(n,s,l,d.transformTemplate)}scrapeMotionValuesFromProps(n,s){return Tw(n,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:n}=this.props;Oi(n)&&(this.childSubscription=n.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}renderInstance(n,s,l,d){LI(n,s,l,d)}}class l6 extends jA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(n,s){return n[s]}readValueFromInstance(n,s){if($c.has(s)){const l=Mw(s);return l&&l.default||0}return s=zI.has(s)?s:mw(s),n.getAttribute(s)}measureInstanceViewportBox(){return Tr()}scrapeMotionValuesFromProps(n,s){return OI(n,s)}build(n,s,l,d){ww(n,s,l,this.isSVGTag,d.transformTemplate)}renderInstance(n,s,l,d){RI(n,s,l,d)}mount(n){this.isSVGTag=bw(n.tagName),super.mount(n)}}const c6=(e,n)=>_w(e)?new l6(n,{enableHardwareAcceleration:!1}):new a6(n,{enableHardwareAcceleration:!0}),u6={layout:{ProjectionNode:RA,MeasureLayout:MA}},h6={...Fj,...iB,...VN,...u6},cl=dF((e,n)=>WF(e,n,h6,c6));function d6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 21v-7.5a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 .75.75V21m-4.5 0H2.36m11.14 0H18m0 0h3.64m-1.39 0V9.349M3.75 21V9.349m0 0a3.001 3.001 0 0 0 3.75-.615A2.993 2.993 0 0 0 9.75 9.75c.896 0 1.7-.393 2.25-1.016a2.993 2.993 0 0 0 2.25 1.016c.896 0 1.7-.393 2.25-1.015a3.001 3.001 0 0 0 3.75.614m-16.5 0a3.004 3.004 0 0 1-.621-4.72l1.189-1.19A1.5 1.5 0 0 1 5.378 3h13.243a1.5 1.5 0 0 1 1.06.44l1.19 1.189a3 3 0 0 1-.621 4.72M6.75 18h3.75a.75.75 0 0 0 .75-.75V13.5a.75.75 0 0 0-.75-.75H6.75a.75.75 0 0 0-.75.75v3.75c0 .414.336.75.75.75Z"}))}const f6=Q.forwardRef(d6);function p6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const zw=Q.forwardRef(p6);function m6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Rw=Q.forwardRef(m6);function g6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"}))}const y6=Q.forwardRef(g6);function _6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const v6=Q.forwardRef(_6);function x6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h-4.5c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9M10.125 2.25h.375a9 9 0 0 1 9 9v.375M10.125 2.25A3.375 3.375 0 0 1 13.5 5.625v1.5c0 .621.504 1.125 1.125 1.125h1.5a3.375 3.375 0 0 1 3.375 3.375M9 15l2.25 2.25L15 12"}))}const w6=Q.forwardRef(x6);function b6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"}))}const T6=Q.forwardRef(b6);function E6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const S6=Q.forwardRef(E6);function C6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const P6=Q.forwardRef(C6);function M6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const Ow=Q.forwardRef(M6);function k6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128Zm0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42"}))}const I6=Q.forwardRef(k6);function A6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))}const D6=Q.forwardRef(A6);function L6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const z6=Q.forwardRef(L6);function R6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))}const O6=Q.forwardRef(R6);function F6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"}))}const B6=Q.forwardRef(F6);function j6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))}const N6=Q.forwardRef(j6);function U6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const V6=Q.forwardRef(U6);function $6({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 1 1-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 0 1 6.336-4.486l-3.276 3.276a3.004 3.004 0 0 0 2.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852Z"}),Q.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.867 19.125h.008v.008h-.008v-.008Z"}))}const G6=Q.forwardRef($6);function Yu(e,n,s){let l=s.initialDeps??[],d;return()=>{var g,x,E,a;let P;s.key&&((g=s.debug)!=null&&g.call(s))&&(P=Date.now());const A=e();if(!(A.length!==l.length||A.some((j,Z)=>l[Z]!==j)))return d;l=A;let F;if(s.key&&((x=s.debug)!=null&&x.call(s))&&(F=Date.now()),d=n(...A),s.key&&((E=s.debug)!=null&&E.call(s))){const j=Math.round((Date.now()-P)*100)/100,Z=Math.round((Date.now()-F)*100)/100,se=Z/16,ve=(X,H)=>{for(X=String(X);X.length<H;)X=" "+X;return X};console.info(`%c ${ve(Z,5)} /${ve(j,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*se,120))}deg 100% 31%);`,s==null?void 0:s.key)}return(a=s==null?void 0:s.onChange)==null||a.call(s,d),d}}function j0(e,n){if(e===void 0)throw new Error("Unexpected undefined");return e}const W6=(e,n)=>Math.abs(e-n)<1,Z6=(e,n,s)=>{let l;return function(...d){e.clearTimeout(l),l=e.setTimeout(()=>n.apply(this,d),s)}},q6=e=>e,H6=e=>{const n=Math.max(e.startIndex-e.overscan,0),s=Math.min(e.endIndex+e.overscan,e.count-1),l=[];for(let d=n;d<=s;d++)l.push(d);return l},X6=(e,n)=>{const s=e.scrollElement;if(!s)return;const l=e.targetWindow;if(!l)return;const d=x=>{const{width:E,height:a}=x;n({width:Math.round(E),height:Math.round(a)})};if(d(s.getBoundingClientRect()),!l.ResizeObserver)return()=>{};const g=new l.ResizeObserver(x=>{const E=x[0];if(E!=null&&E.borderBoxSize){const a=E.borderBoxSize[0];if(a){d({width:a.inlineSize,height:a.blockSize});return}}d(s.getBoundingClientRect())});return g.observe(s,{box:"border-box"}),()=>{g.unobserve(s)}},cP={passive:!0},K6=typeof window>"u"?!0:"onscrollend"in window,Y6=(e,n)=>{const s=e.scrollElement;if(!s)return;const l=e.targetWindow;if(!l)return;let d=0;const g=K6?()=>{}:Z6(l,()=>{n(d,!1)},e.options.isScrollingResetDelay),x=P=>()=>{const{horizontal:A,isRtl:R}=e.options;d=A?s.scrollLeft*(R&&-1||1):s.scrollTop,g(),n(d,P)},E=x(!0),a=x(!1);return a(),s.addEventListener("scroll",E,cP),s.addEventListener("scrollend",a,cP),()=>{s.removeEventListener("scroll",E),s.removeEventListener("scrollend",a)}},J6=(e,n,s)=>{if(n!=null&&n.borderBoxSize){const l=n.borderBoxSize[0];if(l)return Math.round(l[s.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[s.options.horizontal?"width":"height"])},Q6=(e,{adjustments:n=0,behavior:s},l)=>{var d,g;const x=e+n;(g=(d=l.scrollElement)==null?void 0:d.scrollTo)==null||g.call(d,{[l.options.horizontal?"left":"top"]:x,behavior:s})};class eU{constructor(n){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let s=null;const l=()=>s||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:s=new this.targetWindow.ResizeObserver(d=>{d.forEach(g=>{this._measureElement(g.target,g)})}));return{disconnect:()=>{var d;(d=l())==null||d.disconnect(),s=null},observe:d=>{var g;return(g=l())==null?void 0:g.observe(d,{box:"border-box"})},unobserve:d=>{var g;return(g=l())==null?void 0:g.unobserve(d)}}})(),this.range=null,this.setOptions=s=>{Object.entries(s).forEach(([l,d])=>{typeof d>"u"&&delete s[l]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:q6,rangeExtractor:H6,onChange:()=>{},measureElement:J6,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,...s}},this.notify=s=>{var l,d;(d=(l=this.options).onChange)==null||d.call(l,this,s)},this.maybeNotify=Yu(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),s=>{this.notify(s)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(s=>s()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var s;const l=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==l){if(this.cleanup(),!l){this.maybeNotify();return}this.scrollElement=l,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((s=this.scrollElement)==null?void 0:s.window)??null,this.elementsCache.forEach(d=>{this.observer.observe(d)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,d=>{this.scrollRect=d,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(d,g)=>{this.scrollAdjustments=0,this.scrollDirection=g?this.getScrollOffset()<d?"forward":"backward":null,this.scrollOffset=d,this.isScrolling=g,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(s,l)=>{const d=new Map,g=new Map;for(let x=l-1;x>=0;x--){const E=s[x];if(d.has(E.lane))continue;const a=g.get(E.lane);if(a==null||E.end>a.end?g.set(E.lane,E):E.end<a.end&&d.set(E.lane,!0),d.size===this.options.lanes)break}return g.size===this.options.lanes?Array.from(g.values()).sort((x,E)=>x.end===E.end?x.index-E.index:x.end-E.end)[0]:void 0},this.getMeasurementOptions=Yu(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(s,l,d,g,x)=>(this.pendingMeasuredCacheIndexes=[],{count:s,paddingStart:l,scrollMargin:d,getItemKey:g,enabled:x}),{key:!1}),this.getMeasurements=Yu(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:s,paddingStart:l,scrollMargin:d,getItemKey:g,enabled:x},E)=>{if(!x)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(A=>{this.itemSizeCache.set(A.key,A.size)}));const a=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const P=this.measurementsCache.slice(0,a);for(let A=a;A<s;A++){const R=g(A),F=this.options.lanes===1?P[A-1]:this.getFurthestMeasurement(P,A),j=F?F.end+this.options.gap:l+d,Z=E.get(R),se=typeof Z=="number"?Z:this.options.estimateSize(A),ve=j+se,X=F?F.lane:A%this.options.lanes;P[A]={index:A,start:j,size:se,end:ve,key:R,lane:X}}return this.measurementsCache=P,P},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Yu(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(s,l,d)=>this.range=s.length>0&&l>0?tU({measurements:s,outerSize:l,scrollOffset:d}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=Yu(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(s,l,d,g)=>l===null?[]:s({startIndex:l.startIndex,endIndex:l.endIndex,overscan:d,count:g}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=s=>{const l=this.options.indexAttribute,d=s.getAttribute(l);return d?parseInt(d,10):(console.warn(`Missing attribute name '${l}={index}' on measured element.`),-1)},this._measureElement=(s,l)=>{const d=this.indexFromElement(s),g=this.measurementsCache[d];if(!g)return;const x=g.key,E=this.elementsCache.get(x);E!==s&&(E&&this.observer.unobserve(E),this.observer.observe(s),this.elementsCache.set(x,s)),s.isConnected&&this.resizeItem(d,this.options.measureElement(s,l,this))},this.resizeItem=(s,l)=>{const d=this.measurementsCache[s];if(!d)return;const g=this.itemSizeCache.get(d.key)??d.size,x=l-g;x!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(d,x,this):d.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=x,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(d.index),this.itemSizeCache=new Map(this.itemSizeCache.set(d.key,l)),this.notify(!1))},this.measureElement=s=>{if(!s){this.elementsCache.forEach((l,d)=>{l.isConnected||(this.observer.unobserve(l),this.elementsCache.delete(d))});return}this._measureElement(s,void 0)},this.getVirtualItems=Yu(()=>[this.getIndexes(),this.getMeasurements()],(s,l)=>{const d=[];for(let g=0,x=s.length;g<x;g++){const E=s[g],a=l[E];d.push(a)}return d},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=s=>{const l=this.getMeasurements();if(l.length!==0)return j0(l[NA(0,l.length-1,d=>j0(l[d]).start,s)])},this.getOffsetForAlignment=(s,l)=>{const d=this.getSize(),g=this.getScrollOffset();l==="auto"&&(s<=g?l="start":s>=g+d?l="end":l="start"),l==="start"?s=s:l==="end"?s=s-d:l==="center"&&(s=s-d/2);const x=this.options.horizontal?"scrollWidth":"scrollHeight",a=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[x]:this.scrollElement[x]:0)-d;return Math.max(Math.min(a,s),0)},this.getOffsetForIndex=(s,l="auto")=>{s=Math.max(0,Math.min(s,this.options.count-1));const d=this.measurementsCache[s];if(!d)return;const g=this.getSize(),x=this.getScrollOffset();if(l==="auto")if(d.end>=x+g-this.options.scrollPaddingEnd)l="end";else if(d.start<=x+this.options.scrollPaddingStart)l="start";else return[x,l];const E=l==="end"?d.end+this.options.scrollPaddingEnd:d.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(E,l),l]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(s,{align:l="start",behavior:d}={})=>{this.cancelScrollToIndex(),d==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(s,l),{adjustments:void 0,behavior:d})},this.scrollToIndex=(s,{align:l="auto",behavior:d}={})=>{s=Math.max(0,Math.min(s,this.options.count-1)),this.cancelScrollToIndex(),d==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const g=this.getOffsetForIndex(s,l);if(!g)return;const[x,E]=g;this._scrollToOffset(x,{adjustments:void 0,behavior:d}),d!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(s))){const[P]=j0(this.getOffsetForIndex(s,E));W6(P,this.getScrollOffset())||this.scrollToIndex(s,{align:E,behavior:d})}else this.scrollToIndex(s,{align:E,behavior:d})}))},this.scrollBy=(s,{behavior:l}={})=>{this.cancelScrollToIndex(),l==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+s,{adjustments:void 0,behavior:l})},this.getTotalSize=()=>{var s;const l=this.getMeasurements();let d;return l.length===0?d=this.options.paddingStart:d=this.options.lanes===1?((s=l[l.length-1])==null?void 0:s.end)??0:Math.max(...l.slice(-this.options.lanes).map(g=>g.end)),Math.max(d-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(s,{adjustments:l,behavior:d})=>{this.options.scrollToFn(s,{behavior:d,adjustments:l},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(n)}}const NA=(e,n,s,l)=>{for(;e<=n;){const d=(e+n)/2|0,g=s(d);if(g<l)e=d+1;else if(g>l)n=d-1;else return d}return e>0?e-1:0};function tU({measurements:e,outerSize:n,scrollOffset:s}){const l=e.length-1,g=NA(0,l,E=>e[E].start,s);let x=g;for(;x<l&&e[x].end<s+n;)x++;return{startIndex:g,endIndex:x}}const nU=typeof document<"u"?Q.useLayoutEffect:Q.useEffect;function rU(e){const n=Q.useReducer(()=>({}),{})[1],s={...e,onChange:(d,g)=>{var x;g?lw.flushSync(n):n(),(x=e.onChange)==null||x.call(e,d,g)}},[l]=Q.useState(()=>new eU(s));return l.setOptions(s),Q.useEffect(()=>l._didMount(),[]),nU(()=>l._willUpdate()),l}function iU(e){return rU({observeElementRect:X6,observeElementOffset:Y6,scrollToFn:Q6,...e})}var oU=Object.defineProperty,sU=(e,n,s)=>n in e?oU(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,N0=(e,n,s)=>(sU(e,typeof n!="symbol"?n+"":n,s),s);let aU=class{constructor(){N0(this,"current",this.detect()),N0(this,"handoffState","pending"),N0(this,"currentId",0)}set(n){this.current!==n&&(this.handoffState="pending",this.currentId=0,this.current=n)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Dc=new aU,Cr=(e,n)=>{Dc.isServer?Q.useEffect(e,n):Q.useLayoutEffect(e,n)};function Hs(e){let n=Q.useRef(e);return Cr(()=>{n.current=e},[e]),n}function Fw(e,n){let[s,l]=Q.useState(e),d=Hs(e);return Cr(()=>l(d.current),[d,l,...n]),s}let sn=function(e){let n=Hs(e);return An.useCallback((...s)=>n.current(...s),[n])};function lU(e,n,s){let[l,d]=Q.useState(s),g=e!==void 0,x=Q.useRef(g),E=Q.useRef(!1),a=Q.useRef(!1);return g&&!x.current&&!E.current?(E.current=!0,x.current=g,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!g&&x.current&&!a.current&&(a.current=!0,x.current=g,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[g?e:l,sn(P=>(g||d(P),n==null?void 0:n(P)))]}function UA(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(n=>setTimeout(()=>{throw n}))}function Dy(){let e=[],n={addEventListener(s,l,d,g){return s.addEventListener(l,d,g),n.add(()=>s.removeEventListener(l,d,g))},requestAnimationFrame(...s){let l=requestAnimationFrame(...s);return n.add(()=>cancelAnimationFrame(l))},nextFrame(...s){return n.requestAnimationFrame(()=>n.requestAnimationFrame(...s))},setTimeout(...s){let l=setTimeout(...s);return n.add(()=>clearTimeout(l))},microTask(...s){let l={current:!0};return UA(()=>{l.current&&s[0]()}),n.add(()=>{l.current=!1})},style(s,l,d){let g=s.style.getPropertyValue(l);return Object.assign(s.style,{[l]:d}),this.add(()=>{Object.assign(s.style,{[l]:g})})},group(s){let l=Dy();return s(l),this.add(()=>l.dispose())},add(s){return e.push(s),()=>{let l=e.indexOf(s);if(l>=0)for(let d of e.splice(l,1))d()}},dispose(){for(let s of e.splice(0))s()}};return n}function Bw(){let[e]=Q.useState(Dy);return Q.useEffect(()=>()=>e.dispose(),[e]),e}function cU(){let e=typeof document>"u";return"useSyncExternalStore"in G0?(n=>n.useSyncExternalStore)(G0)(()=>()=>{},()=>!1,()=>!e):!1}function uU(){let e=cU(),[n,s]=Q.useState(Dc.isHandoffComplete);return n&&Dc.isHandoffComplete===!1&&s(!1),Q.useEffect(()=>{n!==!0&&s(!0)},[n]),Q.useEffect(()=>Dc.handoff(),[]),e?!1:n}var uP;let Wc=(uP=An.useId)!=null?uP:function(){let e=uU(),[n,s]=An.useState(e?()=>Dc.nextId():null);return Cr(()=>{n===null&&s(Dc.nextId())},[n]),n!=null?""+n:void 0};function Ri(e,n,...s){if(e in n){let d=n[e];return typeof d=="function"?d(...s):d}let l=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(n).map(d=>`"${d}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,Ri),l}function d_(e){return Dc.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}let u1=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var $o=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))($o||{}),Lf=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(Lf||{}),hU=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(hU||{});function dU(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(u1)).sort((n,s)=>Math.sign((n.tabIndex||Number.MAX_SAFE_INTEGER)-(s.tabIndex||Number.MAX_SAFE_INTEGER)))}var VA=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(VA||{});function fU(e,n=0){var s;return e===((s=d_(e))==null?void 0:s.body)?!1:Ri(n,{0(){return e.matches(u1)},1(){let l=e;for(;l!==null;){if(l.matches(u1))return!0;l=l.parentElement}return!1}})}var pU=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(pU||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let mU=["textarea","input"].join(",");function gU(e){var n,s;return(s=(n=e==null?void 0:e.matches)==null?void 0:n.call(e,mU))!=null?s:!1}function Mc(e,n=s=>s){return e.slice().sort((s,l)=>{let d=n(s),g=n(l);if(d===null||g===null)return 0;let x=d.compareDocumentPosition(g);return x&Node.DOCUMENT_POSITION_FOLLOWING?-1:x&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Ju(e,n,{sorted:s=!0,relativeTo:l=null,skipElements:d=[]}={}){let g=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,x=Array.isArray(e)?s?Mc(e):e:dU(e);d.length>0&&x.length>1&&(x=x.filter(j=>!d.includes(j))),l=l??g.activeElement;let E=(()=>{if(n&5)return 1;if(n&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),a=(()=>{if(n&1)return 0;if(n&2)return Math.max(0,x.indexOf(l))-1;if(n&4)return Math.max(0,x.indexOf(l))+1;if(n&8)return x.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),P=n&32?{preventScroll:!0}:{},A=0,R=x.length,F;do{if(A>=R||A+R<=0)return 0;let j=a+A;if(n&16)j=(j+R)%R;else{if(j<0)return 3;if(j>=R)return 1}F=x[j],F==null||F.focus(P),A+=E}while(F!==g.activeElement);return n&6&&gU(F)&&F.select(),2}function yU(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function _U(){return/Android/gi.test(window.navigator.userAgent)}function $A(){return yU()||_U()}function Tg(e,n,s){let l=Hs(n);Q.useEffect(()=>{function d(g){l.current(g)}return document.addEventListener(e,d,s),()=>document.removeEventListener(e,d,s)},[e,s])}function vU(e,n,s){let l=Hs(n);Q.useEffect(()=>{function d(g){l.current(g)}return window.addEventListener(e,d,s),()=>window.removeEventListener(e,d,s)},[e,s])}function xU(e,n,s=!0){let l=Q.useRef(!1);Q.useEffect(()=>{requestAnimationFrame(()=>{l.current=s})},[s]);function d(x,E){if(!l.current||x.defaultPrevented)return;let a=E(x);if(a===null||!a.getRootNode().contains(a)||!a.isConnected)return;let P=function A(R){return typeof R=="function"?A(R()):Array.isArray(R)||R instanceof Set?R:[R]}(e);for(let A of P){if(A===null)continue;let R=A instanceof HTMLElement?A:A.current;if(R!=null&&R.contains(a)||x.composed&&x.composedPath().includes(R))return}return!fU(a,VA.Loose)&&a.tabIndex!==-1&&x.preventDefault(),n(x,a)}let g=Q.useRef(null);Tg("pointerdown",x=>{var E,a;l.current&&(g.current=((a=(E=x.composedPath)==null?void 0:E.call(x))==null?void 0:a[0])||x.target)},!0),Tg("mousedown",x=>{var E,a;l.current&&(g.current=((a=(E=x.composedPath)==null?void 0:E.call(x))==null?void 0:a[0])||x.target)},!0),Tg("click",x=>{$A()||g.current&&(d(x,()=>g.current),g.current=null)},!0),Tg("touchend",x=>d(x,()=>x.target instanceof HTMLElement?x.target:null),!0),vU("blur",x=>d(x,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function wU(...e){return Q.useMemo(()=>d_(...e),[...e])}function hP(e){var n;if(e.type)return e.type;let s=(n=e.as)!=null?n:"button";if(typeof s=="string"&&s.toLowerCase()==="button")return"button"}function GA(e,n){let[s,l]=Q.useState(()=>hP(e));return Cr(()=>{l(hP(e))},[e.type,e.as]),Cr(()=>{s||n.current&&n.current instanceof HTMLButtonElement&&!n.current.hasAttribute("type")&&l("button")},[s,n]),s}let bU=Symbol();function ys(...e){let n=Q.useRef(e);Q.useEffect(()=>{n.current=e},[e]);let s=sn(l=>{for(let d of n.current)d!=null&&(typeof d=="function"?d(l):d.current=l)});return e.every(l=>l==null||(l==null?void 0:l[bU]))?void 0:s}function dP(e){return[e.screenX,e.screenY]}function TU(){let e=Q.useRef([-1,-1]);return{wasMoved(n){let s=dP(n);return e.current[0]===s[0]&&e.current[1]===s[1]?!1:(e.current=s,!0)},update(n){e.current=dP(n)}}}function EU({container:e,accept:n,walk:s,enabled:l=!0}){let d=Q.useRef(n),g=Q.useRef(s);Q.useEffect(()=>{d.current=n,g.current=s},[n,s]),Cr(()=>{if(!e||!l)return;let x=d_(e);if(!x)return;let E=d.current,a=g.current,P=Object.assign(R=>E(R),{acceptNode:E}),A=x.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,P,!1);for(;A.nextNode();)a(A.currentNode)},[e,l,d,g])}function fP(e,n){let s=Q.useRef([]),l=sn(e);Q.useEffect(()=>{let d=[...s.current];for(let[g,x]of n.entries())if(s.current[g]!==x){let E=l(n,d);return s.current=n,E}},[l,...n])}function pP(...e){return Array.from(new Set(e.flatMap(n=>typeof n=="string"?n.split(" "):[]))).filter(Boolean).join(" ")}var mp=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(mp||{}),SU=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(SU||{});function _o({ourProps:e,theirProps:n,slot:s,defaultTag:l,features:d,visible:g=!0,name:x,mergeRefs:E}){E=E??CU;let a=WA(n,e);if(g)return Eg(a,s,l,x,E);let P=d??0;if(P&2){let{static:A=!1,...R}=a;if(A)return Eg(R,s,l,x,E)}if(P&1){let{unmount:A=!0,...R}=a;return Ri(A?0:1,{0(){return null},1(){return Eg({...R,hidden:!0,style:{display:"none"}},s,l,x,E)}})}return Eg(a,s,l,x,E)}function Eg(e,n={},s,l,d){let{as:g=s,children:x,refName:E="ref",...a}=U0(e,["unmount","static"]),P=e.ref!==void 0?{[E]:e.ref}:{},A=typeof x=="function"?x(n):x;"className"in a&&a.className&&typeof a.className=="function"&&(a.className=a.className(n));let R={};if(n){let F=!1,j=[];for(let[Z,se]of Object.entries(n))typeof se=="boolean"&&(F=!0),se===!0&&j.push(Z);F&&(R["data-headlessui-state"]=j.join(" "))}if(g===Q.Fragment&&Object.keys(h1(a)).length>0){if(!Q.isValidElement(A)||Array.isArray(A)&&A.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${l} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(a).map(se=>`  - ${se}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(se=>`  - ${se}`).join(`
`)].join(`
`));let F=A.props,j=typeof(F==null?void 0:F.className)=="function"?(...se)=>pP(F==null?void 0:F.className(...se),a.className):pP(F==null?void 0:F.className,a.className),Z=j?{className:j}:{};return Q.cloneElement(A,Object.assign({},WA(A.props,h1(U0(a,["ref"]))),R,P,{ref:d(A.ref,P.ref)},Z))}return Q.createElement(g,Object.assign({},U0(a,["ref"]),g!==Q.Fragment&&P,g!==Q.Fragment&&R),A)}function CU(...e){return e.every(n=>n==null)?void 0:n=>{for(let s of e)s!=null&&(typeof s=="function"?s(n):s.current=n)}}function WA(...e){if(e.length===0)return{};if(e.length===1)return e[0];let n={},s={};for(let l of e)for(let d in l)d.startsWith("on")&&typeof l[d]=="function"?(s[d]!=null||(s[d]=[]),s[d].push(l[d])):n[d]=l[d];if(n.disabled||n["aria-disabled"])return Object.assign(n,Object.fromEntries(Object.keys(s).map(l=>[l,void 0])));for(let l in s)Object.assign(n,{[l](d,...g){let x=s[l];for(let E of x){if((d instanceof Event||(d==null?void 0:d.nativeEvent)instanceof Event)&&d.defaultPrevented)return;E(d,...g)}}});return n}function vo(e){var n;return Object.assign(Q.forwardRef(e),{displayName:(n=e.displayName)!=null?n:e.name})}function h1(e){let n=Object.assign({},e);for(let s in n)n[s]===void 0&&delete n[s];return n}function U0(e,n=[]){let s=Object.assign({},e);for(let l of n)l in s&&delete s[l];return s}let PU="div";var jw=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(jw||{});function MU(e,n){var s;let{features:l=1,...d}=e,g={ref:n,"aria-hidden":(l&2)===2?!0:(s=d["aria-hidden"])!=null?s:void 0,hidden:(l&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(l&4)===4&&(l&2)!==2&&{display:"none"}}};return _o({ourProps:g,theirProps:d,slot:{},defaultTag:PU,name:"Hidden"})}let Nw=vo(MU),Uw=Q.createContext(null);Uw.displayName="OpenClosedContext";var gp=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(gp||{});function kU(){return Q.useContext(Uw)}function IU({value:e,children:n}){return An.createElement(Uw.Provider,{value:e},n)}function AU(e){function n(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",n))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",n),n())}let xc=[];AU(()=>{function e(n){n.target instanceof HTMLElement&&n.target!==document.body&&xc[0]!==n.target&&(xc.unshift(n.target),xc=xc.filter(s=>s!=null&&s.isConnected),xc.splice(10))}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function DU(e){let n=e.parentElement,s=null;for(;n&&!(n instanceof HTMLFieldSetElement);)n instanceof HTMLLegendElement&&(s=n),n=n.parentElement;let l=(n==null?void 0:n.getAttribute("disabled"))==="";return l&&LU(s)?!1:l}function LU(e){if(!e)return!1;let n=e.previousElementSibling;for(;n!==null;){if(n instanceof HTMLLegendElement)return!1;n=n.previousElementSibling}return!0}function zU(e){throw new Error("Unexpected object: "+e)}var Ar=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(Ar||{});function mP(e,n){let s=n.resolveItems();if(s.length<=0)return null;let l=n.resolveActiveIndex(),d=l??-1;switch(e.focus){case 0:{for(let g=0;g<s.length;++g)if(!n.resolveDisabled(s[g],g,s))return g;return l}case 1:{for(let g=d-1;g>=0;--g)if(!n.resolveDisabled(s[g],g,s))return g;return l}case 2:{for(let g=d+1;g<s.length;++g)if(!n.resolveDisabled(s[g],g,s))return g;return l}case 3:{for(let g=s.length-1;g>=0;--g)if(!n.resolveDisabled(s[g],g,s))return g;return l}case 4:{for(let g=0;g<s.length;++g)if(n.resolveId(s[g],g,s)===e.id)return g;return l}case 5:return null;default:zU(e)}}function ZA(e={},n=null,s=[]){for(let[l,d]of Object.entries(e))HA(s,qA(n,l),d);return s}function qA(e,n){return e?e+"["+n+"]":n}function HA(e,n,s){if(Array.isArray(s))for(let[l,d]of s.entries())HA(e,qA(n,l.toString()),d);else s instanceof Date?e.push([n,s.toISOString()]):typeof s=="boolean"?e.push([n,s?"1":"0"]):typeof s=="string"?e.push([n,s]):typeof s=="number"?e.push([n,`${s}`]):s==null?e.push([n,""]):ZA(s,n,e)}var or=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(or||{}),RU={},OU=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(OU||{}),FU=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(FU||{}),BU=(e=>(e[e.Pointer=0]="Pointer",e[e.Focus=1]="Focus",e[e.Other=2]="Other",e))(BU||{}),jU=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.RegisterOption=3]="RegisterOption",e[e.UnregisterOption=4]="UnregisterOption",e[e.RegisterLabel=5]="RegisterLabel",e[e.SetActivationTrigger=6]="SetActivationTrigger",e[e.UpdateVirtualOptions=7]="UpdateVirtualOptions",e))(jU||{});function V0(e,n=s=>s){let s=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,l=n(e.options.slice()),d=l.length>0&&l[0].dataRef.current.order!==null?l.sort((x,E)=>x.dataRef.current.order-E.dataRef.current.order):Mc(l,x=>x.dataRef.current.domRef.current),g=s?d.indexOf(s):null;return g===-1&&(g=null),{options:d,activeOptionIndex:g}}let NU={1(e){var n;return(n=e.dataRef.current)!=null&&n.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1}},0(e){var n,s;if((n=e.dataRef.current)!=null&&n.disabled||e.comboboxState===0)return e;if((s=e.dataRef.current)!=null&&s.value){let l=e.dataRef.current.calculateIndex(e.dataRef.current.value);if(l!==-1)return{...e,activeOptionIndex:l,comboboxState:0}}return{...e,comboboxState:0}},2(e,n){var s,l,d,g,x;if((s=e.dataRef.current)!=null&&s.disabled||(l=e.dataRef.current)!=null&&l.optionsRef.current&&!((d=e.dataRef.current)!=null&&d.optionsPropsRef.current.static)&&e.comboboxState===1)return e;if(e.virtual){let A=n.focus===Ar.Specific?n.idx:mP(n,{resolveItems:()=>e.virtual.options,resolveActiveIndex:()=>{var F,j;return(j=(F=e.activeOptionIndex)!=null?F:e.virtual.options.findIndex(Z=>!e.virtual.disabled(Z)))!=null?j:null},resolveDisabled:e.virtual.disabled,resolveId(){throw new Error("Function not implemented.")}}),R=(g=n.trigger)!=null?g:2;return e.activeOptionIndex===A&&e.activationTrigger===R?e:{...e,activeOptionIndex:A,activationTrigger:R}}let E=V0(e);if(E.activeOptionIndex===null){let A=E.options.findIndex(R=>!R.dataRef.current.disabled);A!==-1&&(E.activeOptionIndex=A)}let a=n.focus===Ar.Specific?n.idx:mP(n,{resolveItems:()=>E.options,resolveActiveIndex:()=>E.activeOptionIndex,resolveId:A=>A.id,resolveDisabled:A=>A.dataRef.current.disabled}),P=(x=n.trigger)!=null?x:2;return e.activeOptionIndex===a&&e.activationTrigger===P?e:{...e,...E,activeOptionIndex:a,activationTrigger:P}},3:(e,n)=>{var s,l,d;if((s=e.dataRef.current)!=null&&s.virtual)return{...e,options:[...e.options,n.payload]};let g=n.payload,x=V0(e,a=>(a.push(g),a));e.activeOptionIndex===null&&(l=e.dataRef.current)!=null&&l.isSelected(n.payload.dataRef.current.value)&&(x.activeOptionIndex=x.options.indexOf(g));let E={...e,...x,activationTrigger:2};return(d=e.dataRef.current)!=null&&d.__demoMode&&e.dataRef.current.value===void 0&&(E.activeOptionIndex=0),E},4:(e,n)=>{var s;if((s=e.dataRef.current)!=null&&s.virtual)return{...e,options:e.options.filter(d=>d.id!==n.id)};let l=V0(e,d=>{let g=d.findIndex(x=>x.id===n.id);return g!==-1&&d.splice(g,1),d});return{...e,...l,activationTrigger:2}},5:(e,n)=>e.labelId===n.id?e:{...e,labelId:n.id},6:(e,n)=>e.activationTrigger===n.trigger?e:{...e,activationTrigger:n.trigger},7:(e,n)=>{var s;if(((s=e.virtual)==null?void 0:s.options)===n.options)return e;let l=e.activeOptionIndex;if(e.activeOptionIndex!==null){let d=n.options.indexOf(e.virtual.options[e.activeOptionIndex]);d!==-1?l=d:l=null}return{...e,activeOptionIndex:l,virtual:Object.assign({},e.virtual,{options:n.options})}}},Vw=Q.createContext(null);Vw.displayName="ComboboxActionsContext";function Mp(e){let n=Q.useContext(Vw);if(n===null){let s=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Mp),s}return n}let XA=Q.createContext(null);function UU(e){var n;let s=Zc("VirtualProvider"),[l,d]=Q.useMemo(()=>{let a=s.optionsRef.current;if(!a)return[0,0];let P=window.getComputedStyle(a);return[parseFloat(P.paddingBlockStart||P.paddingTop),parseFloat(P.paddingBlockEnd||P.paddingBottom)]},[s.optionsRef.current]),g=iU({scrollPaddingStart:l,scrollPaddingEnd:d,count:s.virtual.options.length,estimateSize(){return 40},getScrollElement(){var a;return(a=s.optionsRef.current)!=null?a:null},overscan:12}),[x,E]=Q.useState(0);return Cr(()=>{E(a=>a+1)},[(n=s.virtual)==null?void 0:n.options]),An.createElement(XA.Provider,{value:g},An.createElement("div",{style:{position:"relative",width:"100%",height:`${g.getTotalSize()}px`},ref:a=>{if(a){if(typeof process<"u"&&RU.JEST_WORKER_ID!==void 0||s.activationTrigger===0)return;s.activeOptionIndex!==null&&s.virtual.options.length>s.activeOptionIndex&&g.scrollToIndex(s.activeOptionIndex)}}},g.getVirtualItems().map(a=>{var P;return An.createElement(Q.Fragment,{key:a.key},An.cloneElement((P=e.children)==null?void 0:P.call(e,{option:s.virtual.options[a.index],open:s.comboboxState===0}),{key:`${x}-${a.key}`,"data-index":a.index,"aria-setsize":s.virtual.options.length,"aria-posinset":a.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${a.start}px)`,overflowAnchor:"none"}}))})))}let $w=Q.createContext(null);$w.displayName="ComboboxDataContext";function Zc(e){let n=Q.useContext($w);if(n===null){let s=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Zc),s}return n}function VU(e,n){return Ri(n.type,NU,e,n)}let $U=Q.Fragment;function GU(e,n){let{value:s,defaultValue:l,onChange:d,form:g,name:x,by:E=null,disabled:a=!1,__demoMode:P=!1,nullable:A=!1,multiple:R=!1,immediate:F=!1,virtual:j=null,...Z}=e,se=!1,ve=null,[X=R?[]:void 0,H]=lU(s,d,l),[Y,fe]=Q.useReducer(VU,{dataRef:Q.createRef(),comboboxState:P?0:1,options:[],virtual:null,activeOptionIndex:null,activationTrigger:2,labelId:null}),Ce=Q.useRef(!1),Ue=Q.useRef({static:!1,hold:!1}),Ge=Q.useRef(null),je=Q.useRef(null),nt=Q.useRef(null),Te=Q.useRef(null),mt=sn(typeof E=="string"?($t,Qt)=>{let Sn=E;return($t==null?void 0:$t[Sn])===(Qt==null?void 0:Qt[Sn])}:E??(($t,Qt)=>$t===Qt)),Dt=sn($t=>Y.options.findIndex(Qt=>mt(Qt.dataRef.current.value,$t))),xt=Q.useCallback($t=>Ri(lt.mode,{1:()=>X.some(Qt=>mt(Qt,$t)),0:()=>mt(X,$t)}),[X]),kt=sn($t=>Y.activeOptionIndex===Dt($t)),lt=Q.useMemo(()=>({...Y,immediate:se,optionsPropsRef:Ue,labelRef:Ge,inputRef:je,buttonRef:nt,optionsRef:Te,value:X,defaultValue:l,disabled:a,mode:R?1:0,virtual:Y.virtual,get activeOptionIndex(){if(Ce.current&&Y.activeOptionIndex===null&&Y.options.length>0){let $t=Y.options.findIndex(Qt=>!Qt.dataRef.current.disabled);if($t!==-1)return $t}return Y.activeOptionIndex},calculateIndex:Dt,compare:mt,isSelected:xt,isActive:kt,nullable:A,__demoMode:P}),[X,l,a,R,A,P,Y,ve]);Cr(()=>{},[ve,void 0]),Cr(()=>{Y.dataRef.current=lt},[lt]),xU([lt.buttonRef,lt.inputRef,lt.optionsRef],()=>pr.closeCombobox(),lt.comboboxState===0);let It=Q.useMemo(()=>{var $t,Qt,Sn;return{open:lt.comboboxState===0,disabled:a,activeIndex:lt.activeOptionIndex,activeOption:lt.activeOptionIndex===null?null:lt.virtual?lt.virtual.options[($t=lt.activeOptionIndex)!=null?$t:0]:(Sn=(Qt=lt.options[lt.activeOptionIndex])==null?void 0:Qt.dataRef.current.value)!=null?Sn:null,value:X}},[lt,a,X]),Kt=sn(()=>{if(lt.activeOptionIndex!==null){if(lt.virtual)ur(lt.virtual.options[lt.activeOptionIndex]);else{let{dataRef:$t}=lt.options[lt.activeOptionIndex];ur($t.current.value)}pr.goToOption(Ar.Specific,lt.activeOptionIndex)}}),st=sn(()=>{fe({type:0}),Ce.current=!0}),He=sn(()=>{fe({type:1}),Ce.current=!1}),bt=sn(($t,Qt,Sn)=>(Ce.current=!1,$t===Ar.Specific?fe({type:2,focus:Ar.Specific,idx:Qt,trigger:Sn}):fe({type:2,focus:$t,trigger:Sn}))),yt=sn(($t,Qt)=>(fe({type:3,payload:{id:$t,dataRef:Qt}}),()=>{lt.isActive(Qt.current.value)&&(Ce.current=!0),fe({type:4,id:$t})})),Nt=sn($t=>(fe({type:5,id:$t}),()=>fe({type:5,id:null}))),ur=sn($t=>Ri(lt.mode,{0(){return H==null?void 0:H($t)},1(){let Qt=lt.value.slice(),Sn=Qt.findIndex(Vt=>mt(Vt,$t));return Sn===-1?Qt.push($t):Qt.splice(Sn,1),H==null?void 0:H(Qt)}})),ln=sn($t=>{fe({type:6,trigger:$t})}),pr=Q.useMemo(()=>({onChange:ur,registerOption:yt,registerLabel:Nt,goToOption:bt,closeCombobox:He,openCombobox:st,setActivationTrigger:ln,selectActiveOption:Kt}),[]),Wn=n===null?{}:{ref:n},Xn=Q.useRef(null),si=Bw();return Q.useEffect(()=>{Xn.current&&l!==void 0&&si.addEventListener(Xn.current,"reset",()=>{H==null||H(l)})},[Xn,H]),An.createElement(Vw.Provider,{value:pr},An.createElement($w.Provider,{value:lt},An.createElement(IU,{value:Ri(lt.comboboxState,{0:gp.Open,1:gp.Closed})},x!=null&&X!=null&&ZA({[x]:X}).map(([$t,Qt],Sn)=>An.createElement(Nw,{features:jw.Hidden,ref:Sn===0?Vt=>{var xo;Xn.current=(xo=Vt==null?void 0:Vt.closest("form"))!=null?xo:null}:void 0,...h1({key:$t,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:g,disabled:a,name:$t,value:Qt})})),_o({ourProps:Wn,theirProps:Z,slot:It,defaultTag:$U,name:"Combobox"}))))}let WU="input";function ZU(e,n){var s,l,d,g,x;let E=Wc(),{id:a=`headlessui-combobox-input-${E}`,onChange:P,displayValue:A,type:R="text",...F}=e,j=Zc("Combobox.Input"),Z=Mp("Combobox.Input"),se=ys(j.inputRef,n),ve=wU(j.inputRef),X=Q.useRef(!1),H=Bw(),Y=sn(()=>{Z.onChange(null),j.optionsRef.current&&(j.optionsRef.current.scrollTop=0),Z.goToOption(Ar.Nothing)}),fe=function(){var lt;return typeof A=="function"&&j.value!==void 0?(lt=A(j.value))!=null?lt:"":typeof j.value=="string"?j.value:""}();fP(([lt,It],[Kt,st])=>{if(X.current)return;let He=j.inputRef.current;He&&((st===0&&It===1||lt!==Kt)&&(He.value=lt),requestAnimationFrame(()=>{if(X.current||!He||(ve==null?void 0:ve.activeElement)!==He)return;let{selectionStart:bt,selectionEnd:yt}=He;Math.abs((yt??0)-(bt??0))===0&&bt===0&&He.setSelectionRange(He.value.length,He.value.length)}))},[fe,j.comboboxState,ve]),fP(([lt],[It])=>{if(lt===0&&It===1){if(X.current)return;let Kt=j.inputRef.current;if(!Kt)return;let st=Kt.value,{selectionStart:He,selectionEnd:bt,selectionDirection:yt}=Kt;Kt.value="",Kt.value=st,yt!==null?Kt.setSelectionRange(He,bt,yt):Kt.setSelectionRange(He,bt)}},[j.comboboxState]);let Ce=Q.useRef(!1),Ue=sn(()=>{Ce.current=!0}),Ge=sn(()=>{H.nextFrame(()=>{Ce.current=!1})}),je=sn(lt=>{switch(X.current=!0,lt.key){case or.Enter:if(X.current=!1,j.comboboxState!==0||Ce.current)return;if(lt.preventDefault(),lt.stopPropagation(),j.activeOptionIndex===null){Z.closeCombobox();return}Z.selectActiveOption(),j.mode===0&&Z.closeCombobox();break;case or.ArrowDown:return X.current=!1,lt.preventDefault(),lt.stopPropagation(),Ri(j.comboboxState,{0:()=>Z.goToOption(Ar.Next),1:()=>Z.openCombobox()});case or.ArrowUp:return X.current=!1,lt.preventDefault(),lt.stopPropagation(),Ri(j.comboboxState,{0:()=>Z.goToOption(Ar.Previous),1:()=>{Z.openCombobox(),H.nextFrame(()=>{j.value||Z.goToOption(Ar.Last)})}});case or.Home:if(lt.shiftKey)break;return X.current=!1,lt.preventDefault(),lt.stopPropagation(),Z.goToOption(Ar.First);case or.PageUp:return X.current=!1,lt.preventDefault(),lt.stopPropagation(),Z.goToOption(Ar.First);case or.End:if(lt.shiftKey)break;return X.current=!1,lt.preventDefault(),lt.stopPropagation(),Z.goToOption(Ar.Last);case or.PageDown:return X.current=!1,lt.preventDefault(),lt.stopPropagation(),Z.goToOption(Ar.Last);case or.Escape:return X.current=!1,j.comboboxState!==0?void 0:(lt.preventDefault(),j.optionsRef.current&&!j.optionsPropsRef.current.static&&lt.stopPropagation(),j.nullable&&j.mode===0&&j.value===null&&Y(),Z.closeCombobox());case or.Tab:if(X.current=!1,j.comboboxState!==0)return;j.mode===0&&j.activationTrigger!==1&&Z.selectActiveOption(),Z.closeCombobox();break}}),nt=sn(lt=>{P==null||P(lt),j.nullable&&j.mode===0&&lt.target.value===""&&Y(),Z.openCombobox()}),Te=sn(lt=>{var It,Kt,st;let He=(It=lt.relatedTarget)!=null?It:xc.find(bt=>bt!==lt.currentTarget);if(X.current=!1,!((Kt=j.optionsRef.current)!=null&&Kt.contains(He))&&!((st=j.buttonRef.current)!=null&&st.contains(He))&&j.comboboxState===0)return lt.preventDefault(),j.mode===0&&(j.nullable&&j.value===null?Y():j.activationTrigger!==1&&Z.selectActiveOption()),Z.closeCombobox()}),mt=sn(lt=>{var It,Kt,st;let He=(It=lt.relatedTarget)!=null?It:xc.find(bt=>bt!==lt.currentTarget);(Kt=j.buttonRef.current)!=null&&Kt.contains(He)||(st=j.optionsRef.current)!=null&&st.contains(He)||j.disabled||j.immediate&&j.comboboxState!==0&&(Z.openCombobox(),H.nextFrame(()=>{Z.setActivationTrigger(1)}))}),Dt=Fw(()=>{if(j.labelId)return[j.labelId].join(" ")},[j.labelId]),xt=Q.useMemo(()=>({open:j.comboboxState===0,disabled:j.disabled}),[j]),kt={ref:se,id:a,role:"combobox",type:R,"aria-controls":(s=j.optionsRef.current)==null?void 0:s.id,"aria-expanded":j.comboboxState===0,"aria-activedescendant":j.activeOptionIndex===null?void 0:j.virtual?(l=j.options.find(lt=>{var It;return!((It=j.virtual)!=null&&It.disabled(lt.dataRef.current.value))&&j.compare(lt.dataRef.current.value,j.virtual.options[j.activeOptionIndex])}))==null?void 0:l.id:(d=j.options[j.activeOptionIndex])==null?void 0:d.id,"aria-labelledby":Dt,"aria-autocomplete":"list",defaultValue:(x=(g=e.defaultValue)!=null?g:j.defaultValue!==void 0?A==null?void 0:A(j.defaultValue):null)!=null?x:j.defaultValue,disabled:j.disabled,onCompositionStart:Ue,onCompositionEnd:Ge,onKeyDown:je,onChange:nt,onFocus:mt,onBlur:Te};return _o({ourProps:kt,theirProps:F,slot:xt,defaultTag:WU,name:"Combobox.Input"})}let qU="button";function HU(e,n){var s;let l=Zc("Combobox.Button"),d=Mp("Combobox.Button"),g=ys(l.buttonRef,n),x=Wc(),{id:E=`headlessui-combobox-button-${x}`,...a}=e,P=Bw(),A=sn(se=>{switch(se.key){case or.ArrowDown:return se.preventDefault(),se.stopPropagation(),l.comboboxState===1&&d.openCombobox(),P.nextFrame(()=>{var ve;return(ve=l.inputRef.current)==null?void 0:ve.focus({preventScroll:!0})});case or.ArrowUp:return se.preventDefault(),se.stopPropagation(),l.comboboxState===1&&(d.openCombobox(),P.nextFrame(()=>{l.value||d.goToOption(Ar.Last)})),P.nextFrame(()=>{var ve;return(ve=l.inputRef.current)==null?void 0:ve.focus({preventScroll:!0})});case or.Escape:return l.comboboxState!==0?void 0:(se.preventDefault(),l.optionsRef.current&&!l.optionsPropsRef.current.static&&se.stopPropagation(),d.closeCombobox(),P.nextFrame(()=>{var ve;return(ve=l.inputRef.current)==null?void 0:ve.focus({preventScroll:!0})}));default:return}}),R=sn(se=>{if(DU(se.currentTarget))return se.preventDefault();l.comboboxState===0?d.closeCombobox():(se.preventDefault(),d.openCombobox()),P.nextFrame(()=>{var ve;return(ve=l.inputRef.current)==null?void 0:ve.focus({preventScroll:!0})})}),F=Fw(()=>{if(l.labelId)return[l.labelId,E].join(" ")},[l.labelId,E]),j=Q.useMemo(()=>({open:l.comboboxState===0,disabled:l.disabled,value:l.value}),[l]),Z={ref:g,id:E,type:GA(e,l.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(s=l.optionsRef.current)==null?void 0:s.id,"aria-expanded":l.comboboxState===0,"aria-labelledby":F,disabled:l.disabled,onClick:R,onKeyDown:A};return _o({ourProps:Z,theirProps:a,slot:j,defaultTag:qU,name:"Combobox.Button"})}let XU="label";function KU(e,n){let s=Wc(),{id:l=`headlessui-combobox-label-${s}`,...d}=e,g=Zc("Combobox.Label"),x=Mp("Combobox.Label"),E=ys(g.labelRef,n);Cr(()=>x.registerLabel(l),[l]);let a=sn(()=>{var A;return(A=g.inputRef.current)==null?void 0:A.focus({preventScroll:!0})}),P=Q.useMemo(()=>({open:g.comboboxState===0,disabled:g.disabled}),[g]);return _o({ourProps:{ref:E,id:l,onClick:a},theirProps:d,slot:P,defaultTag:XU,name:"Combobox.Label"})}let YU="ul",JU=mp.RenderStrategy|mp.Static;function QU(e,n){let s=Wc(),{id:l=`headlessui-combobox-options-${s}`,hold:d=!1,...g}=e,x=Zc("Combobox.Options"),E=ys(x.optionsRef,n),a=kU(),P=a!==null?(a&gp.Open)===gp.Open:x.comboboxState===0;Cr(()=>{var j;x.optionsPropsRef.current.static=(j=e.static)!=null?j:!1},[x.optionsPropsRef,e.static]),Cr(()=>{x.optionsPropsRef.current.hold=d},[x.optionsPropsRef,d]),EU({container:x.optionsRef.current,enabled:x.comboboxState===0,accept(j){return j.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:j.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(j){j.setAttribute("role","none")}});let A=Fw(()=>{var j,Z;return(Z=x.labelId)!=null?Z:(j=x.buttonRef.current)==null?void 0:j.id},[x.labelId,x.buttonRef.current]),R=Q.useMemo(()=>({open:x.comboboxState===0,option:void 0}),[x]),F={"aria-labelledby":A,role:"listbox","aria-multiselectable":x.mode===1?!0:void 0,id:l,ref:E};return x.virtual&&x.comboboxState===0&&Object.assign(g,{children:An.createElement(UU,null,g.children)}),_o({ourProps:F,theirProps:g,slot:R,defaultTag:YU,features:JU,visible:P,name:"Combobox.Options"})}let eV="li";function tV(e,n){var s;let l=Wc(),{id:d=`headlessui-combobox-option-${l}`,disabled:g=!1,value:x,order:E=null,...a}=e,P=Zc("Combobox.Option"),A=Mp("Combobox.Option"),R=P.virtual?P.activeOptionIndex===P.calculateIndex(x):P.activeOptionIndex===null?!1:((s=P.options[P.activeOptionIndex])==null?void 0:s.id)===d,F=P.isSelected(x),j=Q.useRef(null),Z=Hs({disabled:g,value:x,domRef:j,order:E}),se=Q.useContext(XA),ve=ys(n,j,se?se.measureElement:null),X=sn(()=>A.onChange(x));Cr(()=>A.registerOption(d,Z),[Z,d]);let H=Q.useRef(!(P.virtual||P.__demoMode));Cr(()=>{if(!P.virtual||!P.__demoMode)return;let Te=Dy();return Te.requestAnimationFrame(()=>{H.current=!0}),Te.dispose},[P.virtual,P.__demoMode]),Cr(()=>{if(!H.current||P.comboboxState!==0||!R||P.activationTrigger===0)return;let Te=Dy();return Te.requestAnimationFrame(()=>{var mt,Dt;(Dt=(mt=j.current)==null?void 0:mt.scrollIntoView)==null||Dt.call(mt,{block:"nearest"})}),Te.dispose},[j,R,P.comboboxState,P.activationTrigger,P.activeOptionIndex]);let Y=sn(Te=>{var mt;if(g||(mt=P.virtual)!=null&&mt.disabled(x))return Te.preventDefault();X(),$A()||requestAnimationFrame(()=>{var Dt;return(Dt=P.inputRef.current)==null?void 0:Dt.focus({preventScroll:!0})}),P.mode===0&&requestAnimationFrame(()=>A.closeCombobox())}),fe=sn(()=>{var Te;if(g||(Te=P.virtual)!=null&&Te.disabled(x))return A.goToOption(Ar.Nothing);let mt=P.calculateIndex(x);A.goToOption(Ar.Specific,mt)}),Ce=TU(),Ue=sn(Te=>Ce.update(Te)),Ge=sn(Te=>{var mt;if(!Ce.wasMoved(Te)||g||(mt=P.virtual)!=null&&mt.disabled(x)||R)return;let Dt=P.calculateIndex(x);A.goToOption(Ar.Specific,Dt,0)}),je=sn(Te=>{var mt;Ce.wasMoved(Te)&&(g||(mt=P.virtual)!=null&&mt.disabled(x)||R&&(P.optionsPropsRef.current.hold||A.goToOption(Ar.Nothing)))}),nt=Q.useMemo(()=>({active:R,selected:F,disabled:g}),[R,F,g]);return _o({ourProps:{id:d,ref:ve,role:"option",tabIndex:g===!0?void 0:-1,"aria-disabled":g===!0?!0:void 0,"aria-selected":F,disabled:void 0,onClick:Y,onFocus:fe,onPointerEnter:Ue,onMouseEnter:Ue,onPointerMove:Ge,onMouseMove:Ge,onPointerLeave:je,onMouseLeave:je},theirProps:a,slot:nt,defaultTag:eV,name:"Combobox.Option"})}let nV=vo(GU),rV=vo(HU),iV=vo(ZU),oV=vo(KU),sV=vo(QU),aV=vo(tV),Sg=Object.assign(nV,{Input:iV,Button:rV,Label:oV,Options:sV,Option:aV});function lV(){let e=Q.useRef(!1);return Cr(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function cV({onFocus:e}){let[n,s]=Q.useState(!0),l=lV();return n?An.createElement(Nw,{as:"button",type:"button",features:jw.Focusable,onFocus:d=>{d.preventDefault();let g,x=50;function E(){if(x--<=0){g&&cancelAnimationFrame(g);return}if(e()){if(cancelAnimationFrame(g),!l.current)return;s(!1);return}g=requestAnimationFrame(E)}g=requestAnimationFrame(E)}}):null}const KA=Q.createContext(null);function uV(){return{groups:new Map,get(e,n){var s;let l=this.groups.get(e);l||(l=new Map,this.groups.set(e,l));let d=(s=l.get(n))!=null?s:0;l.set(n,d+1);let g=Array.from(l.keys()).indexOf(n);function x(){let E=l.get(n);E>1?l.set(n,E-1):l.delete(n)}return[g,x]}}}function hV({children:e}){let n=Q.useRef(uV());return Q.createElement(KA.Provider,{value:n},e)}function YA(e){let n=Q.useContext(KA);if(!n)throw new Error("You must wrap your component in a <StableCollection>");let s=dV(),[l,d]=n.current.get(e,s);return Q.useEffect(()=>d,[]),l}function dV(){var e,n,s;let l=(s=(n=(e=Q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)==null?void 0:e.ReactCurrentOwner)==null?void 0:n.current)!=null?s:null;if(!l)return Symbol();let d=[],g=l;for(;g;)d.push(g.index),g=g.return;return"$."+d.join(".")}var fV=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(fV||{}),pV=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(pV||{}),mV=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(mV||{});let gV={0(e,n){var s;let l=Mc(e.tabs,A=>A.current),d=Mc(e.panels,A=>A.current),g=l.filter(A=>{var R;return!((R=A.current)!=null&&R.hasAttribute("disabled"))}),x={...e,tabs:l,panels:d};if(n.index<0||n.index>l.length-1){let A=Ri(Math.sign(n.index-e.selectedIndex),{[-1]:()=>1,0:()=>Ri(Math.sign(n.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(g.length===0)return x;let R=Ri(A,{0:()=>l.indexOf(g[0]),1:()=>l.indexOf(g[g.length-1])});return{...x,selectedIndex:R===-1?e.selectedIndex:R}}let E=l.slice(0,n.index),a=[...l.slice(n.index),...E].find(A=>g.includes(A));if(!a)return x;let P=(s=l.indexOf(a))!=null?s:e.selectedIndex;return P===-1&&(P=e.selectedIndex),{...x,selectedIndex:P}},1(e,n){if(e.tabs.includes(n.tab))return e;let s=e.tabs[e.selectedIndex],l=Mc([...e.tabs,n.tab],g=>g.current),d=e.selectedIndex;return e.info.current.isControlled||(d=l.indexOf(s),d===-1&&(d=e.selectedIndex)),{...e,tabs:l,selectedIndex:d}},2(e,n){return{...e,tabs:e.tabs.filter(s=>s!==n.tab)}},3(e,n){return e.panels.includes(n.panel)?e:{...e,panels:Mc([...e.panels,n.panel],s=>s.current)}},4(e,n){return{...e,panels:e.panels.filter(s=>s!==n.panel)}}},Gw=Q.createContext(null);Gw.displayName="TabsDataContext";function Dh(e){let n=Q.useContext(Gw);if(n===null){let s=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Dh),s}return n}let Ww=Q.createContext(null);Ww.displayName="TabsActionsContext";function Zw(e){let n=Q.useContext(Ww);if(n===null){let s=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Zw),s}return n}function yV(e,n){return Ri(n.type,gV,e,n)}let _V=Q.Fragment;function vV(e,n){let{defaultIndex:s=0,vertical:l=!1,manual:d=!1,onChange:g,selectedIndex:x=null,...E}=e;const a=l?"vertical":"horizontal",P=d?"manual":"auto";let A=x!==null,R=Hs({isControlled:A}),F=ys(n),[j,Z]=Q.useReducer(yV,{info:R,selectedIndex:x??s,tabs:[],panels:[]}),se=Q.useMemo(()=>({selectedIndex:j.selectedIndex}),[j.selectedIndex]),ve=Hs(g||(()=>{})),X=Hs(j.tabs),H=Q.useMemo(()=>({orientation:a,activation:P,...j}),[a,P,j]),Y=sn(nt=>(Z({type:1,tab:nt}),()=>Z({type:2,tab:nt}))),fe=sn(nt=>(Z({type:3,panel:nt}),()=>Z({type:4,panel:nt}))),Ce=sn(nt=>{Ue.current!==nt&&ve.current(nt),A||Z({type:0,index:nt})}),Ue=Hs(A?e.selectedIndex:j.selectedIndex),Ge=Q.useMemo(()=>({registerTab:Y,registerPanel:fe,change:Ce}),[]);Cr(()=>{Z({type:0,index:x??s})},[x]),Cr(()=>{if(Ue.current===void 0||j.tabs.length<=0)return;let nt=Mc(j.tabs,Te=>Te.current);nt.some((Te,mt)=>j.tabs[mt]!==Te)&&Ce(nt.indexOf(j.tabs[Ue.current]))});let je={ref:F};return An.createElement(hV,null,An.createElement(Ww.Provider,{value:Ge},An.createElement(Gw.Provider,{value:H},H.tabs.length<=0&&An.createElement(cV,{onFocus:()=>{var nt,Te;for(let mt of X.current)if(((nt=mt.current)==null?void 0:nt.tabIndex)===0)return(Te=mt.current)==null||Te.focus(),!0;return!1}}),_o({ourProps:je,theirProps:E,slot:se,defaultTag:_V,name:"Tabs"}))))}let xV="div";function wV(e,n){let{orientation:s,selectedIndex:l}=Dh("Tab.List"),d=ys(n);return _o({ourProps:{ref:d,role:"tablist","aria-orientation":s},theirProps:e,slot:{selectedIndex:l},defaultTag:xV,name:"Tabs.List"})}let bV="button";function TV(e,n){var s,l;let d=Wc(),{id:g=`headlessui-tabs-tab-${d}`,...x}=e,{orientation:E,activation:a,selectedIndex:P,tabs:A,panels:R}=Dh("Tab"),F=Zw("Tab"),j=Dh("Tab"),Z=Q.useRef(null),se=ys(Z,n);Cr(()=>F.registerTab(Z),[F,Z]);let ve=YA("tabs"),X=A.indexOf(Z);X===-1&&(X=ve);let H=X===P,Y=sn(Te=>{var mt;let Dt=Te();if(Dt===Lf.Success&&a==="auto"){let xt=(mt=d_(Z))==null?void 0:mt.activeElement,kt=j.tabs.findIndex(lt=>lt.current===xt);kt!==-1&&F.change(kt)}return Dt}),fe=sn(Te=>{let mt=A.map(Dt=>Dt.current).filter(Boolean);if(Te.key===or.Space||Te.key===or.Enter){Te.preventDefault(),Te.stopPropagation(),F.change(X);return}switch(Te.key){case or.Home:case or.PageUp:return Te.preventDefault(),Te.stopPropagation(),Y(()=>Ju(mt,$o.First));case or.End:case or.PageDown:return Te.preventDefault(),Te.stopPropagation(),Y(()=>Ju(mt,$o.Last))}if(Y(()=>Ri(E,{vertical(){return Te.key===or.ArrowUp?Ju(mt,$o.Previous|$o.WrapAround):Te.key===or.ArrowDown?Ju(mt,$o.Next|$o.WrapAround):Lf.Error},horizontal(){return Te.key===or.ArrowLeft?Ju(mt,$o.Previous|$o.WrapAround):Te.key===or.ArrowRight?Ju(mt,$o.Next|$o.WrapAround):Lf.Error}}))===Lf.Success)return Te.preventDefault()}),Ce=Q.useRef(!1),Ue=sn(()=>{var Te;Ce.current||(Ce.current=!0,(Te=Z.current)==null||Te.focus({preventScroll:!0}),F.change(X),UA(()=>{Ce.current=!1}))}),Ge=sn(Te=>{Te.preventDefault()}),je=Q.useMemo(()=>{var Te;return{selected:H,disabled:(Te=e.disabled)!=null?Te:!1}},[H,e.disabled]),nt={ref:se,onKeyDown:fe,onMouseDown:Ge,onClick:Ue,id:g,role:"tab",type:GA(e,Z),"aria-controls":(l=(s=R[X])==null?void 0:s.current)==null?void 0:l.id,"aria-selected":H,tabIndex:H?0:-1};return _o({ourProps:nt,theirProps:x,slot:je,defaultTag:bV,name:"Tabs.Tab"})}let EV="div";function SV(e,n){let{selectedIndex:s}=Dh("Tab.Panels"),l=ys(n),d=Q.useMemo(()=>({selectedIndex:s}),[s]);return _o({ourProps:{ref:l},theirProps:e,slot:d,defaultTag:EV,name:"Tabs.Panels"})}let CV="div",PV=mp.RenderStrategy|mp.Static;function MV(e,n){var s,l,d,g;let x=Wc(),{id:E=`headlessui-tabs-panel-${x}`,tabIndex:a=0,...P}=e,{selectedIndex:A,tabs:R,panels:F}=Dh("Tab.Panel"),j=Zw("Tab.Panel"),Z=Q.useRef(null),se=ys(Z,n);Cr(()=>j.registerPanel(Z),[j,Z,E]);let ve=YA("panels"),X=F.indexOf(Z);X===-1&&(X=ve);let H=X===A,Y=Q.useMemo(()=>({selected:H}),[H]),fe={ref:se,id:E,role:"tabpanel","aria-labelledby":(l=(s=R[X])==null?void 0:s.current)==null?void 0:l.id,tabIndex:H?a:-1};return!H&&((d=P.unmount)==null||d)&&!((g=P.static)!=null&&g)?An.createElement(Nw,{as:"span","aria-hidden":"true",...fe}):_o({ourProps:fe,theirProps:P,slot:Y,defaultTag:CV,features:PV,visible:H,name:"Tabs.Panel"})}let kV=vo(TV),IV=vo(vV),AV=vo(wV),DV=vo(SV),LV=vo(MV),Pn=Object.assign(kV,{Group:IV,List:AV,Panels:DV,Panel:LV});const gP=["Home Cleaning","Plumbing","Electrician","AC Repair","Car Service","Computer Repair","Moving Service","Beauty Service"];function zV({className:e=""}){const n=Uk(),[s,l]=Q.useState(""),[d,g]=Q.useState(""),[x,E]=Q.useState(""),a=d===""?gP:gP.filter(A=>A.toLowerCase().includes(d.toLowerCase())),P=A=>{A.preventDefault(),s&&n(`/services/${s.toLowerCase().replace(" ","-")}`)};return ee.jsx("form",{onSubmit:P,className:`${e}`,children:ee.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-white p-3 rounded-lg shadow-lg",children:[ee.jsxs("div",{className:"flex-1 flex items-center border-b md:border-b-0 md:border-r border-gray-200 p-2",children:[ee.jsx(P6,{className:"w-5 h-5 text-gray-400 mr-2"}),ee.jsxs(Sg,{value:s,onChange:l,children:[ee.jsx(Sg.Input,{onChange:A=>g(A.target.value),placeholder:"What service do you need?",className:"w-full focus:outline-none text-gray-700"}),ee.jsx(Sg.Options,{className:"absolute mt-2 max-h-60 w-full overflow-auto rounded-md bg-white py-1 shadow-lg",children:a.map(A=>ee.jsx(Sg.Option,{value:A,className:({active:R})=>`relative cursor-pointer select-none py-2 px-4 ${R?"bg-blue-600 text-white":"text-gray-900"}`,children:A},A))})]})]}),ee.jsxs("div",{className:"flex-1 flex items-center p-2",children:[ee.jsx(Ow,{className:"w-5 h-5 text-gray-400 mr-2"}),ee.jsx("input",{type:"text",placeholder:"Enter your location",className:"w-full focus:outline-none text-gray-700",value:x,onChange:A=>E(A.target.value)})]}),ee.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-8 py-3 rounded-md hover:bg-blue-700 transition-colors font-medium",children:"Search"})]})})}function RV(){return ee.jsxs("section",{className:"relative h-[600px] flex items-center justify-center overflow-hidden",children:[ee.jsxs("div",{className:"absolute inset-0",children:[ee.jsx("img",{src:"https://images.unsplash.com/photo-1521737711867-e3b97375f902?w=1920",alt:"Hero background",className:"w-full h-full object-cover"}),ee.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/80 to-purple-900/80"})]}),ee.jsx("div",{className:"relative container mx-auto px-6 text-center text-white",children:ee.jsxs(cl.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:[ee.jsx("h1",{className:"text-5xl md:text-6xl font-bold mb-6",children:"Your One-Stop Service Solution"}),ee.jsx("p",{className:"text-xl md:text-2xl mb-12 max-w-2xl mx-auto",children:"Find trusted professionals for all your service needs"}),ee.jsx(zV,{className:"max-w-3xl mx-auto"})]})})]})}const OV=[{id:"home-services",name:"Home Services",icon:S6,description:"Cleaning, Plumbing, Electrician",color:"bg-blue-100 text-blue-600"},{id:"repairs",name:"Repairs",icon:G6,description:"Appliances, Electronics, Gadgets",color:"bg-green-100 text-green-600"},{id:"transport",name:"Transport",icon:N6,description:"Moving, Delivery, Logistics",color:"bg-yellow-100 text-yellow-600"},{id:"tech",name:"Tech Support",icon:y6,description:"Computer, Network, IT Services",color:"bg-purple-100 text-purple-600"},{id:"home-improvement",name:"Home Improvement",icon:I6,description:"Painting, Renovation, Design",color:"bg-pink-100 text-pink-600"},{id:"health",name:"Health & Wellness",icon:T6,description:"Fitness, Spa, Healthcare",color:"bg-red-100 text-red-600"},{id:"beauty",name:"Beauty",icon:O6,description:"Salon, Makeup, Grooming",color:"bg-indigo-100 text-indigo-600"},{id:"security",name:"Security",icon:z6,description:"Guards, CCTV, Access Control",color:"bg-gray-100 text-gray-600"}];function FV(){return ee.jsx("section",{className:"py-20 bg-gray-50",children:ee.jsxs("div",{className:"container mx-auto px-6",children:[ee.jsx("h2",{className:"text-3xl font-bold text-center mb-4",children:"Our Services"}),ee.jsx("p",{className:"text-gray-600 text-center mb-12",children:"Choose from our wide range of professional services"}),ee.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:OV.map(e=>ee.jsx(cl.div,{whileHover:{y:-5},className:"group",children:ee.jsxs(Bg,{to:`/services/${e.id}`,className:"block bg-white rounded-lg shadow-md p-6 transition-all duration-300",children:[ee.jsx("div",{className:`w-12 h-12 ${e.color} rounded-lg flex items-center justify-center mb-4`,children:ee.jsx(e.icon,{className:"w-6 h-6"})}),ee.jsx("h3",{className:"text-xl font-semibold mb-2 group-hover:text-blue-600",children:e.name}),ee.jsx("p",{className:"text-gray-600 text-sm",children:e.description})]})},e.id))})]})})}function BV({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z",clipRule:"evenodd"}))}const jV=Q.forwardRef(BV);function NV({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{fillRule:"evenodd",d:"m11.54 22.351.07.04.028.016a.76.76 0 0 0 .723 0l.028-.015.071-.041a16.975 16.975 0 0 0 1.144-.742 19.58 19.58 0 0 0 2.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 0 0-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 0 0 2.682 2.282 16.975 16.975 0 0 0 1.145.742ZM12 13.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",clipRule:"evenodd"}))}const UV=Q.forwardRef(NV);function VV({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{fillRule:"evenodd",d:"M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5Z",clipRule:"evenodd"}))}const $V=Q.forwardRef(VV);function GV({title:e,titleId:n,...s},l){return Q.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},s),e?Q.createElement("title",{id:n},e):null,Q.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const qw=Q.forwardRef(GV),WV=[{name:"Tech Solutions Hub",type:"Computer Service",rating:4.8,experience:"10+ years",image:"https://images.unsplash.com/photo-1531482615713-2afd69097998?w=500",location:"Downtown Tech District"},{name:"AutoCare Express",type:"Auto Service",rating:4.9,experience:"15+ years",image:"https://images.unsplash.com/photo-1632823471565-1ecdf5c6da05?w=500",location:"Central Auto Zone"},{name:"BikeWorks Pro",type:"Bike Service",rating:4.7,experience:"8+ years",image:"https://images.unsplash.com/photo-1523740856324-f2ce89135981?w=500",location:"Bike Valley"}];function ZV(){return ee.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:WV.map((e,n)=>ee.jsxs(cl.div,{whileHover:{y:-5},className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[ee.jsx("img",{src:e.image,alt:e.name,className:"w-full h-48 object-cover"}),ee.jsxs("div",{className:"p-6",children:[ee.jsx("h3",{className:"text-xl font-semibold mb-2",children:e.name}),ee.jsx("p",{className:"text-gray-600 mb-2",children:e.type}),ee.jsxs("div",{className:"flex items-center mb-2",children:[ee.jsx(qw,{className:"w-5 h-5 text-yellow-400"}),ee.jsx("span",{className:"ml-1",children:e.rating})]}),ee.jsxs("p",{className:"text-gray-600 mb-2",children:[ee.jsx("span",{className:"font-semibold",children:"Experience:"})," ",e.experience]}),ee.jsxs("p",{className:"text-gray-600",children:[ee.jsx("span",{className:"font-semibold",children:"Location:"})," ",e.location]})]})]},n))})}const qV=[{name:"Home Cleaning",price:"from $49",image:"https://images.unsplash.com/photo-1581578731548-c64695cc6952?w=500"},{name:"AC Repair",price:"from $39",image:"https://images.unsplash.com/photo-1581092918056-0c4c3acd3789?w=500"},{name:"Plumbing",price:"from $29",image:"https://images.unsplash.com/photo-1585704032915-c3400ca199e7?w=500"},{name:"Electrician",price:"from $35",image:"https://images.unsplash.com/photo-1621905251189-08b45d6a269e?w=500"}];function HV(){return ee.jsx("section",{className:"py-20",children:ee.jsxs("div",{className:"container mx-auto px-6",children:[ee.jsx("h2",{className:"text-3xl font-bold text-center mb-4",children:"Popular Services"}),ee.jsx("p",{className:"text-gray-600 text-center mb-12",children:"Most booked services in your area"}),ee.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:qV.map((e,n)=>ee.jsx(cl.div,{whileHover:{y:-5},className:"relative group cursor-pointer",children:ee.jsxs("div",{className:"relative h-48 rounded-lg overflow-hidden",children:[ee.jsx("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"}),ee.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),ee.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 text-white",children:[ee.jsx("h3",{className:"font-semibold",children:e.name}),ee.jsx("p",{className:"text-sm opacity-90",children:e.price})]})]})},n))})]})})}function XV(){return ee.jsxs("div",{children:[ee.jsx(RV,{}),ee.jsx(FV,{}),ee.jsx(HV,{}),ee.jsx("section",{className:"py-20",children:ee.jsxs("div",{className:"container mx-auto px-6",children:[ee.jsx("h2",{className:"text-3xl font-bold text-center mb-4",children:"Top Service Providers"}),ee.jsx("p",{className:"text-gray-600 text-center mb-12",children:"Trusted and verified professionals near you"}),ee.jsx(ZV,{})]})}),ee.jsx("section",{className:"bg-gradient-to-r from-blue-600 to-purple-600 py-20 text-white",children:ee.jsx("div",{className:"container mx-auto px-6",children:ee.jsxs("div",{className:"grid md:grid-cols-3 gap-12 text-center",children:[ee.jsxs(cl.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},children:[ee.jsx("h3",{className:"text-4xl font-bold mb-2",children:"500+"}),ee.jsx("p",{children:"Service Providers"})]}),ee.jsxs(cl.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.2},children:[ee.jsx("h3",{className:"text-4xl font-bold mb-2",children:"10k+"}),ee.jsx("p",{children:"Happy Customers"})]}),ee.jsxs(cl.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.4},children:[ee.jsx("h3",{className:"text-4xl font-bold mb-2",children:"4.8/5"}),ee.jsx("p",{children:"Average Rating"})]})]})})})]})}function KV(){return ee.jsx("div",{className:"py-20 bg-gray-50",children:ee.jsx("div",{className:"container mx-auto px-6",children:ee.jsxs(cl.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-lg mx-auto bg-white rounded-lg shadow-lg p-8",children:[ee.jsx("h1",{className:"text-3xl font-bold text-center mb-8",children:"Contact Us"}),ee.jsxs("form",{className:"space-y-6",children:[ee.jsxs("div",{children:[ee.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),ee.jsx("input",{type:"text",id:"name",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),ee.jsxs("div",{children:[ee.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),ee.jsx("input",{type:"email",id:"email",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),ee.jsxs("div",{children:[ee.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700",children:"Message"}),ee.jsx("textarea",{id:"message",rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),ee.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:"Send Message"})]})]})})})}function YV(){const{category:e}=Vk(),n=[{id:1,name:"Expert Tech Solutions",rating:4.8,reviews:156,image:"https://images.unsplash.com/photo-1531482615713-2afd69097998?w=500",address:"123 Tech Street, Downtown",phone:"+1 234-567-8900",hours:"Mon-Sat: 9AM-6PM",experience:"12 years",services:["Computer Repair","Virus Removal","Data Recovery"],prices:{"Basic Diagnostics":"$49","Virus Removal":"$89","Data Recovery":"from $129"}}];return ee.jsx("div",{className:"py-12 bg-gray-50",children:ee.jsxs("div",{className:"container mx-auto px-6",children:[ee.jsxs("h1",{className:"text-3xl font-bold mb-8 capitalize",children:[e.replace("-"," ")," Providers"]}),ee.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:n.map(s=>ee.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[ee.jsx("img",{src:s.image,alt:s.name,className:"w-full h-64 object-cover"}),ee.jsxs("div",{className:"p-6",children:[ee.jsx("h2",{className:"text-2xl font-bold mb-4",children:s.name}),ee.jsxs("div",{className:"space-y-4",children:[ee.jsxs("div",{className:"flex items-center",children:[ee.jsx(Ow,{className:"w-5 h-5 text-gray-400 mr-2"}),ee.jsx("span",{children:s.address})]}),ee.jsxs("div",{className:"flex items-center",children:[ee.jsx(D6,{className:"w-5 h-5 text-gray-400 mr-2"}),ee.jsx("span",{children:s.phone})]}),ee.jsxs("div",{className:"flex items-center",children:[ee.jsx(Rw,{className:"w-5 h-5 text-gray-400 mr-2"}),ee.jsx("span",{children:s.hours})]})]}),ee.jsxs("div",{className:"mt-6",children:[ee.jsx("h3",{className:"font-semibold mb-2",children:"Services & Prices:"}),ee.jsx("ul",{className:"space-y-2",children:Object.entries(s.prices).map(([l,d])=>ee.jsxs("li",{className:"flex justify-between",children:[ee.jsx("span",{children:l}),ee.jsx("span",{className:"font-semibold",children:d})]},l))})]})]})]},s.id))})]})})}var JA={exports:{}};(function(e,n){var s={};(function(l,d){e.exports=d()})(DL,function(){var l,d,g;function x(a,P){if(!l)l=P;else if(!d)d=P;else{var A="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+d+")(sharedChunk); self.onerror = null;",R={};l(R),g=P(R),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(g.workerUrl=window.URL.createObjectURL(new Blob([A],{type:"text/javascript"})))}}x(["exports"],function(a){var P=typeof self<"u"?self:{},A="2.15.0";let R;const F={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(R==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{R=s.API_URL_REGEX!=null?new RegExp(s.API_URL_REGEX):r}catch{R=r}}return R},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!F.API_URL)return null;try{const r=new URL(F.API_URL);return r.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":r.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},j={supported:!1,testSupport:function(r){!ve&&se&&(X?H(r):Z=r)}};let Z,se,ve=!1,X=!1;function H(r){const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,se),r.isContextLost())return;j.supported=!0}catch{}r.deleteTexture(t),ve=!0}P.document&&(se=P.document.createElement("img"),se.onload=function(){Z&&H(Z),Z=null,X=!0},se.onerror=function(){ve=!0,Z=null},se.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Y="01";function fe(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ce=Ue;function Ue(r,t,i,c){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(c-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=i,this.p2y=c}Ue.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var i=r,c=0;c<8;c++){var h=this.sampleCurveX(i)-r;if(Math.abs(h)<t)return i;var p=this.sampleCurveDerivativeX(i);if(Math.abs(p)<1e-6)break;i-=h/p}var y=0,v=1;for(i=r,c=0;c<20&&(h=this.sampleCurveX(i),!(Math.abs(h-r)<t));c++)r>h?y=i:v=i,i=.5*(v-y)+y;return i},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var Ge=fe(Ce),je=nt;function nt(r,t){this.x=r,this.y=t}nt.prototype={clone:function(){return new nt(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,i=r.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),i=Math.sin(r),c=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=c,this},_rotateAround:function(r,t){var i=Math.cos(r),c=Math.sin(r),h=t.y+c*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-c*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},nt.convert=function(r){return r instanceof nt?r:Array.isArray(r)?new nt(r[0],r[1]):r};var Te=fe(je);const mt=Math.PI/180,Dt=180/Math.PI;function xt(r){return r*mt}function kt(r){return r*Dt}const lt=[[0,0],[1,0],[1,1],[0,1]];function It(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,i=t*r;return 4*(r<.5?i:3*(r-t)+i-.75)}function Kt(r,t,i,c){const h=new Ge(r,t,i,c);return function(p){return h.solve(p)}}const st=Kt(.25,.1,.25,1);function He(r,t,i){return Math.min(i,Math.max(t,r))}function bt(r,t,i){return(i=He((i-r)/(t-r),0,1))*i*(3-2*i)}function yt(r,t,i){const c=i-t,h=((r-t)%c+c)%c+t;return h===t?i:h}function Nt(r,t,i){if(!r.length)return i(null,[]);let c=r.length;const h=new Array(r.length);let p=null;r.forEach((y,v)=>{t(y,(b,T)=>{b&&(p=b),h[v]=T,--c==0&&i(p,h)})})}function ur(r){const t=[];for(const i in r)t.push(r[i]);return t}function ln(r,...t){for(const i of t)for(const c in i)r[c]=i[c];return r}let pr=1;function Wn(){return pr++}function Xn(){return function r(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function si(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function $t(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function Qt(r,t){r.forEach(i=>{t[i]&&(t[i]=t[i].bind(t))})}function Sn(r,t){return r.indexOf(t,r.length-t.length)!==-1}function Vt(r,t,i){const c={};for(const h in r)c[h]=t.call(this,r[h],h,r);return c}function xo(r,t,i){const c={};for(const h in r)t.call(i||this,r[h],h,r)&&(c[h]=r[h]);return c}function ai(r){return Array.isArray(r)?r.map(ai):typeof r=="object"&&r?Vt(r,ai):r}const xl={};function Rn(r){xl[r]||(typeof console<"u"&&console.warn(r),xl[r]=!0)}function vi(r,t,i){return(i.y-r.y)*(t.x-r.x)>(t.y-r.y)*(i.x-r.x)}function qc(r){let t=0;for(let i,c,h=0,p=r.length,y=p-1;h<p;y=h++)i=r[h],c=r[y],t+=(c.x-i.x)*(i.y+c.y);return t}function wo(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function li(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,c,h,p)=>{const y=h||p;return t[c]=!y||y.toLowerCase(),""}),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}let wl=null;function oa(r){if(wl==null){const t=r.navigator?r.navigator.userAgent:null;wl=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return wl}function bl(r){try{const t=P[r];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ko(r,t){return[r[4*t],r[4*t+1],r[4*t+2],r[4*t+3]]}const sa="mapbox-tiles";let Hc=500,Xc=50,xi,Yo;function Tl(){try{return P.caches}catch{}}function vs(){Tl()&&!xi&&(xi=P.caches.open(sa))}function aa(r){const t=r.indexOf("?");if(t<0)return r;const i=function(h){const p=h.indexOf("?");return p>0?h.slice(p+1).split("&"):[]}(r),c=i.filter(h=>{const p=h.split("=");return p[0]==="language"||p[0]==="worldview"});return c.length?`${r.slice(0,t)}?${c.join("&")}`:r.slice(0,t)}let El=1/0;const xs={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(xs);class Jo extends Error{constructor(t,i,c){i===401&&Me(c)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=i,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ws=wo()?()=>self.worker&&self.worker.referrer:()=>(P.location.protocol==="blob:"?P.parent:P).location.href,bs=function(r,t){if(!(/^file:/.test(i=r.url)||/^file:/.test(ws())&&!/^\w+:/.test(i))){if(P.fetch&&P.Request&&P.AbortController&&P.Request.prototype.hasOwnProperty("signal"))return function(c,h){const p=new P.AbortController,y=new P.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:ws(),referrerPolicy:c.referrerPolicy,signal:p.signal});let v=!1,b=!1;const T=(M=y.url).indexOf("sku=")>0&&Me(M);var M;c.type==="json"&&y.headers.set("Accept","application/json");const I=(O,B,V)=>{if(b)return;if(O&&O.message!=="SecurityError"&&Rn(O.toString()),B&&V)return D(B);const q=Date.now();P.fetch(y).then(ie=>{if(ie.ok){const de=T?ie.clone():null;return D(ie,de,q)}return h(new Jo(ie.statusText,ie.status,c.url))}).catch(ie=>{ie.name!=="AbortError"&&h(new Error(`${ie.message} ${c.url}`))})},D=(O,B,V)=>{(c.type==="arrayBuffer"?O.arrayBuffer():c.type==="json"?O.json():O.text()).then(q=>{b||(B&&V&&function(ie,de,oe){if(vs(),!xi)return;const ue={status:de.status,statusText:de.statusText,headers:new P.Headers};de.headers.forEach((Le,Ie)=>ue.headers.set(Ie,Le));const me=li(de.headers.get("Cache-Control")||"");if(me["no-store"])return;me["max-age"]&&ue.headers.set("Expires",new Date(oe+1e3*me["max-age"]).toUTCString());const pe=ue.headers.get("Expires");pe&&(new Date(pe).getTime()-oe<42e4||function(Le,Ie){if(Yo===void 0)try{new Response(new ReadableStream),Yo=!0}catch{Yo=!1}Yo?Ie(Le.body):Le.blob().then(Ie)}(de,Le=>{const Ie=new P.Response(Le,ue);vs(),xi&&xi.then(Ne=>Ne.put(aa(ie.url),Ie)).catch(Ne=>Rn(Ne.message))}))}(y,B,V),v=!0,h(null,q,O.headers.get("Cache-Control"),O.headers.get("Expires")))}).catch(q=>{b||h(new Error(q.message))})};return T?function(O,B){if(vs(),!xi)return B(null);const V=aa(O.url);xi.then(q=>{q.match(V).then(ie=>{const de=function(oe){if(!oe)return!1;const ue=new Date(oe.headers.get("Expires")||0),me=li(oe.headers.get("Cache-Control")||"");return ue>Date.now()&&!me["no-cache"]}(ie);q.delete(V),de&&q.put(V,ie.clone()),B(null,ie,de)}).catch(B)}).catch(B)}(y,I):I(null,null),{cancel:()=>{b=!0,v||p.abort()}}}(r,t);if(wo()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,t,void 0,!0)}var i;return function(c,h){const p=new P.XMLHttpRequest;p.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const y in c.headers)p.setRequestHeader(y,c.headers[y]);return c.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=c.credentials==="include",p.onerror=()=>{h(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let y=p.response;if(c.type==="json")try{y=JSON.parse(p.response)}catch(v){return h(v)}h(null,y,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else h(new Jo(p.statusText,p.status,c.url))},p.send(c.body),{cancel:()=>p.abort()}}(r,t)},la=function(r,t){return bs(ln(r,{type:"arrayBuffer"}),t)};function Kc(r){const t=P.document.createElement("a");return t.href=r,t.protocol===P.document.location.protocol&&t.host===P.document.location.host}const he="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let $,G;$=[],G=0;const ce=function(r,t){if(j.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),G>=F.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:r,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return $.push(p),p}G++;let i=!1;const c=()=>{if(!i)for(i=!0,G--;$.length&&G<F.MAX_PARALLEL_IMAGE_REQUESTS;){const p=$.shift(),{requestParameters:y,callback:v,cancelled:b}=p;b||(p.cancel=ce(y,v).cancel)}},h=la(r,(p,y,v,b)=>{c(),p?t(p):y&&(P.createImageBitmap?function(T,M){const I=new P.Blob([new Uint8Array(T)],{type:"image/png"});P.createImageBitmap(I).then(D=>{M(null,D)}).catch(D=>{M(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(T,M)=>t(T,M,v,b)):function(T,M){const I=new P.Image,D=P.URL;I.onload=()=>{M(null,I),D.revokeObjectURL(I.src),I.onload=null,P.requestAnimationFrame(()=>{I.src=he})},I.onerror=()=>M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const O=new P.Blob([new Uint8Array(T)],{type:"image/png"});I.src=T.byteLength?D.createObjectURL(O):he}(y,(T,M)=>t(T,M,v,b)))});return{cancel:()=>{h.cancel(),c()}}},ge="NO_ACCESS_TOKEN";function be(r){return r.indexOf("mapbox:")===0}function Me(r){return F.API_URL_REGEX.test(r)}function Pe(r){return F.API_CDN_URL_REGEX.test(r)}function we(r){return F.API_STYLE_REGEX.test(r)&&!Oe(r)}function Oe(r){return F.API_SPRITE_REGEX.test(r)}const ot=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function at(r){const t=r.match(ot);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function tt(r){const t=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${t}`}const Ot="mapbox.eventData";function Gt(r){if(!r)return null;const t=r.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(P.atob(t[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ft{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const i=Gt(F.ACCESS_TOKEN);let c="";return c=i&&i.u?P.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(h,p)=>String.fromCharCode(+("0x"+p)))):F.ACCESS_TOKEN||"",t?`${Ot}.${t}:${c}`:`${Ot}:${c}`}fetchEventData(){const t=bl("localStorage"),i=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{const h=P.localStorage.getItem(i);h&&(this.eventData=JSON.parse(h));const p=P.localStorage.getItem(c);p&&(this.anonId=p)}catch{Rn("Unable to read from LocalStorage")}}saveEventData(){const t=bl("localStorage"),i=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{P.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&P.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{Rn("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,i,c,h){if(!F.EVENTS_URL)return;const p=at(F.EVENTS_URL);p.params.push(`access_token=${h||F.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(t).toISOString()},v=i?ln(y,i):y,b={url:tt(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=function(T,M){return bs(ln(T,{method:"POST"}),M)}(b,T=>{this.pendingRequest=null,c(T),this.saveEventData(),this.processRequests(h)})}queueRequest(t,i){this.queue.push(t),this.processRequests(i)}}const Wt=new class extends Ft{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,t){F.EVENTS_URL&&F.ACCESS_TOKEN&&Array.isArray(r)&&r.some(i=>be(i)||Me(i))&&this.queueRequest(Date.now(),t)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Gt(F.ACCESS_TOKEN),i=t?t.u:F.ACCESS_TOKEN;let c=i!==this.eventData.tokenU;$t(this.anonId)||(this.anonId=Xn(),c=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),y=new Date(h),v=(h-this.eventData.lastSuccess)/864e5;c=c||v>=1||v<-1||p.getDate()!==y.getDate()}else c=!0;c?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:A,skuId:Y,"enabled.telemetry":!1,userId:this.anonId},p=>{p||(this.eventData.lastSuccess=h,this.eventData.tokenU=i)},r):this.processRequests()}},Jt=Wt.postTurnstileEvent.bind(Wt),On=new class extends Ft{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,t,i,c){this.skuToken=t,this.errorCb=c,F.EVENTS_URL&&(i||F.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(ge)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),$t(this.anonId)||(this.anonId=Xn()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:A,skuId:Y,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},r))}},Kn=On.postMapLoadEvent.bind(On),Lr=new class extends Ft{constructor(){super("gljs.performance")}postPerformanceEvent(r,t){F.EVENTS_URL&&(r||F.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},r)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:i}=this.queue.shift(),c=function(h){const p=P.performance.getEntriesByType("resource"),y=P.performance.getEntriesByType("mark"),v=function(D){const O={};if(D){for(const B in D)if(B!=="other")for(const V of D[B]){const q=`${B}ResolveRangeMin`,ie=`${B}ResolveRangeMax`,de=`${B}RequestCount`,oe=`${B}RequestCachedCount`;O[q]=Math.min(O[q]||1/0,V.startTime),O[ie]=Math.max(O[ie]||-1/0,V.responseEnd);const ue=me=>{O[me]===void 0&&(O[me]=0),++O[me]};V.transferSize!==void 0&&V.transferSize===0&&ue(oe),ue(de)}}return O}(function(D,O){const B={};if(D)for(const V of D){const q=O(V);B[q]===void 0&&(B[q]=[]),B[q].push(V)}return B}(p,kp)),b=P.devicePixelRatio,T=P.navigator.connection||P.navigator.mozConnection||P.navigator.webkitConnection,M={counters:[],metadata:[],attributes:[]},I=(D,O,B)=>{B!=null&&D.push({name:O,value:B.toString()})};for(const D in v)I(M.counters,D,v[D]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(I(M.counters,"interactionRangeMin",h.interactionRange[0]),I(M.counters,"interactionRangeMax",h.interactionRange[1])),y)for(const D of Object.keys(ca)){const O=ca[D],B=y.find(V=>V.name===O);B&&I(M.counters,O,B.startTime)}return I(M.counters,"visibilityHidden",h.visibilityHidden),I(M.attributes,"style",function(D){if(D)for(const O of D){const B=O.name.split("?")[0];if(we(B)){const V=B.split("/").slice(-2);if(V.length===2)return`mapbox://styles/${V[0]}/${V[1]}`}}}(p)),I(M.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),I(M.attributes,"fogEnabled",h.fogEnabled?"true":"false"),I(M.attributes,"projection",h.projection),I(M.attributes,"zoom",h.zoom),I(M.metadata,"devicePixelRatio",b),I(M.metadata,"connectionEffectiveType",T?T.effectiveType:void 0),I(M.metadata,"navigatorUserAgent",P.navigator.userAgent),I(M.metadata,"screenWidth",P.screen.width),I(M.metadata,"screenHeight",P.screen.height),I(M.metadata,"windowWidth",P.innerWidth),I(M.metadata,"windowHeight",P.innerHeight),I(M.metadata,"mapWidth",h.width/b),I(M.metadata,"mapHeight",h.height/b),I(M.metadata,"webglRenderer",h.renderer),I(M.metadata,"webglVendor",h.vendor),I(M.metadata,"sdkVersion",A),I(M.metadata,"sdkIdentifier","mapbox-gl-js"),M}(i);for(const h of c.metadata);for(const h of c.counters);for(const h of c.attributes);this.postEvent(t,c,()=>{},r)}},hr=Lr.postPerformanceEvent.bind(Lr),Ji=new class extends Ft{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,t,i,c){if(!F.API_URL||!F.SESSION_PATH)return;const h=at(F.API_URL+F.SESSION_PATH);h.params.push(`sku=${t||""}`),h.params.push(`access_token=${c||F.ACCESS_TOKEN||""}`);const p={url:tt(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(y,v){return bs(ln(y,{method:"GET"}),v)}(p,y=>{this.pendingRequest=null,i(y),this.saveEventData(),this.processRequests(c)})}getSessionAPI(r,t,i,c){this.skuToken=t,this.errorCb=c,F.SESSION_PATH&&F.API_URL&&(i||F.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(ge)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||this.getSession(i,this.skuToken,c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},r)}},yr=Ji.getSessionAPI.bind(Ji),Ur=new Set,ca={create:"create",load:"load",fullLoad:"fullLoad"},p_={mark(r){P.performance.mark(r)},measure(r,t,i){P.performance.measure(r,t,i)}};function kp(r){const t=r.name.split("?")[0];return Pe(t)&&t.includes("mapbox-gl.js")?"javascript":Pe(t)&&t.includes("mapbox-gl.css")?"css":function(i){return F.API_FONTS_REGEX.test(i)}(t)?"fontRange":Oe(t)?"sprite":we(t)?"style":function(i){return F.API_TILEJSON_REGEX.test(i)}(t)?"tilejson":"other"}const cn=P.performance;function Fh(r){const t=r?r.url.toString():void 0;return cn.getEntriesByName(t)}let Sl,Bh,Yc,Qi;const bo={now:()=>Yc!==void 0?Yc:P.performance.now(),setNow(r){Yc=r},restoreNow(){Yc=void 0},frame(r){const t=P.requestAnimationFrame(r);return{cancel:()=>P.cancelAnimationFrame(t)}},getImageData(r,t=0){const{width:i,height:c}=r;Qi||(Qi=P.document.createElement("canvas"));const h=Qi.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(i>Qi.width||c>Qi.height)&&(Qi.width=i,Qi.height=c),h.clearRect(-t,-t,i+2*t,c+2*t),h.drawImage(r,0,0,i,c),h.getImageData(-t,-t,i+2*t,c+2*t)},resolveURL:r=>(Sl||(Sl=P.document.createElement("a")),Sl.href=r,Sl.href),get devicePixelRatio(){return P.devicePixelRatio},get prefersReducedMotion(){return!!P.matchMedia&&(Bh==null&&(Bh=P.matchMedia("(prefers-reduced-motion: reduce)")),Bh.matches)}};function jh(r,t,i){i[r]&&i[r].indexOf(t)!==-1||(i[r]=i[r]||[],i[r].push(t))}function Nh(r,t,i){if(i&&i[r]){const c=i[r].indexOf(t);c!==-1&&i[r].splice(c,1)}}class Ts{constructor(t,i={}){ln(this,i),this.type=t}}class To extends Ts{constructor(t,i={}){super("error",ln({error:t},i))}}class Cl{on(t,i){return this._listeners=this._listeners||{},jh(t,i,this._listeners),this}off(t,i){return Nh(t,i,this._listeners),Nh(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},jh(t,i,this._oneTimeListeners),this):new Promise(c=>this.once(t,c))}fire(t,i){typeof t=="string"&&(t=new Ts(t,i||{}));const c=t.type;if(this.listens(c)){t.target=this;const h=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const v of h)v.call(this,t);const p=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const v of p)Nh(c,v,this._oneTimeListeners),v.call(this,t);const y=this._eventedParent;y&&(ln(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof To&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}var Be=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Eo(r,...t){for(const i of t)for(const c in i)r[c]=i[c];return r}function Yn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function _r(r){if(Array.isArray(r))return r.map(_r);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const i in r)t[i]=_r(r[i]);return t}return Yn(r)}class Ip extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}var eo=Ip;class Uh{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[c,h]of i)this.bindings[c]=h}concat(t){return new Uh(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var Ap=Uh;const ua={kind:"null"},ft={kind:"number"},Yt={kind:"string"},qt={kind:"boolean"},ci={kind:"color"},Fi={kind:"object"},Ht={kind:"value"},ui={kind:"collator"},Pl={kind:"formatted"},Es={kind:"resolvedImage"};function wi(r,t){return{kind:"array",itemType:r,N:t}}function Ln(r){if(r.kind==="array"){const t=Ln(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const Dp=[ua,ft,Yt,qt,ci,Pl,Fi,wi(Ht),Es];function So(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!So(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const i of Dp)if(!So(i,t))return null}}return`Expected ${Ln(r)} but found ${Ln(t)} instead.`}function Ml(r,t){return t.some(i=>i.kind===r.kind)}function kl(r,t){return t.some(i=>i==="null"?r===null:i==="array"?Array.isArray(r):i==="object"?r&&!Array.isArray(r)&&typeof r=="object":i===typeof r)}var Vh,Lp={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Il(r){return(r=Math.round(r))<0?0:r>255?255:r}function Al(r){return Il(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function Jc(r){return(t=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:t>1?1:t;var t}function ha(r,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?r+(t-r)*i*6:2*i<1?t:3*i<2?r+(t-r)*(2/3-i)*6:r}try{Vh={}.parseCSSColor=function(r){var t,i=r.replace(/ /g,"").toLowerCase();if(i in Lp)return Lp[i].slice();if(i[0]==="#")return i.length===4?(t=parseInt(i.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:i.length===7&&(t=parseInt(i.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var c=i.indexOf("("),h=i.indexOf(")");if(c!==-1&&h+1===i.length){var p=i.substr(0,c),y=i.substr(c+1,h-(c+1)).split(","),v=1;switch(p){case"rgba":if(y.length!==4)return null;v=Jc(y.pop());case"rgb":return y.length!==3?null:[Al(y[0]),Al(y[1]),Al(y[2]),v];case"hsla":if(y.length!==4)return null;v=Jc(y.pop());case"hsl":if(y.length!==3)return null;var b=(parseFloat(y[0])%360+360)%360/360,T=Jc(y[1]),M=Jc(y[2]),I=M<=.5?M*(T+1):M+T-M*T,D=2*M-I;return[Il(255*ha(D,I,b+1/3)),Il(255*ha(D,I,b)),Il(255*ha(D,I,b-1/3)),v];default:return null}}return null}}catch{}class qr{constructor(t,i,c,h=1){this.r=t,this.g=i,this.b=c,this.a=h}static parse(t){if(!t)return;if(t instanceof qr)return t;if(typeof t!="string")return;const i=Vh(t);return i?new qr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[t,i,c,h]=this.toArray();return`rgba(${Math.round(t)},${Math.round(i)},${Math.round(c)},${h})`}toArray(){const{r:t,g:i,b:c,a:h}=this;return h===0?[0,0,0,0]:[255*t/h,255*i/h,255*c/h,h]}toArray01(){const{r:t,g:i,b:c,a:h}=this;return h===0?[0,0,0,0]:[t/h,i/h,c/h,h]}toArray01PremultipliedAlpha(){const{r:t,g:i,b:c,a:h}=this;return[t,i,c,h]}}qr.black=new qr(0,0,0,1),qr.white=new qr(1,1,1,1),qr.transparent=new qr(0,0,0,0),qr.red=new qr(1,0,0,1),qr.blue=new qr(0,0,1,1);var Zn=qr;class $h{constructor(t,i,c){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Gh{constructor(t,i,c,h,p){this.text=t.normalize?t.normalize():t,this.image=i,this.scale=c,this.fontStack=h,this.textColor=p}}class Hr{constructor(t){this.sections=t}static fromString(t){return new Hr([new Gh(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Hr?t:Hr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const i of this.sections){if(i.image){t.push(["image",i.image.name]);continue}t.push(i.text);const c={};i.fontStack&&(c["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(c["font-scale"]=i.scale),i.textColor&&(c["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(c)}return t}}class bi{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new bi({name:t,available:!1}):null}serialize(){return["image",this.name]}}function zp(r,t,i,c){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[r,t,i,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[r,t,i,c]:[r,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Dl(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Zn||r instanceof $h||r instanceof Hr||r instanceof bi)return!0;if(Array.isArray(r)){for(const t of r)if(!Dl(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Dl(r[t]))return!1;return!0}return!1}function Nn(r){if(r===null)return ua;if(typeof r=="string")return Yt;if(typeof r=="boolean")return qt;if(typeof r=="number")return ft;if(r instanceof Zn)return ci;if(r instanceof $h)return ui;if(r instanceof Hr)return Pl;if(r instanceof bi)return Es;if(Array.isArray(r)){const t=r.length;let i;for(const c of r){const h=Nn(c);if(i){if(i===h)continue;i=Ht;break}i=h}return wi(i||Ht,t)}return Fi}function Ll(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof Zn||r instanceof Hr||r instanceof bi?r.toString():JSON.stringify(r)}class Wh{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Dl(t[1]))return i.error("invalid value");const c=t[1];let h=Nn(c);const p=i.expectedType;return h.kind!=="array"||h.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(h=p),new Wh(h,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Zn?["rgba"].concat(this.value.toArray()):this.value instanceof Hr?this.value.serialize():this.value}}var Ss=Wh,Pr=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const Zh={string:Yt,number:ft,boolean:qt,object:Fi};class qh{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let c,h=1;const p=t[0];if(p==="array"){let v,b;if(t.length>2){const T=t[1];if(typeof T!="string"||!(T in Zh)||T==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);v=Zh[T],h++}else v=Ht;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);b=t[2],h++}c=wi(v,b)}else c=Zh[p];const y=[];for(;h<t.length;h++){const v=i.parse(t[h],h,Ht);if(!v)return null;y.push(v)}return new qh(c,y)}evaluate(t){for(let i=0;i<this.args.length;i++){const c=this.args[i].evaluate(t);if(!So(this.type,Nn(c)))return c;if(i===this.args.length-1)throw new Pr(`Expected value to be of type ${Ln(this.type)}, but found ${Ln(Nn(c))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,i=[t.kind];if(t.kind==="array"){const c=t.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){i.push(c.kind);const h=t.N;(typeof h=="number"||this.args.length>1)&&i.push(h)}}return i.concat(this.args.map(c=>c.serialize()))}}var Co=qh;class Qo{constructor(t){this.type=Pl,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const c=t[1];if(!Array.isArray(c)&&typeof c=="object")return i.error("First argument must be an image or text section.");const h=[];let p=!1;for(let y=1;y<=t.length-1;++y){const v=t[y];if(p&&typeof v=="object"&&!Array.isArray(v)){p=!1;let b=null;if(v["font-scale"]&&(b=i.parse(v["font-scale"],1,ft),!b))return null;let T=null;if(v["text-font"]&&(T=i.parse(v["text-font"],1,wi(Yt)),!T))return null;let M=null;if(v["text-color"]&&(M=i.parse(v["text-color"],1,ci),!M))return null;const I=h[h.length-1];I.scale=b,I.font=T,I.textColor=M}else{const b=i.parse(t[y],1,Ht);if(!b)return null;const T=b.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,h.push({content:b,scale:null,font:null,textColor:null})}}return new Qo(h)}evaluate(t){return new Hr(this.sections.map(i=>{const c=i.content.evaluate(t);return Nn(c)===Es?new Gh("",c,null,null,null):new Gh(Ll(c),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null)}))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const i of this.sections){t.push(i.content.serialize());const c={};i.scale&&(c["font-scale"]=i.scale.serialize()),i.font&&(c["text-font"]=i.font.serialize()),i.textColor&&(c["text-color"]=i.textColor.serialize()),t.push(c)}return t}}class Qc{constructor(t){this.type=Es,this.input=t}static parse(t,i){if(t.length!==2)return i.error("Expected two arguments.");const c=i.parse(t[1],1,Yt);return c?new Qc(c):i.error("No image name provided.")}evaluate(t){const i=this.input.evaluate(t),c=bi.fromString(i);return c&&t.availableImages&&(c.available=t.availableImages.indexOf(i)>-1),c}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const m_={"to-boolean":qt,"to-color":ci,"to-number":ft,"to-string":Yt};class Hh{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const c=t[0];if((c==="to-boolean"||c==="to-string")&&t.length!==2)return i.error("Expected one argument.");const h=m_[c],p=[];for(let y=1;y<t.length;y++){const v=i.parse(t[y],y,Ht);if(!v)return null;p.push(v)}return new Hh(h,p)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let i,c;for(const h of this.args){if(i=h.evaluate(t),c=null,i instanceof Zn)return i;if(typeof i=="string"){const p=t.parseColor(i);if(p)return p}else if(Array.isArray(i)&&(c=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:zp(i[0],i[1],i[2],i[3]),!c))return new Zn(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Pr(c||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const c of this.args){if(i=c.evaluate(t),i===null)return 0;const h=Number(i);if(!isNaN(h))return h}throw new Pr(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Hr.fromString(Ll(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?bi.fromString(Ll(this.args[0].evaluate(t))):Ll(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Qo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Qc(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(i=>{t.push(i.serialize())}),t}}var da=Hh;const to=["Unknown","Point","LineString","Polygon"];var Xh=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?to[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:i,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*t-r[0])+this.featureDistanceData.bearing[1]*(c*t-r[1])}return 0}parseColor(r){let t=this._parseColorCache[r];return t||(t=this._parseColorCache[r]=Zn.parse(r)),t}};class Cs{constructor(t,i,c,h){this.name=t,this.type=i,this._evaluate=c,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,i){const c=t[0],h=Cs.definitions[c];if(!h)return i.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=y.filter(([T])=>!Array.isArray(T)||T.length===t.length-1);let b=null;for(const[T,M]of v){b=new td(i.registry,i.path,null,i.scope);const I=[];let D=!1;for(let O=1;O<t.length;O++){const B=t[O],V=Array.isArray(T)?T[O-1]:T.type,q=b.parse(B,1+I.length,V);if(!q){D=!0;break}I.push(q)}if(!D)if(Array.isArray(T)&&T.length!==I.length)b.error(`Expected ${T.length} arguments, but found ${I.length} instead.`);else{for(let O=0;O<I.length;O++){const B=Array.isArray(T)?T[O]:T.type,V=I[O];b.concat(O+1).checkSubtype(B,V.type)}if(b.errors.length===0)return new Cs(c,p,M,I)}}if(v.length===1)i.errors.push(...b.errors);else{const T=(v.length?v:y).map(([I])=>{return D=I,Array.isArray(D)?`(${D.map(Ln).join(", ")})`:`(${Ln(D.type)}...)`;var D}).join(" | "),M=[];for(let I=1;I<t.length;I++){const D=i.parse(t[I],1+M.length);if(!D)return null;M.push(Ln(D.type))}i.error(`Expected arguments of type ${T}, but found (${M.join(", ")}) instead.`)}return null}static register(t,i){Cs.definitions=i;for(const c in i)t[c]=Cs}}var Po=Cs;class zl{constructor(t,i,c){this.type=ui,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const c=t[1];if(typeof c!="object"||Array.isArray(c))return i.error("Collator options argument must be an object.");const h=i.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,qt);if(!h)return null;const p=i.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,qt);if(!p)return null;let y=null;return c.locale&&(y=i.parse(c.locale,1,Yt),!y)?null:new zl(h,p,y)}evaluate(t){return new $h(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Mo=8192;function eu(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function fa(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function Rl(r,t){const i=(180+r[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(i*h*Mo),Math.round(c*h*Mo)]}function Rp(r,t,i){const c=r[0]-t[0],h=r[1]-t[1],p=r[0]-i[0],y=r[1]-i[1];return c*y-p*h==0&&c*p<=0&&h*y<=0}function tu(r,t){let i=!1;for(let y=0,v=t.length;y<v;y++){const b=t[y];for(let T=0,M=b.length;T<M-1;T++){if(Rp(r,b[T],b[T+1]))return!1;(h=b[T])[1]>(c=r)[1]!=(p=b[T+1])[1]>c[1]&&c[0]<(p[0]-h[0])*(c[1]-h[1])/(p[1]-h[1])+h[0]&&(i=!i)}}var c,h,p;return i}function Kh(r,t){for(let i=0;i<t.length;i++)if(tu(r,t[i]))return!0;return!1}function Yh(r,t,i,c){const h=c[0]-i[0],p=c[1]-i[1],y=(r[0]-i[0])*p-h*(r[1]-i[1]),v=(t[0]-i[0])*p-h*(t[1]-i[1]);return y>0&&v<0||y<0&&v>0}function pa(r,t,i){for(const T of i)for(let M=0;M<T.length-1;++M)if((v=[(y=T[M+1])[0]-(p=T[M])[0],y[1]-p[1]])[0]*(b=[(h=t)[0]-(c=r)[0],h[1]-c[1]])[1]-v[1]*b[0]!=0&&Yh(c,h,p,y)&&Yh(p,y,c,h))return!0;var c,h,p,y,v,b;return!1}function un(r,t){for(let i=0;i<r.length;++i)if(!tu(r[i],t))return!1;for(let i=0;i<r.length-1;++i)if(pa(r[i],r[i+1],t))return!1;return!0}function g_(r,t){for(let i=0;i<t.length;i++)if(un(r,t[i]))return!0;return!1}function Jh(r,t,i){const c=[];for(let h=0;h<r.length;h++){const p=[];for(let y=0;y<r[h].length;y++){const v=Rl(r[h][y],i);eu(t,v),p.push(v)}c.push(p)}return c}function Op(r,t,i){const c=[];for(let h=0;h<r.length;h++){const p=Jh(r[h],t,i);c.push(p)}return c}function Qh(r,t,i,c){if(r[0]<i[0]||r[0]>i[2]){const h=.5*c;let p=r[0]-i[0]>h?-c:i[0]-r[0]>h?c:0;p===0&&(p=r[0]-i[2]>h?-c:i[2]-r[0]>h?c:0),r[0]+=p}eu(t,r)}function Fp(r,t,i,c){const h=Math.pow(2,c.z)*Mo,p=[c.x*Mo,c.y*Mo],y=[];if(!r)return y;for(const v of r)for(const b of v){const T=[b.x+p[0],b.y+p[1]];Qh(T,t,i,h),y.push(T)}return y}function ed(r,t,i,c){const h=Math.pow(2,c.z)*Mo,p=[c.x*Mo,c.y*Mo],y=[];if(!r)return y;for(const b of r){const T=[];for(const M of b){const I=[M.x+p[0],M.y+p[1]];eu(t,I),T.push(I)}y.push(T)}if(t[2]-t[0]<=h/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const b of y)for(const T of b)Qh(T,t,i,h)}var v;return y}class ma{constructor(t,i){this.type=qt,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Dl(t[1])){const c=t[1];if(c.type==="FeatureCollection")for(let h=0;h<c.features.length;++h){const p=c.features[h].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new ma(c,c.features[h].geometry)}else if(c.type==="Feature"){const h=c.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new ma(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new ma(c,c)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,c){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if(!y)return!1;if(c.type==="Polygon"){const v=Jh(c.coordinates,p,y),b=Fp(i.geometry(),h,p,y);if(!fa(h,p))return!1;for(const T of b)if(!tu(T,v))return!1}if(c.type==="MultiPolygon"){const v=Op(c.coordinates,p,y),b=Fp(i.geometry(),h,p,y);if(!fa(h,p))return!1;for(const T of b)if(!Kh(T,v))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,c){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if(!y)return!1;if(c.type==="Polygon"){const v=Jh(c.coordinates,p,y),b=ed(i.geometry(),h,p,y);if(!fa(h,p))return!1;for(const T of b)if(!un(T,v))return!1}if(c.type==="MultiPolygon"){const v=Op(c.coordinates,p,y),b=ed(i.geometry(),h,p,y);if(!fa(h,p))return!1;for(const T of b)if(!g_(T,v))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var nu=ma;function ga(r){if(r instanceof Po&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof nu)return!1;let t=!0;return r.eachChild(i=>{t&&!ga(i)&&(t=!1)}),t}function ko(r){if(r instanceof Po&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(i=>{t&&!ko(i)&&(t=!1)}),t}function Ps(r,t){if(r instanceof Po&&t.indexOf(r.name)>=0)return!1;let i=!0;return r.eachChild(c=>{i&&!Ps(c,t)&&(i=!1)}),i}class ru{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const c=t[1];return i.scope.has(c)?new ru(c,i.scope.get(c)):i.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Bp=ru;class Ol{constructor(t,i=[],c,h=new Ap,p=[]){this.registry=t,this.path=i,this.key=i.map(y=>`[${y}]`).join(""),this.scope=h,this.errors=p,this.expectedType=c}parse(t,i,c,h,p={}){return i?this.concat(i,c,h)._parse(t,p):this._parse(t,p)}_parse(t,i){function c(h,p,y){return y==="assert"?new Co(p,[h]):y==="coerce"?new da(p,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[h];if(p){let y=p.parse(t,this);if(!y)return null;if(this.expectedType){const v=this.expectedType,b=y.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||b.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(v,b))return null}else y=c(y,v,i.typeAnnotation||"coerce");else y=c(y,v,i.typeAnnotation||"assert")}if(!(y instanceof Ss)&&y.type.kind!=="resolvedImage"&&nd(y)){const v=new Xh;try{y=new Ss(y.type,y.evaluate(v))}catch(b){return this.error(b.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,c){const h=typeof t=="number"?this.path.concat(t):this.path,p=c?this.scope.concat(c):this.scope;return new Ol(this.registry,h,i||null,p,this.errors)}error(t,...i){const c=`${this.key}${i.map(h=>`[${h}]`).join("")}`;this.errors.push(new eo(c,t))}checkSubtype(t,i){const c=So(t,i);return c&&this.error(c),c}}var td=Ol;function nd(r){if(r instanceof Bp)return nd(r.boundExpression);if(r instanceof Po&&r.name==="error"||r instanceof zl||r instanceof nu)return!1;const t=r instanceof da||r instanceof Co;let i=!0;return r.eachChild(c=>{i=t?i&&nd(c):i&&c instanceof Ss}),!!i&&ga(r)&&Ps(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function iu(r,t){const i=r.length-1;let c,h,p=0,y=i,v=0;for(;p<=y;)if(v=Math.floor((p+y)/2),c=r[v],h=r[v+1],c<=t){if(v===i||t<h)return v;p=v+1}else{if(!(c>t))throw new Pr("Input is not a number.");y=v-1}return 0}class ou{constructor(t,i,c){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[h,p]of c)this.labels.push(h),this.outputs.push(p)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const c=i.parse(t[1],1,ft);if(!c)return null;const h=[];let p=null;i.expectedType&&i.expectedType.kind!=="value"&&(p=i.expectedType);for(let y=1;y<t.length;y+=2){const v=y===1?-1/0:t[y],b=t[y+1],T=y,M=y+1;if(typeof v!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(h.length&&h[h.length-1][0]>=v)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const I=i.parse(b,M,p);if(!I)return null;p=p||I.type,h.push([v,I])}return new ou(p,c,h)}evaluate(t){const i=this.labels,c=this.outputs;if(i.length===1)return c[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return c[0].evaluate(t);const p=i.length;return h>=i[p-1]?c[p-1].evaluate(t):c[iu(i,h)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&t.push(this.labels[i]),t.push(this.outputs[i].serialize());return t}}var rd=ou;function en(r,t,i){return r*(1-i)+t*i}var Fl=Object.freeze({__proto__:null,array:function(r,t,i){return r.map((c,h)=>en(c,t[h],i))},color:function(r,t,i){return new Zn(en(r.r,t.r,i),en(r.g,t.g,i),en(r.b,t.b,i),en(r.a,t.a,i))},number:en});const jp=.95047,id=1.08883,Np=4/29,Ms=6/29,od=3*Ms*Ms,y_=Ms*Ms*Ms,__=Math.PI/180,v_=180/Math.PI;function sd(r){return r>y_?Math.pow(r,1/3):r/od+Np}function ad(r){return r>Ms?r*r*r:od*(r-Np)}function ld(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function su(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Up(r){const t=su(r.r),i=su(r.g),c=su(r.b),h=sd((.4124564*t+.3575761*i+.1804375*c)/jp),p=sd((.2126729*t+.7151522*i+.072175*c)/1);return{l:116*p-16,a:500*(h-p),b:200*(p-sd((.0193339*t+.119192*i+.9503041*c)/id)),alpha:r.a}}function Vp(r){let t=(r.l+16)/116,i=isNaN(r.a)?t:t+r.a/500,c=isNaN(r.b)?t:t-r.b/200;return t=1*ad(t),i=jp*ad(i),c=id*ad(c),new Zn(ld(3.2404542*i-1.5371385*t-.4985314*c),ld(-.969266*i+1.8760108*t+.041556*c),ld(.0556434*i-.2040259*t+1.0572252*c),r.alpha)}function x_(r,t,i){const c=t-r;return r+i*(c>180||c<-180?c-360*Math.round(c/360):c)}const Bl={forward:Up,reverse:Vp,interpolate:function(r,t,i){return{l:en(r.l,t.l,i),a:en(r.a,t.a,i),b:en(r.b,t.b,i),alpha:en(r.alpha,t.alpha,i)}}},ya={forward:function(r){const{l:t,a:i,b:c}=Up(r),h=Math.atan2(c,i)*v_;return{h:h<0?h+360:h,c:Math.sqrt(i*i+c*c),l:t,alpha:r.a}},reverse:function(r){const t=r.h*__,i=r.c;return Vp({l:r.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:r.alpha})},interpolate:function(r,t,i){return{h:x_(r.h,t.h,i),c:en(r.c,t.c,i),l:en(r.l,t.l,i),alpha:en(r.alpha,t.alpha,i)}}};var cd=Object.freeze({__proto__:null,hcl:ya,lab:Bl});class jl{constructor(t,i,c,h,p){this.type=t,this.operator=i,this.interpolation=c,this.input=h,this.labels=[],this.outputs=[];for(const[y,v]of p)this.labels.push(y),this.outputs.push(v)}static interpolationFactor(t,i,c,h){let p=0;if(t.name==="exponential")p=ud(i,t.base,c,h);else if(t.name==="linear")p=ud(i,1,c,h);else if(t.name==="cubic-bezier"){const y=t.controlPoints;p=new Ge(y[0],y[1],y[2],y[3]).solve(ud(i,1,c,h))}return p}static parse(t,i){let[c,h,p,...y]=t;if(!Array.isArray(h)||h.length===0)return i.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const T=h[1];if(typeof T!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:T}}else{if(h[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const T=h.slice(1);if(T.length!==4||T.some(M=>typeof M!="number"||M<0||M>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:T}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(p=i.parse(p,2,ft),!p)return null;const v=[];let b=null;c==="interpolate-hcl"||c==="interpolate-lab"?b=ci:i.expectedType&&i.expectedType.kind!=="value"&&(b=i.expectedType);for(let T=0;T<y.length;T+=2){const M=y[T],I=y[T+1],D=T+3,O=T+4;if(typeof M!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(v.length&&v[v.length-1][0]>=M)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const B=i.parse(I,O,b);if(!B)return null;b=b||B.type,v.push([M,B])}return b.kind==="number"||b.kind==="color"||b.kind==="array"&&b.itemType.kind==="number"&&typeof b.N=="number"?new jl(b,c,h,p,v):i.error(`Type ${Ln(b)} is not interpolatable.`)}evaluate(t){const i=this.labels,c=this.outputs;if(i.length===1)return c[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return c[0].evaluate(t);const p=i.length;if(h>=i[p-1])return c[p-1].evaluate(t);const y=iu(i,h),v=jl.interpolationFactor(this.interpolation,h,i[y],i[y+1]),b=c[y].evaluate(t),T=c[y+1].evaluate(t);return this.operator==="interpolate"?Fl[this.type.kind.toLowerCase()](b,T,v):this.operator==="interpolate-hcl"?ya.reverse(ya.interpolate(ya.forward(b),ya.forward(T),v)):Bl.reverse(Bl.interpolate(Bl.forward(b),Bl.forward(T),v))}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,t,this.input.serialize()];for(let c=0;c<this.labels.length;c++)i.push(this.labels[c],this.outputs[c].serialize());return i}}function ud(r,t,i,c){const h=c-i,p=r-i;return h===0?0:t===1?p/h:(Math.pow(t,p)-1)/(Math.pow(t,h)-1)}var no=jl;class au{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expectected at least one argument.");let c=null;const h=i.expectedType;h&&h.kind!=="value"&&(c=h);const p=[];for(const v of t.slice(1)){const b=i.parse(v,1+p.length,c,void 0,{typeAnnotation:"omit"});if(!b)return null;c=c||b.type,p.push(b)}const y=h&&p.some(v=>So(h,v.type));return new au(y?Ht:c,p)}evaluate(t){let i,c=null,h=0;for(const p of this.args){if(h++,c=p.evaluate(t),c&&c instanceof bi&&!c.available&&(i||(i=c),c=null,h===this.args.length))return i;if(c!==null)break}return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var hd=au;class lu{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const c=[];for(let p=1;p<t.length-1;p+=2){const y=t[p];if(typeof y!="string")return i.error(`Expected string, but found ${typeof y} instead.`,p);if(/[^a-zA-Z0-9_]/.test(y))return i.error("Variable names must contain only alphanumeric characters or '_'.",p);const v=i.parse(t[p+1],p+1);if(!v)return null;c.push([y,v])}const h=i.parse(t[t.length-1],t.length-1,i.expectedType,c);return h?new lu(c,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[i,c]of this.bindings)t.push(i,c.serialize());return t.push(this.result.serialize()),t}}var $p=lu;class dd{constructor(t,i,c){this.type=t,this.index=i,this.input=c}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=i.parse(t[1],1,ft),h=i.parse(t[2],2,wi(i.expectedType||Ht));return c&&h?new dd(h.type.itemType,c,h):null}evaluate(t){const i=this.index.evaluate(t),c=this.input.evaluate(t);if(i<0)throw new Pr(`Array index out of bounds: ${i} < 0.`);if(i>=c.length)throw new Pr(`Array index out of bounds: ${i} > ${c.length-1}.`);if(i!==Math.floor(i))throw new Pr(`Array index must be an integer, but found ${i} instead.`);return c[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var w_=dd;class fd{constructor(t,i){this.type=qt,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=i.parse(t[1],1,Ht),h=i.parse(t[2],2,Ht);return c&&h?Ml(c.type,[qt,Yt,ft,ua,Ht])?new fd(c,h):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ln(c.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(c==null)return!1;if(!kl(i,["boolean","string","number","null"]))throw new Pr(`Expected first argument to be of type boolean, string, number or null, but found ${Ln(Nn(i))} instead.`);if(!kl(c,["string","array"]))throw new Pr(`Expected second argument to be of type array or string, but found ${Ln(Nn(c))} instead.`);return c.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var cu=fd;class Nl{constructor(t,i,c){this.type=ft,this.needle=t,this.haystack=i,this.fromIndex=c}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=i.parse(t[1],1,Ht),h=i.parse(t[2],2,Ht);if(!c||!h)return null;if(!Ml(c.type,[qt,Yt,ft,ua,Ht]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ln(c.type)} instead`);if(t.length===4){const p=i.parse(t[3],3,ft);return p?new Nl(c,h,p):null}return new Nl(c,h)}evaluate(t){const i=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!kl(i,["boolean","string","number","null"]))throw new Pr(`Expected first argument to be of type boolean, string, number or null, but found ${Ln(Nn(i))} instead.`);if(!kl(c,["string","array"]))throw new Pr(`Expected second argument to be of type array or string, but found ${Ln(Nn(c))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(t);return c.indexOf(i,h)}return c.indexOf(i)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Gp=Nl;class pd{constructor(t,i,c,h,p,y){this.inputType=t,this.type=i,this.input=c,this.cases=h,this.outputs=p,this.otherwise=y}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let c,h;i.expectedType&&i.expectedType.kind!=="value"&&(h=i.expectedType);const p={},y=[];for(let T=2;T<t.length-1;T+=2){let M=t[T];const I=t[T+1];Array.isArray(M)||(M=[M]);const D=i.concat(T);if(M.length===0)return D.error("Expected at least one branch label.");for(const B of M){if(typeof B!="number"&&typeof B!="string")return D.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return D.error("Numeric branch labels must be integer values.");if(c){if(D.checkSubtype(c,Nn(B)))return null}else c=Nn(B);if(p[String(B)]!==void 0)return D.error("Branch labels must be unique.");p[String(B)]=y.length}const O=i.parse(I,T,h);if(!O)return null;h=h||O.type,y.push(O)}const v=i.parse(t[1],1,Ht);if(!v)return null;const b=i.parse(t[t.length-1],t.length-1,h);return b?v.type.kind!=="value"&&i.concat(1).checkSubtype(c,v.type)?null:new pd(c,h,v,p,y,b):null}evaluate(t){const i=this.input.evaluate(t);return(Nn(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),c=[],h={};for(const y of i){const v=h[this.cases[y]];v===void 0?(h[this.cases[y]]=c.length,c.push([this.cases[y],[y]])):c[v][1].push(y)}const p=y=>this.inputType.kind==="number"?Number(y):y;for(const[y,v]of c)t.push(v.length===1?p(v[0]):v.map(p)),t.push(this.outputs[y].serialize());return t.push(this.otherwise.serialize()),t}}var b_=pd;class md{constructor(t,i,c){this.type=t,this.branches=i,this.otherwise=c}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let c;i.expectedType&&i.expectedType.kind!=="value"&&(c=i.expectedType);const h=[];for(let y=1;y<t.length-1;y+=2){const v=i.parse(t[y],y,qt);if(!v)return null;const b=i.parse(t[y+1],y+1,c);if(!b)return null;h.push([v,b]),c=c||b.type}const p=i.parse(t[t.length-1],t.length-1,c);return p?new md(c,h,p):null}evaluate(t){for(const[i,c]of this.branches)if(i.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,c]of this.branches)t(i),t(c);t(this.otherwise)}outputDefined(){return this.branches.every(([t,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var Wp=md;class Ul{constructor(t,i,c,h){this.type=t,this.input=i,this.beginIndex=c,this.endIndex=h}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=i.parse(t[1],1,Ht),h=i.parse(t[2],2,ft);if(!c||!h)return null;if(!Ml(c.type,[wi(Ht),Yt,Ht]))return i.error(`Expected first argument to be of type array or string, but found ${Ln(c.type)} instead`);if(t.length===4){const p=i.parse(t[3],3,ft);return p?new Ul(c.type,c,h,p):null}return new Ul(c.type,c,h)}evaluate(t){const i=this.input.evaluate(t),c=this.beginIndex.evaluate(t);if(!kl(i,["string","array"]))throw new Pr(`Expected first argument to be of type array or string, but found ${Ln(Nn(i))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(t);return i.slice(c,h)}return i.slice(c)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Zp=Ul;function uu(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function qp(r,t,i,c){return c.compare(t,i)===0}function _a(r,t,i){const c=r!=="=="&&r!=="!=";return class QA{constructor(p,y,v){this.type=qt,this.lhs=p,this.rhs=y,this.collator=v,this.hasUntypedArgument=p.type.kind==="value"||y.type.kind==="value"}static parse(p,y){if(p.length!==3&&p.length!==4)return y.error("Expected two or three arguments.");const v=p[0];let b=y.parse(p[1],1,Ht);if(!b)return null;if(!uu(v,b.type))return y.concat(1).error(`"${v}" comparisons are not supported for type '${Ln(b.type)}'.`);let T=y.parse(p[2],2,Ht);if(!T)return null;if(!uu(v,T.type))return y.concat(2).error(`"${v}" comparisons are not supported for type '${Ln(T.type)}'.`);if(b.type.kind!==T.type.kind&&b.type.kind!=="value"&&T.type.kind!=="value")return y.error(`Cannot compare types '${Ln(b.type)}' and '${Ln(T.type)}'.`);c&&(b.type.kind==="value"&&T.type.kind!=="value"?b=new Co(T.type,[b]):b.type.kind!=="value"&&T.type.kind==="value"&&(T=new Co(b.type,[T])));let M=null;if(p.length===4){if(b.type.kind!=="string"&&T.type.kind!=="string"&&b.type.kind!=="value"&&T.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(M=y.parse(p[3],3,ui),!M)return null}return new QA(b,T,M)}evaluate(p){const y=this.lhs.evaluate(p),v=this.rhs.evaluate(p);if(c&&this.hasUntypedArgument){const b=Nn(y),T=Nn(v);if(b.kind!==T.kind||b.kind!=="string"&&b.kind!=="number")throw new Pr(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${b.kind}, ${T.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const b=Nn(y),T=Nn(v);if(b.kind!=="string"||T.kind!=="string")return t(p,y,v)}return this.collator?i(p,y,v,this.collator.evaluate(p)):t(p,y,v)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[r];return this.eachChild(y=>{p.push(y.serialize())}),p}}}const T_=_a("==",function(r,t,i){return t===i},qp),E_=_a("!=",function(r,t,i){return t!==i},function(r,t,i,c){return!qp(0,t,i,c)}),S_=_a("<",function(r,t,i){return t<i},function(r,t,i,c){return c.compare(t,i)<0}),C_=_a(">",function(r,t,i){return t>i},function(r,t,i,c){return c.compare(t,i)>0}),P_=_a("<=",function(r,t,i){return t<=i},function(r,t,i,c){return c.compare(t,i)<=0}),Hp=_a(">=",function(r,t,i){return t>=i},function(r,t,i,c){return c.compare(t,i)>=0});class hu{constructor(t,i,c,h,p,y){this.type=Yt,this.number=t,this.locale=i,this.currency=c,this.unit=h,this.minFractionDigits=p,this.maxFractionDigits=y}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const c=i.parse(t[1],1,ft);if(!c)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return i.error("NumberFormat options argument must be an object.");let p=null;if(h.locale&&(p=i.parse(h.locale,1,Yt),!p))return null;let y=null;if(h.currency&&(y=i.parse(h.currency,1,Yt),!y))return null;let v=null;if(h.unit&&(v=i.parse(h.unit,1,Yt),!v))return null;let b=null;if(h["min-fraction-digits"]&&(b=i.parse(h["min-fraction-digits"],1,ft),!b))return null;let T=null;return h["max-fraction-digits"]&&(T=i.parse(h["max-fraction-digits"],1,ft),!T)?null:new hu(c,p,y,v,b,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class va{constructor(t){this.type=ft,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=i.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Ln(c.type)} instead.`):new va(c):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Pr(`Expected value to be of type string or array, but found ${Ln(Nn(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(i=>{t.push(i.serialize())}),t}}const Xp={"==":T_,"!=":E_,">":C_,"<":S_,">=":Hp,"<=":P_,array:Co,at:w_,boolean:Co,case:Wp,coalesce:hd,collator:zl,format:Qo,image:Qc,in:cu,"index-of":Gp,interpolate:no,"interpolate-hcl":no,"interpolate-lab":no,length:va,let:$p,literal:Ss,match:b_,number:Co,"number-format":hu,object:Co,slice:Zp,step:rd,string:Co,"to-boolean":da,"to-color":da,"to-number":da,"to-string":da,var:Bp,within:nu};function Kp(r,[t,i,c,h]){t=t.evaluate(r),i=i.evaluate(r),c=c.evaluate(r);const p=h?h.evaluate(r):1,y=zp(t,i,c,p);if(y)throw new Pr(y);return new Zn(t/255*p,i/255*p,c/255*p,p)}function Io(r,t){return r in t}function du(r,t){const i=t[r];return i===void 0?null:i}function Ti(r){return{type:r}}Po.register(Xp,{error:[{kind:"error"},[Yt],(r,[t])=>{throw new Pr(t.evaluate(r))}],typeof:[Yt,[Ht],(r,[t])=>Ln(Nn(t.evaluate(r)))],"to-rgba":[wi(ft,4),[ci],(r,[t])=>t.evaluate(r).toArray()],rgb:[ci,[ft,ft,ft],Kp],rgba:[ci,[ft,ft,ft,ft],Kp],has:{type:qt,overloads:[[[Yt],(r,[t])=>Io(t.evaluate(r),r.properties())],[[Yt,Fi],(r,[t,i])=>Io(t.evaluate(r),i.evaluate(r))]]},get:{type:Ht,overloads:[[[Yt],(r,[t])=>du(t.evaluate(r),r.properties())],[[Yt,Fi],(r,[t,i])=>du(t.evaluate(r),i.evaluate(r))]]},"feature-state":[Ht,[Yt],(r,[t])=>du(t.evaluate(r),r.featureState||{})],properties:[Fi,[],r=>r.properties()],"geometry-type":[Yt,[],r=>r.geometryType()],id:[Ht,[],r=>r.id()],zoom:[ft,[],r=>r.globals.zoom],pitch:[ft,[],r=>r.globals.pitch||0],"distance-from-center":[ft,[],r=>r.distanceFromCenter()],"heatmap-density":[ft,[],r=>r.globals.heatmapDensity||0],"line-progress":[ft,[],r=>r.globals.lineProgress||0],"sky-radial-progress":[ft,[],r=>r.globals.skyRadialProgress||0],accumulated:[Ht,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[ft,Ti(ft),(r,t)=>{let i=0;for(const c of t)i+=c.evaluate(r);return i}],"*":[ft,Ti(ft),(r,t)=>{let i=1;for(const c of t)i*=c.evaluate(r);return i}],"-":{type:ft,overloads:[[[ft,ft],(r,[t,i])=>t.evaluate(r)-i.evaluate(r)],[[ft],(r,[t])=>-t.evaluate(r)]]},"/":[ft,[ft,ft],(r,[t,i])=>t.evaluate(r)/i.evaluate(r)],"%":[ft,[ft,ft],(r,[t,i])=>t.evaluate(r)%i.evaluate(r)],ln2:[ft,[],()=>Math.LN2],pi:[ft,[],()=>Math.PI],e:[ft,[],()=>Math.E],"^":[ft,[ft,ft],(r,[t,i])=>Math.pow(t.evaluate(r),i.evaluate(r))],sqrt:[ft,[ft],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[ft,[ft],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[ft,[ft],(r,[t])=>Math.log(t.evaluate(r))],log2:[ft,[ft],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[ft,[ft],(r,[t])=>Math.sin(t.evaluate(r))],cos:[ft,[ft],(r,[t])=>Math.cos(t.evaluate(r))],tan:[ft,[ft],(r,[t])=>Math.tan(t.evaluate(r))],asin:[ft,[ft],(r,[t])=>Math.asin(t.evaluate(r))],acos:[ft,[ft],(r,[t])=>Math.acos(t.evaluate(r))],atan:[ft,[ft],(r,[t])=>Math.atan(t.evaluate(r))],min:[ft,Ti(ft),(r,t)=>Math.min(...t.map(i=>i.evaluate(r)))],max:[ft,Ti(ft),(r,t)=>Math.max(...t.map(i=>i.evaluate(r)))],abs:[ft,[ft],(r,[t])=>Math.abs(t.evaluate(r))],round:[ft,[ft],(r,[t])=>{const i=t.evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[ft,[ft],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[ft,[ft],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[qt,[Yt,Ht],(r,[t,i])=>r.properties()[t.value]===i.value],"filter-id-==":[qt,[Ht],(r,[t])=>r.id()===t.value],"filter-type-==":[qt,[Yt],(r,[t])=>r.geometryType()===t.value],"filter-<":[qt,[Yt,Ht],(r,[t,i])=>{const c=r.properties()[t.value],h=i.value;return typeof c==typeof h&&c<h}],"filter-id-<":[qt,[Ht],(r,[t])=>{const i=r.id(),c=t.value;return typeof i==typeof c&&i<c}],"filter->":[qt,[Yt,Ht],(r,[t,i])=>{const c=r.properties()[t.value],h=i.value;return typeof c==typeof h&&c>h}],"filter-id->":[qt,[Ht],(r,[t])=>{const i=r.id(),c=t.value;return typeof i==typeof c&&i>c}],"filter-<=":[qt,[Yt,Ht],(r,[t,i])=>{const c=r.properties()[t.value],h=i.value;return typeof c==typeof h&&c<=h}],"filter-id-<=":[qt,[Ht],(r,[t])=>{const i=r.id(),c=t.value;return typeof i==typeof c&&i<=c}],"filter->=":[qt,[Yt,Ht],(r,[t,i])=>{const c=r.properties()[t.value],h=i.value;return typeof c==typeof h&&c>=h}],"filter-id->=":[qt,[Ht],(r,[t])=>{const i=r.id(),c=t.value;return typeof i==typeof c&&i>=c}],"filter-has":[qt,[Ht],(r,[t])=>t.value in r.properties()],"filter-has-id":[qt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[qt,[wi(Yt)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[qt,[wi(Ht)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[qt,[Yt,wi(Ht)],(r,[t,i])=>i.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[qt,[Yt,wi(Ht)],(r,[t,i])=>function(c,h,p,y){for(;p<=y;){const v=p+y>>1;if(h[v]===c)return!0;h[v]>c?y=v-1:p=v+1}return!1}(r.properties()[t.value],i.value,0,i.value.length-1)],all:{type:qt,overloads:[[[qt,qt],(r,[t,i])=>t.evaluate(r)&&i.evaluate(r)],[Ti(qt),(r,t)=>{for(const i of t)if(!i.evaluate(r))return!1;return!0}]]},any:{type:qt,overloads:[[[qt,qt],(r,[t,i])=>t.evaluate(r)||i.evaluate(r)],[Ti(qt),(r,t)=>{for(const i of t)if(i.evaluate(r))return!0;return!1}]]},"!":[qt,[qt],(r,[t])=>!t.evaluate(r)],"is-supported-script":[qt,[Yt],(r,[t])=>{const i=r.globals&&r.globals.isSupportedScript;return!i||i(t.evaluate(r))}],upcase:[Yt,[Yt],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[Yt,[Yt],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[Yt,Ti(Ht),(r,t)=>t.map(i=>Ll(i.evaluate(r))).join("")],"resolved-locale":[Yt,[ui],(r,[t])=>t.evaluate(r).resolvedLocale()]});var Vl=Xp;function Yp(r){return{result:"success",value:r}}function ks(r){return{result:"error",value:r}}function xa(r){return r["property-type"]==="data-driven"}function fu(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function pu(r){return!!r.expression&&r.expression.interpolated}function tn(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function $l(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Jp(r){return r}function mu(r,t){const i=t.type==="color",c=r.stops&&typeof r.stops[0][0]=="object",h=c||!(c||r.property!==void 0),p=r.type||(pu(t)?"exponential":"interval");if(i&&((r=Eo({},r)).stops&&(r.stops=r.stops.map(T=>[T[0],Zn.parse(T[1])])),r.default=Zn.parse(r.default?r.default:t.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!cd[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let y,v,b;if(p==="exponential")y=Ao;else if(p==="interval")y=gu;else if(p==="categorical"){y=Qp,v=Object.create(null);for(const T of r.stops)v[T[0]]=T[1];b=typeof r.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);y=em}if(c){const T={},M=[];for(let O=0;O<r.stops.length;O++){const B=r.stops[O],V=B[0].zoom;T[V]===void 0&&(T[V]={zoom:V,type:r.type,property:r.property,default:r.default,stops:[]},M.push(V)),T[V].stops.push([B[0].value,B[1]])}const I=[];for(const O of M)I.push([T[O].zoom,mu(T[O],t)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:no.interpolationFactor.bind(void 0,D),zoomStops:I.map(O=>O[0]),evaluate:({zoom:O},B)=>Ao({stops:I,base:r.base},t,O).evaluate(O,B)}}if(h){const T=p==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:no.interpolationFactor.bind(void 0,T),zoomStops:r.stops.map(M=>M[0]),evaluate:({zoom:M})=>y(r,t,M,v,b)}}return{kind:"source",evaluate(T,M){const I=M&&M.properties?M.properties[r.property]:void 0;return I===void 0?wa(r.default,t.default):y(r,t,I,v,b)}}}function wa(r,t,i){return r!==void 0?r:t!==void 0?t:i!==void 0?i:void 0}function Qp(r,t,i,c,h){return wa(typeof i===h?c[i]:void 0,r.default,t.default)}function gu(r,t,i){if(tn(i)!=="number")return wa(r.default,t.default);const c=r.stops.length;if(c===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[c-1][0])return r.stops[c-1][1];const h=iu(r.stops.map(p=>p[0]),i);return r.stops[h][1]}function Ao(r,t,i){const c=r.base!==void 0?r.base:1;if(tn(i)!=="number")return wa(r.default,t.default);const h=r.stops.length;if(h===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[h-1][0])return r.stops[h-1][1];const p=iu(r.stops.map(M=>M[0]),i),y=function(M,I,D,O){const B=O-D,V=M-D;return B===0?0:I===1?V/B:(Math.pow(I,V)-1)/(Math.pow(I,B)-1)}(i,c,r.stops[p][0],r.stops[p+1][0]),v=r.stops[p][1],b=r.stops[p+1][1];let T=Fl[t.type]||Jp;if(r.colorSpace&&r.colorSpace!=="rgb"){const M=cd[r.colorSpace];T=(I,D)=>M.reverse(M.interpolate(M.forward(I),M.forward(D),y))}return typeof v.evaluate=="function"?{evaluate(...M){const I=v.evaluate.apply(void 0,M),D=b.evaluate.apply(void 0,M);if(I!==void 0&&D!==void 0)return T(I,D,y)}}:T(v,b,y)}function em(r,t,i){return t.type==="color"?i=Zn.parse(i):t.type==="formatted"?i=Hr.fromString(i.toString()):t.type==="resolvedImage"?i=bi.fromString(i.toString()):tn(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),wa(i,r.default,t.default)}class yu{constructor(t,i){this.expression=t,this._warningHistory={},this._evaluator=new Xh,this._defaultValue=i?function(c){return c.type==="color"&&($l(c.default)||Array.isArray(c.default))?new Zn(0,0,0,0):c.type==="color"?Zn.parse(c.default)||null:c.default===void 0?null:c.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,c,h,p,y,v,b){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=c,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=b||null,this.expression.evaluate(this._evaluator)}evaluate(t,i,c,h,p,y,v,b){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=c||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=b||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Pr(`Expected value to be one of ${Object.keys(this._enumValues).map(M=>JSON.stringify(M)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function ba(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Vl}function Ta(r,t){const i=new td(Vl,[],t?function(h){const p={color:ci,string:Yt,number:ft,enum:Yt,boolean:qt,formatted:Pl,resolvedImage:Es};return h.type==="array"?wi(p[h.value]||Ht,h.length):p[h.type]}(t):void 0),c=i.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?Yp(new yu(c,t)):ks(i.errors)}class gd{constructor(t,i){this.kind=t,this._styleExpression=i,this.isStateDependent=t!=="constant"&&!ko(i.expression)}evaluateWithoutErrorHandling(t,i,c,h,p,y){return this._styleExpression.evaluateWithoutErrorHandling(t,i,c,h,p,y)}evaluate(t,i,c,h,p,y){return this._styleExpression.evaluate(t,i,c,h,p,y)}}class Gl{constructor(t,i,c,h){this.kind=t,this.zoomStops=c,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!ko(i.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,i,c,h,p,y){return this._styleExpression.evaluateWithoutErrorHandling(t,i,c,h,p,y)}evaluate(t,i,c,h,p,y){return this._styleExpression.evaluate(t,i,c,h,p,y)}interpolationFactor(t,i,c){return this.interpolationType?no.interpolationFactor(this.interpolationType,t,i,c):0}}function Wl(r,t){if((r=Ta(r,t)).result==="error")return r;const i=r.value.expression,c=ga(i);if(!c&&!xa(t))return ks([new eo("","data expressions not supported")]);const h=Ps(i,["zoom","pitch","distance-from-center"]);if(!h&&!fu(t))return ks([new eo("","zoom expressions not supported")]);const p=vu(i);return p||h?p instanceof eo?ks([p]):p instanceof no&&!pu(t)?ks([new eo("",'"interpolate" expressions cannot be used with this property')]):Yp(p?new Gl(c?"camera":"composite",r.value,p.labels,p instanceof no?p.interpolation:void 0):new gd(c?"constant":"source",r.value)):ks([new eo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class _u{constructor(t,i){this._parameters=t,this._specification=i,Eo(this,mu(this._parameters,this._specification))}static deserialize(t){return new _u(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function vu(r){let t=null;if(r instanceof $p)t=vu(r.result);else if(r instanceof hd){for(const i of r.args)if(t=vu(i),t)break}else(r instanceof rd||r instanceof no)&&r.input instanceof Po&&r.input.name==="zoom"&&(t=r);return t instanceof eo||r.eachChild(i=>{const c=vu(i);c instanceof eo?t=c:!t&&c?t=new eo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&c&&t!==c&&(t=new eo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}class pt{constructor(t,i,c,h){this.message=(t?`${t}: `:"")+c,h&&(this.identifier=h),i!=null&&i.__line__&&(this.line=i.__line__)}}function Bi(r){const t=r.key,i=r.value,c=r.valueSpec||{},h=r.objectElementValidators||{},p=r.style,y=r.styleSpec;let v=[];const b=tn(i);if(b!=="object")return[new pt(t,i,`object expected, ${b} found`)];for(const T in i){const M=T.split(".")[0];let I;h[M]?I=h[M]:c[M]?I=zr:h["*"]?I=h["*"]:c["*"]&&(I=zr),I?v=v.concat(I({key:(t&&`${t}.`)+T,value:i[T],valueSpec:c[M]||c["*"],style:p,styleSpec:y,object:i,objectKey:T},i)):v.push(new pt(t,i[T],`unknown property "${T}"`))}for(const T in c)h[T]||c[T].required&&c[T].default===void 0&&i[T]===void 0&&v.push(new pt(t,i,`missing required property "${T}"`));return v}function tm(r){const t=r.value,i=r.valueSpec,c=r.style,h=r.styleSpec,p=r.key,y=r.arrayElementValidator||zr;if(tn(t)!=="array")return[new pt(p,t,`array expected, ${tn(t)} found`)];if(i.length&&t.length!==i.length)return[new pt(p,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new pt(p,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let v={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};h.$version<7&&(v.function=i.function),tn(i.value)==="object"&&(v=i.value);let b=[];for(let T=0;T<t.length;T++)b=b.concat(y({array:t,arrayIndex:T,value:t[T],valueSpec:v,style:c,styleSpec:h,key:`${p}[${T}]`}));return b}function Zl(r){const t=r.key,i=r.value,c=r.valueSpec;let h=tn(i);if(h==="number"&&i!=i&&(h="NaN"),h!=="number")return[new pt(t,i,`number expected, ${h} found`)];if("minimum"in c){let p=c.minimum;if(tn(c.minimum)==="array"&&(p=c.minimum[r.arrayIndex]),i<p)return[new pt(t,i,`${i} is less than the minimum value ${p}`)]}if("maximum"in c){let p=c.maximum;if(tn(c.maximum)==="array"&&(p=c.maximum[r.arrayIndex]),i>p)return[new pt(t,i,`${i} is greater than the maximum value ${p}`)]}return[]}function ql(r){const t=r.valueSpec,i=Yn(r.value.type);let c,h,p,y={};const v=i!=="categorical"&&r.value.property===void 0,b=!v,T=tn(r.value.stops)==="array"&&tn(r.value.stops[0])==="array"&&tn(r.value.stops[0][0])==="object",M=Bi({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(O){if(i==="identity")return[new pt(O.key,O.value,'identity function may not have a "stops" property')];let B=[];const V=O.value;return B=B.concat(tm({key:O.key,value:V,valueSpec:O.valueSpec,style:O.style,styleSpec:O.styleSpec,arrayElementValidator:I})),tn(V)==="array"&&V.length===0&&B.push(new pt(O.key,V,"array must have at least one stop")),B},default:function(O){return zr({key:O.key,value:O.value,valueSpec:t,style:O.style,styleSpec:O.styleSpec})}}});return i==="identity"&&v&&M.push(new pt(r.key,r.value,'missing required property "property"')),i==="identity"||r.value.stops||M.push(new pt(r.key,r.value,'missing required property "stops"')),i==="exponential"&&r.valueSpec.expression&&!pu(r.valueSpec)&&M.push(new pt(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(b&&!xa(r.valueSpec)?M.push(new pt(r.key,r.value,"property functions not supported")):v&&!fu(r.valueSpec)&&M.push(new pt(r.key,r.value,"zoom functions not supported"))),i!=="categorical"&&!T||r.value.property!==void 0||M.push(new pt(r.key,r.value,'"property" property is required')),M;function I(O){let B=[];const V=O.value,q=O.key;if(tn(V)!=="array")return[new pt(q,V,`array expected, ${tn(V)} found`)];if(V.length!==2)return[new pt(q,V,`array length 2 expected, length ${V.length} found`)];if(T){if(tn(V[0])!=="object")return[new pt(q,V,`object expected, ${tn(V[0])} found`)];if(V[0].zoom===void 0)return[new pt(q,V,"object stop key must have zoom")];if(V[0].value===void 0)return[new pt(q,V,"object stop key must have value")];const ie=Yn(V[0].zoom);if(typeof ie!="number")return[new pt(q,V[0].zoom,"stop zoom values must be numbers")];if(p&&p>ie)return[new pt(q,V[0].zoom,"stop zoom values must appear in ascending order")];ie!==p&&(p=ie,h=void 0,y={}),B=B.concat(Bi({key:`${q}[0]`,value:V[0],valueSpec:{zoom:{}},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{zoom:Zl,value:D}}))}else B=B.concat(D({key:`${q}[0]`,value:V[0],valueSpec:{},style:O.style,styleSpec:O.styleSpec},V));return ba(_r(V[1]))?B.concat([new pt(`${q}[1]`,V[1],"expressions are not allowed in function stops.")]):B.concat(zr({key:`${q}[1]`,value:V[1],valueSpec:t,style:O.style,styleSpec:O.styleSpec}))}function D(O,B){const V=tn(O.value),q=Yn(O.value),ie=O.value!==null?O.value:B;if(c){if(V!==c)return[new pt(O.key,ie,`${V} stop domain type must match previous stop domain type ${c}`)]}else c=V;if(V!=="number"&&V!=="string"&&V!=="boolean"&&typeof q!="number"&&typeof q!="string"&&typeof q!="boolean")return[new pt(O.key,ie,"stop domain value must be a number, string, or boolean")];if(V!=="number"&&i!=="categorical"){let de=`number expected, ${V} found`;return xa(t)&&i===void 0&&(de+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pt(O.key,ie,de)]}return i!=="categorical"||V!=="number"||typeof q=="number"&&isFinite(q)&&Math.floor(q)===q?i!=="categorical"&&V==="number"&&typeof q=="number"&&typeof h=="number"&&h!==void 0&&q<h?[new pt(O.key,ie,"stop domain values must appear in ascending order")]:(h=q,i==="categorical"&&q in y?[new pt(O.key,ie,"stop domain values must be unique")]:(y[q]=!0,[])):[new pt(O.key,ie,`integer expected, found ${String(q)}`)]}}function vr(r){const t=(r.expressionContext==="property"?Wl:Ta)(_r(r.value),r.valueSpec);if(t.result==="error")return t.value.map(c=>new pt(`${r.key}${c.key}`,r.value,c.message));const i=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!i.outputDefined())return[new pt(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!ko(i))return[new pt(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter")return Hl(i,r);if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Ps(i,["zoom","feature-state"]))return[new pt(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!ga(i))return[new pt(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hl(r,t){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const h of t.valueSpec.expression.parameters)i.delete(h);if(i.size===0)return[];const c=[];return r instanceof Po&&i.has(r.name)?[new pt(t.key,t.value,`["${r.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(r.eachChild(h=>{c.push(...Hl(h,t))}),c)}function xu(r){const t=r.key,i=r.value,c=r.valueSpec,h=[];return Array.isArray(c.values)?c.values.indexOf(Yn(i))===-1&&h.push(new pt(t,i,`expected one of [${c.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(c.values).indexOf(Yn(i))===-1&&h.push(new pt(t,i,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(i)} found`)),h}function yd(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!yd(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function wu(r,t="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};yd(r)||(r=Sa(r));const i=r;let c=!0;try{c=function(T){if(!Ea(T))return T;let M=_r(T);return bu(M),M=nm(M),M}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const h=Be[`filter_${t}`],p=Ta(c,h);let y=null;if(p.result==="error")throw new Error(p.value.map(T=>`${T.key}: ${T.message}`).join(", "));y=(T,M,I)=>p.value.evaluate(T,M,{},I);let v=null,b=null;if(c!==i){const T=Ta(i,h);if(T.result==="error")throw new Error(T.value.map(M=>`${M.key}: ${M.message}`).join(", "));v=(M,I,D,O,B)=>T.value.evaluate(M,I,{},D,void 0,void 0,O,B),b=!ga(T.value.expression)}return{filter:y,dynamicFilter:v||void 0,needGeometry:rm(c),needFeature:!!b}}function nm(r){if(!Array.isArray(r))return r;const t=function(i){if(_d.has(i[0])){for(let c=1;c<i.length;c++)if(Ea(i[c]))return!0}return i}(r);return t===!0?t:t.map(i=>nm(i))}function bu(r){let t=!1;const i=[];if(r[0]==="case"){for(let c=1;c<r.length-1;c+=2)t=t||Ea(r[c]),i.push(r[c+1]);i.push(r[r.length-1])}else if(r[0]==="match"){t=t||Ea(r[1]);for(let c=2;c<r.length-1;c+=2)i.push(r[c+1]);i.push(r[r.length-1])}else if(r[0]==="step"){t=t||Ea(r[1]);for(let c=1;c<r.length-1;c+=2)i.push(r[c+1])}t&&(r.length=0,r.push("any",...i));for(let c=1;c<r.length;c++)bu(r[c])}function Ea(r){if(!Array.isArray(r))return!1;if((t=r[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let i=1;i<r.length;i++)if(Ea(r[i]))return!0;return!1}const _d=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function M_(r,t){return r<t?-1:r>t?1:0}function rm(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let t=1;t<r.length;t++)if(rm(r[t]))return!0;return!1}function Sa(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?vd(r[1],r[2],"=="):t==="!="?Tu(vd(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?vd(r[1],r[2],t):t==="any"?(i=r.slice(1),["any"].concat(i.map(Sa))):t==="all"?["all"].concat(r.slice(1).map(Sa)):t==="none"?["all"].concat(r.slice(1).map(Sa).map(Tu)):t==="in"?xd(r[1],r.slice(2)):t==="!in"?Tu(xd(r[1],r.slice(2))):t==="has"?wd(r[1]):t==="!has"?Tu(wd(r[1])):t!=="within"||r;var i}function vd(r,t,i){switch(r){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,r,t]}}function xd(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(i=>typeof i!=typeof t[0])?["filter-in-large",r,["literal",t.sort(M_)]]:["filter-in-small",r,["literal",t]]}}function wd(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Tu(r){return["!",r]}function Xl(r){return yd(_r(r.value))?vr(Eo({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):Kl(r)}function Kl(r){const t=r.value,i=r.key;if(tn(t)!=="array")return[new pt(i,t,`array expected, ${tn(t)} found`)];const c=r.styleSpec;let h,p=[];if(t.length<1)return[new pt(i,t,"filter array must have at least 1 element")];switch(p=p.concat(xu({key:`${i}[0]`,value:t[0],valueSpec:c.filter_operator,style:r.style,styleSpec:r.styleSpec})),Yn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Yn(t[1])==="$type"&&p.push(new pt(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&p.push(new pt(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=tn(t[1]),h!=="string"&&p.push(new pt(`${i}[1]`,t[1],`string expected, ${h} found`)));for(let y=2;y<t.length;y++)h=tn(t[y]),Yn(t[1])==="$type"?p=p.concat(xu({key:`${i}[${y}]`,value:t[y],valueSpec:c.geometry_type,style:r.style,styleSpec:r.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&p.push(new pt(`${i}[${y}]`,t[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)p=p.concat(Kl({key:`${i}[${y}]`,value:t[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":h=tn(t[1]),t.length!==2?p.push(new pt(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&p.push(new pt(`${i}[1]`,t[1],`string expected, ${h} found`));break;case"within":h=tn(t[1]),t.length!==2?p.push(new pt(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="object"&&p.push(new pt(`${i}[1]`,t[1],`object expected, ${h} found`))}return p}function bd(r,t){const i=r.key,c=r.style,h=r.styleSpec,p=r.value,y=r.objectKey,v=h[`${t}_${r.layerType}`];if(!v)return[];const b=y.match(/^(.*)-transition$/);if(t==="paint"&&b&&v[b[1]]&&v[b[1]].transition)return zr({key:i,value:p,valueSpec:h.transition,style:c,styleSpec:h});const T=r.valueSpec||v[y];if(!T)return[new pt(i,p,`unknown property "${y}"`)];let M;if(tn(p)==="string"&&xa(T)&&!T.tokens&&(M=/^{([^}]+)}$/.exec(p))){const D=`\`{ "type": "identity", "property": ${M?JSON.stringify(M[1]):'"_"'} }\``;return[new pt(i,p,`"${y}" does not support interpolation syntax
Use an identity property function instead: ${D}.`)]}const I=[];return r.layerType==="symbol"&&(y==="text-field"&&c&&!c.glyphs&&I.push(new pt(i,p,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&$l(_r(p))&&Yn(p.type)==="identity"&&I.push(new pt(i,p,'"text-font" does not support identity functions'))),I.concat(zr({key:r.key,value:p,valueSpec:T,style:c,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:y}))}function im(r){return bd(r,"paint")}function Td(r){return bd(r,"layout")}function om(r){let t=[];const i=r.value,c=r.key,h=r.style,p=r.styleSpec;i.type||i.ref||t.push(new pt(c,i,'either "type" or "ref" is required'));let y=Yn(i.type);const v=Yn(i.ref);if(i.id){const b=Yn(i.id);for(let T=0;T<r.arrayIndex;T++){const M=h.layers[T];Yn(M.id)===b&&t.push(new pt(c,i.id,`duplicate layer id "${i.id}", previously used at line ${M.id.__line__}`))}}if("ref"in i){let b;["type","source","source-layer","filter","layout"].forEach(T=>{T in i&&t.push(new pt(c,i[T],`"${T}" is prohibited for ref layers`))}),h.layers.forEach(T=>{Yn(T.id)===v&&(b=T)}),b?b.ref?t.push(new pt(c,i.ref,"ref cannot reference another ref layer")):y=Yn(b.type):typeof v=="string"&&t.push(new pt(c,i.ref,`ref layer "${v}" not found`))}else if(y!=="background"&&y!=="sky")if(i.source){const b=h.sources&&h.sources[i.source],T=b&&Yn(b.type);b?T==="vector"&&y==="raster"?t.push(new pt(c,i.source,`layer "${i.id}" requires a raster source`)):T==="raster"&&y!=="raster"?t.push(new pt(c,i.source,`layer "${i.id}" requires a vector source`)):T!=="vector"||i["source-layer"]?T==="raster-dem"&&y!=="hillshade"?t.push(new pt(c,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||T==="geojson"&&b.lineMetrics||t.push(new pt(c,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new pt(c,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new pt(c,i.source,`source "${i.source}" not found`))}else t.push(new pt(c,i,'missing required property "source"'));return t=t.concat(Bi({key:c,value:i,valueSpec:p.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>zr({key:`${c}.type`,value:i.type,valueSpec:p.layer.type,style:r.style,styleSpec:r.styleSpec,object:i,objectKey:"type"}),filter:b=>Xl(Eo({layerType:y},b)),layout:b=>Bi({layer:i,key:b.key,value:b.value,valueSpec:{},style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":T=>Td(Eo({layerType:y},T))}}),paint:b=>Bi({layer:i,key:b.key,value:b.value,valueSpec:{},style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":T=>im(Eo({layerType:y},T))}})}})),t}function es(r){const t=r.value,i=r.key,c=tn(t);return c!=="string"?[new pt(i,t,`string expected, ${c} found`)]:[]}const sm={promoteId:function({key:r,value:t}){if(tn(t)==="string")return es({key:r,value:t});{const i=[];for(const c in t)i.push(...es({key:`${r}.${c}`,value:t[c]}));return i}}};function am(r){const t=r.value,i=r.key,c=r.styleSpec,h=r.style;if(!t.type)return[new pt(i,t,'"type" is required')];const p=Yn(t.type);let y;switch(p){case"vector":case"raster":case"raster-dem":return y=Bi({key:i,value:t,valueSpec:c[`source_${p.replace("-","_")}`],style:r.style,styleSpec:c,objectElementValidators:sm}),y;case"geojson":if(y=Bi({key:i,value:t,valueSpec:c.source_geojson,style:h,styleSpec:c,objectElementValidators:sm}),t.cluster)for(const v in t.clusterProperties){const[b,T]=t.clusterProperties[v],M=typeof b=="string"?[b,["accumulated"],["get",v]]:b;y.push(...vr({key:`${i}.${v}.map`,value:T,expressionContext:"cluster-map"})),y.push(...vr({key:`${i}.${v}.reduce`,value:M,expressionContext:"cluster-reduce"}))}return y;case"video":return Bi({key:i,value:t,valueSpec:c.source_video,style:h,styleSpec:c});case"image":return Bi({key:i,value:t,valueSpec:c.source_image,style:h,styleSpec:c});case"canvas":return[new pt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return xu({key:`${i}.type`,value:t.type,valueSpec:{values:k_(c)},style:h,styleSpec:c})}}function k_(r){return r.source.reduce((t,i)=>{const c=r[i];return c.type.type==="enum"&&(t=t.concat(Object.keys(c.type.values))),t},[])}function lm(r){const t=r.value,i=r.styleSpec,c=i.light,h=r.style;let p=[];const y=tn(t);if(t===void 0)return p;if(y!=="object")return p=p.concat([new pt("light",t,`object expected, ${y} found`)]),p;for(const v in t){const b=v.match(/^(.*)-transition$/);p=p.concat(b&&c[b[1]]&&c[b[1]].transition?zr({key:v,value:t[v],valueSpec:i.transition,style:h,styleSpec:i}):c[v]?zr({key:v,value:t[v],valueSpec:c[v],style:h,styleSpec:i}):[new pt(v,t[v],`unknown property "${v}"`)])}return p}function Ed(r){const t=r.value,i=r.key,c=r.style,h=r.styleSpec,p=h.terrain;let y=[];const v=tn(t);if(t===void 0)return y;if(v!=="object")return y=y.concat([new pt("terrain",t,`object expected, ${v} found`)]),y;for(const b in t){const T=b.match(/^(.*)-transition$/);y=y.concat(T&&p[T[1]]&&p[T[1]].transition?zr({key:b,value:t[b],valueSpec:h.transition,style:c,styleSpec:h}):p[b]?zr({key:b,value:t[b],valueSpec:p[b],style:c,styleSpec:h}):[new pt(b,t[b],`unknown property "${b}"`)])}if(t.source){const b=c.sources&&c.sources[t.source],T=b&&Yn(b.type);b?T!=="raster-dem"&&y.push(new pt(i,t.source,`terrain cannot be used with a source of type ${String(T)}, it only be used with a "raster-dem" source type`)):y.push(new pt(i,t.source,`source "${t.source}" not found`))}else y.push(new pt(i,t,'terrain is missing required property "source"'));return y}function cm(r){const t=r.value,i=r.style,c=r.styleSpec,h=c.fog;let p=[];const y=tn(t);if(t===void 0)return p;if(y!=="object")return p=p.concat([new pt("fog",t,`object expected, ${y} found`)]),p;for(const v in t){const b=v.match(/^(.*)-transition$/);p=p.concat(b&&h[b[1]]&&h[b[1]].transition?zr({key:v,value:t[v],valueSpec:c.transition,style:i,styleSpec:c}):h[v]?zr({key:v,value:t[v],valueSpec:h[v],style:i,styleSpec:c}):[new pt(v,t[v],`unknown property "${v}"`)])}return p}const um={"*":()=>[],array:tm,boolean:function(r){const t=r.value,i=r.key,c=tn(t);return c!=="boolean"?[new pt(i,t,`boolean expected, ${c} found`)]:[]},number:Zl,color:function(r){const t=r.key,i=r.value,c=tn(i);return c!=="string"?[new pt(t,i,`color expected, ${c} found`)]:Vh(i)===null?[new pt(t,i,`color expected, "${i}" found`)]:[]},enum:xu,filter:Xl,function:ql,layer:om,object:Bi,source:am,light:lm,terrain:Ed,fog:cm,string:es,formatted:function(r){return es(r).length===0?[]:vr(r)},resolvedImage:function(r){return es(r).length===0?[]:vr(r)},projection:function(r){const t=r.value,i=r.styleSpec,c=i.projection,h=r.style;let p=[];const y=tn(t);if(y==="object")for(const v in t)p=p.concat(zr({key:v,value:t[v],valueSpec:c[v],style:h,styleSpec:i}));else y!=="string"&&(p=p.concat([new pt("projection",t,`object or string expected, ${y} found`)]));return p}};function zr(r){const t=r.value,i=r.valueSpec,c=r.styleSpec;return i.expression&&$l(Yn(t))?ql(r):i.expression&&ba(_r(t))?vr(r):i.type&&um[i.type]?um[i.type](r):Bi(Eo({},r,{valueSpec:i.type?c[i.type]:i}))}function I_(r){const t=r.value,i=r.key,c=es(r);return c.length||(t.indexOf("{fontstack}")===-1&&c.push(new pt(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&c.push(new pt(i,t,'"glyphs" url must include a "{range}" token'))),c}function hm(r,t=Be){return Ei(zr({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,objectElementValidators:{glyphs:I_,"*":()=>[]}}))}const A_=r=>Ei(im(r)),D_=r=>Ei(Td(r));function Ei(r){return r.slice().sort((t,i)=>t.line&&i.line?t.line-i.line:0)}function dm(r,t){let i=!1;if(t&&t.length)for(const c of t)r.fire(new To(new Error(c.message))),i=!0;return i}var L_=ro,ji=3;function ro(r,t,i){var c=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var h=new Int32Array(this.arrayBuffer);r=h[0],this.d=(t=h[1])+2*(i=h[2]);for(var p=0;p<this.d*this.d;p++){var y=h[ji+p],v=h[ji+p+1];c.push(y===v?null:h.subarray(y,v))}var b=h[ji+c.length+1];this.keys=h.subarray(h[ji+c.length],b),this.bboxes=h.subarray(b),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var T=0;T<this.d*this.d;T++)c.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=r,this.padding=i,this.scale=t/r,this.uid=0;var M=i/t*r;this.min=-M,this.max=r+M}ro.prototype.insert=function(r,t,i,c,h){this._forEachCell(t,i,c,h,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(c),this.bboxes.push(h)},ro.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ro.prototype._insertCell=function(r,t,i,c,h,p){this.cells[h].push(p)},ro.prototype.query=function(r,t,i,c,h){var p=this.min,y=this.max;if(r<=p&&t<=p&&y<=i&&y<=c&&!h)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(r,t,i,c,this._queryCell,v,{},h),v},ro.prototype._queryCell=function(r,t,i,c,h,p,y,v){var b=this.cells[h];if(b!==null)for(var T=this.keys,M=this.bboxes,I=0;I<b.length;I++){var D=b[I];if(y[D]===void 0){var O=4*D;(v?v(M[O+0],M[O+1],M[O+2],M[O+3]):r<=M[O+2]&&t<=M[O+3]&&i>=M[O+0]&&c>=M[O+1])?(y[D]=!0,p.push(T[D])):y[D]=!1}}},ro.prototype._forEachCell=function(r,t,i,c,h,p,y,v){for(var b=this._convertToCellCoord(r),T=this._convertToCellCoord(t),M=this._convertToCellCoord(i),I=this._convertToCellCoord(c),D=b;D<=M;D++)for(var O=T;O<=I;O++){var B=this.d*O+D;if((!v||v(this._convertFromCellCoord(D),this._convertFromCellCoord(O),this._convertFromCellCoord(D+1),this._convertFromCellCoord(O+1)))&&h.call(this,r,t,i,c,B,p,y,v))return}},ro.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},ro.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},ro.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,t=ji+this.cells.length+1+1,i=0,c=0;c<this.cells.length;c++)i+=this.cells[c].length;var h=new Int32Array(t+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var p=t,y=0;y<r.length;y++){var v=r[y];h[ji+y]=p,h.set(v,p),p+=v.length}return h[ji+r.length]=p,h.set(this.keys,p),h[ji+r.length+1]=p+=this.keys.length,h.set(this.bboxes,p),p+=this.bboxes.length,h.buffer};var Is=fe(L_);const Eu={};function gt(r,t,i={}){Object.defineProperty(r,"_classRegistryKey",{value:t,writeable:!1}),Eu[t]={klass:r,omit:i.omit||[]}}gt(Object,"Object"),Is.serialize=function(r,t){const i=r.toArrayBuffer();return t&&t.push(i),{buffer:i}},Is.deserialize=function(r){return new Is(r.buffer)},Object.defineProperty(Is,"name",{value:"Grid"}),gt(Is,"Grid"),gt(Zn,"Color"),gt(Error,"Error"),gt(Jo,"AJAXError"),gt(bi,"ResolvedImage"),gt(_u,"StylePropertyFunction"),gt(yu,"StyleExpression",{omit:["_evaluator"]}),gt(Gl,"ZoomDependentExpression"),gt(gd,"ZoomConstantExpression"),gt(Po,"CompoundExpression",{omit:["_evaluate"]});for(const r in Vl)Eu[Vl[r]._classRegistryKey]||gt(Vl[r],`Expression${r}`);function Sd(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Cd(r){return P.ImageBitmap&&r instanceof P.ImageBitmap}function Ca(r,t){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(Sd(r)||Cd(r))return t&&t.push(r),r;if(ArrayBuffer.isView(r)){const i=r;return t&&t.push(i.buffer),i}if(r instanceof P.ImageData)return t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const i=[];for(const c of r)i.push(Ca(c,t));return i}if(typeof r=="object"){const i=r.constructor,c=i._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const h=i.serialize?i.serialize(r,t):{};if(!i.serialize){for(const p in r)r.hasOwnProperty(p)&&(Eu[c].omit.indexOf(p)>=0||(h[p]=Ca(r[p],t)));r instanceof Error&&(h.message=r.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(h.$name=c),h}throw new Error("can't serialize object of type "+typeof r)}function As(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||Sd(r)||Cd(r)||ArrayBuffer.isView(r)||r instanceof P.ImageData)return r;if(Array.isArray(r))return r.map(As);if(typeof r=="object"){const t=r.$name||"Object",{klass:i}=Eu[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(r);const c=Object.create(i.prototype);for(const h of Object.keys(r))h!=="$name"&&(c[h]=As(r[h]));return c}throw new Error("can't deserialize object of type "+typeof r)}const dt={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Pd(r){for(const t of r)if(Md(t.charCodeAt(0)))return!0;return!1}function z_(r){for(const t of r)if(!fm(t.charCodeAt(0)))return!1;return!0}function fm(r){return!(dt.Arabic(r)||dt["Arabic Supplement"](r)||dt["Arabic Extended-A"](r)||dt["Arabic Presentation Forms-A"](r)||dt["Arabic Presentation Forms-B"](r))}function Md(r){return!(r!==746&&r!==747&&(r<4352||!(dt["Bopomofo Extended"](r)||dt.Bopomofo(r)||dt["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||dt["CJK Compatibility Ideographs"](r)||dt["CJK Compatibility"](r)||dt["CJK Radicals Supplement"](r)||dt["CJK Strokes"](r)||!(!dt["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||dt["CJK Unified Ideographs Extension A"](r)||dt["CJK Unified Ideographs"](r)||dt["Enclosed CJK Letters and Months"](r)||dt["Hangul Compatibility Jamo"](r)||dt["Hangul Jamo Extended-A"](r)||dt["Hangul Jamo Extended-B"](r)||dt["Hangul Jamo"](r)||dt["Hangul Syllables"](r)||dt.Hiragana(r)||dt["Ideographic Description Characters"](r)||dt.Kanbun(r)||dt["Kangxi Radicals"](r)||dt["Katakana Phonetic Extensions"](r)||dt.Katakana(r)&&r!==12540||!(!dt["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!dt["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||dt["Unified Canadian Aboriginal Syllabics"](r)||dt["Unified Canadian Aboriginal Syllabics Extended"](r)||dt["Vertical Forms"](r)||dt["Yijing Hexagram Symbols"](r)||dt["Yi Syllables"](r)||dt["Yi Radicals"](r))))}function pm(r){return!(Md(r)||function(t){return!!(dt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||dt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||dt["Letterlike Symbols"](t)||dt["Number Forms"](t)||dt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||dt["Control Pictures"](t)&&t!==9251||dt["Optical Character Recognition"](t)||dt["Enclosed Alphanumerics"](t)||dt["Geometric Shapes"](t)||dt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||dt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||dt["CJK Symbols and Punctuation"](t)||dt.Katakana(t)||dt["Private Use Area"](t)||dt["CJK Compatibility Forms"](t)||dt["Small Form Variants"](t)||dt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}function mm(r){return r>=1424&&r<=2303||dt["Arabic Presentation Forms-A"](r)||dt["Arabic Presentation Forms-B"](r)}function R_(r,t){return!(!t&&mm(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||dt.Khmer(r))}function O_(r){for(const t of r)if(mm(t.charCodeAt(0)))return!0;return!1}const kd="deferred",Id="loading",Ad="loaded";let Pa=null,f="unavailable",o=null;const u=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(f="error"),Pa&&Pa(r)};function m(){_.fire(new Ts("pluginStateChange",{pluginStatus:f,pluginURL:o}))}const _=new Cl,w=function(){return f},S=function(){if(f!==kd||!o)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");f=Id,m(),o&&la({url:o},r=>{r?u(r):(f=Ad,m())})},C={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>f===Ad||C.applyArabicShaping!=null,isLoading:()=>f===Id,setState(r){f=r.pluginStatus,o=r.pluginURL},isParsed:()=>C.applyArabicShaping!=null&&C.processBidirectionalText!=null&&C.processStyledBidirectionalText!=null,getPluginURL:()=>o};class k{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(t){return function(i,c){for(const h of i)if(!R_(h.charCodeAt(0),c))return!1;return!0}(t,C.isLoaded())}}class z{constructor(t,i){this.property=t,this.value=i,this.expression=function(c,h){if($l(c))return new _u(c,h);if(ba(c)){const p=Wl(c,h);if(p.result==="error")throw new Error(p.value.map(y=>`${y.key}: ${y.message}`).join(", "));return p.value}{let p=c;return typeof c=="string"&&h.type==="color"&&(p=Zn.parse(c)),{kind:"constant",evaluate:()=>p}}}(i===void 0?t.specification.default:i,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,c){return this.property.possiblyEvaluate(this,t,i,c)}}class L{constructor(t){this.property=t,this.value=new z(t,void 0)}transitioned(t,i){return new W(this.property,this.value,i,ln({},t.transition,this.transition),t.now)}untransitioned(){return new W(this.property,this.value,null,{},0)}}class N{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ai(this._values[t].value.value)}setValue(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new L(this._values[t].property)),this._values[t].value=new z(this._values[t].property,i===null?void 0:ai(i))}getTransition(t){return ai(this._values[t].transition)}setTransition(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new L(this._values[t].property)),this._values[t].transition=ai(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const c=this.getValue(i);c!==void 0&&(t[i]=c);const h=this.getTransition(i);h!==void 0&&(t[`${i}-transition`]=h)}return t}transitioned(t,i){const c=new J(this._properties);for(const h of Object.keys(this._values))c._values[h]=this._values[h].transitioned(t,i._values[h]);return c}untransitioned(){const t=new J(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class W{constructor(t,i,c,h,p){const y=h.delay||0,v=h.duration||0;p=p||0,this.property=t,this.value=i,this.begin=p+y,this.end=this.begin+v,t.specification.transition&&(h.delay||h.duration)&&(this.prior=c)}possiblyEvaluate(t,i,c){const h=t.now||0,p=this.value.possiblyEvaluate(t,i,c),y=this.prior;if(y){if(h>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(h<this.begin)return y.possiblyEvaluate(t,i,c);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,i,c),p,It(v))}}return p}}class J{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,c){const h=new re(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(t,i,c);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ne{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return ai(this._values[t].value)}setValue(t,i){this._values[t]=new z(this._values[t].property,i===null?void 0:ai(i))}serialize(){const t={};for(const i of Object.keys(this._values)){const c=this.getValue(i);c!==void 0&&(t[i]=c)}return t}possiblyEvaluate(t,i,c){const h=new re(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(t,i,c);return h}}class te{constructor(t,i,c){this.property=t,this.value=i,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,c,h){return this.property.evaluate(this.value,this.parameters,t,i,c,h)}}class re{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class U{constructor(t){this.specification=t}possiblyEvaluate(t,i){return t.expression.evaluate(i)}interpolate(t,i,c){const h=Fl[this.specification.type];return h?h(t,i,c):t}}class K{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,c,h){return new te(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},c,h)}:t.expression,i)}interpolate(t,i,c){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new te(this,{kind:"constant",value:void 0},t.parameters);const h=Fl[this.specification.type];return h?new te(this,{kind:"constant",value:h(t.value.value,i.value.value,c)},t.parameters):t}evaluate(t,i,c,h,p,y){return t.kind==="constant"?t.value:t.evaluate(i,c,h,p,y)}}class ae{constructor(t){this.specification=t}possiblyEvaluate(t,i,c,h){return!!t.expression.evaluate(i,null,{},c,h)}interpolate(){return!1}}class le{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new k(0,{});for(const c in t){const h=t[c];h.specification.overridable&&this.overridableProperties.push(c);const p=this.defaultPropertyValues[c]=new z(h,void 0),y=this.defaultTransitionablePropertyValues[c]=new L(h);this.defaultTransitioningPropertyValues[c]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=p.possiblyEvaluate(i)}}}function ye(r,t){return 256*(r=He(Math.floor(r),0,255))+He(Math.floor(t),0,255)}gt(K,"DataDrivenProperty"),gt(U,"DataConstantProperty"),gt(ae,"ColorRampProperty");const xe={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class _e{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Se{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ee(r,t=1){let i=0,c=0;return{members:r.map(h=>{const p=xe[h.type].BYTES_PER_ELEMENT,y=i=De(i,Math.max(t,p)),v=h.components||1;return c=Math.max(c,p),i+=p*v,{name:h.name,type:h.type,components:v,offset:y}}),size:De(i,Math.max(c,t)),alignment:t}}function De(r,t){return Math.ceil(r/t)*t}class Ye extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const c=this.length;return this.resize(c+1),this.emplace(c,t,i)}emplace(t,i,c){const h=2*t;return this.int16[h+0]=i,this.int16[h+1]=c,t}}Ye.prototype.bytesPerElement=4,gt(Ye,"StructArrayLayout2i4");class ke extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,c)}emplace(t,i,c,h){const p=3*t;return this.int16[p+0]=i,this.int16[p+1]=c,this.int16[p+2]=h,t}}ke.prototype.bytesPerElement=6,gt(ke,"StructArrayLayout3i6");class $e extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,c,h)}emplace(t,i,c,h,p){const y=4*t;return this.int16[y+0]=i,this.int16[y+1]=c,this.int16[y+2]=h,this.int16[y+3]=p,t}}$e.prototype.bytesPerElement=8,gt($e,"StructArrayLayout4i8");class ze extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p,y,v){const b=this.length;return this.resize(b+1),this.emplace(b,t,i,c,h,p,y,v)}emplace(t,i,c,h,p,y,v,b){const T=6*t,M=12*t,I=3*t;return this.int16[T+0]=i,this.int16[T+1]=c,this.uint8[M+4]=h,this.uint8[M+5]=p,this.uint8[M+6]=y,this.uint8[M+7]=v,this.float32[I+2]=b,t}}ze.prototype.bytesPerElement=12,gt(ze,"StructArrayLayout2i4ub1f12");class Ke extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,c,h)}emplace(t,i,c,h,p){const y=4*t;return this.float32[y+0]=i,this.float32[y+1]=c,this.float32[y+2]=h,this.float32[y+3]=p,t}}Ke.prototype.bytesPerElement=16,gt(Ke,"StructArrayLayout4f16");class Ae extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,t,i,c,h,p)}emplace(t,i,c,h,p,y){const v=6*t,b=3*t;return this.uint16[v+0]=i,this.uint16[v+1]=c,this.uint16[v+2]=h,this.uint16[v+3]=p,this.float32[b+2]=y,t}}Ae.prototype.bytesPerElement=12,gt(Ae,"StructArrayLayout4ui1f12");class Ve extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,c,h)}emplace(t,i,c,h,p){const y=4*t;return this.uint16[y+0]=i,this.uint16[y+1]=c,this.uint16[y+2]=h,this.uint16[y+3]=p,t}}Ve.prototype.bytesPerElement=8,gt(Ve,"StructArrayLayout4ui8");class Qe extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,c,h,p,y)}emplace(t,i,c,h,p,y,v){const b=6*t;return this.int16[b+0]=i,this.int16[b+1]=c,this.int16[b+2]=h,this.int16[b+3]=p,this.int16[b+4]=y,this.int16[b+5]=v,t}}Qe.prototype.bytesPerElement=12,gt(Qe,"StructArrayLayout6i12");class qe extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p,y,v,b,T,M,I,D){const O=this.length;return this.resize(O+1),this.emplace(O,t,i,c,h,p,y,v,b,T,M,I,D)}emplace(t,i,c,h,p,y,v,b,T,M,I,D,O){const B=12*t;return this.int16[B+0]=i,this.int16[B+1]=c,this.int16[B+2]=h,this.int16[B+3]=p,this.uint16[B+4]=y,this.uint16[B+5]=v,this.uint16[B+6]=b,this.uint16[B+7]=T,this.int16[B+8]=M,this.int16[B+9]=I,this.int16[B+10]=D,this.int16[B+11]=O,t}}qe.prototype.bytesPerElement=24,gt(qe,"StructArrayLayout4i4ui4i24");class et extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,c,h,p,y)}emplace(t,i,c,h,p,y,v){const b=10*t,T=5*t;return this.int16[b+0]=i,this.int16[b+1]=c,this.int16[b+2]=h,this.float32[T+2]=p,this.float32[T+3]=y,this.float32[T+4]=v,t}}et.prototype.bytesPerElement=20,gt(et,"StructArrayLayout3i3f20");class Tt extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}Tt.prototype.bytesPerElement=4,gt(Tt,"StructArrayLayout1ul4");class At extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p,y,v,b,T,M,I,D,O){const B=this.length;return this.resize(B+1),this.emplace(B,t,i,c,h,p,y,v,b,T,M,I,D,O)}emplace(t,i,c,h,p,y,v,b,T,M,I,D,O,B){const V=20*t,q=10*t;return this.int16[V+0]=i,this.int16[V+1]=c,this.int16[V+2]=h,this.int16[V+3]=p,this.int16[V+4]=y,this.float32[q+3]=v,this.float32[q+4]=b,this.float32[q+5]=T,this.float32[q+6]=M,this.int16[V+14]=I,this.uint32[q+8]=D,this.uint16[V+18]=O,this.uint16[V+19]=B,t}}At.prototype.bytesPerElement=40,gt(At,"StructArrayLayout5i4f1i1ul2ui40");class _t extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p,y,v){const b=this.length;return this.resize(b+1),this.emplace(b,t,i,c,h,p,y,v)}emplace(t,i,c,h,p,y,v,b){const T=8*t;return this.int16[T+0]=i,this.int16[T+1]=c,this.int16[T+2]=h,this.int16[T+4]=p,this.int16[T+5]=y,this.int16[T+6]=v,this.int16[T+7]=b,t}}_t.prototype.bytesPerElement=16,gt(_t,"StructArrayLayout3i2i2i16");class Pt extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,t,i,c,h,p)}emplace(t,i,c,h,p,y){const v=4*t,b=8*t;return this.float32[v+0]=i,this.float32[v+1]=c,this.float32[v+2]=h,this.int16[b+6]=p,this.int16[b+7]=y,t}}Pt.prototype.bytesPerElement=16,gt(Pt,"StructArrayLayout2f1f2i16");class Xt extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,c,h)}emplace(t,i,c,h,p){const y=12*t,v=3*t;return this.uint8[y+0]=i,this.uint8[y+1]=c,this.float32[v+1]=h,this.float32[v+2]=p,t}}Xt.prototype.bytesPerElement=12,gt(Xt,"StructArrayLayout2ub2f12");class Zt extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,c)}emplace(t,i,c,h){const p=3*t;return this.float32[p+0]=i,this.float32[p+1]=c,this.float32[p+2]=h,t}}Zt.prototype.bytesPerElement=12,gt(Zt,"StructArrayLayout3f12");class wt extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,c){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,c)}emplace(t,i,c,h){const p=3*t;return this.uint16[p+0]=i,this.uint16[p+1]=c,this.uint16[p+2]=h,t}}wt.prototype.bytesPerElement=6,gt(wt,"StructArrayLayout3ui6");class hn extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p,y,v,b,T,M,I,D,O,B,V,q,ie,de,oe,ue,me){const pe=this.length;return this.resize(pe+1),this.emplace(pe,t,i,c,h,p,y,v,b,T,M,I,D,O,B,V,q,ie,de,oe,ue,me)}emplace(t,i,c,h,p,y,v,b,T,M,I,D,O,B,V,q,ie,de,oe,ue,me,pe){const Le=30*t,Ie=15*t,Ne=60*t;return this.int16[Le+0]=i,this.int16[Le+1]=c,this.int16[Le+2]=h,this.float32[Ie+2]=p,this.float32[Ie+3]=y,this.uint16[Le+8]=v,this.uint16[Le+9]=b,this.uint32[Ie+5]=T,this.uint32[Ie+6]=M,this.uint32[Ie+7]=I,this.uint16[Le+16]=D,this.uint16[Le+17]=O,this.uint16[Le+18]=B,this.float32[Ie+10]=V,this.float32[Ie+11]=q,this.uint8[Ne+48]=ie,this.uint8[Ne+49]=de,this.uint8[Ne+50]=oe,this.uint32[Ie+13]=ue,this.int16[Le+28]=me,this.uint8[Ne+58]=pe,t}}hn.prototype.bytesPerElement=60,gt(hn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class fn extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p,y,v,b,T,M,I,D,O,B,V,q,ie,de,oe,ue,me,pe,Le,Ie,Ne,Je,Re,We,Ze,Xe){const rt=this.length;return this.resize(rt+1),this.emplace(rt,t,i,c,h,p,y,v,b,T,M,I,D,O,B,V,q,ie,de,oe,ue,me,pe,Le,Ie,Ne,Je,Re,We,Ze,Xe)}emplace(t,i,c,h,p,y,v,b,T,M,I,D,O,B,V,q,ie,de,oe,ue,me,pe,Le,Ie,Ne,Je,Re,We,Ze,Xe,rt){const Fe=38*t,ut=19*t;return this.int16[Fe+0]=i,this.int16[Fe+1]=c,this.int16[Fe+2]=h,this.float32[ut+2]=p,this.float32[ut+3]=y,this.int16[Fe+8]=v,this.int16[Fe+9]=b,this.int16[Fe+10]=T,this.int16[Fe+11]=M,this.int16[Fe+12]=I,this.int16[Fe+13]=D,this.uint16[Fe+14]=O,this.uint16[Fe+15]=B,this.uint16[Fe+16]=V,this.uint16[Fe+17]=q,this.uint16[Fe+18]=ie,this.uint16[Fe+19]=de,this.uint16[Fe+20]=oe,this.uint16[Fe+21]=ue,this.uint16[Fe+22]=me,this.uint16[Fe+23]=pe,this.uint16[Fe+24]=Le,this.uint16[Fe+25]=Ie,this.uint16[Fe+26]=Ne,this.uint16[Fe+27]=Je,this.uint16[Fe+28]=Re,this.uint32[ut+15]=We,this.float32[ut+16]=Ze,this.float32[ut+17]=Xe,this.float32[ut+18]=rt,t}}fn.prototype.bytesPerElement=76,gt(fn,"StructArrayLayout3i2f6i15ui1ul3f76");class pn extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}pn.prototype.bytesPerElement=4,gt(pn,"StructArrayLayout1f4");class mn extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,t,i,c,h,p)}emplace(t,i,c,h,p,y){const v=5*t;return this.float32[v+0]=i,this.float32[v+1]=c,this.float32[v+2]=h,this.float32[v+3]=p,this.float32[v+4]=y,t}}mn.prototype.bytesPerElement=20,gt(mn,"StructArrayLayout5f20");class Rr extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,c,h)}emplace(t,i,c,h,p){const y=6*t;return this.uint32[3*t+0]=i,this.uint16[y+2]=c,this.uint16[y+3]=h,this.uint16[y+4]=p,t}}Rr.prototype.bytesPerElement=12,gt(Rr,"StructArrayLayout1ul3ui12");class xr extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const c=this.length;return this.resize(c+1),this.emplace(c,t,i)}emplace(t,i,c){const h=2*t;return this.uint16[h+0]=i,this.uint16[h+1]=c,t}}xr.prototype.bytesPerElement=4,gt(xr,"StructArrayLayout2ui4");class Si extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}Si.prototype.bytesPerElement=2,gt(Si,"StructArrayLayout1ui2");class io extends Se{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const c=this.length;return this.resize(c+1),this.emplace(c,t,i)}emplace(t,i,c){const h=2*t;return this.float32[h+0]=i,this.float32[h+1]=c,t}}io.prototype.bytesPerElement=8,gt(io,"StructArrayLayout2f8");class zn extends _e{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}zn.prototype.size=40;class gn extends At{get(t){return new zn(this,t)}}gt(gn,"CollisionBoxArray");class rn extends _e{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}rn.prototype.size=60;class Jn extends hn{get(t){return new rn(this,t)}}gt(Jn,"PlacedSymbolArray");class Vr extends _e{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Vr.prototype.size=76;class Mn extends fn{get(t){return new Vr(this,t)}}gt(Mn,"SymbolInstanceArray");class Xr extends pn{getoffsetX(t){return this.float32[1*t+0]}}gt(Xr,"GlyphOffsetArray");class Su extends Ye{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}gt(Su,"SymbolLineVertexArray");class Ds extends _e{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ds.prototype.size=12;class Yl extends Rr{get(t){return new Ds(this,t)}}gt(Yl,"FeatureIndexArray");class Do extends xr{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}gt(Do,"FillExtrusionCentroidArray");const ts=Ee([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ls=Ee([{name:"a_dash",components:4,type:"Uint16"}]);var Cu={exports:{}},Jl={exports:{}};Jl.exports=function(r,t){var i,c,h,p,y,v,b,T;for(c=r.length-(i=3&r.length),h=t,y=3432918353,v=461845907,T=0;T<c;)b=255&r.charCodeAt(T)|(255&r.charCodeAt(++T))<<8|(255&r.charCodeAt(++T))<<16|(255&r.charCodeAt(++T))<<24,++T,h=27492+(65535&(p=5*(65535&(h=(h^=b=(65535&(b=(b=(65535&b)*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(b=0,i){case 3:b^=(255&r.charCodeAt(T+2))<<16;case 2:b^=(255&r.charCodeAt(T+1))<<8;case 1:h^=b=(65535&(b=(b=(65535&(b^=255&r.charCodeAt(T)))*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return h^=r.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var Dd=Jl.exports,Hw={exports:{}};Hw.exports=function(r,t){for(var i,c=r.length,h=t^c,p=0;c>=4;)i=1540483477*(65535&(i=255&r.charCodeAt(p)|(255&r.charCodeAt(++p))<<8|(255&r.charCodeAt(++p))<<16|(255&r.charCodeAt(++p))<<24))+((1540483477*(i>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),c-=4,++p;switch(c){case 3:h^=(255&r.charCodeAt(p+2))<<16;case 2:h^=(255&r.charCodeAt(p+1))<<8;case 1:h=1540483477*(65535&(h^=255&r.charCodeAt(p)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var Xw=Dd,r3=Hw.exports;Cu.exports=Xw,Cu.exports.murmur3=Xw,Cu.exports.murmur2=r3;var F_=fe(Cu.exports);class gm{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,i,c,h){this.ids.push(Kw(t)),this.positions.push(i,c,h)}getPositions(t){const i=Kw(t);let c=0,h=this.ids.length-1;for(;c<h;){const y=c+h>>1;this.ids[y]>=i?h=y:c=y+1}const p=[];for(;this.ids[c]===i;)p.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return p}static serialize(t,i){const c=new Float64Array(t.ids),h=new Uint32Array(t.positions);return B_(c,h,0,c.length-1),i&&i.push(c.buffer,h.buffer),{ids:c,positions:h}}static deserialize(t){const i=new gm;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i}}function Kw(r){const t=+r;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:F_(String(r))}function B_(r,t,i,c){for(;i<c;){const h=r[i+c>>1];let p=i-1,y=c+1;for(;;){do p++;while(r[p]<h);do y--;while(r[y]>h);if(p>=y)break;ym(r,p,y),ym(t,3*p,3*y),ym(t,3*p+1,3*y+1),ym(t,3*p+2,3*y+2)}y-i<c-y?(B_(r,t,i,y),i=y+1):(B_(r,t,y+1,c),c=y)}}function ym(r,t,i){const c=r[t];r[t]=r[i],r[i]=c}gt(gm,"FeaturePositionMap");class zs{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,i),this.initialized=!0),!!this.location}}class _m extends zs{constructor(t){super(t),this.current=0}set(t,i,c){this.fetchUniformLocation(t,i)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Yw extends zs{constructor(t){super(t),this.current=[0,0,0,0]}set(t,i,c){this.fetchUniformLocation(t,i)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class Jw extends zs{constructor(t){super(t),this.current=Zn.transparent}set(t,i,c){this.fetchUniformLocation(t,i)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const i3=new Float32Array(16),o3=new Float32Array(9),s3=new Float32Array(4);function j_(r){return[ye(255*r.r,255*r.g),ye(255*r.b,255*r.a)]}class Ld{constructor(t,i,c){this.value=t,this.uniformNames=i.map(h=>`u_${h}`),this.type=c}setUniform(t,i,c,h,p){i.set(t,p,h.constantOr(this.value))}getBinding(t,i){return this.type==="color"?new Jw(t):new _m(t)}}class Pu{constructor(t,i){this.uniformNames=i.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,i,c,h,p){const y=p==="u_pattern"||p==="u_dash"?this.pattern:p==="u_pixel_ratio"?this.pixelRatio:null;y&&i.set(t,p,y)}getBinding(t,i){return i==="u_pattern"||i==="u_dash"?new Yw(t):new _m(t)}}class Rs{constructor(t,i,c,h){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=i.map(p=>({name:`a_${p}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,i,c,h,p,y){const v=this.paintVertexArray.length,b=this.expression.evaluate(new k(0),i,{},p,h,y);this.paintVertexArray.resize(t),this._setPaintValue(v,t,b)}updatePaintArray(t,i,c,h,p){const y=this.expression.evaluate({zoom:0},c,h,void 0,p);this._setPaintValue(t,i,y)}_setPaintValue(t,i,c){if(this.type==="color"){const h=j_(c);for(let p=t;p<i;p++)this.paintVertexArray.emplace(p,h[0],h[1])}else{for(let h=t;h<i;h++)this.paintVertexArray.emplace(h,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Lo{constructor(t,i,c,h,p,y){this.expression=t,this.uniformNames=i.map(v=>`u_${v}_t`),this.type=c,this.useIntegerZoom=h,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=i.map(v=>({name:`a_${v}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(t,i,c,h,p,y){const v=this.expression.evaluate(new k(this.zoom),i,{},p,h,y),b=this.expression.evaluate(new k(this.zoom+1),i,{},p,h,y),T=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(T,t,v,b)}updatePaintArray(t,i,c,h,p){const y=this.expression.evaluate({zoom:this.zoom},c,h,void 0,p),v=this.expression.evaluate({zoom:this.zoom+1},c,h,void 0,p);this._setPaintValue(t,i,y,v)}_setPaintValue(t,i,c,h){if(this.type==="color"){const p=j_(c),y=j_(h);for(let v=t;v<i;v++)this.paintVertexArray.emplace(v,p[0],p[1],y[0],y[1])}else{for(let p=t;p<i;p++)this.paintVertexArray.emplace(p,c,h);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i,c,h,p){const y=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,v=He(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);i.set(t,p,v)}getBinding(t,i){return new _m(t)}}class Ma{constructor(t,i,c,h,p){this.expression=t,this.layerId=p,this.paintVertexAttributes=(c==="array"?Ls:ts).members;for(let y=0;y<i.length;++y);this.paintVertexArray=new h}populatePaintArray(t,i,c){const h=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(h,t,i.patterns&&i.patterns[this.layerId],c)}updatePaintArray(t,i,c,h,p,y){this._setPaintValues(t,i,c.patterns&&c.patterns[this.layerId],y)}_setPaintValues(t,i,c,h){if(!h||!c)return;const p=h[c];if(!p)return;const{tl:y,br:v,pixelRatio:b}=p;for(let T=t;T<i;T++)this.paintVertexArray.emplace(T,y[0],y[1],v[0],v[1],b)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ka{constructor(t,i,c=()=>!0){this.binders={},this._buffers=[];const h=[];for(const p in t.paint._values){if(!c(p))continue;const y=t.paint.get(p);if(!(y instanceof te&&xa(y.property.specification)))continue;const v=l3(p,t.type),b=y.value,T=y.property.specification.type,M=!!y.property.useIntegerZoom,I=p==="line-dasharray"||p.endsWith("pattern"),D=p==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(b.kind!=="constant"||D)if(b.kind==="source"||D||I){const O=Qw(p,T,"source");this.binders[p]=I?new Ma(b,v,T,O,t.id):new Rs(b,v,T,O),h.push(`/a_${p}`)}else{const O=Qw(p,T,"composite");this.binders[p]=new Lo(b,v,T,M,i,O),h.push(`/z_${p}`)}else this.binders[p]=I?new Pu(b.value,v):new Ld(b.value,v,T),h.push(`/u_${p}`)}this.cacheKey=h.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof Rs||i instanceof Lo?i.maxValue:0}populatePaintArrays(t,i,c,h,p,y){for(const v in this.binders){const b=this.binders[v];(b instanceof Rs||b instanceof Lo||b instanceof Ma)&&b.populatePaintArray(t,i,c,h,p,y)}}setConstantPatternPositions(t){for(const i in this.binders){const c=this.binders[i];c instanceof Pu&&c.setConstantPatternPositions(t)}}updatePaintArrays(t,i,c,h,p,y){let v=!1;for(const b in t){const T=i.getPositions(b);for(const M of T){const I=c.feature(M.index);for(const D in this.binders){const O=this.binders[D];if((O instanceof Rs||O instanceof Lo||O instanceof Ma)&&O.expression.isStateDependent===!0){const B=h.paint.get(D);O.expression=B.value,O.updatePaintArray(M.start,M.end,I,t[b],p,y),v=!0}}}}return v}defines(){const t=[];for(const i in this.binders){const c=this.binders[i];(c instanceof Ld||c instanceof Pu)&&t.push(...c.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const c=this.binders[i];if(c instanceof Rs||c instanceof Lo||c instanceof Ma)for(let h=0;h<c.paintVertexAttributes.length;h++)t.push(c.paintVertexAttributes[h].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const c=this.binders[i];if(c instanceof Ld||c instanceof Pu||c instanceof Lo)for(const h of c.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const i=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof Ld||h instanceof Pu||h instanceof Lo)for(const p of h.uniformNames)i.push({name:p,property:c,binding:h.getBinding(t,p)})}return i}setUniforms(t,i,c,h,p){for(const{name:y,property:v,binding:b}of c)this.binders[v].setUniform(t,b,p,h.get(v),y)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const i=this.binders[t];(i instanceof Rs||i instanceof Lo||i instanceof Ma)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const i in this.binders){const c=this.binders[i];(c instanceof Rs||c instanceof Lo||c instanceof Ma)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof Rs||i instanceof Lo||i instanceof Ma)&&i.destroy()}}}class Ql{constructor(t,i,c=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new ka(h,i,c);this.needsUpload=!1,this._featureMap=new gm,this._bufferOffset=0}populatePaintArrays(t,i,c,h,p,y,v){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,i,h,p,y,v);i.id!==void 0&&this._featureMap.add(i.id,c,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,c,h,p){for(const y of c)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(t,this._featureMap,i,y,h,p)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const a3={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function l3(r,t){return a3[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}const c3={"line-pattern":{source:Ae,composite:Ae},"fill-pattern":{source:Ae,composite:Ae},"fill-extrusion-pattern":{source:Ae,composite:Ae},"line-dasharray":{source:Ve,composite:Ve}},u3={color:{source:io,composite:Ke},number:{source:pn,composite:io}};function Qw(r,t,i){const c=c3[r];return c&&c[i]||u3[t][i]}gt(Ld,"ConstantBinder"),gt(Pu,"PatternConstantBinder"),gt(Rs,"SourceExpressionBinder"),gt(Ma,"PatternCompositeBinder"),gt(Lo,"CompositeExpressionBinder"),gt(ka,"ProgramConfiguration",{omit:["_buffers"]}),gt(Ql,"ProgramConfigurationSet");const eb="-transition";class zo extends Cl{constructor(t,i){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),i.layout&&(this._unevaluatedLayout=new ne(i.layout)),i.paint)){this._transitionablePaint=new N(i.paint);for(const c in t.paint)this.setPaintProperty(c,t.paint[c],{validate:!1});for(const c in t.layout)this.setLayoutProperty(c,t.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new re(i.paint)}}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i,c={}){i!=null&&this._validate(D_,`layers.${this.id}.layout.${t}`,t,i,c)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,i):this.visibility=i)}getPaintProperty(t){return Sn(t,eb)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i,c={}){if(i!=null&&this._validate(A_,`layers.${this.id}.paint.${t}`,t,i,c))return!1;if(Sn(t,eb))return this._transitionablePaint.setTransition(t.slice(0,-11),i||void 0),!1;{const h=this._transitionablePaint._values[t],p=h.value.isDataDriven(),y=h.value;this._transitionablePaint.setValue(t,i),this._handleSpecialPaintPropertyUpdate(t);const v=this._transitionablePaint._values[t].value,b=v.isDataDriven(),T=Sn(t,"pattern")||t==="line-dasharray";return b||p||T||this._handleOverridablePaintPropertyUpdate(t,y,v)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,i,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),xo(t,(i,c)=>!(i===void 0||c==="layout"&&!Object.keys(i).length||c==="paint"&&!Object.keys(i).length))}_validate(t,i,c,h,p={}){return(!p||p.validate!==!1)&&dm(this,t.call(hm,{key:i,layerType:this.type,objectKey:c,value:h,styleSpec:Be,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof te&&xa(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=wu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const h3=Ee([{name:"a_pos",components:2,type:"Int16"}],4),d3=Ee([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Qn{constructor(t=[]){this.segments=t}prepareSegment(t,i,c,h){let p=this.segments[this.segments.length-1];return t>Qn.MAX_VERTEX_ARRAY_LENGTH&&Rn(`Max vertices per segment is ${Qn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!p||p.vertexLength+t>Qn.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==h)&&(p={vertexOffset:i.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},h!==void 0&&(p.sortKey=h),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,c,h){return new Qn([{vertexOffset:t,primitiveOffset:i,vertexLength:c,primitiveLength:h,vaos:{},sortKey:0}])}}Qn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,gt(Qn,"SegmentVector");var Ct=8192;class Ia{constructor(t,i){t&&(i?this.setSouthWest(t).setNorthEast(i):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof yn?new yn(t.lng,t.lat):yn.convert(t),this}setSouthWest(t){return this._sw=t instanceof yn?new yn(t.lng,t.lat):yn.convert(t),this}extend(t){const i=this._sw,c=this._ne;let h,p;if(t instanceof yn)h=t,p=t;else{if(!(t instanceof Ia))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ia.convert(t)):this.extend(yn.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(yn.convert(t)):this;if(h=t._sw,p=t._ne,!h||!p)return this}return i||c?(i.lng=Math.min(h.lng,i.lng),i.lat=Math.min(h.lat,i.lat),c.lng=Math.max(p.lng,c.lng),c.lat=Math.max(p.lat,c.lat)):(this._sw=new yn(h.lng,h.lat),this._ne=new yn(p.lng,p.lat)),this}getCenter(){return new yn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new yn(this.getWest(),this.getNorth())}getSouthEast(){return new yn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:i,lat:c}=yn.convert(t);let h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&h}static convert(t){return!t||t instanceof Ia?t:new Ia(t)}}var vm=1e-6,Ci=typeof Float32Array<"u"?Float32Array:Array;function tb(){var r=new Ci(9);return Ci!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function nb(r,t,i){var c=t[0],h=t[1],p=t[2],y=t[3],v=t[4],b=t[5],T=t[6],M=t[7],I=t[8],D=i[0],O=i[1],B=i[2],V=i[3],q=i[4],ie=i[5],de=i[6],oe=i[7],ue=i[8];return r[0]=D*c+O*y+B*T,r[1]=D*h+O*v+B*M,r[2]=D*p+O*b+B*I,r[3]=V*c+q*y+ie*T,r[4]=V*h+q*v+ie*M,r[5]=V*p+q*b+ie*I,r[6]=de*c+oe*y+ue*T,r[7]=de*h+oe*v+ue*M,r[8]=de*p+oe*b+ue*I,r}function Ro(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function N_(r,t){var i=t[0],c=t[1],h=t[2],p=t[3],y=t[4],v=t[5],b=t[6],T=t[7],M=t[8],I=t[9],D=t[10],O=t[11],B=t[12],V=t[13],q=t[14],ie=t[15],de=i*v-c*y,oe=i*b-h*y,ue=i*T-p*y,me=c*b-h*v,pe=c*T-p*v,Le=h*T-p*b,Ie=M*V-I*B,Ne=M*q-D*B,Je=M*ie-O*B,Re=I*q-D*V,We=I*ie-O*V,Ze=D*ie-O*q,Xe=de*Ze-oe*We+ue*Re+me*Je-pe*Ne+Le*Ie;return Xe?(r[0]=(v*Ze-b*We+T*Re)*(Xe=1/Xe),r[1]=(h*We-c*Ze-p*Re)*Xe,r[2]=(V*Le-q*pe+ie*me)*Xe,r[3]=(D*pe-I*Le-O*me)*Xe,r[4]=(b*Je-y*Ze-T*Ne)*Xe,r[5]=(i*Ze-h*Je+p*Ne)*Xe,r[6]=(q*ue-B*Le-ie*oe)*Xe,r[7]=(M*Le-D*ue+O*oe)*Xe,r[8]=(y*We-v*Je+T*Ie)*Xe,r[9]=(c*Je-i*We-p*Ie)*Xe,r[10]=(B*pe-V*ue+ie*de)*Xe,r[11]=(I*ue-M*pe-O*de)*Xe,r[12]=(v*Ne-y*Re-b*Ie)*Xe,r[13]=(i*Re-c*Ne+h*Ie)*Xe,r[14]=(V*oe-B*me-q*de)*Xe,r[15]=(M*me-I*oe+D*de)*Xe,r):null}function ec(r,t,i){var c=t[0],h=t[1],p=t[2],y=t[3],v=t[4],b=t[5],T=t[6],M=t[7],I=t[8],D=t[9],O=t[10],B=t[11],V=t[12],q=t[13],ie=t[14],de=t[15],oe=i[0],ue=i[1],me=i[2],pe=i[3];return r[0]=oe*c+ue*v+me*I+pe*V,r[1]=oe*h+ue*b+me*D+pe*q,r[2]=oe*p+ue*T+me*O+pe*ie,r[3]=oe*y+ue*M+me*B+pe*de,r[4]=(oe=i[4])*c+(ue=i[5])*v+(me=i[6])*I+(pe=i[7])*V,r[5]=oe*h+ue*b+me*D+pe*q,r[6]=oe*p+ue*T+me*O+pe*ie,r[7]=oe*y+ue*M+me*B+pe*de,r[8]=(oe=i[8])*c+(ue=i[9])*v+(me=i[10])*I+(pe=i[11])*V,r[9]=oe*h+ue*b+me*D+pe*q,r[10]=oe*p+ue*T+me*O+pe*ie,r[11]=oe*y+ue*M+me*B+pe*de,r[12]=(oe=i[12])*c+(ue=i[13])*v+(me=i[14])*I+(pe=i[15])*V,r[13]=oe*h+ue*b+me*D+pe*q,r[14]=oe*p+ue*T+me*O+pe*ie,r[15]=oe*y+ue*M+me*B+pe*de,r}function zd(r,t,i){var c,h,p,y,v,b,T,M,I,D,O,B,V=i[0],q=i[1],ie=i[2];return t===r?(r[12]=t[0]*V+t[4]*q+t[8]*ie+t[12],r[13]=t[1]*V+t[5]*q+t[9]*ie+t[13],r[14]=t[2]*V+t[6]*q+t[10]*ie+t[14],r[15]=t[3]*V+t[7]*q+t[11]*ie+t[15]):(h=t[1],p=t[2],y=t[3],v=t[4],b=t[5],T=t[6],M=t[7],I=t[8],D=t[9],O=t[10],B=t[11],r[0]=c=t[0],r[1]=h,r[2]=p,r[3]=y,r[4]=v,r[5]=b,r[6]=T,r[7]=M,r[8]=I,r[9]=D,r[10]=O,r[11]=B,r[12]=c*V+v*q+I*ie+t[12],r[13]=h*V+b*q+D*ie+t[13],r[14]=p*V+T*q+O*ie+t[14],r[15]=y*V+M*q+B*ie+t[15]),r}function tc(r,t,i){var c=i[0],h=i[1],p=i[2];return r[0]=t[0]*c,r[1]=t[1]*c,r[2]=t[2]*c,r[3]=t[3]*c,r[4]=t[4]*h,r[5]=t[5]*h,r[6]=t[6]*h,r[7]=t[7]*h,r[8]=t[8]*p,r[9]=t[9]*p,r[10]=t[10]*p,r[11]=t[11]*p,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function U_(r,t,i){var c=Math.sin(i),h=Math.cos(i),p=t[4],y=t[5],v=t[6],b=t[7],T=t[8],M=t[9],I=t[10],D=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=p*h+T*c,r[5]=y*h+M*c,r[6]=v*h+I*c,r[7]=b*h+D*c,r[8]=T*h-p*c,r[9]=M*h-y*c,r[10]=I*h-v*c,r[11]=D*h-b*c,r}function xm(r,t,i){var c=Math.sin(i),h=Math.cos(i),p=t[0],y=t[1],v=t[2],b=t[3],T=t[8],M=t[9],I=t[10],D=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=p*h-T*c,r[1]=y*h-M*c,r[2]=v*h-I*c,r[3]=b*h-D*c,r[8]=p*c+T*h,r[9]=y*c+M*h,r[10]=v*c+I*h,r[11]=b*c+D*h,r}function rb(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ib(r,t,i){var c,h,p,y=i[0],v=i[1],b=i[2],T=Math.hypot(y,v,b);return T<vm?null:(y*=T=1/T,v*=T,b*=T,c=Math.sin(t),h=Math.cos(t),r[0]=y*y*(p=1-h)+h,r[1]=v*y*p+b*c,r[2]=b*y*p-v*c,r[3]=0,r[4]=y*v*p-b*c,r[5]=v*v*p+h,r[6]=b*v*p+y*c,r[7]=0,r[8]=y*b*p+v*c,r[9]=v*b*p-y*c,r[10]=b*b*p+h,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var f3=ec;function V_(){var r=new Ci(3);return Ci!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function ob(r){var t=new Ci(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function Rd(r){return Math.hypot(r[0],r[1],r[2])}function Mu(r,t,i){var c=new Ci(3);return c[0]=r,c[1]=t,c[2]=i,c}function Os(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r}function $_(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r}function sb(r,t,i){return r[0]=t[0]*i[0],r[1]=t[1]*i[1],r[2]=t[2]*i[2],r}function Od(r,t,i){return r[0]=Math.min(t[0],i[0]),r[1]=Math.min(t[1],i[1]),r[2]=Math.min(t[2],i[2]),r}function Fd(r,t,i){return r[0]=Math.max(t[0],i[0]),r[1]=Math.max(t[1],i[1]),r[2]=Math.max(t[2],i[2]),r}function Ni(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r}function Bd(r,t,i,c){return r[0]=t[0]+i[0]*c,r[1]=t[1]+i[1]*c,r[2]=t[2]+i[2]*c,r}function Kr(r,t){var i=t[0],c=t[1],h=t[2],p=i*i+c*c+h*h;return p>0&&(p=1/Math.sqrt(p)),r[0]=t[0]*p,r[1]=t[1]*p,r[2]=t[2]*p,r}function oo(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function G_(r,t,i){var c=t[0],h=t[1],p=t[2],y=i[0],v=i[1],b=i[2];return r[0]=h*b-p*v,r[1]=p*y-c*b,r[2]=c*v-h*y,r}function qn(r,t,i){var c=t[0],h=t[1],p=t[2],y=i[3]*c+i[7]*h+i[11]*p+i[15];return r[0]=(i[0]*c+i[4]*h+i[8]*p+i[12])/(y=y||1),r[1]=(i[1]*c+i[5]*h+i[9]*p+i[13])/y,r[2]=(i[2]*c+i[6]*h+i[10]*p+i[14])/y,r}function ab(r,t,i){var c=i[0],h=i[1],p=i[2],y=t[0],v=t[1],b=t[2],T=h*b-p*v,M=p*y-c*b,I=c*v-h*y,D=h*I-p*M,O=p*T-c*I,B=c*M-h*T,V=2*i[3];return M*=V,I*=V,O*=2,B*=2,r[0]=y+(T*=V)+(D*=2),r[1]=v+M+O,r[2]=b+I+B,r}var jd,Oo=$_,p3=sb,m3=Rd;function lb(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r}function cb(r,t){var i=t[0],c=t[1],h=t[2],p=t[3],y=i*i+c*c+h*h+p*p;return y>0&&(y=1/Math.sqrt(y)),r[0]=i*y,r[1]=c*y,r[2]=h*y,r[3]=p*y,r}function nc(r,t,i){var c=t[0],h=t[1],p=t[2],y=t[3];return r[0]=i[0]*c+i[4]*h+i[8]*p+i[12]*y,r[1]=i[1]*c+i[5]*h+i[9]*p+i[13]*y,r[2]=i[2]*c+i[6]*h+i[10]*p+i[14]*y,r[3]=i[3]*c+i[7]*h+i[11]*p+i[15]*y,r}function ub(){var r=new Ci(4);return Ci!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function hb(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function db(r,t,i){i*=.5;var c=t[0],h=t[1],p=t[2],y=t[3],v=Math.sin(i),b=Math.cos(i);return r[0]=c*b+y*v,r[1]=h*b+p*v,r[2]=p*b-h*v,r[3]=y*b-c*v,r}function fb(r,t,i){i*=.5;var c=t[0],h=t[1],p=t[2],y=t[3],v=Math.sin(i),b=Math.cos(i);return r[0]=c*b-p*v,r[1]=h*b+y*v,r[2]=p*b+c*v,r[3]=y*b-h*v,r}V_(),jd=new Ci(4),Ci!=Float32Array&&(jd[0]=0,jd[1]=0,jd[2]=0,jd[3]=0);var g3=cb;V_(),Mu(1,0,0),Mu(0,1,0),ub(),ub(),tb();const y3=Ee([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:pb}=y3,mb=Ee([{name:"a_pos_3",components:3,type:"Int16"}]);var Nd=Ee([{name:"a_pos",type:"Int16",components:2}]);class W_{constructor(t,i){this.pos=t,this.dir=i}intersectsPlane(t,i,c){const h=oo(i,this.dir);if(Math.abs(h)<1e-6)return!1;const p=((t[0]-this.pos[0])*i[0]+(t[1]-this.pos[1])*i[1]+(t[2]-this.pos[2])*i[2])/h;return c[0]=this.pos[0]+this.dir[0]*p,c[1]=this.pos[1]+this.dir[1]*p,c[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(t,i,c){if(function(O,B){var V=O[0],q=O[1],ie=O[2],de=B[0],oe=B[1],ue=B[2];return Math.abs(V-de)<=vm*Math.max(1,Math.abs(V),Math.abs(de))&&Math.abs(q-oe)<=vm*Math.max(1,Math.abs(q),Math.abs(oe))&&Math.abs(ie-ue)<=vm*Math.max(1,Math.abs(ie),Math.abs(ue))}(this.pos,t)||i===0)return c[0]=c[1]=c[2]=0,!1;const[h,p,y]=this.dir,v=this.pos[0]-t[0],b=this.pos[1]-t[1],T=this.pos[2]-t[2],M=h*h+p*p+y*y,I=2*(v*h+b*p+T*y),D=I*I-4*M*(v*v+b*b+T*T-i*i);if(D<0){const O=Math.max(-I/2,0),B=v+h*O,V=b+p*O,q=T+y*O,ie=Math.hypot(B,V,q);return c[0]=B*i/ie,c[1]=V*i/ie,c[2]=q*i/ie,!1}{const O=(-I-Math.sqrt(D))/(2*M);if(O<0){const B=Math.hypot(v,b,T);return c[0]=v*i/B,c[1]=b*i/B,c[2]=T*i/B,!1}return c[0]=v+h*O,c[1]=b+p*O,c[2]=T+y*O,!0}}}class Z_{constructor(t,i,c,h,p){this.TL=t,this.TR=i,this.BR=c,this.BL=h,this.horizon=p}static fromInvProjectionMatrix(t,i,c){const h=[-1,1,1],p=[1,1,1],y=[1,-1,1],v=[-1,-1,1],b=qn(h,h,t),T=qn(p,p,t),M=qn(y,y,t),I=qn(v,v,t);return new Z_(b,T,M,I,i/c)}}class q_{constructor(t,i){this.points=t,this.planes=i}static fromInvProjectionMatrix(t,i,c,h){const p=Math.pow(2,c),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const T=nc([],b,t),M=1/T[3]/i*p;return function(I,D,O){return I[0]=D[0]*O[0],I[1]=D[1]*O[1],I[2]=D[2]*O[2],I[3]=D[3]*O[3],I}(T,T,[M,M,h?1/T[3]:M,M])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const T=Kr([],G_([],Oo([],y[b[0]],y[b[1]]),Oo([],y[b[2]],y[b[1]]))),M=-oo(T,y[b[1]]);return T.concat(M)});return new q_(y,v)}}class Yr{static fromPoints(t){const i=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const h of t)Od(i,i,h),Fd(c,c,h);return new Yr(i,c)}static applyTransform(t,i){const c=t.getCorners();for(let h=0;h<c.length;++h)qn(c[h],c[h],i);return Yr.fromPoints(c)}constructor(t,i){this.min=t,this.max=i,this.center=Ni([],Os([],this.min,this.max),.5)}quadrant(t){const i=[t%2==0,t<2],c=ob(this.min),h=ob(this.max);for(let p=0;p<i.length;p++)c[p]=i[p]?this.min[p]:this.center[p],h[p]=i[p]?this.center[p]:this.max[p];return h[2]=this.max[2],new Yr(c,h)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,i=this.max;return[[t[0],t[1],t[2]],[i[0],t[1],t[2]],[i[0],i[1],t[2]],[t[0],i[1],t[2]],[t[0],t[1],i[2]],[i[0],t[1],i[2]],[i[0],i[1],i[2]],[t[0],i[1],i[2]]]}intersects(t){const i=this.getCorners();let c=!0;for(let h=0;h<t.planes.length;h++){const p=t.planes[h];let y=0;for(let v=0;v<i.length;v++)y+=oo(p,i[v])+p[3]>=0;if(y===0)return 0;y!==i.length&&(c=!1)}if(c)return 2;for(let h=0;h<3;h++){let p=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let v=0;v<t.points.length;v++){const b=t.points[v][h]-this.min[h];p=Math.min(p,b),y=Math.max(y,b)}if(y<0||p>this.max[h]-this.min[h])return 0}return 1}}const H_=5,gb=6,ns=Ct/Math.PI/2,_3=16383,rc=64,Ud=[rc,32,16],so=-ns,ao=ns,v3=[new Yr([so,so,so],[ao,ao,ao]),new Yr([so,so,so],[0,0,ao]),new Yr([0,so,so],[ao,0,ao]),new Yr([so,0,so],[0,ao,ao]),new Yr([0,0,so],[ao,ao,ao])];function wm(r){return r*ns/Gd}function yb(r,t,i,c=!0){const h=Ni([],r._camera.position,r.worldSize),p=[t,i,1,1];nc(p,p,r.pixelMatrixInverse),lb(p,p,1/p[3]);const y=Kr([],Oo([],p,h)),v=r.globeMatrix,b=[v[12],v[13],v[14]],T=Oo([],b,h),M=Rd(T),I=Kr([],T),D=r.worldSize/(2*Math.PI),O=oo(I,y),B=Math.asin(D/M);if(B<Math.acos(O)){if(!c)return null;const Je=[],Re=[];Ni(Je,y,M/O),Kr(Re,Oo(Re,Je,T)),Kr(y,Os(y,T,Ni(y,Re,Math.tan(B)*M)))}const V=[];new W_(h,y).closestPointOnSphere(b,D,V);const q=Kr([],Ko(v,0)),ie=Kr([],Ko(v,1)),de=Kr([],Ko(v,2)),oe=oo(q,V),ue=oo(ie,V),me=oo(de,V),pe=kt(Math.asin(-ue/D));let Le=kt(Math.atan2(oe,me));Le=r.center.lng+function(Je,Re){const We=(Re-Je+180)%360-180;return We<-180?We+360:We}(r.center.lng,Le);const Ie=is(Le),Ne=He(os(pe),0,1);return new Du(Ie,Ne)}class x3{constructor(t,i,c){this.a=Oo([],t,c),this.b=Oo([],i,c),this.center=c;const h=Kr([],this.a),p=Kr([],this.b);this.angle=Math.acos(oo(h,p))}}function X_(r,t){if(r.angle===0)return null;let i;return i=r.a[t]===0?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[t]/r.a[t]/Math.sin(r.angle)-1/Math.tan(r.angle)),i<0||i>1?null:function(c,h,p,y){const v=Math.sin(p);return c*(Math.sin((1-y)*p)/v)+h*(Math.sin(y*p)/v)}(r.a[t],r.b[t],r.angle,He(i,0,1))+r.center[t]}function rs(r){if(r.z<=1)return v3[r.z+2*r.y+r.x];const t=K_(bm(r));return Yr.fromPoints(t)}function ic(r,t,i){return Ni(r,r,1-i),Bd(r,r,t,i)}function _b(r,t){const i=Au(t.zoom);if(i===0)return rs(r);const c=bm(r),h=K_(c),p=is(c.getWest())*t.worldSize,y=is(c.getEast())*t.worldSize,v=os(c.getNorth())*t.worldSize,b=os(c.getSouth())*t.worldSize,T=[p,v,0],M=[y,v,0],I=[p,b,0],D=[y,b,0],O=N_([],t.globeMatrix);return qn(T,T,O),qn(M,M,O),qn(I,I,O),qn(D,D,O),h[0]=ic(h[0],I,i),h[1]=ic(h[1],D,i),h[2]=ic(h[2],M,i),h[3]=ic(h[3],T,i),Yr.fromPoints(h)}function vb(r,t,i){for(const c of r)qn(c,c,t),Ni(c,c,i)}function w3(r,t,i){const c=t/r.worldSize,h=r.globeMatrix;if(i.z<=1){const Ie=rs(i).getCorners();return vb(Ie,h,c),Yr.fromPoints(Ie)}const p=bm(i),y=K_(p);vb(y,h,c);const v=Number.MAX_VALUE,b=[-v,-v,-v],T=[v,v,v];if(p.contains(r.center)){for(const Je of y)Od(T,T,Je),Fd(b,b,Je);b[2]=0;const Ie=r.point,Ne=[Ie.x*c,Ie.y*c,0];return Od(T,T,Ne),Fd(b,b,Ne),new Yr(T,b)}const M=[h[12]*c,h[13]*c,h[14]*c],I=p.getCenter(),D=He(r.center.lat,-Fr,Fr),O=He(I.lat,-Fr,Fr),B=is(r.center.lng),V=os(D);let q=B-is(I.lng);const ie=V-os(O);q>.5?q-=1:q<-.5&&(q+=1);let de=0;Math.abs(q)>Math.abs(ie)?de=q>=0?1:3:(de=ie>=0?0:2,Bd(M,M,[h[4]*c,h[5]*c,h[6]*c],-Math.sin(xt(ie>=0?p.getSouth():p.getNorth()))*ns));const oe=y[de],ue=y[(de+1)%4],me=new x3(oe,ue,M),pe=[X_(me,0)||oe[0],X_(me,1)||oe[1],X_(me,2)||oe[2]],Le=Au(r.zoom);if(Le>0){const Ie=function({x:Je,y:Re,z:We},Ze,Xe,rt,Fe){const ut=1/(1<<We);let vt=Je*ut,ht=vt+ut,Lt=Re*ut,it=Lt+ut,Et=0;const zt=(vt+ht)/2-rt;return zt>.5?Et=-1:zt<-.5&&(Et=1),vt=((vt+Et)*Ze-(rt*=Ze))*Xe+rt,ht=((ht+Et)*Ze-rt)*Xe+rt,Lt=(Lt*Ze-(Fe*=Ze))*Xe+Fe,it=(it*Ze-Fe)*Xe+Fe,[[vt,it,0],[ht,it,0],[ht,Lt,0],[vt,Lt,0]]}(i,t,r._pixelsPerMercatorPixel,B,V);for(let Je=0;Je<y.length;Je++)ic(y[Je],Ie[Je],Le);const Ne=Os([],Ie[de],Ie[(de+1)%4]);Ni(Ne,Ne,.5),ic(pe,Ne,Le)}for(const Ie of y)Od(T,T,Ie),Fd(b,b,Ie);return T[2]=Math.min(oe[2],ue[2]),Od(T,T,pe),Fd(b,b,pe),new Yr(T,b)}function bm({x:r,y:t,z:i}){const c=1/(1<<i),h=new yn(Ui(r*c),Or((t+1)*c)),p=new yn(Ui((r+1)*c),Or(t*c));return new Ia(h,p)}function K_(r){const t=xt(r.getNorth()),i=xt(r.getSouth()),c=Math.cos(t),h=Math.cos(i),p=Math.sin(t),y=Math.sin(i),v=r.getWest(),b=r.getEast();return[ku(h,y,v),ku(h,y,b),ku(c,p,b),ku(c,p,v)]}function ku(r,t,i,c=ns){return i=xt(i),[r*Math.sin(i)*c,-t*c,r*Math.cos(i)*c]}function Iu(r,t,i){return ku(Math.cos(xt(r)),Math.sin(xt(r)),t,i)}function Vd(r,t,i,c){const h=1<<i.z,p=(r/Ct+i.x)/h;return Iu(Or((t/Ct+i.y)/h),Ui(p),c)}function Tm({min:r,max:t}){return _3/Math.max(t[0]-r[0],t[1]-r[1],t[2]-r[2])}const xb=new Float64Array(16);function $d(r){const t=Tm(r),i=rb(xb,[t,t,t]);return zd(i,i,((c=[])[0]=-(h=r.min)[0],c[1]=-h[1],c[2]=-h[2],c));var c,h}function Y_(r){const t=(c=r.min,(i=xb)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=c[0],i[13]=c[1],i[14]=c[2],i[15]=1,i);var i,c;const h=1/Tm(r);return tc(t,t,[h,h,h])}function wb(r,t,i,c,h){const p=function(b){const T=Ct/(2*Math.PI);return b/(2*Math.PI)/T}(i),y=[r,t,-i/(2*Math.PI)],v=Ro(new Float64Array(16));return zd(v,v,y),tc(v,v,[p,p,p]),U_(v,v,xt(-h)),xm(v,v,xt(-c)),v}function Au(r){return bt(H_,gb,r)}function bb(r,t){const i=Iu(t.lat,t.lng),c=function(B){const V=Iu(B._center.lat,B._center.lng);let q=G_([],Mu(0,1,0),V);const ie=ib([],-B.angle,V);q=qn(q,q,ie),ib(ie,-B._pitch,q);const de=Kr([],V);return Ni(de,de,wm(B.cameraToCenterDistance/B.pixelsPerMeter)),qn(de,de,ie),Os([],V,de)}(r);return y=(h=$_([],c,i))[0],v=h[1],b=h[2],T=(p=i)[0],M=p[1],I=p[2],O=(D=Math.sqrt(y*y+v*v+b*b)*Math.sqrt(T*T+M*M+I*I))&&oo(h,p)/D,Math.acos(Math.min(Math.max(O,-1),1));var h,p,y,v,b,T,M,I,D,O}function J_(r,t){return bb(r,t)>Math.PI/2*1.01}const Tb=xt(85),b3=Math.cos(Tb),T3=Math.sin(Tb),Gd=63710088e-1,Eb=2*Math.PI*Gd;class Aa{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Aa(yt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,c=this.lat*i,h=t.lat*i,p=Math.sin(c)*Math.sin(h)+Math.cos(c)*Math.cos(h)*Math.cos((t.lng-this.lng)*i);return Gd*Math.acos(Math.min(p,1))}toBounds(t=0){const i=360*t/40075017,c=i/Math.cos(Math.PI/180*this.lat);return new Ia(new Aa(this.lng-c,this.lat-i),new Aa(this.lng+c,this.lat+i))}toEcef(t){const i=wm(t);return Iu(this.lat,this.lng,ns+i)}static convert(t){if(t instanceof Aa)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Aa(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Aa(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var yn=Aa;function Q_(r){return Eb*Math.cos(r*Math.PI/180)}function is(r){return(180+r)/360}function os(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Fo(r,t){return r/Q_(t)}function Ui(r){return 360*r-180}function Or(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function Sb(r,t){return r*Q_(Or(t))}const Fr=85.051129;function Cb(r){return 1/Math.cos(r*Math.PI/180)}class Du{constructor(t,i,c=0){this.x=+t,this.y=+i,this.z=+c}static fromLngLat(t,i=0){const c=yn.convert(t);return new Du(is(c.lng),os(c.lat),Fo(i,c.lat))}toLngLat(){return new yn(Ui(this.x),Or(this.y))}toAltitude(){return Sb(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Eb*Cb(Or(this.y))}}function ev(r,t,i,c,h,p,y,v,b){const T=(t+c)/2,M=(i+h)/2,I=new Te(T,M);v(I),function(D,O,B,V,q,ie){const de=B-q,oe=V-ie;return Math.abs((V-O)*de-(B-D)*oe)/Math.hypot(de,oe)}(I.x,I.y,p.x,p.y,y.x,y.y)>=b?(ev(r,t,i,T,M,p,I,v,b),ev(r,T,M,c,h,I,y,v,b)):r.push(y)}function Pb(r,t,i){let c=r[0],h=c.x,p=c.y;t(c);const y=[c];for(let v=1;v<r.length;v++){const b=r[v],{x:T,y:M}=b;t(b),ev(y,h,p,T,M,c,b,t,i),h=T,p=M,c=b}return y}function tv(r,t,i,c){if(c(t,i)){const h=t.add(i)._mult(.5);tv(r,t,h,c),tv(r,h,i,c)}else r.push(i)}function E3(r,t){let i=r[0];const c=[i];for(let h=1;h<r.length;h++){const p=r[h];tv(c,i,p,t),i=p}return c}const nv=Math.pow(2,14)-1,Mb=-nv-1;function S3(r,t){const i=Math.round(r.x*t),c=Math.round(r.y*t);return r.x=He(i,Mb,nv),r.y=He(c,Mb,nv),(i<r.x||i>r.x+1||c<r.y||c>r.y+1)&&Rn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function Fs(r,t,i){const c=r.loadGeometry(),h=r.extent,p=Ct/h;if(t&&i&&i.projection.isReprojectedInTileSpace){const y=1<<t.z,{scale:v,x:b,y:T,projection:M}=i,I=D=>{const O=Ui((t.x+D.x/h)/y),B=Or((t.y+D.y/h)/y),V=M.project(O,B);D.x=(V.x*v-b)*h,D.y=(V.y*v-T)*h};for(let D=0;D<c.length;D++)if(r.type!==1)c[D]=Pb(c[D],I,1);else{const O=[];for(const B of c[D])B.x<0||B.x>=h||B.y<0||B.y>=h||(I(B),O.push(B));c[D]=O}}for(const y of c)for(const v of y)S3(v,p);return c}function oc(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?Fs(r):[]}}function Em(r,t,i,c,h){r.emplaceBack(2*t+(c+1)/2,2*i+(h+1)/2)}function Sm(r,t,i){r.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class rv{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new Ye,this.indexArray=new wt,this.segments=new Qn,this.programConfigurations=new Ql(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,c,h){const p=this.layers[0],y=[];let v=null;p.type==="circle"&&(v=p.layout.get("circle-sort-key"));for(const{feature:T,id:M,index:I,sourceLayerIndex:D}of t){const O=this.layers[0]._featureFilter.needGeometry,B=oc(T,O);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),B,c))continue;const V=v?v.evaluate(B,{},c):void 0,q={id:M,properties:T.properties,type:T.type,sourceLayerIndex:D,index:I,geometry:O?B.geometry:Fs(T,c,h),patterns:{},sortKey:V};y.push(q)}v&&y.sort((T,M)=>T.sortKey-M.sortKey);let b=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new Qe,b=h.projection);for(const T of y){const{geometry:M,index:I,sourceLayerIndex:D}=T,O=t[I].feature;this.addFeature(T,M,I,i.availableImages,c,b),i.featureIndex.insert(O,M,I,D,this.index)}}update(t,i,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,c,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,h3.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,d3.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,i,c,h,p,y){for(const v of i)for(const b of v){const T=b.x,M=b.y;if(T<0||T>=Ct||M<0||M>=Ct)continue;if(y){const O=y.projectTilePoint(T,M,p),B=y.upVector(p,T,M),V=this.globeExtVertexArray;Sm(V,O,B),Sm(V,O,B),Sm(V,O,B),Sm(V,O,B)}const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),D=I.vertexLength;Em(this.layoutVertexArray,T,M,-1,-1),Em(this.layoutVertexArray,T,M,1,-1),Em(this.layoutVertexArray,T,M,1,1),Em(this.layoutVertexArray,T,M,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+2,D+3),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{},h,p)}}function kb(r,t){for(let i=0;i<r.length;i++)if(sc(t,r[i]))return!0;for(let i=0;i<t.length;i++)if(sc(r,t[i]))return!0;return!!iv(r,t)}function C3(r,t,i){return!!sc(r,t)||!!ov(t,r,i)}function Ib(r,t){if(r.length===1)return Db(t,r[0]);for(let i=0;i<t.length;i++){const c=t[i];for(let h=0;h<c.length;h++)if(sc(r,c[h]))return!0}for(let i=0;i<r.length;i++)if(Db(t,r[i]))return!0;for(let i=0;i<t.length;i++)if(iv(r,t[i]))return!0;return!1}function P3(r,t,i){if(r.length>1){if(iv(r,t))return!0;for(let c=0;c<t.length;c++)if(ov(t[c],r,i))return!0}for(let c=0;c<r.length;c++)if(ov(r[c],t,i))return!0;return!1}function iv(r,t){if(r.length===0||t.length===0)return!1;for(let i=0;i<r.length-1;i++){const c=r[i],h=r[i+1];for(let p=0;p<t.length-1;p++)if(M3(c,h,t[p],t[p+1]))return!0}return!1}function M3(r,t,i,c){return vi(r,i,c)!==vi(t,i,c)&&vi(r,t,i)!==vi(r,t,c)}function ov(r,t,i){const c=i*i;if(t.length===1)return r.distSqr(t[0])<c;for(let h=1;h<t.length;h++)if(Ab(r,t[h-1],t[h])<c)return!0;return!1}function Ab(r,t,i){const c=t.distSqr(i);if(c===0)return r.distSqr(t);const h=((r.x-t.x)*(i.x-t.x)+(r.y-t.y)*(i.y-t.y))/c;return r.distSqr(h<0?t:h>1?i:i.sub(t)._mult(h)._add(t))}function Db(r,t){let i,c,h,p=!1;for(let y=0;y<r.length;y++){i=r[y];for(let v=0,b=i.length-1;v<i.length;b=v++)c=i[v],h=i[b],c.y>t.y!=h.y>t.y&&t.x<(h.x-c.x)*(t.y-c.y)/(h.y-c.y)+c.x&&(p=!p)}return p}function sc(r,t){let i=!1;for(let c=0,h=r.length-1;c<r.length;h=c++){const p=r[c],y=r[h];p.y>t.y!=y.y>t.y&&t.x<(y.x-p.x)*(t.y-p.y)/(y.y-p.y)+p.x&&(i=!i)}return i}function Lb(r,t,i,c,h){for(const y of r)if(t<=y.x&&i<=y.y&&c>=y.x&&h>=y.y)return!0;const p=[new Te(t,i),new Te(t,h),new Te(c,h),new Te(c,i)];if(r.length>2){for(const y of p)if(sc(r,y))return!0}for(let y=0;y<r.length-1;y++)if(k3(r[y],r[y+1],p))return!0;return!1}function k3(r,t,i){const c=i[0],h=i[2];if(r.x<c.x&&t.x<c.x||r.x>h.x&&t.x>h.x||r.y<c.y&&t.y<c.y||r.y>h.y&&t.y>h.y)return!1;const p=vi(r,t,i[0]);return p!==vi(r,t,i[1])||p!==vi(r,t,i[2])||p!==vi(r,t,i[3])}function Lu(r,t,i){const c=t.paint.get(r).value;return c.kind==="constant"?c.value:i.programConfigurations.get(t.id).getMaxValue(r)}function Cm(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function zb(r,t,i,c,h){if(!t[0]&&!t[1])return r;const p=Te.convert(t)._mult(h);i==="viewport"&&p._rotate(-c);const y=[];for(let v=0;v<r.length;v++)y.push(r[v].sub(p));return y}function Rb(r,t,i,c){const h=Te.convert(r)._mult(c);return t==="viewport"&&h._rotate(-i),h}gt(rv,"CircleBucket",{omit:["layers"]});const I3=new le({"circle-sort-key":new K(Be.layout_circle["circle-sort-key"])});var A3={paint:new le({"circle-radius":new K(Be.paint_circle["circle-radius"]),"circle-color":new K(Be.paint_circle["circle-color"]),"circle-blur":new K(Be.paint_circle["circle-blur"]),"circle-opacity":new K(Be.paint_circle["circle-opacity"]),"circle-translate":new U(Be.paint_circle["circle-translate"]),"circle-translate-anchor":new U(Be.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new U(Be.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new U(Be.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new K(Be.paint_circle["circle-stroke-width"]),"circle-stroke-color":new K(Be.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new K(Be.paint_circle["circle-stroke-opacity"])}),layout:I3};function Ob(r,t,i,c,h,p,y,v,b){if(p&&r.queryGeometry.isAboveHorizon)return!1;p&&(b*=r.pixelToTileUnitsFactor);const T=r.tileID.canonical,M=i.projection.upVectorScale(T,i.center.lat,i.worldSize).metersToTile;for(const I of t)for(const D of I){const O=D.add(v),B=h&&i.elevation?i.elevation.exaggeration()*h.getElevationAt(O.x,O.y,!0):0,V=i.projection.projectTilePoint(O.x,O.y,T);if(B>0){const oe=i.projection.upVector(T,O.x,O.y);V.x+=oe[0]*M*B,V.y+=oe[1]*M*B,V.z+=oe[2]*M*B}const q=p?O:D3(V.x,V.y,V.z,c),ie=p?r.tilespaceRays.map(oe=>z3(oe,B)):r.queryGeometry.screenGeometry,de=nc([],[V.x,V.y,V.z,1],c);if(!y&&p?b*=de[3]/i.cameraToCenterDistance:y&&!p&&(b*=i.cameraToCenterDistance/de[3]),p){const oe=Or((D.y/Ct+T.y)/(1<<T.z));b/=i.projection.pixelsPerMeter(oe,1)/Fo(1,oe)}if(C3(ie,q,b))return!0}return!1}function D3(r,t,i,c){const h=nc([],[r,t,i,1],c);return new Te(h[0]/h[3],h[1]/h[3])}const Fb=Mu(0,0,0),L3=Mu(0,0,1);function z3(r,t){const i=V_();return Fb[2]=t,r.intersectsPlane(Fb,L3,i),new Te(i[0],i[1])}class Bb extends rv{}function jb(r,{width:t,height:i},c,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*i*c)throw new RangeError("mismatched image size")}else h=new Uint8Array(t*i*c);return r.width=t,r.height=i,r.data=h,r}function Nb(r,t,i){const{width:c,height:h}=t;c===r.width&&h===r.height||(sv(r,t,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,c),height:Math.min(r.height,h)},i),r.width=c,r.height=h,r.data=t.data)}function sv(r,t,i,c,h,p){if(h.width===0||h.height===0)return t;if(h.width>r.width||h.height>r.height||i.x>r.width-h.width||i.y>r.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||c.x>t.width-h.width||c.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=r.data,v=t.data;for(let b=0;b<h.height;b++){const T=((i.y+b)*r.width+i.x)*p,M=((c.y+b)*t.width+c.x)*p;for(let I=0;I<h.width*p;I++)v[M+I]=y[T+I]}return t}gt(Bb,"HeatmapBucket",{omit:["layers"]});class Bs{constructor(t,i){jb(this,t,1,i)}resize(t){Nb(this,new Bs(t),1)}clone(){return new Bs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,c,h,p){sv(t,i,c,h,p,1)}}class Pi{constructor(t,i){jb(this,t,4,i)}resize(t){Nb(this,new Pi(t),4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Pi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,c,h,p){sv(t,i,c,h,p,4)}}gt(Bs,"AlphaImage"),gt(Pi,"RGBAImage");var R3={paint:new le({"heatmap-radius":new K(Be.paint_heatmap["heatmap-radius"]),"heatmap-weight":new K(Be.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new U(Be.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ae(Be.paint_heatmap["heatmap-color"]),"heatmap-opacity":new U(Be.paint_heatmap["heatmap-opacity"])})};function av(r){const t={},i=r.resolution||256,c=r.clips?r.clips.length:1,h=r.image||new Pi({width:i,height:c}),p=(y,v,b)=>{t[r.evaluationKey]=b;const T=r.expression.evaluate(t);h.data[y+v+0]=Math.floor(255*T.r/T.a),h.data[y+v+1]=Math.floor(255*T.g/T.a),h.data[y+v+2]=Math.floor(255*T.b/T.a),h.data[y+v+3]=Math.floor(255*T.a)};if(r.clips)for(let y=0,v=0;y<c;++y,v+=4*i)for(let b=0,T=0;b<i;b++,T+=4){const M=b/(i-1),{start:I,end:D}=r.clips[y];p(v,T,I*(1-M)+D*M)}else for(let y=0,v=0;y<i;y++,v+=4)p(0,v,y/(i-1));return h}var O3={paint:new le({"hillshade-illumination-direction":new U(Be.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new U(Be.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new U(Be.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new U(Be.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new U(Be.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new U(Be.paint_hillshade["hillshade-accent-color"])})};const F3=Ee([{name:"a_pos",components:2,type:"Int16"}],4),{members:B3}=F3;var lv={exports:{}};function Pm(r,t,i){i=i||2;var c,h,p,y,v,b,T,M=t&&t.length,I=M?t[0]*i:r.length,D=Ub(r,0,I,i,!0),O=[];if(!D||D.next===D.prev)return O;if(M&&(D=function(V,q,ie,de){var oe,ue,me,pe=[];for(oe=0,ue=q.length;oe<ue;oe++)(me=Ub(V,q[oe]*de,oe<ue-1?q[oe+1]*de:V.length,de,!1))===me.next&&(me.steiner=!0),pe.push(Z3(me));for(pe.sort($3),oe=0;oe<pe.length;oe++)ie=G3(pe[oe],ie);return ie}(r,t,D,i)),r.length>80*i){c=p=r[0],h=y=r[1];for(var B=i;B<I;B+=i)(v=r[B])<c&&(c=v),(b=r[B+1])<h&&(h=b),v>p&&(p=v),b>y&&(y=b);T=(T=Math.max(p-c,y-h))!==0?32767/T:0}return Wd(D,O,i,c,h,T,0),O}function Ub(r,t,i,c,h){var p,y;if(h===hv(r,t,i,c)>0)for(p=t;p<i;p+=c)y=Gb(p,r[p],r[p+1],y);else for(p=i-c;p>=t;p-=c)y=Gb(p,r[p],r[p+1],y);return y&&Mm(y,y.next)&&(qd(y),y=y.next),y}function ac(r,t){if(!r)return r;t||(t=r);var i,c=r;do if(i=!1,c.steiner||!Mm(c,c.next)&&er(c.prev,c,c.next)!==0)c=c.next;else{if(qd(c),(c=t=c.prev)===c.next)break;i=!0}while(i||c!==t);return t}function Wd(r,t,i,c,h,p,y){if(r){!y&&p&&function(M,I,D,O){var B=M;do B.z===0&&(B.z=cv(B.x,B.y,I,D,O)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==M);B.prevZ.nextZ=null,B.prevZ=null,function(V){var q,ie,de,oe,ue,me,pe,Le,Ie=1;do{for(ie=V,V=null,ue=null,me=0;ie;){for(me++,de=ie,pe=0,q=0;q<Ie&&(pe++,de=de.nextZ);q++);for(Le=Ie;pe>0||Le>0&&de;)pe!==0&&(Le===0||!de||ie.z<=de.z)?(oe=ie,ie=ie.nextZ,pe--):(oe=de,de=de.nextZ,Le--),ue?ue.nextZ=oe:V=oe,oe.prevZ=ue,ue=oe;ie=de}ue.nextZ=null,Ie*=2}while(me>1)}(B)}(r,c,h,p);for(var v,b,T=r;r.prev!==r.next;)if(v=r.prev,b=r.next,p?N3(r,c,h,p):j3(r))t.push(v.i/i|0),t.push(r.i/i|0),t.push(b.i/i|0),qd(r),r=b.next,T=b.next;else if((r=b)===T){y?y===1?Wd(r=U3(ac(r),t,i),t,i,c,h,p,2):y===2&&V3(r,t,i,c,h,p):Wd(ac(r),t,i,c,h,p,1);break}}}function j3(r){var t=r.prev,i=r,c=r.next;if(er(t,i,c)>=0)return!1;for(var h=t.x,p=i.x,y=c.x,v=t.y,b=i.y,T=c.y,M=h<p?h<y?h:y:p<y?p:y,I=v<b?v<T?v:T:b<T?b:T,D=h>p?h>y?h:y:p>y?p:y,O=v>b?v>T?v:T:b>T?b:T,B=c.next;B!==t;){if(B.x>=M&&B.x<=D&&B.y>=I&&B.y<=O&&zu(h,v,p,b,y,T,B.x,B.y)&&er(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function N3(r,t,i,c){var h=r.prev,p=r,y=r.next;if(er(h,p,y)>=0)return!1;for(var v=h.x,b=p.x,T=y.x,M=h.y,I=p.y,D=y.y,O=v<b?v<T?v:T:b<T?b:T,B=M<I?M<D?M:D:I<D?I:D,V=v>b?v>T?v:T:b>T?b:T,q=M>I?M>D?M:D:I>D?I:D,ie=cv(O,B,t,i,c),de=cv(V,q,t,i,c),oe=r.prevZ,ue=r.nextZ;oe&&oe.z>=ie&&ue&&ue.z<=de;){if(oe.x>=O&&oe.x<=V&&oe.y>=B&&oe.y<=q&&oe!==h&&oe!==y&&zu(v,M,b,I,T,D,oe.x,oe.y)&&er(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,ue.x>=O&&ue.x<=V&&ue.y>=B&&ue.y<=q&&ue!==h&&ue!==y&&zu(v,M,b,I,T,D,ue.x,ue.y)&&er(ue.prev,ue,ue.next)>=0))return!1;ue=ue.nextZ}for(;oe&&oe.z>=ie;){if(oe.x>=O&&oe.x<=V&&oe.y>=B&&oe.y<=q&&oe!==h&&oe!==y&&zu(v,M,b,I,T,D,oe.x,oe.y)&&er(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;ue&&ue.z<=de;){if(ue.x>=O&&ue.x<=V&&ue.y>=B&&ue.y<=q&&ue!==h&&ue!==y&&zu(v,M,b,I,T,D,ue.x,ue.y)&&er(ue.prev,ue,ue.next)>=0)return!1;ue=ue.nextZ}return!0}function U3(r,t,i){var c=r;do{var h=c.prev,p=c.next.next;!Mm(h,p)&&Vb(h,c,c.next,p)&&Zd(h,p)&&Zd(p,h)&&(t.push(h.i/i|0),t.push(c.i/i|0),t.push(p.i/i|0),qd(c),qd(c.next),c=r=p),c=c.next}while(c!==r);return ac(c)}function V3(r,t,i,c,h,p){var y=r;do{for(var v=y.next.next;v!==y.prev;){if(y.i!==v.i&&q3(y,v)){var b=$b(y,v);return y=ac(y,y.next),b=ac(b,b.next),Wd(y,t,i,c,h,p,0),void Wd(b,t,i,c,h,p,0)}v=v.next}y=y.next}while(y!==r)}function $3(r,t){return r.x-t.x}function G3(r,t){var i=function(h,p){var y,v=p,b=h.x,T=h.y,M=-1/0;do{if(T<=v.y&&T>=v.next.y&&v.next.y!==v.y){var I=v.x+(T-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(I<=b&&I>M&&(M=I,y=v.x<v.next.x?v:v.next,I===b))return y}v=v.next}while(v!==p);if(!y)return null;var D,O=y,B=y.x,V=y.y,q=1/0;v=y;do b>=v.x&&v.x>=B&&b!==v.x&&zu(T<V?b:M,T,B,V,T<V?M:b,T,v.x,v.y)&&(D=Math.abs(T-v.y)/(b-v.x),Zd(v,h)&&(D<q||D===q&&(v.x>y.x||v.x===y.x&&W3(y,v)))&&(y=v,q=D)),v=v.next;while(v!==O);return y}(r,t);if(!i)return t;var c=$b(i,r);return ac(c,c.next),ac(i,i.next)}function W3(r,t){return er(r.prev,r,t.prev)<0&&er(t.next,r,r.next)<0}function cv(r,t,i,c,h){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-i)*h|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-c)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Z3(r){var t=r,i=r;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==r);return i}function zu(r,t,i,c,h,p,y,v){return(h-y)*(t-v)>=(r-y)*(p-v)&&(r-y)*(c-v)>=(i-y)*(t-v)&&(i-y)*(p-v)>=(h-y)*(c-v)}function q3(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(i,c){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==c.i&&h.next.i!==c.i&&Vb(h,h.next,i,c))return!0;h=h.next}while(h!==i);return!1}(r,t)&&(Zd(r,t)&&Zd(t,r)&&function(i,c){var h=i,p=!1,y=(i.x+c.x)/2,v=(i.y+c.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&y<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(p=!p),h=h.next;while(h!==i);return p}(r,t)&&(er(r.prev,r,t.prev)||er(r,t.prev,t))||Mm(r,t)&&er(r.prev,r,r.next)>0&&er(t.prev,t,t.next)>0)}function er(r,t,i){return(t.y-r.y)*(i.x-t.x)-(t.x-r.x)*(i.y-t.y)}function Mm(r,t){return r.x===t.x&&r.y===t.y}function Vb(r,t,i,c){var h=Im(er(r,t,i)),p=Im(er(r,t,c)),y=Im(er(i,c,r)),v=Im(er(i,c,t));return h!==p&&y!==v||!(h!==0||!km(r,i,t))||!(p!==0||!km(r,c,t))||!(y!==0||!km(i,r,c))||!(v!==0||!km(i,t,c))}function km(r,t,i){return t.x<=Math.max(r.x,i.x)&&t.x>=Math.min(r.x,i.x)&&t.y<=Math.max(r.y,i.y)&&t.y>=Math.min(r.y,i.y)}function Im(r){return r>0?1:r<0?-1:0}function Zd(r,t){return er(r.prev,r,r.next)<0?er(r,t,r.next)>=0&&er(r,r.prev,t)>=0:er(r,t,r.prev)<0||er(r,r.next,t)<0}function $b(r,t){var i=new uv(r.i,r.x,r.y),c=new uv(t.i,t.x,t.y),h=r.next,p=t.prev;return r.next=t,t.prev=r,i.next=h,h.prev=i,c.next=i,i.prev=c,p.next=c,c.prev=p,c}function Gb(r,t,i,c){var h=new uv(r,t,i);return c?(h.next=c.next,h.prev=c,c.next.prev=h,c.next=h):(h.prev=h,h.next=h),h}function qd(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function uv(r,t,i){this.i=r,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function hv(r,t,i,c){for(var h=0,p=t,y=i-c;p<i;p+=c)h+=(r[y]-r[p])*(r[p+1]+r[y+1]),y=p;return h}lv.exports=Pm,lv.exports.default=Pm,Pm.deviation=function(r,t,i,c){var h=t&&t.length,p=Math.abs(hv(r,0,h?t[0]*i:r.length,i));if(h)for(var y=0,v=t.length;y<v;y++)p-=Math.abs(hv(r,t[y]*i,y<v-1?t[y+1]*i:r.length,i));var b=0;for(y=0;y<c.length;y+=3){var T=c[y]*i,M=c[y+1]*i,I=c[y+2]*i;b+=Math.abs((r[T]-r[I])*(r[M+1]-r[T+1])-(r[T]-r[M])*(r[I+1]-r[T+1]))}return p===0&&b===0?0:Math.abs((b-p)/p)},Pm.flatten=function(r){for(var t=r[0][0].length,i={vertices:[],holes:[],dimensions:t},c=0,h=0;h<r.length;h++){for(var p=0;p<r[h].length;p++)for(var y=0;y<t;y++)i.vertices.push(r[h][p][y]);h>0&&i.holes.push(c+=r[h-1].length)}return i};var dv=fe(lv.exports);function H3(r,t,i,c,h){Wb(r,t,i,c||r.length-1,h||X3)}function Wb(r,t,i,c,h){for(;c>i;){if(c-i>600){var p=c-i+1,y=t-i+1,v=Math.log(p),b=.5*Math.exp(2*v/3),T=.5*Math.sqrt(v*b*(p-b)/p)*(y-p/2<0?-1:1);Wb(r,t,Math.max(i,Math.floor(t-y*b/p+T)),Math.min(c,Math.floor(t+(p-y)*b/p+T)),h)}var M=r[t],I=i,D=c;for(Hd(r,i,t),h(r[c],M)>0&&Hd(r,i,c);I<D;){for(Hd(r,I,D),I++,D--;h(r[I],M)<0;)I++;for(;h(r[D],M)>0;)D--}h(r[i],M)===0?Hd(r,i,D):Hd(r,++D,c),D<=t&&(i=D+1),t<=D&&(c=D-1)}}function Hd(r,t,i){var c=r[t];r[t]=r[i],r[i]=c}function X3(r,t){return r<t?-1:r>t?1:0}function fv(r,t){const i=r.length;if(i<=1)return[r];const c=[];let h,p;for(let y=0;y<i;y++){const v=qc(r[y]);v!==0&&(r[y].area=Math.abs(v),p===void 0&&(p=v<0),p===v<0?(h&&c.push(h),h=[r[y]]):h.push(r[y]))}if(h&&c.push(h),t>1)for(let y=0;y<c.length;y++)c[y].length<=t||(H3(c[y],t,1,c[y].length-1,K3),c[y]=c[y].slice(0,t));return c}function K3(r,t){return t.area-r.area}function pv(r,t,i){const c=i.patternDependencies;let h=!1;for(const p of t){const y=p.paint.get(`${r}-pattern`);y.isConstant()||(h=!0);const v=y.constantOr(null);v&&(h=!0,c[v]=!0)}return h}function mv(r,t,i,c,h){const p=h.patternDependencies;for(const y of t){const v=y.paint.get(`${r}-pattern`).value;if(v.kind!=="constant"){let b=v.evaluate({zoom:c},i,{},h.availableImages);b=b&&b.name?b.name:b,p[b]=!0,i.patterns[y.id]=b}}return i}class Am{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ye,this.indexArray=new wt,this.indexArray2=new xr,this.programConfigurations=new Ql(t.layers,t.zoom),this.segments=new Qn,this.segments2=new Qn,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=t.projection}populate(t,i,c,h){this.hasPattern=pv("fill",this.layers,i);const p=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:v,id:b,index:T,sourceLayerIndex:M}of t){const I=this.layers[0]._featureFilter.needGeometry,D=oc(v,I);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),D,c))continue;const O=p?p.evaluate(D,{},c,i.availableImages):void 0,B={id:b,properties:v.properties,type:v.type,sourceLayerIndex:M,index:T,geometry:I?D.geometry:Fs(v,c,h),patterns:{},sortKey:O};y.push(B)}p&&y.sort((v,b)=>v.sortKey-b.sortKey);for(const v of y){const{geometry:b,index:T,sourceLayerIndex:M}=v;if(this.hasPattern){const I=mv("fill",this.layers,v,this.zoom,i);this.patternFeatures.push(I)}else this.addFeature(v,b,T,c,{},i.availableImages);i.featureIndex.insert(t[T].feature,b,T,M,this.index)}}update(t,i,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,c,h)}addFeatures(t,i,c,h,p){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,i,c,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,B3),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,c,h,p,y=[]){for(const v of fv(i,500)){let b=0;for(const B of v)b+=B.length;const T=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),M=T.vertexLength,I=[],D=[];for(const B of v){if(B.length===0)continue;B!==v[0]&&D.push(I.length/2);const V=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),q=V.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(q+B.length-1,q),I.push(B[0].x),I.push(B[0].y);for(let ie=1;ie<B.length;ie++)this.layoutVertexArray.emplaceBack(B[ie].x,B[ie].y),this.indexArray2.emplaceBack(q+ie-1,q+ie),I.push(B[ie].x),I.push(B[ie].y);V.vertexLength+=B.length,V.primitiveLength+=B.length}const O=dv(I,D);for(let B=0;B<O.length;B+=3)this.indexArray.emplaceBack(M+O[B],M+O[B+1],M+O[B+2]);T.vertexLength+=b,T.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,p,y,h)}}gt(Am,"FillBucket",{omit:["layers","patternFeatures"]});const Y3=new le({"fill-sort-key":new K(Be.layout_fill["fill-sort-key"])});var J3={paint:new le({"fill-antialias":new U(Be.paint_fill["fill-antialias"]),"fill-opacity":new K(Be.paint_fill["fill-opacity"]),"fill-color":new K(Be.paint_fill["fill-color"]),"fill-outline-color":new K(Be.paint_fill["fill-outline-color"]),"fill-translate":new U(Be.paint_fill["fill-translate"]),"fill-translate-anchor":new U(Be.paint_fill["fill-translate-anchor"]),"fill-pattern":new K(Be.paint_fill["fill-pattern"])}),layout:Y3};const Q3=Ee([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),eD=Ee([{name:"a_centroid_pos",components:2,type:"Uint16"}]),tD=Ee([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:nD}=Q3;var Dm={},rD=je,Zb=Ru;function Ru(r,t,i,c,h){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=c,this._values=h,r.readFields(iD,this,t)}function iD(r,t,i){r==1?t.id=i.readVarint():r==2?function(c,h){for(var p=c.readVarint()+c.pos;c.pos<p;){var y=h._keys[c.readVarint()],v=h._values[c.readVarint()];h.properties[y]=v}}(i,t):r==3?t.type=i.readVarint():r==4&&(t._geometry=i.pos)}function oD(r){for(var t,i,c=0,h=0,p=r.length,y=p-1;h<p;y=h++)c+=((i=r[y]).x-(t=r[h]).x)*(t.y+i.y);return c}Ru.types=["Unknown","Point","LineString","Polygon"],Ru.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,i=r.readVarint()+r.pos,c=1,h=0,p=0,y=0,v=[];r.pos<i;){if(h<=0){var b=r.readVarint();c=7&b,h=b>>3}if(h--,c===1||c===2)p+=r.readSVarint(),y+=r.readSVarint(),c===1&&(t&&v.push(t),t=[]),t.push(new rD(p,y));else{if(c!==7)throw new Error("unknown command "+c);t&&t.push(t[0].clone())}}return t&&v.push(t),v},Ru.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,i=1,c=0,h=0,p=0,y=1/0,v=-1/0,b=1/0,T=-1/0;r.pos<t;){if(c<=0){var M=r.readVarint();i=7&M,c=M>>3}if(c--,i===1||i===2)(h+=r.readSVarint())<y&&(y=h),h>v&&(v=h),(p+=r.readSVarint())<b&&(b=p),p>T&&(T=p);else if(i!==7)throw new Error("unknown command "+i)}return[y,b,v,T]},Ru.prototype.toGeoJSON=function(r,t,i){var c,h,p=this.extent*Math.pow(2,i),y=this.extent*r,v=this.extent*t,b=this.loadGeometry(),T=Ru.types[this.type];function M(O){for(var B=0;B<O.length;B++){var V=O[B];O[B]=[360*(V.x+y)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(V.y+v)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var I=[];for(c=0;c<b.length;c++)I[c]=b[c][0];M(b=I);break;case 2:for(c=0;c<b.length;c++)M(b[c]);break;case 3:for(b=function(O){var B=O.length;if(B<=1)return[O];for(var V,q,ie=[],de=0;de<B;de++){var oe=oD(O[de]);oe!==0&&(q===void 0&&(q=oe<0),q===oe<0?(V&&ie.push(V),V=[O[de]]):V.push(O[de]))}return V&&ie.push(V),ie}(b),c=0;c<b.length;c++)for(h=0;h<b[c].length;h++)M(b[c][h])}b.length===1?b=b[0]:T="Multi"+T;var D={type:"Feature",geometry:{type:T,coordinates:b},properties:this.properties};return"id"in this&&(D.id=this.id),D};var sD=Zb,qb=Hb;function Hb(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(aD,this,t),this.length=this._features.length}function aD(r,t,i){r===15?t.version=i.readVarint():r===1?t.name=i.readString():r===5?t.extent=i.readVarint():r===2?t._features.push(i.pos):r===3?t._keys.push(i.readString()):r===4&&t._values.push(function(c){for(var h=null,p=c.readVarint()+c.pos;c.pos<p;){var y=c.readVarint()>>3;h=y===1?c.readString():y===2?c.readFloat():y===3?c.readDouble():y===4?c.readVarint64():y===5?c.readVarint():y===6?c.readSVarint():y===7?c.readBoolean():null}return h}(i))}Hb.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new sD(this._pbf,t,this.extent,this._keys,this._values)};var lD=qb;function cD(r,t,i){if(r===3){var c=new lD(i,i.readVarint()+i.pos);c.length&&(t[c.name]=c)}}var gv=Dm.VectorTile=function(r,t){this.layers=r.readFields(cD,{},t)},Lm=Dm.VectorTileFeature=Zb;function zm(r,t,i,c){const h=[],p=c===0?(y,v,b,T,M,I)=>{y.push(new Te(I,b+(I-v)/(T-v)*(M-b)))}:(y,v,b,T,M,I)=>{y.push(new Te(v+(I-b)/(M-b)*(T-v),I))};for(const y of r){const v=[];for(const b of y){if(b.length<=2)continue;const T=[];for(let D=0;D<b.length-1;D++){const O=b[D].x,B=b[D].y,V=b[D+1].x,q=b[D+1].y,ie=c===0?O:B,de=c===0?V:q;ie<t?de>t&&p(T,O,B,V,q,t):ie>i?de<i&&p(T,O,B,V,q,i):T.push(b[D]),de<t&&ie>=t&&p(T,O,B,V,q,t),de>i&&ie<=i&&p(T,O,B,V,q,i)}let M=b[b.length-1];const I=c===0?M.x:M.y;I>=t&&I<=i&&T.push(M),T.length&&(M=T[T.length-1],T[0].x===M.x&&T[0].y===M.y||T.push(T[0]),v.push(T))}v.length&&h.push(v)}return h}Dm.VectorTileLayer=qb;const uD=Lm.types,hD=Math.pow(2,13);function Xd(r,t,i,c,h,p,y,v){r.emplaceBack((t<<1)+y,(i<<1)+p,(Math.floor(c*hD)<<1)+h,Math.round(v))}function Kd(r,t,i){r.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class Xb{constructor(){this.acc=new Te(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Te(t.x,t.y),this.max=new Te(t.x,t.y))}append(t,i){this.currentPolyCount.edges++,this.acc._add(t);const c=this.min,h=this.max;t.x<c.x?c.x=t.x:t.x>h.x&&(h.x=t.x),t.y<c.y?c.y=t.y:t.y>h.y&&(h.y=t.y),((t.x===0||t.x===Ct)&&t.x===i.x)!=((t.y===0||t.y===Ct)&&t.y===i.y)&&this.processBorderOverlap(t,i),i.x<0!=t.x<0&&this.addBorderIntersection(0,en(i.y,t.y,(0-i.x)/(t.x-i.x))),i.x>Ct!=t.x>Ct&&this.addBorderIntersection(1,en(i.y,t.y,(Ct-i.x)/(t.x-i.x))),i.y<0!=t.y<0&&this.addBorderIntersection(2,en(i.x,t.x,(0-i.y)/(t.y-i.y))),i.y>Ct!=t.y>Ct&&this.addBorderIntersection(3,en(i.x,t.x,(Ct-i.y)/(t.y-i.y)))}addBorderIntersection(t,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[t];i<c[0]&&(c[0]=i),i>c[1]&&(c[1]=i)}processBorderOverlap(t,i){if(t.x===i.x){if(t.y===i.y)return;const c=t.x===0?0:1;this.addBorderIntersection(c,i.y),this.addBorderIntersection(c,t.y)}else{const c=t.y===0?2:3;this.addBorderIntersection(c,i.x),this.addBorderIntersection(c,t.x)}}centroid(){const t=this.polyCount.reduce((i,c)=>i+c.edges,0);return t!==0?this.acc.div(t)._round():new Te(0,0)}span(){return new Te(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,i)=>t+ +(i[0]!==Number.MAX_VALUE),0)}}class Yd{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.layoutVertexArray=new $e,this.centroidVertexArray=new Do,this.indexArray=new wt,this.programConfigurations=new Ql(t.layers,t.zoom),this.segments=new Qn,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=t.enableTerrain}populate(t,i,c,h){this.features=[],this.hasPattern=pv("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(p){const y=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*y/(y*y+1)/Ct/(1<<p.z)}(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:p,id:y,index:v,sourceLayerIndex:b}of t){const T=this.layers[0]._featureFilter.needGeometry,M=oc(p,T);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),M,c))continue;const I={id:y,sourceLayerIndex:b,index:v,geometry:T?M.geometry:Fs(p,c,h),properties:p.properties,type:p.type,patterns:{}},D=this.layoutVertexArray.length;this.hasPattern?this.features.push(mv("fill-extrusion",this.layers,I,this.zoom,i)):this.addFeature(I,I.geometry,v,c,{},i.availableImages,h),i.featureIndex.insert(p,I.geometry,v,b,this.index,D)}this.sortBorders()}addFeatures(t,i,c,h,p){for(const y of this.features){const{geometry:v}=y;this.addFeature(y,v,y.index,i,c,h,p)}this.sortBorders()}update(t,i,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,c,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,nD),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,tD.members,!0))),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,eD.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,c,h,p,y,v){const b=[new Te(0,0),new Te(Ct,Ct)],T=v.projection,M=T.name==="globe",I=this.enableTerrain&&!M?new Xb:null,D=uD[t.type]==="Polygon";M&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Qe);const O=fv(i,500);for(let ie=O.length-1;ie>=0;ie--){const de=O[ie];(de.length===0||(B=de[0]).every(oe=>oe.x<=0)||B.every(oe=>oe.x>=Ct)||B.every(oe=>oe.y<=0)||B.every(oe=>oe.y>=Ct))&&O.splice(ie,1)}var B;let V;if(M)V=nT(O,b,h);else{V=[];for(const ie of O)V.push({polygon:ie,bounds:b})}const q=D?this.edgeRadius:0;for(const{polygon:ie,bounds:de}of V){let oe=0,ue=0;for(const pe of ie)D&&!pe[0].equals(pe[pe.length-1])&&pe.push(pe[0]),ue+=D?pe.length-1:pe.length;const me=this.segments.prepareSegment((D?5:4)*ue,this.layoutVertexArray,this.indexArray);if(D){const pe=[],Le=[];oe=me.vertexLength;for(const Ne of ie){let Je,Re;Ne.length&&Ne!==ie[0]&&Le.push(pe.length/2),Je=Ne[1].sub(Ne[0])._perp()._unit();for(let We=1;We<Ne.length;We++){const Ze=Ne[We],Xe=Ne[We===Ne.length-1?1:We+1];let{x:rt,y:Fe}=Ze;if(q){Re=Xe.sub(Ze)._perp()._unit();const ut=Je.add(Re)._unit(),vt=q*Math.min(4,1/(Je.x*ut.x+Je.y*ut.y));rt+=vt*ut.x,Fe+=vt*ut.y,Je=Re}Xd(this.layoutVertexArray,rt,Fe,0,0,1,1,0),me.vertexLength++,pe.push(Ze.x,Ze.y),M&&Kd(this.layoutVertexExtArray,T.projectTilePoint(rt,Fe,h),T.upVector(h,rt,Fe))}}const Ie=dv(pe,Le);for(let Ne=0;Ne<Ie.length;Ne+=3)this.indexArray.emplaceBack(oe+Ie[Ne],oe+Ie[Ne+2],oe+Ie[Ne+1]),me.primitiveLength++}for(const pe of ie){I&&pe.length&&I.startRing(pe[0]);let Le,Ie,Ne,Je=pe.length>4&&Qb(pe[pe.length-2],pe[0],pe[1]),Re=q?dD(pe[pe.length-2],pe[0],pe[1],q):0;Ie=pe[1].sub(pe[0])._perp()._unit();let We=!0;for(let Ze=1,Xe=0;Ze<pe.length;Ze++){let rt=pe[Ze-1],Fe=pe[Ze];const ut=pe[Ze===pe.length-1?1:Ze+1];if(I&&D&&I.currentPolyCount.top++,Jb(Fe,rt,de)){q&&(Ie=ut.sub(Fe)._perp()._unit(),We=!We);continue}I&&I.append(Fe,rt);const vt=Fe.sub(rt)._perp(),ht=vt.x/(Math.abs(vt.x)+Math.abs(vt.y)),Lt=vt.y>0?1:0,it=rt.dist(Fe);if(Xe+it>32768&&(Xe=0),q){Ne=ut.sub(Fe)._perp()._unit();let Rt=Yb(rt,Fe,ut,Kb(Ie,Ne),q);isNaN(Rt)&&(Rt=0);const Mt=Fe.sub(rt)._unit();rt=rt.add(Mt.mult(Re))._round(),Fe=Fe.add(Mt.mult(-Rt))._round(),Re=Rt,Ie=Ne}const Et=me.vertexLength,zt=pe.length>4&&Qb(rt,Fe,ut);let nn=eT(Xe,Je,We);if(Xd(this.layoutVertexArray,rt.x,rt.y,ht,Lt,0,0,nn),Xd(this.layoutVertexArray,rt.x,rt.y,ht,Lt,0,1,nn),Xe+=it,nn=eT(Xe,zt,!We),Je=zt,Xd(this.layoutVertexArray,Fe.x,Fe.y,ht,Lt,0,0,nn),Xd(this.layoutVertexArray,Fe.x,Fe.y,ht,Lt,0,1,nn),me.vertexLength+=4,this.indexArray.emplaceBack(Et+0,Et+1,Et+2),this.indexArray.emplaceBack(Et+1,Et+3,Et+2),me.primitiveLength+=2,q){const Rt=oe+(Ze===1?pe.length-2:Ze-2),Mt=Ze===1?oe:Rt+1;if(this.indexArray.emplaceBack(Et+1,Rt,Et+3),this.indexArray.emplaceBack(Rt,Mt,Et+3),me.primitiveLength+=2,Le===void 0&&(Le=Et),!Jb(ut,pe[Ze],de)){const Cn=Ze===pe.length-1?Le:me.vertexLength;this.indexArray.emplaceBack(Et+2,Et+3,Cn),this.indexArray.emplaceBack(Et+3,Cn+1,Cn),this.indexArray.emplaceBack(Et+3,Mt,Cn+1),me.primitiveLength+=3}We=!We}if(M){const Rt=this.layoutVertexExtArray,Mt=T.projectTilePoint(rt.x,rt.y,h),Cn=T.projectTilePoint(Fe.x,Fe.y,h),Bt=T.upVector(h,rt.x,rt.y),jt=T.upVector(h,Fe.x,Fe.y);Kd(Rt,Mt,Bt),Kd(Rt,Mt,Bt),Kd(Rt,Cn,jt),Kd(Rt,Cn,jt)}}D&&(oe+=pe.length-1)}}if(I&&I.polyCount.length>0){if(I.borders){I.vertexArrayOffset=this.centroidVertexArray.length;const ie=I.borders,de=this.featuresOnBorder.push(I)-1;for(let oe=0;oe<4;oe++)ie[oe][0]!==Number.MAX_VALUE&&this.borders[oe].push(de)}this.encodeCentroid(I.borders?void 0:I.centroid(),I)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,p,y,h)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((i,c)=>this.featuresOnBorder[i].borders[t][0]-this.featuresOnBorder[c].borders[t][0])}encodeCentroid(t,i,c=!0){let h,p;if(t)if(t.y!==0){const v=i.span()._mult(this.tileToMeter);h=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(v.x/10)),p=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(v.y/10))}else h=Math.ceil(7*(t.x+450)),p=0;else h=0,p=+c;let y=c?this.centroidVertexArray.length:i.vertexArrayOffset;for(const v of i.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*v.edges+v.top);for(let b=0;b<v.top;b++)this.centroidVertexArray.emplace(y++,h,p);for(let b=0;b<2*v.edges;b++)this.centroidVertexArray.emplace(y++,0,p),this.centroidVertexArray.emplace(y++,h,p)}}}function Kb(r,t){const i=r.add(t)._unit();return r.x*i.x+r.y*i.y}function dD(r,t,i,c){const h=t.sub(r)._perp()._unit(),p=i.sub(t)._perp()._unit();return Yb(r,t,i,Kb(h,p),c)}function Yb(r,t,i,c,h){const p=Math.sqrt(1-c*c);return Math.min(r.dist(t)/3,t.dist(i)/3,h*p/c)}function Jb(r,t,i){return r.x<i[0].x&&t.x<i[0].x||r.x>i[1].x&&t.x>i[1].x||r.y<i[0].y&&t.y<i[0].y||r.y>i[1].y&&t.y>i[1].y}function Qb(r,t,i){if(r.x<0||r.x>=Ct||t.x<0||t.x>=Ct||i.x<0||i.x>=Ct)return!1;const c=i.sub(t),h=c.perp(),p=r.sub(t);return(c.x*p.x+c.y*p.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(p.x*p.x+p.y*p.y))>-.866&&h.x*p.x+h.y*p.y<0}function eT(r,t,i){const c=t?2|r:-3&r;return i?1|c:-2&c}function tT(){const r=Math.PI/32,t=Math.tan(r),i=Gd;return i*Math.sqrt(1+2*t*t)-i}function nT(r,t,i){const c=1<<i.z,h=Ui(i.x/c),p=Ui((i.x+1)/c),y=Or(i.y/c),v=Or((i.y+1)/c);return function(b,T,M,I,D=0,O){const B=[];if(!b.length||!M||!I)return B;const V=(pe,Le)=>{for(const Ie of pe)B.push({polygon:Ie,bounds:Le})},q=Math.ceil(Math.log2(M)),ie=Math.ceil(Math.log2(I)),de=q-ie,oe=[];for(let pe=0;pe<Math.abs(de);pe++)oe.push(de>0?0:1);for(let pe=0;pe<Math.min(q,ie);pe++)oe.push(0),oe.push(1);let ue=b;if(ue=zm(ue,T[0].y-D,T[1].y+D,1),ue=zm(ue,T[0].x-D,T[1].x+D,0),!ue.length)return B;const me=[];for(oe.length?me.push({polygons:ue,bounds:T,depth:0}):V(ue,T);me.length;){const pe=me.pop(),Le=pe.depth,Ie=oe[Le],Ne=pe.bounds[0],Je=pe.bounds[1],Re=Ie===0?Ne.x:Ne.y,We=Ie===0?Je.x:Je.y,Ze=O?O(Ie,Re,We):.5*(Re+We),Xe=zm(pe.polygons,Re-D,Ze+D,Ie),rt=zm(pe.polygons,Ze-D,We+D,Ie);if(Xe.length){const Fe=[Ne,new Te(Ie===0?Ze:Je.x,Ie===1?Ze:Je.y)];oe.length>Le+1?me.push({polygons:Xe,bounds:Fe,depth:Le+1}):V(Xe,Fe)}if(rt.length){const Fe=[new Te(Ie===0?Ze:Ne.x,Ie===1?Ze:Ne.y),Je];oe.length>Le+1?me.push({polygons:rt,bounds:Fe,depth:Le+1}):V(rt,Fe)}}return B}(r,t,Math.ceil((p-h)/11.25),Math.ceil((y-v)/11.25),1,(b,T,M)=>{if(b===0)return .5*(T+M);{const I=Or((i.y+T/Ct)/c);return(os(.5*(Or((i.y+M/Ct)/c)+I))*c-i.y)*Ct}})}gt(Yd,"FillExtrusionBucket",{omit:["layers","features"]}),gt(Xb,"PartMetadata");const fD=new le({"fill-extrusion-edge-radius":new U(Be["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var pD={paint:new le({"fill-extrusion-opacity":new U(Be["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new K(Be["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new U(Be["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new U(Be["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new K(Be["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new K(Be["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new K(Be["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new U(Be["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new U(Be["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new U(Be["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new U(Be["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:fD};function rT(r,t,i){var c=2*Math.PI*6378137/256/Math.pow(2,i);return[r*c-2*Math.PI*6378137/2,t*c-2*Math.PI*6378137/2]}class Rm{constructor(t,i,c){this.z=t,this.x=i,this.y=c,this.key=Jd(0,t,t,i,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i){const c=function(p,y,v){var b=rT(256*p,256*(y=Math.pow(2,v)-y-1),v),T=rT(256*(p+1),256*(y+1),v);return b[0]+","+b[1]+","+T[0]+","+T[1]}(this.x,this.y,this.z),h=function(p,y,v){let b,T="";for(let M=p;M>0;M--)b=1<<M-1,T+=(y&b?1:0)+(v&b?2:0);return T}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class iT{constructor(t,i){this.wrap=t,this.canonical=i,this.key=Jd(t,i.z,i.z,i.x,i.y)}}class Jr{constructor(t,i,c,h,p){this.overscaledZ=t,this.wrap=i,this.canonical=new Rm(c,+h,+p),this.key=i===0&&t===c?this.canonical.key:Jd(i,t,c,h,p)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const i=this.canonical.z-t;return t>this.canonical.z?new Jr(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Jr(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i=!0){if(this.overscaledZ===t&&i)return this.key;if(t>this.canonical.z)return Jd(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-t;return Jd(this.wrap*+i,t,t,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new Jr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,c=2*this.canonical.x,h=2*this.canonical.y;return[new Jr(i,this.wrap,i,c,h),new Jr(i,this.wrap,i,c+1,h),new Jr(i,this.wrap,i,c,h+1),new Jr(i,this.wrap,i,c+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Jr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Jr(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new iT(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Jd(r,t,i,c,h){const p=1<<Math.min(i,22);let y=p*(h%p)+c%p;return r&&i<22&&(y+=p*p*((r<0?-2*r-1:2*r)%(1<<2*(22-i)))),16*(32*y+i)+(t-i)}gt(Rm,"CanonicalTileID"),gt(Jr,"OverscaledTileID",{omit:["projMatrix"]});class Ou extends Te{constructor(t,i,c){super(t,i),this.z=c}}function Qd(r,t){return r.x*t.x+r.y*t.y}function oT(r,t){if(r.length===1){let i=0;const c=t[i++];let h;for(;!h||c.equals(h);)if(h=t[i++],!h)return 1/0;for(;i<t.length;i++){const p=t[i],y=r[0],v=h.sub(c),b=p.sub(c),T=y.sub(c),M=Qd(v,v),I=Qd(v,b),D=Qd(b,b),O=Qd(T,v),B=Qd(T,b),V=M*D-I*I,q=(D*O-I*B)/V,ie=(M*B-I*O)/V,de=c.z*(1-q-ie)+h.z*q+p.z*ie;if(isFinite(de))return de}return 1/0}{let i=1/0;for(const c of t)i=Math.min(i,c.z);return i}}function sT(r,t,i,c,h,p,y,v){const b=y*h.getElevationAt(r,t,!0,!0),T=p[0]!==0,M=T?p[1]===0?y*(p[0]/7-450):y*function(I,D,O){const B=Math.floor(D[0]/8),V=Math.floor(D[1]/8),q=10*(D[0]-8*B),ie=10*(D[1]-8*V),de=I.getElevationAt(B,V,!0,!0),oe=I.getMeterToDEM(O),ue=Math.floor(.5*(q*oe-1)),me=Math.floor(.5*(ie*oe-1)),pe=I.tileCoordToPixel(B,V),Le=2*ue+1,Ie=2*me+1,Ne=function(rt,Fe,ut,vt,ht){return[rt.getElevationAtPixel(Fe,ut,!0),rt.getElevationAtPixel(Fe+ht,ut,!0),rt.getElevationAtPixel(Fe,ut+ht,!0),rt.getElevationAtPixel(Fe+vt,ut+ht,!0)]}(I,pe.x-ue,pe.y-me,Le,Ie),Je=Math.abs(Ne[0]-Ne[1]),Re=Math.abs(Ne[2]-Ne[3]),We=Math.abs(Ne[0]-Ne[2])+Math.abs(Ne[1]-Ne[3]),Ze=Math.min(.25,.5*oe*(Je+Re)/Le),Xe=Math.min(.25,.5*oe*We/Ie);return de+Math.max(Ze*q,Xe*ie)}(h,p,v):b;return{base:b+(i===0)?-1:i,top:T?Math.max(M+c,b+i+2):b+c}}const mD=Ee([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:gD}=mD,yD=Ee([{name:"a_packed",components:4,type:"Float32"}]),{members:_D}=yD,vD=Lm.types,xD=Math.cos(Math.PI/180*37.5);class Om{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new ze,this.layoutVertexArray2=new Ke,this.indexArray=new wt,this.programConfigurations=new Ql(t.layers,t.zoom),this.segments=new Qn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,c,h){this.hasPattern=pv("line",this.layers,i);const p=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:M,id:I,index:D,sourceLayerIndex:O}of t){const B=this.layers[0]._featureFilter.needGeometry,V=oc(M,B);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),V,c))continue;const q=p?p.evaluate(V,{},c):void 0,ie={id:I,properties:M.properties,type:M.type,sourceLayerIndex:O,index:D,geometry:B?V.geometry:Fs(M,c,h),patterns:{},sortKey:q};y.push(ie)}p&&y.sort((M,I)=>M.sortKey-I.sortKey);const{lineAtlas:v,featureIndex:b}=i,T=this.addConstantDashes(v);for(const M of y){const{geometry:I,index:D,sourceLayerIndex:O}=M;if(T&&this.addFeatureDashes(M,v),this.hasPattern){const B=mv("line",this.layers,M,this.zoom,i);this.patternFeatures.push(B)}else this.addFeature(M,I,D,c,v.positions,i.availableImages);b.insert(t[D].feature,I,D,O,this.index)}}addConstantDashes(t){let i=!1;for(const c of this.layers){const h=c.paint.get("line-dasharray").value,p=c.layout.get("line-cap").value;if(h.kind!=="constant"||p.kind!=="constant")i=!0;else{const y=p.value,v=h.value;if(!v)continue;t.addDash(v,y)}}return i}addFeatureDashes(t,i){const c=this.zoom;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,y=h.layout.get("line-cap").value;if(p.kind==="constant"&&y.kind==="constant")continue;let v,b;if(p.kind==="constant"){if(v=p.value,!v)continue}else v=p.evaluate({zoom:c},t);b=y.kind==="constant"?y.value:y.evaluate({zoom:c},t),i.addDash(v,b),t.patterns[h.id]=i.getKey(v,b)}}update(t,i,c,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,c,h)}addFeatures(t,i,c,h,p){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,i,c,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,_D)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gD),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,c,h,p,y){const v=this.layers[0].layout,b=v.get("line-join").evaluate(t,{}),T=v.get("line-cap").evaluate(t,{}),M=v.get("line-miter-limit"),I=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const D of i)this.addLine(D,t,b,T,M,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,p,y,h)}addLine(t,i,c,h,p,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ie=0;ie<t.length-1;ie++)this.totalDistance+=t[ie].dist(t[ie+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=vD[i.type]==="Polygon";let b=t.length;for(;b>=2&&t[b-1].equals(t[b-2]);)b--;let T=0;for(;T<b-1&&t[T].equals(t[T+1]);)T++;if(b<(v?3:2))return;c==="bevel"&&(p=1.05);const M=this.overscaling<=16?15*Ct/(512*this.overscaling):0,I=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let D,O,B,V,q;this.e1=this.e2=-1,v&&(D=t[b-2],q=t[T].sub(D)._unit()._perp());for(let ie=T;ie<b;ie++){if(B=ie===b-1?v?t[T+1]:void 0:t[ie+1],B&&t[ie].equals(B))continue;q&&(V=q),D&&(O=D),D=t[ie],q=B?B.sub(D)._unit()._perp():V,V=V||q;let de=V.add(q);de.x===0&&de.y===0||de._unit();const oe=V.x*q.x+V.y*q.y,ue=de.x*q.x+de.y*q.y,me=ue!==0?1/ue:1/0,pe=2*Math.sqrt(2-2*ue),Le=ue<xD&&O&&B,Ie=V.x*q.y-V.y*q.x>0;if(Le&&ie>T){const Re=D.dist(O);if(Re>2*M){const We=D.sub(D.sub(O)._mult(M/Re)._round());this.updateDistance(O,We),this.addCurrentVertex(We,V,0,0,I),O=We}}const Ne=O&&B;let Je=Ne?c:v?"butt":h;if(Ne&&Je==="round"&&(me<y?Je="miter":me<=2&&(Je="fakeround")),Je==="miter"&&me>p&&(Je="bevel"),Je==="bevel"&&(me>2&&(Je="flipbevel"),me<p&&(Je="miter")),O&&this.updateDistance(O,D),Je==="miter")de._mult(me),this.addCurrentVertex(D,de,0,0,I);else if(Je==="flipbevel"){if(me>100)de=q.mult(-1);else{const Re=me*V.add(q).mag()/V.sub(q).mag();de._perp()._mult(Re*(Ie?-1:1))}this.addCurrentVertex(D,de,0,0,I),this.addCurrentVertex(D,de.mult(-1),0,0,I)}else if(Je==="bevel"||Je==="fakeround"){const Re=-Math.sqrt(me*me-1),We=Ie?Re:0,Ze=Ie?0:Re;if(O&&this.addCurrentVertex(D,V,We,Ze,I),Je==="fakeround"){const Xe=Math.round(180*pe/Math.PI/20);for(let rt=1;rt<Xe;rt++){let Fe=rt/Xe;if(Fe!==.5){const vt=Fe-.5;Fe+=Fe*vt*(Fe-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*vt*vt+(.848013+oe*(.215638*oe-1.06021)))}const ut=q.sub(V)._mult(Fe)._add(V)._unit()._mult(Ie?-1:1);this.addHalfVertex(D,ut.x,ut.y,!1,Ie,0,I)}}B&&this.addCurrentVertex(D,q,-We,-Ze,I)}else if(Je==="butt")this.addCurrentVertex(D,de,0,0,I);else if(Je==="square"){const Re=O?1:-1;O||this.addCurrentVertex(D,de,Re,Re,I),this.addCurrentVertex(D,de,0,0,I),O&&this.addCurrentVertex(D,de,Re,Re,I)}else Je==="round"&&(O&&(this.addCurrentVertex(D,V,0,0,I),this.addCurrentVertex(D,V,1,1,I,!0)),B&&(this.addCurrentVertex(D,q,-1,-1,I,!0),this.addCurrentVertex(D,q,0,0,I)));if(Le&&ie<b-1){const Re=D.dist(B);if(Re>2*M){const We=D.add(B.sub(D)._mult(M/Re)._round());this.updateDistance(D,We),this.addCurrentVertex(We,q,0,0,I),D=We}}}}addCurrentVertex(t,i,c,h,p,y=!1){const v=i.y*h-i.x,b=-i.y-i.x*h;this.addHalfVertex(t,i.x+i.y*c,i.y-i.x*c,y,!1,c,p),this.addHalfVertex(t,v,b,y,!0,-h,p)}addHalfVertex({x:t,y:i},c,h,p,y,v,b){this.layoutVertexArray.emplaceBack((t<<1)+(p?1:0),(i<<1)+(y?1:0),Math.round(63*c)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const T=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),b.primitiveLength++),y?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}gt(Om,"LineBucket",{omit:["layers","patternFeatures"]});const wD=new le({"line-cap":new K(Be.layout_line["line-cap"]),"line-join":new K(Be.layout_line["line-join"]),"line-miter-limit":new U(Be.layout_line["line-miter-limit"]),"line-round-limit":new U(Be.layout_line["line-round-limit"]),"line-sort-key":new K(Be.layout_line["line-sort-key"])});var aT={paint:new le({"line-opacity":new K(Be.paint_line["line-opacity"]),"line-color":new K(Be.paint_line["line-color"]),"line-translate":new U(Be.paint_line["line-translate"]),"line-translate-anchor":new U(Be.paint_line["line-translate-anchor"]),"line-width":new K(Be.paint_line["line-width"]),"line-gap-width":new K(Be.paint_line["line-gap-width"]),"line-offset":new K(Be.paint_line["line-offset"]),"line-blur":new K(Be.paint_line["line-blur"]),"line-dasharray":new K(Be.paint_line["line-dasharray"]),"line-pattern":new K(Be.paint_line["line-pattern"]),"line-gradient":new ae(Be.paint_line["line-gradient"]),"line-trim-offset":new U(Be.paint_line["line-trim-offset"])}),layout:wD};const lT=new class extends K{possiblyEvaluate(r,t){return t=new k(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(r,t)}evaluate(r,t,i,c){return t=ln({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(r,t,i,c)}}(aT.paint.properties["line-width"].specification);function cT(r,t){return t>0?t+2*r:r}lT.useIntegerZoom=!0;const bD=Ee([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),TD=Ee([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),ED=Ee([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ee([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const SD=Ee([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),CD=Ee([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ee([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const uT=Ee([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),PD=Ee([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ee([{name:"triangle",components:3,type:"Uint16"}]),Ee([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ee([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ee([{type:"Float32",name:"offsetX"}]),Ee([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Mr=24;const Bo=128;function yv(r,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new k(r+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:h}=i;let p=0;for(;p<c.length&&c[p]<=r;)p++;p=Math.max(0,p-1);let y=p;for(;y<c.length&&c[y]<r+1;)y++;y=Math.min(c.length-1,y);const v=c[p],b=c[y];return i.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:b,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:b,minSize:i.evaluate(new k(v)),maxSize:i.evaluate(new k(b)),interpolationType:h}}}function Fm(r,{uSize:t,uSizeT:i},{lowerSize:c,upperSize:h}){return r.kind==="source"?c/Bo:r.kind==="composite"?en(c/Bo,h/Bo,i):t}function Fu(r,t){let i=0,c=0;if(r.kind==="constant")c=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:h,minZoom:p,maxZoom:y}=r,v=h?He(no.interpolationFactor(h,t,p,y),0,1):0;r.kind==="camera"?c=en(r.minSize,r.maxSize,v):i=v}return{uSizeT:i,uSize:c}}var MD=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Bo,evaluateSizeForFeature:Fm,evaluateSizeForZoom:Fu,getSizeData:yv});function kD(r,t,i){return r.sections.forEach(c=>{c.text=function(h,p,y){const v=p.layout.get("text-transform").evaluate(y,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),C.applyArabicShaping&&(h=C.applyArabicShaping(h)),h}(c.text,t,i)}),r}const ef={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function ID(r){return r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""}function AD(r){return r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""}var hT=wn,dT=function(r,t,i,c,h){var p,y,v=8*h-c-1,b=(1<<v)-1,T=b>>1,M=-7,I=h-1,D=-1,O=r[t+I];for(I+=D,p=O&(1<<-M)-1,O>>=-M,M+=v;M>0;p=256*p+r[t+I],I+=D,M-=8);for(y=p&(1<<-M)-1,p>>=-M,M+=c;M>0;y=256*y+r[t+I],I+=D,M-=8);if(p===0)p=1-T;else{if(p===b)return y?NaN:1/0*(O?-1:1);y+=Math.pow(2,c),p-=T}return(O?-1:1)*y*Math.pow(2,p-c)},fT=function(r,t,i,c,h,p){var y,v,b,T=8*p-h-1,M=(1<<T)-1,I=M>>1,D=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=0,B=1,V=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,y=M):(y=Math.floor(Math.log(t)/Math.LN2),t*(b=Math.pow(2,-y))<1&&(y--,b*=2),(t+=y+I>=1?D/b:D*Math.pow(2,1-I))*b>=2&&(y++,b/=2),y+I>=M?(v=0,y=M):y+I>=1?(v=(t*b-1)*Math.pow(2,h),y+=I):(v=t*Math.pow(2,I-1)*Math.pow(2,h),y=0));h>=8;r[i+O]=255&v,O+=B,v/=256,h-=8);for(y=y<<h|v,T+=h;T>0;r[i+O]=255&y,O+=B,y/=256,T-=8);r[i+O-B]|=128*V};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function wn(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}wn.Varint=0,wn.Fixed64=1,wn.Bytes=2,wn.Fixed32=5;var _v=4294967296,pT=1/_v,mT=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function js(r){return r.type===wn.Bytes?r.readVarint()+r.pos:r.pos+1}function Bu(r,t,i){return i?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function gT(r,t,i){var c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(c);for(var h=i.pos-1;h>=r;h--)i.buf[h+c]=i.buf[h]}function DD(r,t){for(var i=0;i<r.length;i++)t.writeVarint(r[i])}function LD(r,t){for(var i=0;i<r.length;i++)t.writeSVarint(r[i])}function zD(r,t){for(var i=0;i<r.length;i++)t.writeFloat(r[i])}function RD(r,t){for(var i=0;i<r.length;i++)t.writeDouble(r[i])}function OD(r,t){for(var i=0;i<r.length;i++)t.writeBoolean(r[i])}function FD(r,t){for(var i=0;i<r.length;i++)t.writeFixed32(r[i])}function BD(r,t){for(var i=0;i<r.length;i++)t.writeSFixed32(r[i])}function jD(r,t){for(var i=0;i<r.length;i++)t.writeFixed64(r[i])}function ND(r,t){for(var i=0;i<r.length;i++)t.writeSFixed64(r[i])}function Bm(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function ju(r,t,i){r[i]=t,r[i+1]=t>>>8,r[i+2]=t>>>16,r[i+3]=t>>>24}function yT(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}wn.prototype={destroy:function(){this.buf=null},readFields:function(r,t,i){for(i=i||this.length;this.pos<i;){var c=this.readVarint(),h=c>>3,p=this.pos;this.type=7&c,r(h,t,this),this.pos===p&&this.skip(c)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=Bm(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=yT(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Bm(this.buf,this.pos)+Bm(this.buf,this.pos+4)*_v;return this.pos+=8,r},readSFixed64:function(){var r=Bm(this.buf,this.pos)+yT(this.buf,this.pos+4)*_v;return this.pos+=8,r},readFloat:function(){var r=dT(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=dT(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,i,c=this.buf;return t=127&(i=c[this.pos++]),i<128?t:(t|=(127&(i=c[this.pos++]))<<7,i<128?t:(t|=(127&(i=c[this.pos++]))<<14,i<128?t:(t|=(127&(i=c[this.pos++]))<<21,i<128?t:function(h,p,y){var v,b,T=y.buf;if(v=(112&(b=T[y.pos++]))>>4,b<128||(v|=(127&(b=T[y.pos++]))<<3,b<128)||(v|=(127&(b=T[y.pos++]))<<10,b<128)||(v|=(127&(b=T[y.pos++]))<<17,b<128)||(v|=(127&(b=T[y.pos++]))<<24,b<128)||(v|=(1&(b=T[y.pos++]))<<31,b<128))return Bu(h,v,p);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=c[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&mT?function(i,c,h){return mT.decode(i.subarray(c,h))}(this.buf,t,r):function(i,c,h){for(var p="",y=c;y<h;){var v,b,T,M=i[y],I=null,D=M>239?4:M>223?3:M>191?2:1;if(y+D>h)break;D===1?M<128&&(I=M):D===2?(192&(v=i[y+1]))==128&&(I=(31&M)<<6|63&v)<=127&&(I=null):D===3?(b=i[y+2],(192&(v=i[y+1]))==128&&(192&b)==128&&((I=(15&M)<<12|(63&v)<<6|63&b)<=2047||I>=55296&&I<=57343)&&(I=null)):D===4&&(b=i[y+2],T=i[y+3],(192&(v=i[y+1]))==128&&(192&b)==128&&(192&T)==128&&((I=(15&M)<<18|(63&v)<<12|(63&b)<<6|63&T)<=65535||I>=1114112)&&(I=null)),I===null?(I=65533,D=1):I>65535&&(I-=65536,p+=String.fromCharCode(I>>>10&1023|55296),I=56320|1023&I),p+=String.fromCharCode(I),y+=D}return p}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==wn.Bytes)return r.push(this.readVarint(t));var i=js(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==wn.Bytes)return r.push(this.readSVarint());var t=js(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==wn.Bytes)return r.push(this.readBoolean());var t=js(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==wn.Bytes)return r.push(this.readFloat());var t=js(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==wn.Bytes)return r.push(this.readDouble());var t=js(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==wn.Bytes)return r.push(this.readFixed32());var t=js(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==wn.Bytes)return r.push(this.readSFixed32());var t=js(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==wn.Bytes)return r.push(this.readFixed64());var t=js(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==wn.Bytes)return r.push(this.readSFixed64());var t=js(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===wn.Varint)for(;this.buf[this.pos++]>127;);else if(t===wn.Bytes)this.pos=this.readVarint()+this.pos;else if(t===wn.Fixed32)this.pos+=4;else{if(t!==wn.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),ju(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),ju(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),ju(this.buf,-1&r,this.pos),ju(this.buf,Math.floor(r*pT),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),ju(this.buf,-1&r,this.pos),ju(this.buf,Math.floor(r*pT),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,i){var c,h;if(t>=0?(c=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(c=~(-t%4294967296))?c=c+1|0:(c=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(p,y,v){v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,v.buf[v.pos]=127&(p>>>=7)}(c,0,i),function(p,y){var v=(7&p)<<4;y.buf[y.pos++]|=v|((p>>>=3)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p)))))}(h,i)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(c,h,p){for(var y,v,b=0;b<h.length;b++){if((y=h.charCodeAt(b))>55295&&y<57344){if(!v){y>56319||b+1===h.length?(c[p++]=239,c[p++]=191,c[p++]=189):v=y;continue}if(y<56320){c[p++]=239,c[p++]=191,c[p++]=189,v=y;continue}y=v-55296<<10|y-56320|65536,v=null}else v&&(c[p++]=239,c[p++]=191,c[p++]=189,v=null);y<128?c[p++]=y:(y<2048?c[p++]=y>>6|192:(y<65536?c[p++]=y>>12|224:(c[p++]=y>>18|240,c[p++]=y>>12&63|128),c[p++]=y>>6&63|128),c[p++]=63&y|128)}return p}(this.buf,r,this.pos);var i=this.pos-t;i>=128&&gT(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),fT(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),fT(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,t){this.pos++;var i=this.pos;r(t,this);var c=this.pos-i;c>=128&&gT(i,c,this),this.pos=i-1,this.writeVarint(c),this.pos+=c},writeMessage:function(r,t,i){this.writeTag(r,wn.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,DD,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,LD,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,OD,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,zD,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,RD,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,FD,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,BD,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,jD,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,ND,t)},writeBytesField:function(r,t){this.writeTag(r,wn.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,wn.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,wn.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,wn.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,wn.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,wn.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,wn.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,wn.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,wn.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,wn.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,!!t)}};var jm=fe(hT);const vv=3;function UD(r,t,i){t.glyphs=[],r===1&&i.readMessage(VD,t)}function VD(r,t,i){if(r===3){const{id:c,bitmap:h,width:p,height:y,left:v,top:b,advance:T}=i.readMessage($D,{});t.glyphs.push({id:c,bitmap:new Bs({width:p+2*vv,height:y+2*vv},h),metrics:{width:p,height:y,left:v,top:b,advance:T}})}else r===4?t.ascender=i.readSVarint():r===5&&(t.descender=i.readSVarint())}function $D(r,t,i){r===1?t.id=i.readVarint():r===2?t.bitmap=i.readBytes():r===3?t.width=i.readVarint():r===4?t.height=i.readVarint():r===5?t.left=i.readSVarint():r===6?t.top=i.readSVarint():r===7&&(t.advance=i.readVarint())}const _T=vv;function xv(r){let t=0,i=0;for(const y of r)t+=y.w*y.h,i=Math.max(i,y.w);r.sort((y,v)=>v.h-y.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let h=0,p=0;for(const y of r)for(let v=c.length-1;v>=0;v--){const b=c[v];if(!(y.w>b.w||y.h>b.h)){if(y.x=b.x,y.y=b.y,p=Math.max(p,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===b.w&&y.h===b.h){const T=c.pop();v<c.length&&(c[v]=T)}else y.h===b.h?(b.x+=y.w,b.w-=y.w):y.w===b.w?(b.y+=y.h,b.h-=y.h):(c.push({x:b.x+y.w,y:b.y,w:b.w-y.w,h:y.h}),b.y+=y.h,b.h-=y.h);break}}return{w:h,h:p,fill:t/(h*p)||0}}const hi=1;class wv{constructor(t,{pixelRatio:i,version:c,stretchX:h,stretchY:p,content:y}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=h,this.stretchY=p,this.content=y,this.version=c}get tl(){return[this.paddedRect.x+hi,this.paddedRect.y+hi]}get br(){return[this.paddedRect.x+this.paddedRect.w-hi,this.paddedRect.y+this.paddedRect.h-hi]}get displaySize(){return[(this.paddedRect.w-2*hi)/this.pixelRatio,(this.paddedRect.h-2*hi)/this.pixelRatio]}}class vT{constructor(t,i){const c={},h={};this.haveRenderCallbacks=[];const p=[];this.addImages(t,c,p),this.addImages(i,h,p);const{w:y,h:v}=xv(p),b=new Pi({width:y||1,height:v||1});for(const T in t){const M=t[T],I=c[T].paddedRect;Pi.copy(M.data,b,{x:0,y:0},{x:I.x+hi,y:I.y+hi},M.data)}for(const T in i){const M=i[T],I=h[T].paddedRect,D=I.x+hi,O=I.y+hi,B=M.data.width,V=M.data.height;Pi.copy(M.data,b,{x:0,y:0},{x:D,y:O},M.data),Pi.copy(M.data,b,{x:0,y:V-1},{x:D,y:O-1},{width:B,height:1}),Pi.copy(M.data,b,{x:0,y:0},{x:D,y:O+V},{width:B,height:1}),Pi.copy(M.data,b,{x:B-1,y:0},{x:D-1,y:O},{width:1,height:V}),Pi.copy(M.data,b,{x:0,y:0},{x:D+B,y:O},{width:1,height:V})}this.image=b,this.iconPositions=c,this.patternPositions=h}addImages(t,i,c){for(const h in t){const p=t[h],y={x:0,y:0,w:p.data.width+2*hi,h:p.data.height+2*hi};c.push(y),i[h]=new wv(y,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>t.hasImage(c)),t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in t.updatedImages)this.patchUpdatedImage(this.iconPositions[c],t.getImage(c),i),this.patchUpdatedImage(this.patternPositions[c],t.getImage(c),i)}patchUpdatedImage(t,i,c){if(!t||!i||t.version===i.version)return;t.version=i.version;const[h,p]=t.tl;c.update(i.data,void 0,{x:h,y:p})}}gt(wv,"ImagePosition"),gt(vT,"ImageAtlas");const Vi={horizontal:1,vertical:2,horizontalOnly:3},xT=-17;class tf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,i){const c=new tf;return c.scale=t||1,c.fontStack=i,c}static forImage(t){const i=new tf;return i.imageName=t,i}}class Nu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const c=new Nu;for(let h=0;h<t.sections.length;h++){const p=t.sections[h];p.image?c.addImageSection(p):c.addTextSection(p,i)}return c}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(i,c){let h="";for(let p=0;p<i.length;p++){const y=i.charCodeAt(p+1)||null,v=i.charCodeAt(p-1)||null;h+=!c&&(y&&pm(y)&&!ef[i[p+1]]||v&&pm(v)&&!ef[i[p-1]])||!ef[i[p]]?i[p]:ef[i[p]]}return h}(this.text,t)}trim(){let t=0;for(let c=0;c<this.text.length&&Nm[this.text.charCodeAt(c)];c++)t++;let i=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&Nm[this.text.charCodeAt(c)];c--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const c=new Nu;return c.text=this.text.substring(t,i),c.sectionIndex=this.sectionIndex.slice(t,i),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,i)=>Math.max(t,this.sections[i].scale),0)}addTextSection(t,i){this.text+=t.text,this.sections.push(tf.forText(t.scale,t.fontStack||i));const c=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(c)}addImageSection(t){const i=t.image?t.image.name:"";if(i.length===0)return void Rn("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(tf.forImage(i)),this.sectionIndex.push(this.sections.length-1)):Rn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function bv(r,t,i,c,h,p,y,v,b,T,M,I,D,O,B){const V=Nu.fromFeature(r,h);I===Vi.vertical&&V.verticalizePunctuation(D);let q=[];const ie=function(pe,Le,Ie,Ne,Je,Re){if(!pe)return[];const We=[],Ze=function(ut,vt,ht,Lt,it,Et){let zt=0;for(let nn=0;nn<ut.length();nn++){const Rt=ut.getSection(nn);zt+=wT(ut.getCharCode(nn),Rt,Lt,it,vt,Et)}return zt/Math.max(1,Math.ceil(zt/ht))}(pe,Le,Ie,Ne,Je,Re),Xe=pe.text.indexOf("")>=0;let rt=0;for(let ut=0;ut<pe.length();ut++){const vt=pe.getSection(ut),ht=pe.getCharCode(ut);if(Nm[ht]||(rt+=wT(ht,vt,Ne,Je,Le,Re)),ut<pe.length()-1){const Lt=!((Fe=ht)<11904||!(dt["Bopomofo Extended"](Fe)||dt.Bopomofo(Fe)||dt["CJK Compatibility Forms"](Fe)||dt["CJK Compatibility Ideographs"](Fe)||dt["CJK Compatibility"](Fe)||dt["CJK Radicals Supplement"](Fe)||dt["CJK Strokes"](Fe)||dt["CJK Symbols and Punctuation"](Fe)||dt["CJK Unified Ideographs Extension A"](Fe)||dt["CJK Unified Ideographs"](Fe)||dt["Enclosed CJK Letters and Months"](Fe)||dt["Halfwidth and Fullwidth Forms"](Fe)||dt.Hiragana(Fe)||dt["Ideographic Description Characters"](Fe)||dt["Kangxi Radicals"](Fe)||dt["Katakana Phonetic Extensions"](Fe)||dt.Katakana(Fe)||dt["Vertical Forms"](Fe)||dt["Yi Radicals"](Fe)||dt["Yi Syllables"](Fe)));(GD[ht]||Lt||vt.imageName)&&We.push(TT(ut+1,rt,Ze,We,WD(ht,pe.getCharCode(ut+1),Lt&&Xe),!1))}}var Fe;return ET(TT(pe.length(),rt,Ze,We,0,!0))}(V,T,p,t,c,O),{processBidirectionalText:de,processStyledBidirectionalText:oe}=C;if(de&&V.sections.length===1){const pe=de(V.toString(),ie);for(const Le of pe){const Ie=new Nu;Ie.text=Le,Ie.sections=V.sections;for(let Ne=0;Ne<Le.length;Ne++)Ie.sectionIndex.push(0);q.push(Ie)}}else if(oe){const pe=oe(V.text,V.sectionIndex,ie);for(const Le of pe){const Ie=new Nu;Ie.text=Le[0],Ie.sectionIndex=Le[1],Ie.sections=V.sections,q.push(Ie)}}else q=function(pe,Le){const Ie=[],Ne=pe.text;let Je=0;for(const Re of Le)Ie.push(pe.substring(Je,Re)),Je=Re;return Je<Ne.length&&Ie.push(pe.substring(Je,Ne.length)),Ie}(V,ie);const ue=[],me={positionedLines:ue,text:V.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:I,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(pe,Le,Ie,Ne,Je,Re,We,Ze,Xe,rt,Fe,ut){let vt=0,ht=0,Lt=0;const it=Ze==="right"?1:Ze==="left"?0:.5;let Et=!1;for(const Bt of Je){const jt=Bt.getSections();for(const _n of jt){if(_n.imageName)continue;const bn=Le[_n.fontStack];if(bn&&(Et=bn.ascender!==void 0&&bn.descender!==void 0,!Et))break}if(!Et)break}let zt=0;for(const Bt of Je){Bt.trim();const jt=Bt.getMaxScale(),_n=(jt-1)*Mr,bn={positionedGlyphs:[],lineOffset:0};pe.positionedLines[zt]=bn;const Tn=bn.positionedGlyphs;let vn=0;if(!Bt.length()){ht+=Re,++zt;continue}let Fn=0,Un=0;for(let xn=0;xn<Bt.length();xn++){const dr=Bt.getSection(xn),nr=Bt.getSectionIndex(xn),Bn=Bt.getCharCode(xn);let on=dr.scale,rr=null,En=null,Qr=null,ir=Mr,kr=0;const wr=!(Xe===Vi.horizontal||!Fe&&!Md(Bn)||Fe&&(Nm[Bn]||(nn=Bn,dt.Arabic(nn)||dt["Arabic Supplement"](nn)||dt["Arabic Extended-A"](nn)||dt["Arabic Presentation Forms-A"](nn)||dt["Arabic Presentation Forms-B"](nn))));if(dr.imageName){const ei=Ne[dr.imageName];if(!ei)continue;Qr=dr.imageName,pe.iconsInText=pe.iconsInText||!0,En=ei.paddedRect;const br=ei.displaySize;on=on*Mr/ut,rr={width:br[0],height:br[1],left:hi,top:-_T,advance:wr?br[1]:br[0],localGlyph:!1},kr=Et?-rr.height*on:xT+jt*Mr-br[1]*on,ir=rr.advance;const Uo=(wr?br[0]:br[1])*on-Mr*jt;Uo>0&&Uo>vn&&(vn=Uo)}else{const ei=Ie[dr.fontStack];if(!ei)continue;ei[Bn]&&(En=ei[Bn]);const br=Le[dr.fontStack];if(!br)continue;const Uo=br.glyphs[Bn];if(!Uo)continue;if(rr=Uo.metrics,ir=Bn!==8203?Mr:0,Et){const qu=br.ascender!==void 0?Math.abs(br.ascender):0,df=br.descender!==void 0?Math.abs(br.descender):0,ff=(qu+df)*on;Fn<ff&&(Fn=ff,Un=(qu-df)/2*on),kr=-qu*on}else kr=xT+(jt-on)*Mr}wr?(pe.verticalizable=!0,Tn.push({glyph:Bn,imageName:Qr,x:vt,y:ht+kr,vertical:wr,scale:on,localGlyph:rr.localGlyph,fontStack:dr.fontStack,sectionIndex:nr,metrics:rr,rect:En}),vt+=ir*on+rt):(Tn.push({glyph:Bn,imageName:Qr,x:vt,y:ht+kr,vertical:wr,scale:on,localGlyph:rr.localGlyph,fontStack:dr.fontStack,sectionIndex:nr,metrics:rr,rect:En}),vt+=rr.advance*on+rt)}Tn.length!==0&&(Lt=Math.max(vt-rt,Lt),Et?ST(Tn,it,vn,Un,Re*jt/2):ST(Tn,it,vn,0,Re/2)),vt=0;const tr=Re*jt+vn;bn.lineOffset=Math.max(vn,_n),ht+=tr,++zt}var nn;const Rt=ht,{horizontalAlign:Mt,verticalAlign:Cn}=Tv(We);(function(Bt,jt,_n,bn,Tn,vn){const Fn=(jt-_n)*Tn,Un=-vn*bn;for(const tr of Bt)for(const xn of tr.positionedGlyphs)xn.x+=Fn,xn.y+=Un})(pe.positionedLines,it,Mt,Cn,Lt,Rt),pe.top+=-Cn*Rt,pe.bottom=pe.top+Rt,pe.left+=-Mt*Lt,pe.right=pe.left+Lt,pe.hasBaseline=Et}(me,t,i,c,q,y,v,b,I,T,D,B),!function(pe){for(const Le of pe)if(Le.positionedGlyphs.length!==0)return!1;return!0}(ue)&&me}const Nm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},GD={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function wT(r,t,i,c,h,p){if(t.imageName){const y=c[t.imageName];return y?y.displaySize[0]*t.scale*Mr/p+h:0}{const y=i[t.fontStack],v=y&&y.glyphs[r];return v?v.metrics.advance*t.scale+h:0}}function bT(r,t,i,c){const h=Math.pow(r-t,2);return c?r<t?h/2:2*h:h+Math.abs(i)*i}function WD(r,t,i){let c=0;return r===10&&(c-=1e4),i&&(c+=150),r!==40&&r!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function TT(r,t,i,c,h,p){let y=null,v=bT(t,i,h,p);for(const b of c){const T=bT(t-b.x,i,h,p)+b.badness;T<=v&&(y=b,v=T)}return{index:r,x:t,priorBreak:y,badness:v}}function ET(r){return r?ET(r.priorBreak).concat(r.index):[]}function Tv(r){let t=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function ST(r,t,i,c,h){if(!(t||i||c||h))return;const p=r.length-1,y=r[p],v=(y.x+y.metrics.advance*y.scale)*t;for(let b=0;b<=p;b++)r[b].x-=v,r[b].y+=i+c+h}function ZD(r,t,i){const{horizontalAlign:c,verticalAlign:h}=Tv(i),p=t[0]-r.displaySize[0]*c,y=t[1]-r.displaySize[1]*h;return{image:r,top:y,bottom:y+r.displaySize[1],left:p,right:p+r.displaySize[0]}}function CT(r,t,i,c,h,p){const y=r.image;let v;if(y.content){const q=y.content,ie=y.pixelRatio||1;v=[q[0]/ie,q[1]/ie,y.displaySize[0]-q[2]/ie,y.displaySize[1]-q[3]/ie]}const b=t.left*p,T=t.right*p;let M,I,D,O;i==="width"||i==="both"?(O=h[0]+b-c[3],I=h[0]+T+c[1]):(O=h[0]+(b+T-y.displaySize[0])/2,I=O+y.displaySize[0]);const B=t.top*p,V=t.bottom*p;return i==="height"||i==="both"?(M=h[1]+B-c[0],D=h[1]+V+c[2]):(M=h[1]+(B+V-y.displaySize[1])/2,D=M+y.displaySize[1]),{image:y,top:M,right:I,bottom:D,left:O,collisionPadding:v}}class Ns extends Te{constructor(t,i,c,h,p){super(t,i),this.angle=h,this.z=c,p!==void 0&&(this.segment=p)}clone(){return new Ns(this.x,this.y,this.z,this.angle,this.segment)}}function PT(r,t,i,c,h){if(t.segment===void 0)return!0;let p=t,y=t.segment+1,v=0;for(;v>-i/2;){if(y--,y<0)return!1;v-=r[y].dist(p),p=r[y]}v+=r[y].dist(r[y+1]),y++;const b=[];let T=0;for(;v<i/2;){const M=r[y],I=r[y+1];if(!I)return!1;let D=r[y-1].angleTo(M)-M.angleTo(I);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:v,angleDelta:D}),T+=D;v-b[0].distance>c;)T-=b.shift().angleDelta;if(T>h)return!1;y++,v+=M.dist(I)}return!0}function MT(r){let t=0;for(let i=0;i<r.length-1;i++)t+=r[i].dist(r[i+1]);return t}function kT(r,t,i){return r?.6*t*i:0}function IT(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function qD(r,t,i,c,h,p){const y=kT(i,h,p),v=IT(i,c)*p;let b=0;const T=MT(r)/2;for(let M=0;M<r.length-1;M++){const I=r[M],D=r[M+1],O=I.dist(D);if(b+O>T){const B=(T-b)/O,V=en(I.x,D.x,B),q=en(I.y,D.y,B),ie=new Ns(V,q,0,D.angleTo(I),M);return!y||PT(r,ie,v,y,t)?ie:void 0}b+=O}}function HD(r,t,i,c,h,p,y,v,b){const T=kT(c,p,y),M=IT(c,h),I=M*y,D=r[0].x===0||r[0].x===b||r[0].y===0||r[0].y===b;return t-I<t/4&&(t=I+t/4),AT(r,D?t/2*v%t:(M/2+2*p)*y*v%t,t,T,i,I,D,!1,b)}function AT(r,t,i,c,h,p,y,v,b){const T=p/2,M=MT(r);let I=0,D=t-i,O=[];for(let B=0;B<r.length-1;B++){const V=r[B],q=r[B+1],ie=V.dist(q),de=q.angleTo(V);for(;D+i<I+ie;){D+=i;const oe=(D-I)/ie,ue=en(V.x,q.x,oe),me=en(V.y,q.y,oe);if(ue>=0&&ue<b&&me>=0&&me<b&&D-T>=0&&D+T<=M){const pe=new Ns(ue,me,0,de,B);pe._round(),c&&!PT(r,pe,p,c,h)||O.push(pe)}}I+=ie}return v||O.length||y||(O=AT(r,I/2,i,c,h,p,y,!0,b)),O}function DT(r,t,i,c,h){const p=[];for(let y=0;y<r.length;y++){const v=r[y];let b;for(let T=0;T<v.length-1;T++){let M=v[T],I=v[T+1];M.x<t&&I.x<t||(M.x<t?M=new Te(t,M.y+(t-M.x)/(I.x-M.x)*(I.y-M.y))._round():I.x<t&&(I=new Te(t,M.y+(t-M.x)/(I.x-M.x)*(I.y-M.y))._round()),M.y<i&&I.y<i||(M.y<i?M=new Te(M.x+(i-M.y)/(I.y-M.y)*(I.x-M.x),i)._round():I.y<i&&(I=new Te(M.x+(i-M.y)/(I.y-M.y)*(I.x-M.x),i)._round()),M.x>=c&&I.x>=c||(M.x>=c?M=new Te(c,M.y+(c-M.x)/(I.x-M.x)*(I.y-M.y))._round():I.x>=c&&(I=new Te(c,M.y+(c-M.x)/(I.x-M.x)*(I.y-M.y))._round()),M.y>=h&&I.y>=h||(M.y>=h?M=new Te(M.x+(h-M.y)/(I.y-M.y)*(I.x-M.x),h)._round():I.y>=h&&(I=new Te(M.x+(h-M.y)/(I.y-M.y)*(I.x-M.x),h)._round()),b&&M.equals(b[b.length-1])||(b=[M],p.push(b)),b.push(I)))))}}return p}gt(Ns,"Anchor");const nf=1e20;function LT(r,t,i,c,h,p,y,v,b){for(let T=t;T<t+c;T++)zT(r,i*p+T,p,h,y,v,b);for(let T=i;T<i+h;T++)zT(r,T*p+t,1,c,y,v,b)}function zT(r,t,i,c,h,p,y){p[0]=0,y[0]=-nf,y[1]=nf,h[0]=r[t];for(let v=1,b=0,T=0;v<c;v++){h[v]=r[t+v*i];const M=v*v;do{const I=p[b];T=(h[v]-h[I]+M-I*I)/(v-I)/2}while(T<=y[b]&&--b>-1);b++,p[b]=v,y[b]=T,y[b+1]=nf}for(let v=0,b=0;v<c;v++){for(;y[b+1]<v;)b++;const T=p[b],M=v-T;r[t+v*i]=h[T]+M*M}}const jo=2,Ev={none:0,ideographs:1,all:2};class Uu{constructor(t,i,c){this.requestManager=t,this.localGlyphMode=i,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,i){const c=[];for(const h in t)for(const p of t[h])c.push({stack:h,id:p});Nt(c,({stack:h,id:p},y)=>{let v=this.entries[h];v||(v=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let b=v.glyphs[p];if(b!==void 0)return void y(null,{stack:h,id:p,glyph:b});if(b=this._tinySDF(v,h,p),b)return v.glyphs[p]=b,void y(null,{stack:h,id:p,glyph:b});const T=Math.floor(p/256);if(256*T>65535)return void y(new Error("glyphs > 65535 not supported"));if(v.ranges[T])return void y(null,{stack:h,id:p,glyph:b});let M=v.requests[T];M||(M=v.requests[T]=[],Uu.loadGlyphRange(h,T,this.url,this.requestManager,(I,D)=>{if(D){v.ascender=D.ascender,v.descender=D.descender;for(const O in D.glyphs)this._doesCharSupportLocalGlyph(+O)||(v.glyphs[+O]=D.glyphs[+O]);v.ranges[T]=!0}for(const O of M)O(I,D);delete v.requests[T]})),M.push((I,D)=>{I?y(I):D&&y(null,{stack:h,id:p,glyph:D.glyphs[p]||null})})},(h,p)=>{if(h)i(h);else if(p){const y={};for(const{stack:v,id:b,glyph:T}of p)y[v]===void 0&&(y[v]={}),y[v].glyphs===void 0&&(y[v].glyphs={}),y[v].glyphs[b]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics},y[v].ascender=this.entries[v].ascender,y[v].descender=this.entries[v].descender;i(null,y)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==Ev.none&&(this.localGlyphMode===Ev.all?!!this.localFontFamily:!!this.localFontFamily&&(dt["CJK Unified Ideographs"](t)||dt["Hangul Syllables"](t)||dt.Hiragana(t)||dt.Katakana(t)||dt["CJK Symbols and Punctuation"](t)))}_tinySDF(t,i,c){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(c))return;let p=t.tinySDF;if(!p){let V="400";/bold/i.test(i)?V="900":/medium/i.test(i)?V="500":/light/i.test(i)&&(V="200"),p=t.tinySDF=new Uu.TinySDF({fontFamily:h,fontWeight:V,fontSize:24*jo,buffer:3*jo,radius:8*jo}),p.fontWeight=V}if(this.localGlyphs[p.fontWeight][c])return this.localGlyphs[p.fontWeight][c];const y=String.fromCharCode(c),{data:v,width:b,height:T,glyphWidth:M,glyphHeight:I,glyphLeft:D,glyphTop:O,glyphAdvance:B}=p.draw(y);return this.localGlyphs[p.fontWeight][c]={id:c,bitmap:new Bs({width:b,height:T},v),metrics:{width:M/jo,height:I/jo,left:D/jo,top:O/jo-27,advance:B/jo,localGlyph:!0}}}}Uu.loadGlyphRange=function(r,t,i,c,h){const p=256*t,y=p+255,v=c.transformRequest(c.normalizeGlyphsURL(i).replace("{fontstack}",r).replace("{range}",`${p}-${y}`),xs.Glyphs);la(v,(b,T)=>{if(b)h(b);else if(T){const M={},I=function(D){return new jm(D).readFields(UD,{})}(T);for(const D of I.glyphs)M[D.id]=D;h(null,{glyphs:M,ascender:I.ascender,descender:I.descender})}})},Uu.TinySDF=class{constructor({fontSize:r=24,buffer:t=3,radius:i=8,cutoff:c=.25,fontFamily:h="sans-serif",fontWeight:p="normal",fontStyle:y="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=i;const v=this.size=r+4*t,b=this._createCanvas(v),T=this.ctx=b.getContext("2d",{willReadFrequently:!0});T.font=`${y} ${p} ${r}px ${h}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}_createCanvas(r){const t=document.createElement("canvas");return t.width=t.height=r,t}draw(r){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:c,actualBoundingBoxLeft:h,actualBoundingBoxRight:p}=this.ctx.measureText(r),y=Math.ceil(i),v=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-h))),b=Math.min(this.size-this.buffer,y+Math.ceil(c)),T=v+2*this.buffer,M=b+2*this.buffer,I=Math.max(T*M,0),D=new Uint8ClampedArray(I),O={data:D,width:T,height:M,glyphWidth:v,glyphHeight:b,glyphTop:y,glyphLeft:0,glyphAdvance:t};if(v===0||b===0)return O;const{ctx:B,buffer:V,gridInner:q,gridOuter:ie}=this;B.clearRect(V,V,v,b),B.fillText(r,V,V+y);const de=B.getImageData(V,V,v,b);ie.fill(nf,0,I),q.fill(0,0,I);for(let oe=0;oe<b;oe++)for(let ue=0;ue<v;ue++){const me=de.data[4*(oe*v+ue)+3]/255;if(me===0)continue;const pe=(oe+V)*T+ue+V;if(me===1)ie[pe]=0,q[pe]=nf;else{const Le=.5-me;ie[pe]=Le>0?Le*Le:0,q[pe]=Le<0?Le*Le:0}}LT(ie,0,0,T,M,T,this.f,this.v,this.z),LT(q,V,V,v,b,T,this.f,this.v,this.z);for(let oe=0;oe<I;oe++){const ue=Math.sqrt(ie[oe])-Math.sqrt(q[oe]);D[oe]=Math.round(255-255*(ue/this.radius+this.cutoff))}return O}};const Vu=hi;function RT(r,t,i,c){const h=[],p=r.image,y=p.pixelRatio,v=p.paddedRect.w-2*Vu,b=p.paddedRect.h-2*Vu,T=r.right-r.left,M=r.bottom-r.top,I=p.stretchX||[[0,v]],D=p.stretchY||[[0,b]],O=(Re,We)=>Re+We[1]-We[0],B=I.reduce(O,0),V=D.reduce(O,0),q=v-B,ie=b-V;let de=0,oe=B,ue=0,me=V,pe=0,Le=q,Ie=0,Ne=ie;if(p.content&&c){const Re=p.content;de=Um(I,0,Re[0]),ue=Um(D,0,Re[1]),oe=Um(I,Re[0],Re[2]),me=Um(D,Re[1],Re[3]),pe=Re[0]-de,Ie=Re[1]-ue,Le=Re[2]-Re[0]-oe,Ne=Re[3]-Re[1]-me}const Je=(Re,We,Ze,Xe)=>{const rt=Vm(Re.stretch-de,oe,T,r.left),Fe=$m(Re.fixed-pe,Le,Re.stretch,B),ut=Vm(We.stretch-ue,me,M,r.top),vt=$m(We.fixed-Ie,Ne,We.stretch,V),ht=Vm(Ze.stretch-de,oe,T,r.left),Lt=$m(Ze.fixed-pe,Le,Ze.stretch,B),it=Vm(Xe.stretch-ue,me,M,r.top),Et=$m(Xe.fixed-Ie,Ne,Xe.stretch,V),zt=new Te(rt,ut),nn=new Te(ht,ut),Rt=new Te(ht,it),Mt=new Te(rt,it),Cn=new Te(Fe/y,vt/y),Bt=new Te(Lt/y,Et/y),jt=t*Math.PI/180;if(jt){const Tn=Math.sin(jt),vn=Math.cos(jt),Fn=[vn,-Tn,Tn,vn];zt._matMult(Fn),nn._matMult(Fn),Mt._matMult(Fn),Rt._matMult(Fn)}const _n=Re.stretch+Re.fixed,bn=We.stretch+We.fixed;return{tl:zt,tr:nn,bl:Mt,br:Rt,tex:{x:p.paddedRect.x+Vu+_n,y:p.paddedRect.y+Vu+bn,w:Ze.stretch+Ze.fixed-_n,h:Xe.stretch+Xe.fixed-bn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Cn,pixelOffsetBR:Bt,minFontScaleX:Le/y/T,minFontScaleY:Ne/y/M,isSDF:i}};if(c&&(p.stretchX||p.stretchY)){const Re=OT(I,q,B),We=OT(D,ie,V);for(let Ze=0;Ze<Re.length-1;Ze++){const Xe=Re[Ze],rt=Re[Ze+1];for(let Fe=0;Fe<We.length-1;Fe++)h.push(Je(Xe,We[Fe],rt,We[Fe+1]))}}else h.push(Je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:b+1}));return h}function Um(r,t,i){let c=0;for(const h of r)c+=Math.max(t,Math.min(i,h[1]))-Math.max(t,Math.min(i,h[0]));return c}function OT(r,t,i){const c=[{fixed:-Vu,stretch:0}];for(const[h,p]of r){const y=c[c.length-1];c.push({fixed:h-y.stretch,stretch:y.stretch}),c.push({fixed:h-y.stretch,stretch:y.stretch+(p-h)})}return c.push({fixed:t+Vu,stretch:i}),c}function Vm(r,t,i,c){return r/t*i+c}function $m(r,t,i,c){return r-t*i/c}function XD(r,t,i,c){const h=t+r.positionedLines[c].lineOffset;return c===0?i+h/2:i+(h+(t+r.positionedLines[c-1].lineOffset))/2}class KD{constructor(t=[],i=YD){if(this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:i,compare:c}=this,h=i[t];for(;t>0;){const p=t-1>>1,y=i[p];if(c(h,y)>=0)break;i[t]=y,t=p}i[t]=h}_down(t){const{data:i,compare:c}=this,h=this.length>>1,p=i[t];for(;t<h;){let y=1+(t<<1),v=i[y];const b=y+1;if(b<this.length&&c(i[b],v)<0&&(y=b,v=i[b]),c(v,p)>=0)break;i[t]=v,t=y}i[t]=p}}function YD(r,t){return r<t?-1:r>t?1:0}function JD(r,t=1,i=!1){let c=1/0,h=1/0,p=-1/0,y=-1/0;const v=r[0];for(let O=0;O<v.length;O++){const B=v[O];(!O||B.x<c)&&(c=B.x),(!O||B.y<h)&&(h=B.y),(!O||B.x>p)&&(p=B.x),(!O||B.y>y)&&(y=B.y)}const b=Math.min(p-c,y-h);let T=b/2;const M=new KD([],QD);if(b===0)return new Te(c,h);for(let O=c;O<p;O+=b)for(let B=h;B<y;B+=b)M.push(new $u(O+T,B+T,T,r));let I=function(O){let B=0,V=0,q=0;const ie=O[0];for(let de=0,oe=ie.length,ue=oe-1;de<oe;ue=de++){const me=ie[de],pe=ie[ue],Le=me.x*pe.y-pe.x*me.y;V+=(me.x+pe.x)*Le,q+=(me.y+pe.y)*Le,B+=3*Le}return new $u(V/B,q/B,0,O)}(r),D=M.length;for(;M.length;){const O=M.pop();(O.d>I.d||!I.d)&&(I=O,i&&console.log("found best %d after %d probes",Math.round(1e4*O.d)/1e4,D)),O.max-I.d<=t||(T=O.h/2,M.push(new $u(O.p.x-T,O.p.y-T,T,r)),M.push(new $u(O.p.x+T,O.p.y-T,T,r)),M.push(new $u(O.p.x-T,O.p.y+T,T,r)),M.push(new $u(O.p.x+T,O.p.y+T,T,r)),D+=4)}return i&&(console.log(`num probes: ${D}`),console.log(`best distance: ${I.d}`)),I.p}function QD(r,t){return t.max-r.max}class $u{constructor(t,i,c,h){this.p=new Te(t,i),this.h=c,this.d=function(p,y){let v=!1,b=1/0;for(let T=0;T<y.length;T++){const M=y[T];for(let I=0,D=M.length,O=D-1;I<D;O=I++){const B=M[I],V=M[O];B.y>p.y!=V.y>p.y&&p.x<(V.x-B.x)*(p.y-B.y)/(V.y-B.y)+B.x&&(v=!v),b=Math.min(b,Ab(p,B,V))}}return(v?1:-1)*Math.sqrt(b)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}}const Gu=7,Sv=Number.POSITIVE_INFINITY,eL=Math.sqrt(2);function FT(r,[t,i]){let c=0,h=0;if(i===Sv){t<0&&(t=0);const p=t/eL;switch(r){case"top-right":case"top-left":h=p-Gu;break;case"bottom-right":case"bottom-left":h=-p+Gu;break;case"bottom":h=-t+Gu;break;case"top":h=t-Gu}switch(r){case"top-right":case"bottom-right":c=-p;break;case"top-left":case"bottom-left":c=p;break;case"left":c=t;break;case"right":c=-t}}else{switch(t=Math.abs(t),i=Math.abs(i),r){case"top-right":case"top-left":case"top":h=i-Gu;break;case"bottom-right":case"bottom-left":case"bottom":h=-i+Gu}switch(r){case"top-right":case"bottom-right":case"right":c=-t;break;case"top-left":case"bottom-left":case"left":c=t}}return[c,h]}function tL(r,t,i,c,h,p,y,v,b,T){r.createArrays(),r.tilePixelRatio=Ct/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const M=r.layers[0].layout,I=r.layers[0]._unevaluatedLayout._values,D={};if(r.textSizeData.kind==="composite"){const{minZoom:V,maxZoom:q}=r.textSizeData;D.compositeTextSizes=[I["text-size"].possiblyEvaluate(new k(V),v),I["text-size"].possiblyEvaluate(new k(q),v)]}if(r.iconSizeData.kind==="composite"){const{minZoom:V,maxZoom:q}=r.iconSizeData;D.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new k(V),v),I["icon-size"].possiblyEvaluate(new k(q),v)]}D.layoutTextSize=I["text-size"].possiblyEvaluate(new k(b+1),v),D.layoutIconSize=I["icon-size"].possiblyEvaluate(new k(b+1),v),D.textMaxSize=I["text-size"].possiblyEvaluate(new k(18),v);const O=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",B=M.get("text-size");for(const V of r.features){const q=M.get("text-font").evaluate(V,{},v).join(","),ie=B.evaluate(V,{},v),de=D.layoutTextSize.evaluate(V,{},v),oe=(D.layoutIconSize.evaluate(V,{},v),{horizontal:{},vertical:void 0}),ue=V.text;let me,pe=[0,0];if(ue){const Ne=ue.toString(),Je=M.get("text-letter-spacing").evaluate(V,{},v)*Mr,Re=M.get("text-line-height").evaluate(V,{},v)*Mr,We=z_(Ne)?Je:0,Ze=M.get("text-anchor").evaluate(V,{},v),Xe=M.get("text-variable-anchor");if(!Xe){const ht=M.get("text-radial-offset").evaluate(V,{},v);pe=ht?FT(Ze,[ht*Mr,Sv]):M.get("text-offset").evaluate(V,{},v).map(Lt=>Lt*Mr)}let rt=O?"center":M.get("text-justify").evaluate(V,{},v);const Fe=M.get("symbol-placement")==="point",ut=Fe?M.get("text-max-width").evaluate(V,{},v)*Mr:1/0,vt=ht=>{r.allowVerticalPlacement&&Pd(Ne)&&(oe.vertical=bv(ue,t,i,h,q,ut,Re,Ze,ht,We,pe,Vi.vertical,!0,de,ie))};if(!O&&Xe){const ht=rt==="auto"?Xe.map(it=>Cv(it)):[rt];let Lt=!1;for(let it=0;it<ht.length;it++){const Et=ht[it];if(!oe.horizontal[Et])if(Lt)oe.horizontal[Et]=oe.horizontal[0];else{const zt=bv(ue,t,i,h,q,ut,Re,"center",Et,We,pe,Vi.horizontal,!1,de,ie);zt&&(oe.horizontal[Et]=zt,Lt=zt.positionedLines.length===1)}}vt("left")}else{if(rt==="auto"&&(rt=Cv(Ze)),Fe||M.get("text-writing-mode").indexOf("horizontal")>=0||!Pd(Ne)){const ht=bv(ue,t,i,h,q,ut,Re,Ze,rt,We,pe,Vi.horizontal,!1,de,ie);ht&&(oe.horizontal[rt]=ht)}vt(Fe?"left":rt)}}let Le=!1;if(V.icon&&V.icon.name){const Ne=c[V.icon.name];Ne&&(me=ZD(h[V.icon.name],M.get("icon-offset").evaluate(V,{},v),M.get("icon-anchor").evaluate(V,{},v)),Le=Ne.sdf,r.sdfIcons===void 0?r.sdfIcons=Ne.sdf:r.sdfIcons!==Ne.sdf&&Rn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ne.pixelRatio!==r.pixelRatio||M.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const Ie=jT(oe.horizontal)||oe.vertical;r.iconsInText||(r.iconsInText=!!Ie&&Ie.iconsInText),(Ie||me)&&nL(r,V,oe,me,c,D,de,0,pe,Le,y,v,T)}p&&r.generateCollisionDebugBuffers(b,r.collisionBoxArray)}function Cv(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function nL(r,t,i,c,h,p,y,v,b,T,M,I,D){let O=p.textMaxSize.evaluate(t,{},I);O===void 0&&(O=y);const B=r.layers[0].layout,V=B.get("icon-offset").evaluate(t,{},I),q=jT(i.horizontal)||i.vertical,ie=D.name==="globe",de=Mr,oe=y/de,ue=r.tilePixelRatio*O/de,me=(Ze=r.overscaling,r.zoom>18&&Ze>2&&(Ze>>=1),Math.max(Ct/(512*Ze),1)*B.get("symbol-spacing")),pe=B.get("text-padding")*r.tilePixelRatio,Le=B.get("icon-padding")*r.tilePixelRatio,Ie=xt(B.get("text-max-angle")),Ne=B.get("text-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",Je=B.get("icon-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",Re=B.get("symbol-placement"),We=me/2;var Ze;const Xe=B.get("icon-text-fit");let rt;c&&Xe!=="none"&&(r.allowVerticalPlacement&&i.vertical&&(rt=CT(c,i.vertical,Xe,B.get("icon-text-fit-padding"),V,oe)),q&&(c=CT(c,q,Xe,B.get("icon-text-fit-padding"),V,oe)));const Fe=(ut,vt,ht)=>{if(vt.x<0||vt.x>=Ct||vt.y<0||vt.y>=Ct)return;let Lt=null;if(ie){const{x:it,y:Et,z:zt}=D.projectTilePoint(vt.x,vt.y,ht);Lt={anchor:new Ns(it,Et,zt,0,void 0),up:D.upVector(ht,vt.x,vt.y)}}(function(it,Et,zt,nn,Rt,Mt,Cn,Bt,jt,_n,bn,Tn,vn,Fn,Un,tr,xn,dr,nr,Bn,on,rr,En,Qr,ir){const kr=it.addToLineVertexArray(Et,nn);let wr,ei,br,Uo,qu,df,ff,_E=0,vE=0,xE=0,wE=0,Uv=-1,Vv=-1;const cs={};let bE=F_("");const uc=zt?zt.anchor:Et;let $v=0,Gv=0;if(jt._unevaluatedLayout.getValue("text-radial-offset")===void 0?[$v,Gv]=jt.layout.get("text-offset").evaluate(on,{},ir).map(Mi=>Mi*Mr):($v=jt.layout.get("text-radial-offset").evaluate(on,{},ir)*Mr,Gv=Sv),it.allowVerticalPlacement&&Rt.vertical){const Mi=Rt.vertical;if(Un)df=Pv(Mi),Bt&&(ff=Pv(Bt));else{const ki=jt.layout.get("text-rotate").evaluate(on,{},ir)+90;br=Gm(_n,uc,Et,bn,Tn,vn,Mi,Fn,ki,tr),Bt&&(Uo=Gm(_n,uc,Et,bn,Tn,vn,Bt,dr,ki))}}if(Mt){const Mi=jt.layout.get("icon-rotate").evaluate(on,{},ir),ki=jt.layout.get("icon-text-fit")!=="none",pf=RT(Mt,Mi,En,ki),Zv=Bt?RT(Bt,Mi,En,ki):void 0;ei=Gm(_n,uc,Et,bn,Tn,vn,Mt,dr,Mi),_E=4*pf.length;const TE=it.iconSizeData;let hc=null;TE.kind==="source"?(hc=[Bo*jt.layout.get("icon-size").evaluate(on,{},ir)],hc[0]>Da&&Rn(`${it.layerIds[0]}: Value for "icon-size" is >= ${rf}. Reduce your "icon-size".`)):TE.kind==="composite"&&(hc=[Bo*rr.compositeIconSizes[0].evaluate(on,{},ir),Bo*rr.compositeIconSizes[1].evaluate(on,{},ir)],(hc[0]>Da||hc[1]>Da)&&Rn(`${it.layerIds[0]}: Value for "icon-size" is >= ${rf}. Reduce your "icon-size".`)),it.addSymbols(it.icon,pf,hc,Bn,nr,on,!1,zt,Et,kr.lineStartIndex,kr.lineLength,-1,Qr,ir),Uv=it.icon.placedSymbolArray.length-1,Zv&&(vE=4*Zv.length,it.addSymbols(it.icon,Zv,hc,Bn,nr,on,Vi.vertical,zt,Et,kr.lineStartIndex,kr.lineLength,-1,Qr,ir),Vv=it.icon.placedSymbolArray.length-1)}for(const Mi in Rt.horizontal){const ki=Rt.horizontal[Mi];wr||(bE=F_(ki.text),Un?qu=Pv(ki):wr=Gm(_n,uc,Et,bn,Tn,vn,ki,Fn,jt.layout.get("text-rotate").evaluate(on,{},ir),tr));const pf=ki.positionedLines.length===1;if(xE+=BT(it,zt,Et,ki,Cn,jt,Un,on,tr,kr,Rt.vertical?Vi.horizontal:Vi.horizontalOnly,pf?Object.keys(Rt.horizontal):[Mi],cs,Uv,rr,Qr,ir),pf)break}Rt.vertical&&(wE+=BT(it,zt,Et,Rt.vertical,Cn,jt,Un,on,tr,kr,Vi.vertical,["vertical"],cs,Vv,rr,Qr,ir));let Ba=-1;const Wv=(Mi,ki)=>Mi?Math.max(Mi,ki):ki;Ba=Wv(qu,Ba),Ba=Wv(df,Ba),Ba=Wv(ff,Ba);const IL=Ba>-1?1:0;it.glyphOffsetArray.length>=za.MAX_GLYPHS&&Rn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),on.sortKey!==void 0&&it.addToSortKeyRanges(it.symbolInstances.length,on.sortKey),it.symbolInstances.emplaceBack(uc.x,uc.y,uc.z,Et.x,Et.y,cs.right>=0?cs.right:-1,cs.center>=0?cs.center:-1,cs.left>=0?cs.left:-1,cs.vertical>=0?cs.vertical:-1,Uv,Vv,bE,wr!==void 0?wr:it.collisionBoxArray.length,wr!==void 0?wr+1:it.collisionBoxArray.length,br!==void 0?br:it.collisionBoxArray.length,br!==void 0?br+1:it.collisionBoxArray.length,ei!==void 0?ei:it.collisionBoxArray.length,ei!==void 0?ei+1:it.collisionBoxArray.length,Uo||it.collisionBoxArray.length,Uo?Uo+1:it.collisionBoxArray.length,bn,xE,wE,_E,vE,IL,0,$v,Gv,Ba)})(r,vt,Lt,ut,i,c,h,rt,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,pe,Ne,b,0,Le,Je,V,t,p,T,M,I)};if(Re==="line")for(const ut of DT(t.geometry,0,0,Ct,Ct)){const vt=HD(ut,me,Ie,i.vertical||q,c,de,ue,r.overscaling,Ct);for(const ht of vt)q&&rL(r,q.text,We,ht)||Fe(ut,ht,I)}else if(Re==="line-center"){for(const ut of t.geometry)if(ut.length>1){const vt=qD(ut,Ie,i.vertical||q,c,de,ue);vt&&Fe(ut,vt,I)}}else if(t.type==="Polygon")for(const ut of fv(t.geometry,0)){const vt=JD(ut,16);Fe(ut[0],new Ns(vt.x,vt.y,0,0,void 0),I)}else if(t.type==="LineString")for(const ut of t.geometry)Fe(ut,new Ns(ut[0].x,ut[0].y,0,0,void 0),I);else if(t.type==="Point")for(const ut of t.geometry)for(const vt of ut)Fe([vt],new Ns(vt.x,vt.y,0,0,void 0),I)}const rf=255,Da=rf*Bo;function BT(r,t,i,c,h,p,y,v,b,T,M,I,D,O,B,V,q){const ie=function(ue,me,pe,Le,Ie,Ne,Je,Re){const We=[];if(me.positionedLines.length===0)return We;const Ze=Le.layout.get("text-rotate").evaluate(Ne,{})*Math.PI/180,Xe=function(ht){const Lt=ht[0],it=ht[1],Et=Lt*it;return Et>0?[Lt,-it]:Et<0?[-Lt,it]:Lt===0?[it,Lt]:[it,-Lt]}(pe);let rt=Math.abs(me.top-me.bottom);for(const ht of me.positionedLines)rt-=ht.lineOffset;const Fe=me.positionedLines.length,ut=rt/Fe;let vt=me.top-pe[1];for(let ht=0;ht<Fe;++ht){const Lt=me.positionedLines[ht];vt=XD(me,ut,vt,ht);for(const it of Lt.positionedGlyphs){if(!it.rect)continue;const Et=it.rect||{};let zt=_T+1,nn=!0,Rt=1,Mt=0;if(it.imageName){const En=Je[it.imageName];if(!En)continue;if(En.sdf){Rn("SDF images are not supported in formatted text and will be ignored.");continue}nn=!1,Rt=En.pixelRatio,zt=hi/Rt}const Cn=(Ie||Re)&&it.vertical,Bt=it.metrics.advance*it.scale/2,jt=it.metrics,_n=it.rect;if(_n===null)continue;Re&&me.verticalizable&&(Mt=it.imageName?Bt-it.metrics.width*it.scale/2:0);const bn=Ie?[it.x+Bt,it.y]:[0,0];let Tn=[0,0],vn=[0,0],Fn=!1;Ie||(Cn?(vn=[it.x+Bt+Xe[0],it.y+Xe[1]-Mt],Fn=!0):Tn=[it.x+Bt+pe[0],it.y+pe[1]-Mt]);const Un=_n.w*it.scale/(Rt*(it.localGlyph?jo:1)),tr=_n.h*it.scale/(Rt*(it.localGlyph?jo:1));let xn,dr,nr,Bn;if(Cn){const En=it.y-vt,Qr=new Te(-Bt,Bt-En),ir=-Math.PI/2,kr=new Te(...vn);xn=new Te(-Bt+Tn[0],Tn[1]),xn._rotateAround(ir,Qr)._add(kr),xn.x+=-En+Bt,xn.y-=(jt.left-zt)*it.scale;const wr=it.imageName?jt.advance*it.scale:Mr*it.scale,ei=String.fromCharCode(it.glyph);ID(ei)?xn.x+=(1-zt)*it.scale:AD(ei)?xn.x+=wr-jt.height*it.scale+(-zt-1)*it.scale:xn.x+=it.imageName||jt.width+2*zt===_n.w&&jt.height+2*zt===_n.h?(wr-tr)/2:(wr-(jt.height+2*zt)*it.scale)/2,dr=new Te(xn.x,xn.y-Un),nr=new Te(xn.x+tr,xn.y),Bn=new Te(xn.x+tr,xn.y-Un)}else{const En=(jt.left-zt)*it.scale-Bt+Tn[0],Qr=(-jt.top-zt)*it.scale+Tn[1],ir=En+Un,kr=Qr+tr;xn=new Te(En,Qr),dr=new Te(ir,Qr),nr=new Te(En,kr),Bn=new Te(ir,kr)}if(Ze){let En;En=Ie?new Te(0,0):Fn?new Te(Xe[0],Xe[1]):new Te(pe[0],pe[1]),xn._rotateAround(Ze,En),dr._rotateAround(Ze,En),nr._rotateAround(Ze,En),Bn._rotateAround(Ze,En)}const on=new Te(0,0),rr=new Te(0,0);We.push({tl:xn,tr:dr,bl:nr,br:Bn,tex:Et,writingMode:me.writingMode,glyphOffset:bn,sectionIndex:it.sectionIndex,isSDF:nn,pixelOffsetTL:on,pixelOffsetBR:rr,minFontScaleX:0,minFontScaleY:0})}}return We}(0,c,b,p,y,v,h,r.allowVerticalPlacement),de=r.textSizeData;let oe=null;de.kind==="source"?(oe=[Bo*p.layout.get("text-size").evaluate(v,{},q)],oe[0]>Da&&Rn(`${r.layerIds[0]}: Value for "text-size" is >= ${rf}. Reduce your "text-size".`)):de.kind==="composite"&&(oe=[Bo*B.compositeTextSizes[0].evaluate(v,{},q),Bo*B.compositeTextSizes[1].evaluate(v,{},q)],(oe[0]>Da||oe[1]>Da)&&Rn(`${r.layerIds[0]}: Value for "text-size" is >= ${rf}. Reduce your "text-size".`)),r.addSymbols(r.text,ie,oe,b,y,v,M,t,i,T.lineStartIndex,T.lineLength,O,V,q);for(const ue of I)D[ue]=r.text.placedSymbolArray.length-1;return 4*ie.length}function jT(r){for(const t in r)return r[t];return null}function Gm(r,t,i,c,h,p,y,v,b,T){let M=y.top,I=y.bottom,D=y.left,O=y.right;const B=y.collisionPadding;if(B&&(D-=B[0],M-=B[1],O+=B[2],I+=B[3]),b){const V=new Te(D,M),q=new Te(O,M),ie=new Te(D,I),de=new Te(O,I),oe=xt(b);let ue=new Te(0,0);T&&(ue=new Te(T[0],T[1])),V._rotateAround(oe,ue),q._rotateAround(oe,ue),ie._rotateAround(oe,ue),de._rotateAround(oe,ue),D=Math.min(V.x,q.x,ie.x,de.x),O=Math.max(V.x,q.x,ie.x,de.x),M=Math.min(V.y,q.y,ie.y,de.y),I=Math.max(V.y,q.y,ie.y,de.y)}return r.emplaceBack(t.x,t.y,t.z,i.x,i.y,D,M,O,I,v,c,h,p),r.length-1}function Pv(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const t=r.bottom-r.top;return t>0?Math.max(10,t):null}function rL(r,t,i,c){const h=r.compareText;if(t in h){const p=h[t];for(let y=p.length-1;y>=0;y--)if(c.dist(p[y])<i)return!0}else h[t]=[];return h[t].push(c),!1}function NT(r,t){const i=r.fovAboveCenter,c=r.elevation?r.elevation.getMinElevationBelowMSL()*t:0,h=(r._camera.position[2]*r.worldSize-c)/Math.cos(r._pitch),p=Math.sin(i)*h/Math.sin(Math.max(Math.PI/2-r._pitch-i,.01)),y=Math.sin(r._pitch)*p+h;return Math.min(1.01*y,h*(1/r._horizonShift))}function lc(r,t){if(!t.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:t};const i=Math.pow(2,-r.z),c=r.x*i,h=(r.x+1)*i,p=r.y*i,y=(r.y+1)*i,v=Ui(c),b=Ui(h),T=Or(p),M=Or(y),I=t.project(v,T),D=t.project(b,T),O=t.project(b,M),B=t.project(v,M);let V=Math.min(I.x,D.x,O.x,B.x),q=Math.min(I.y,D.y,O.y,B.y),ie=Math.max(I.x,D.x,O.x,B.x),de=Math.max(I.y,D.y,O.y,B.y);const oe=i/16;function ue(pe,Le,Ie,Ne,Je,Re){const We=(Ie+Je)/2,Ze=(Ne+Re)/2,Xe=t.project(Ui(We),Or(Ze)),rt=Math.max(0,V-Xe.x,q-Xe.y,Xe.x-ie,Xe.y-de);V=Math.min(V,Xe.x),ie=Math.max(ie,Xe.x),q=Math.min(q,Xe.y),de=Math.max(de,Xe.y),rt>oe&&(ue(pe,Xe,Ie,Ne,We,Ze),ue(Xe,Le,We,Ze,Je,Re))}ue(I,D,c,p,h,p),ue(D,O,h,p,h,y),ue(O,B,h,y,c,y),ue(B,I,c,y,c,p),V-=oe,q-=oe,ie+=oe,de+=oe;const me=1/Math.max(ie-V,de-q);return{scale:me,x:V*me,y:q*me,x2:ie*me,y2:de*me,projection:t}}const iL=Ro(new Float32Array(16));class La{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,i){return{x:0,y:0,z:0}}unproject(t,i){return new yn(0,0)}projectTilePoint(t,i,c){return{x:t,y:i,z:0}}locationPoint(t,i,c=!0){return t._coordinatePoint(t.locationCoordinate(i),c)}pixelsPerMeter(t,i){return Fo(1,t)*i}pixelSpaceConversion(t,i,c){return 1}farthestPixelDistance(t){return NT(t,t.pixelsPerMeter)}pointCoordinate(t,i,c,h){const p=t.horizonLineFromTop(!1),y=new Te(i,Math.max(p,c));return t.rayIntersectionCoordinate(t.pointRayIntersection(y,h))}pointCoordinate3D(t,i,c){const h=new Te(i,c);if(t.elevation)return t.elevation.pointCoordinate(h);{const p=this.pointCoordinate(t,h.x,h.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(t,i){if(t.elevation)return!this.pointCoordinate3D(t,i.x,i.y);const c=t.horizonLineFromTop();return i.y<c}createInversionMatrix(t,i){return iL}createTileMatrix(t,i,c){let h,p,y;const v=c.canonical,b=Ro(new Float64Array(16));if(this.isReprojectedInTileSpace){const T=lc(v,this);h=1,p=T.x+c.wrap*T.scale,y=T.y,tc(b,b,[h/T.scale,h/T.scale,t.pixelsPerMeter/i])}else h=i/t.zoomScale(v.z),p=(v.x+Math.pow(2,v.z)*c.wrap)*h,y=v.y*h;return zd(b,b,[p,y,0]),tc(b,b,[h/Ct,h/Ct,1]),b}upVector(t,i,c){return[0,0,1]}upVectorScale(t,i,c){return{metersToTile:1}}}class oL extends La{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[i,c]=this.parallels=t.parallels||[29.5,45.5],h=Math.sin(xt(i));this.n=(h+Math.sin(xt(c)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(t,i){const{n:c,c:h,r0:p}=this,y=xt(t-this.center[0]),v=xt(i),b=Math.sqrt(h-2*c*Math.sin(v))/c;return{x:b*Math.sin(y*c),y:b*Math.cos(y*c)-p,z:0}}unproject(t,i){const{n:c,c:h,r0:p}=this,y=p+i;let v=Math.atan2(t,Math.abs(y))*Math.sign(y);y*c<0&&(v-=Math.PI*Math.sign(t)*Math.sign(y));const b=xt(this.center[0])*c;v=yt(v,-Math.PI-b,Math.PI-b);const T=He(kt(v/c)+this.center[0],-180,180),M=Math.asin(He((h-(t*t+y*y)*c*c)/(2*c),-1,1)),I=He(kt(M),-Fr,Fr);return new yn(T,I)}}const of=1.340264,sf=-.081106,af=893e-6,lf=.003796,Wm=Math.sqrt(3)/2;class sL extends La{project(t,i){i=i/180*Math.PI,t=t/180*Math.PI;const c=Math.asin(Wm*Math.sin(i)),h=c*c,p=h*h*h;return{x:.5*(t*Math.cos(c)/(Wm*(of+3*sf*h+p*(7*af+9*lf*h)))/Math.PI+.5),y:1-.5*(c*(of+sf*h+p*(af+lf*h))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let c=i=(2*(1-i)-1)*Math.PI,h=c*c,p=h*h*h;for(let M,I,D,O=0;O<12&&(I=c*(of+sf*h+p*(af+lf*h))-i,D=of+3*sf*h+p*(7*af+9*lf*h),M=I/D,c=He(c-M,-Math.PI/3,Math.PI/3),h=c*c,p=h*h*h,!(Math.abs(M)<1e-12));++O);const y=Wm*t*(of+3*sf*h+p*(7*af+9*lf*h))/Math.cos(c),v=Math.asin(Math.sin(c)/Wm),b=He(180*y/Math.PI,-180,180),T=He(180*v/Math.PI,-Fr,Fr);return new yn(b,T)}}class aL extends La{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){return{x:.5+t/360,y:.5-i/360,z:0}}unproject(t,i){const c=360*(t-.5),h=He(360*(.5-i),-Fr,Fr);return new yn(c,h)}}const Wu=Math.PI/2;function Zm(r){return Math.tan((Wu+r)/2)}class lL extends La{constructor(t){super(t),this.center=t.center||[0,30];const[i,c]=this.parallels=t.parallels||[30,30];let h=xt(i),p=xt(c);this.southernCenter=h+p<0,this.southernCenter&&(h=-h,p=-p);const y=Math.cos(h),v=Zm(h);this.n=h===p?Math.sin(h):Math.log(y/Math.cos(p))/Math.log(Zm(p)/v),this.f=y*Math.pow(Zm(h),this.n)/this.n}project(t,i){i=xt(i),this.southernCenter&&(i=-i),t=xt(t-this.center[0]);const c=1e-6,{n:h,f:p}=this;p>0?i<-Wu+c&&(i=-Wu+c):i>Wu-c&&(i=Wu-c);const y=p/Math.pow(Zm(i),h);let v=y*Math.sin(h*t),b=p-y*Math.cos(h*t);return v=.5*(v/Math.PI+.5),b=.5*(b/Math.PI+.5),{x:v,y:this.southernCenter?b:1-b,z:0}}unproject(t,i){t=(2*t-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:c,f:h}=this,p=h-i,y=Math.sign(p),v=Math.sign(c)*Math.sqrt(t*t+p*p);let b=Math.atan2(t,Math.abs(p))*y;p*c<0&&(b-=Math.PI*Math.sign(t)*y);const T=He(kt(b/c)+this.center[0],-180,180),M=He(kt(2*Math.atan(Math.pow(h/v,1/c))-Wu),-Fr,Fr);return new yn(T,this.southernCenter?-M:M)}}class UT extends La{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,i){return{x:is(t),y:os(i),z:0}}unproject(t,i){const c=Ui(t),h=Or(i);return new yn(c,h)}}const VT=xt(Fr);class cL extends La{project(t,i){const c=(i=xt(i))*i,h=c*c;return{x:.5*((t=xt(t))*(.8707-.131979*c+h*(h*(.003971*c-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+c*(.015085+h*(.028874*c-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let c=i=(2*(1-i)-1)*Math.PI,h=25,p=0,y=c*c;do{y=c*c;const T=y*y;p=(c*(1.007226+y*(.015085+T*(.028874*y-.044475-.005916*T)))-i)/(1.007226+y*(.045255+T*(.259866*y-.311325-.005916*11*T))),c=He(c-p,-VT,VT)}while(Math.abs(p)>1e-6&&--h>0);y=c*c;const v=He(kt(t/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),b=kt(c);return new yn(v,b)}}const $T=xt(Fr);class uL extends La{project(t,i){i=xt(i),t=xt(t);const c=Math.cos(i),h=2/Math.PI,p=Math.acos(c*Math.cos(t/2)),y=Math.sin(p)/p,v=.5*(t*h+2*c*Math.sin(t/2)/y)||0,b=.5*(i+Math.sin(i)/y)||0;return{x:.5*(v/Math.PI+.5),y:1-.5*(b/Math.PI+1),z:0}}unproject(t,i){let c=t=(2*t-.5)*Math.PI,h=i=(2*(1-i)-1)*Math.PI,p=25;const y=1e-6;let v=0,b=0;do{const T=Math.cos(h),M=Math.sin(h),I=2*M*T,D=M*M,O=T*T,B=Math.cos(c/2),V=Math.sin(c/2),q=2*B*V,ie=V*V,de=1-O*B*B,oe=de?1/de:0,ue=de?Math.acos(T*B)*Math.sqrt(1/de):0,me=.5*(2*ue*T*V+2*c/Math.PI)-t,pe=.5*(ue*M+h)-i,Le=.5*oe*(O*ie+ue*T*B*D)+1/Math.PI,Ie=oe*(q*I/4-ue*M*V),Ne=.125*oe*(I*V-ue*M*O*q),Je=.5*oe*(D*B+ue*ie*T)+.5,Re=Ie*Ne-Je*Le;v=(pe*Ie-me*Je)/Re,b=(me*Ne-pe*Le)/Re,c=He(c-v,-Math.PI,Math.PI),h=He(h-b,-$T,$T)}while((Math.abs(v)>y||Math.abs(b)>y)&&--p>0);return new yn(kt(c),kt(h))}}class GT extends La{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(xt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){const{scale:c,cosPhi:h}=this;return{x:xt(t)*h*c+.5,y:-Math.sin(xt(i))/h*c+.5,z:0}}unproject(t,i){const{scale:c,cosPhi:h}=this,p=-(i-.5)/c,y=He(kt((t-.5)/c)/h,-180,180),v=Math.asin(He(p*h,-1,1)),b=He(kt(v),-Fr,Fr);return new yn(y,b)}}class hL extends UT{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,i,c){const h=Vd(t,i,c);return qn(h,h,$d(rs(c))),{x:h[0],y:h[1],z:h[2]}}locationPoint(t,i){const c=Iu(i.lat,i.lng),h=Kr([],c),p=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(i),t._centerAltitude):t._centerAltitude;Bd(c,c,h,Fo(1,0)*Ct*p);const y=Ro(new Float64Array(16));return ec(y,t.pixelMatrix,t.globeMatrix),qn(c,c,y),new Te(c[0],c[1])}pixelsPerMeter(t,i){return Fo(1,0)*i}pixelSpaceConversion(t,i,c){const h=Fo(1,t)*i,p=en(Fo(1,45)*i,h,c);return this.pixelsPerMeter(t,i)/p}createTileMatrix(t,i,c){const h=Y_(rs(c.canonical));return ec(new Float64Array(16),t.globeMatrix,h)}createInversionMatrix(t,i){const{center:c}=t,h=$d(rs(i));return xm(h,h,xt(c.lng)),U_(h,h,xt(c.lat)),tc(h,h,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(t,i,c,h){return yb(t,i,c,!0)||new Du(0,0)}pointCoordinate3D(t,i,c){const h=this.pointCoordinate(t,i,c,0);return[h.x,h.y,h.z]}isPointAboveHorizon(t,i){return!yb(t,i.x,i.y,!1)}farthestPixelDistance(t){const i=function(h,p){const y=h.cameraToCenterDistance,v=h._centerAltitude*p,b=h._camera,T=h._camera.forward(),M=Os([],Ni([],T,-y),[0,0,v]),I=h.worldSize/(2*Math.PI),D=[0,0,-I],O=h.width/h.height,B=Math.tan(h.fovAboveCenter),V=Ni([],b.up(),B),q=Ni([],b.right(),B*O),ie=Kr([],Os([],Os([],T,V),q)),de=[];let oe;if(new W_(M,ie).closestPointOnSphere(D,I,de)){const ue=Os([],de,D),me=Oo([],ue,M);oe=Math.cos(h.fovAboveCenter)*Rd(me)}else{const ue=Oo([],M,D),me=Oo([],D,M);Kr(me,me);const pe=Rd(ue)-I;oe=Math.sqrt(pe*(pe+2*I));const Le=Math.acos(oe/(I+pe))-Math.acos(oo(T,me));oe*=Math.cos(Le)}return 1.01*oe}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),c=Au(t.zoom);if(c>0){const h=NT(t,Fo(1,t.center.lat)*t.worldSize),p=t.worldSize/(2*Math.PI),y=Math.max(t.width,t.height)/t.worldSize*Math.PI;return en(i,h+p*(1-Math.cos(y)),Math.pow(c,10))}return i}upVector(t,i,c){return Vd(i,c,t,1)}upVectorScale(t){return{metersToTile:wm(Tm(rs(t)))}}}function WT(r){const t=r.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(r.name){case"mercator":return new UT(r);case"equirectangular":return new aL(r);case"naturalEarth":return new cL(r);case"equalEarth":return new sL(r);case"winkelTripel":return new uL(r);case"albers":return i?new GT(r):new oL(r);case"lambertConformalConic":return i?new GT(r):new lL(r);case"globe":return new hL(r)}throw new Error(`Invalid projection name: ${r.name}`)}const dL=Lm.types,fL=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function qm(r,t,i,c,h,p,y,v,b,T,M,I,D){const O=v?Math.min(Da,Math.round(v[0])):0,B=v?Math.min(Da,Math.round(v[1])):0;r.emplaceBack(t,i,Math.round(32*c),Math.round(32*h),p,y,(O<<1)+(b?1:0),B,16*T,16*M,256*I,256*D)}function Hm(r,t,i,c,h,p,y){r.emplaceBack(t,i,c,h,p,y)}function Xm(r,t,i,c,h){r.emplaceBack(t,i,c,h),r.emplaceBack(t,i,c,h),r.emplaceBack(t,i,c,h),r.emplaceBack(t,i,c,h)}function pL(r){for(const t of r.sections)if(O_(t.text))return!0;return!1}class Mv{constructor(t){this.layoutVertexArray=new qe,this.indexArray=new wt,this.programConfigurations=t,this.segments=new Qn,this.dynamicLayoutVertexArray=new Ke,this.opacityVertexArray=new Tt,this.placedSymbolArray=new Jn,this.globeExtVertexArray=new et}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,i,c,h){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bD.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,ED.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,fL,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,TD.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}gt(Mv,"SymbolBuffers");class kv{constructor(t,i,c){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new c,this.segments=new Qn,this.collisionVertexArray=new Xt,this.collisionVertexArrayExt=new Zt}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,SD.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,CD.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}gt(kv,"CollisionBuffers");class za{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(y=>y.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ro([]),this.placementViewportMatrix=Ro([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=yv(this.zoom,i["text-size"]),this.iconSizeData=yv(this.zoom,i["icon-size"]);const c=this.layers[0].layout,h=c.get("symbol-sort-key"),p=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(y=>Vi[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=t.sourceID,this.projection=t.projection}createArrays(){this.text=new Mv(new Ql(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Mv(new Ql(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Xr,this.lineVertexArray=new Su,this.symbolInstances=new Mn}calculateGlyphDependencies(t,i,c,h,p){for(let y=0;y<t.length;y++)if(i[t.charCodeAt(y)]=!0,h&&p){const v=ef[t.charAt(y)];v&&(i[v.charCodeAt(0)]=!0)}}populate(t,i,c,h){const p=this.layers[0],y=p.layout,v=this.projection.name==="globe",b=y.get("text-font"),T=y.get("text-field"),M=y.get("icon-image"),I=(T.value.kind!=="constant"||T.value.value instanceof Hr&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),D=M.value.kind!=="constant"||!!M.value.value||Object.keys(M.parameters).length>0,O=y.get("symbol-sort-key");if(this.features=[],!I&&!D)return;const B=i.iconDependencies,V=i.glyphDependencies,q=i.availableImages,ie=new k(this.zoom);for(const{feature:de,id:oe,index:ue,sourceLayerIndex:me}of t){const pe=p._featureFilter.needGeometry,Le=oc(de,pe);if(!p._featureFilter.filter(ie,Le,c))continue;if(pe||(Le.geometry=Fs(de,c,h)),v&&de.type!==1&&c.z<=5){const Re=Le.geometry,We=.98078528056,Ze=(Xe,rt)=>oo(Vd(Xe.x,Xe.y,c,1),Vd(rt.x,rt.y,c,1))<We;for(let Xe=0;Xe<Re.length;Xe++)Re[Xe]=E3(Re[Xe],Ze)}let Ie,Ne;if(I){const Re=p.getValueAndResolveTokens("text-field",Le,c,q),We=Hr.factory(Re);pL(We)&&(this.hasRTLText=!0),(!this.hasRTLText||w()==="unavailable"||this.hasRTLText&&C.isParsed())&&(Ie=kD(We,p,Le))}if(D){const Re=p.getValueAndResolveTokens("icon-image",Le,c,q);Ne=Re instanceof bi?Re:bi.fromString(Re)}if(!Ie&&!Ne)continue;const Je=this.sortFeaturesByKey?O.evaluate(Le,{},c):void 0;if(this.features.push({id:oe,text:Ie,icon:Ne,index:ue,sourceLayerIndex:me,geometry:Le.geometry,properties:de.properties,type:dL[de.type],sortKey:Je}),Ne&&(B[Ne.name]=!0),Ie){const Re=b.evaluate(Le,{},c).join(","),We=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Vi.vertical)>=0;for(const Ze of Ie.sections)if(Ze.image)B[Ze.image.name]=!0;else{const Xe=Pd(Ie.toString()),rt=Ze.fontStack||Re,Fe=V[rt]=V[rt]||{};this.calculateGlyphDependencies(Ze.text,Fe,We,this.allowVerticalPlacement,Xe)}}}y.get("symbol-placement")==="line"&&(this.features=function(de){const oe={},ue={},me=[];let pe=0;function Le(Re){me.push(de[Re]),pe++}function Ie(Re,We,Ze){const Xe=ue[Re];return delete ue[Re],ue[We]=Xe,me[Xe].geometry[0].pop(),me[Xe].geometry[0]=me[Xe].geometry[0].concat(Ze[0]),Xe}function Ne(Re,We,Ze){const Xe=oe[We];return delete oe[We],oe[Re]=Xe,me[Xe].geometry[0].shift(),me[Xe].geometry[0]=Ze[0].concat(me[Xe].geometry[0]),Xe}function Je(Re,We,Ze){const Xe=Ze?We[0][We[0].length-1]:We[0][0];return`${Re}:${Xe.x}:${Xe.y}`}for(let Re=0;Re<de.length;Re++){const We=de[Re],Ze=We.geometry,Xe=We.text?We.text.toString():null;if(!Xe){Le(Re);continue}const rt=Je(Xe,Ze),Fe=Je(Xe,Ze,!0);if(rt in ue&&Fe in oe&&ue[rt]!==oe[Fe]){const ut=Ne(rt,Fe,Ze),vt=Ie(rt,Fe,me[ut].geometry);delete oe[rt],delete ue[Fe],ue[Je(Xe,me[vt].geometry,!0)]=vt,me[ut].geometry=null}else rt in ue?Ie(rt,Fe,Ze):Fe in oe?Ne(rt,Fe,Ze):(Le(Re),oe[rt]=pe-1,ue[Fe]=pe-1)}return me.filter(Re=>Re.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((de,oe)=>de.sortKey-oe.sortKey)}update(t,i,c,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,i,this.layers,c,h),this.icon.programConfigurations.updatePaintArrays(t,i,this.layers,c,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=WT(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const c=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:h,y:p}of i)this.lineVertexArray.emplaceBack(h,p);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,i,c,h,p,y,v,b,T,M,I,D,O,B){const V=t.indexArray,q=t.layoutVertexArray,ie=t.globeExtVertexArray,de=t.segments.prepareSegment(4*i.length,q,V,this.canOverlap?y.sortKey:void 0),oe=this.glyphOffsetArray.length,ue=de.vertexLength,me=this.allowVerticalPlacement&&v===Vi.vertical?Math.PI/2:0,pe=y.text&&y.text.sections;for(let Ie=0;Ie<i.length;Ie++){const{tl:Ne,tr:Je,bl:Re,br:We,tex:Ze,pixelOffsetTL:Xe,pixelOffsetBR:rt,minFontScaleX:Fe,minFontScaleY:ut,glyphOffset:vt,isSDF:ht,sectionIndex:Lt}=i[Ie],it=de.vertexLength,Et=vt[1];if(qm(q,T.x,T.y,Ne.x,Et+Ne.y,Ze.x,Ze.y,c,ht,Xe.x,Xe.y,Fe,ut),qm(q,T.x,T.y,Je.x,Et+Je.y,Ze.x+Ze.w,Ze.y,c,ht,rt.x,Xe.y,Fe,ut),qm(q,T.x,T.y,Re.x,Et+Re.y,Ze.x,Ze.y+Ze.h,c,ht,Xe.x,rt.y,Fe,ut),qm(q,T.x,T.y,We.x,Et+We.y,Ze.x+Ze.w,Ze.y+Ze.h,c,ht,rt.x,rt.y,Fe,ut),b){const{x:zt,y:nn,z:Rt}=b.anchor,[Mt,Cn,Bt]=b.up;Hm(ie,zt,nn,Rt,Mt,Cn,Bt),Hm(ie,zt,nn,Rt,Mt,Cn,Bt),Hm(ie,zt,nn,Rt,Mt,Cn,Bt),Hm(ie,zt,nn,Rt,Mt,Cn,Bt),Xm(t.dynamicLayoutVertexArray,zt,nn,Rt,me)}else Xm(t.dynamicLayoutVertexArray,T.x,T.y,T.z,me);V.emplaceBack(it,it+1,it+2),V.emplaceBack(it+1,it+2,it+3),de.vertexLength+=4,de.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(vt[0]),Ie!==i.length-1&&Lt===i[Ie+1].sectionIndex||t.programConfigurations.populatePaintArrays(q.length,y,y.index,{},O,B,pe&&pe[Lt])}const Le=b?b.anchor:T;t.placedSymbolArray.emplaceBack(Le.x,Le.y,Le.z,T.x,T.y,oe,this.glyphOffsetArray.length-oe,ue,M,I,T.segment,c?c[0]:0,c?c[1]:0,h[0],h[1],v,0,!1,0,D,0)}_commitLayoutVertex(t,i,c,h,p,y,v){t.emplaceBack(i,c,h,p,y,Math.round(v.x),Math.round(v.y))}_addCollisionDebugVertices(t,i,c,h,p,y,v){const b=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),T=b.vertexLength,M=v.tileAnchorX,I=v.tileAnchorY;for(let O=0;O<4;O++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(i,-t.padding,-t.padding),c.collisionVertexArrayExt.emplaceBack(i,t.padding,-t.padding),c.collisionVertexArrayExt.emplaceBack(i,t.padding,t.padding),c.collisionVertexArrayExt.emplaceBack(i,-t.padding,t.padding),this._commitLayoutVertex(c.layoutVertexArray,h,p,y,M,I,new Te(t.x1,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,h,p,y,M,I,new Te(t.x2,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,h,p,y,M,I,new Te(t.x2,t.y2)),this._commitLayoutVertex(c.layoutVertexArray,h,p,y,M,I,new Te(t.x1,t.y2)),b.vertexLength+=4;const D=c.indexArray;D.emplaceBack(T,T+1),D.emplaceBack(T+1,T+2),D.emplaceBack(T+2,T+3),D.emplaceBack(T+3,T),b.primitiveLength+=4}_addTextDebugCollisionBoxes(t,i,c,h,p,y){for(let v=h;v<p;v++){const b=c.get(v),T=this.getSymbolInstanceTextSize(t,y,i,v);this._addCollisionDebugVertices(b,T,this.textCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(t,i,c,h,p,y){for(let v=h;v<p;v++){const b=c.get(v),T=this.getSymbolInstanceIconSize(t,i,y.placedIconSymbolIndex);this._addCollisionDebugVertices(b,T,this.iconCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,y)}}generateCollisionDebugBuffers(t,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new kv(_t,uT.members,xr),this.iconCollisionBox=new kv(_t,uT.members,xr);const c=Fu(this.iconSizeData,t),h=Fu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const y=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(h,t,i,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(h,t,i,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(c,t,i,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(c,t,i,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(t,i,c,h){const p=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:h),y=Fm(this.textSizeData,t,p)/Mr;return this.tilePixelRatio*y}getSymbolInstanceIconSize(t,i,c){const h=this.icon.placedSymbolArray.get(c),p=Fm(this.iconSizeData,t,h);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(t,i,c){t.emplaceBack(i,-c,-c),t.emplaceBack(i,c,-c),t.emplaceBack(i,c,c),t.emplaceBack(i,-c,c)}_updateTextDebugCollisionBoxes(t,i,c,h,p,y){for(let v=h;v<p;v++){const b=c.get(v),T=this.getSymbolInstanceTextSize(t,y,i,v);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,b.padding)}}_updateIconDebugCollisionBoxes(t,i,c,h,p,y){for(let v=h;v<p;v++){const b=c.get(v),T=this.getSymbolInstanceIconSize(t,i,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,b.padding)}}updateCollisionDebugBuffers(t,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=Fu(this.iconSizeData,t),h=Fu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const y=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(h,t,i,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(h,t,i,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(c,t,i,y.iconBoxStartIndex,y.iconBoxEndIndex,y.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,t,i,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,i,c,h,p,y,v,b,T){const M={};if(i<c){const{x1:I,y1:D,x2:O,y2:B,padding:V,projectedAnchorX:q,projectedAnchorY:ie,projectedAnchorZ:de,tileAnchorX:oe,tileAnchorY:ue,featureIndex:me}=t.get(i);M.textBox={x1:I,y1:D,x2:O,y2:B,padding:V,projectedAnchorX:q,projectedAnchorY:ie,projectedAnchorZ:de,tileAnchorX:oe,tileAnchorY:ue},M.textFeatureIndex=me}if(h<p){const{x1:I,y1:D,x2:O,y2:B,padding:V,projectedAnchorX:q,projectedAnchorY:ie,projectedAnchorZ:de,tileAnchorX:oe,tileAnchorY:ue,featureIndex:me}=t.get(h);M.verticalTextBox={x1:I,y1:D,x2:O,y2:B,padding:V,projectedAnchorX:q,projectedAnchorY:ie,projectedAnchorZ:de,tileAnchorX:oe,tileAnchorY:ue},M.verticalTextFeatureIndex=me}if(y<v){const{x1:I,y1:D,x2:O,y2:B,padding:V,projectedAnchorX:q,projectedAnchorY:ie,projectedAnchorZ:de,tileAnchorX:oe,tileAnchorY:ue,featureIndex:me}=t.get(y);M.iconBox={x1:I,y1:D,x2:O,y2:B,padding:V,projectedAnchorX:q,projectedAnchorY:ie,projectedAnchorZ:de,tileAnchorX:oe,tileAnchorY:ue},M.iconFeatureIndex=me}if(b<T){const{x1:I,y1:D,x2:O,y2:B,padding:V,projectedAnchorX:q,projectedAnchorY:ie,projectedAnchorZ:de,tileAnchorX:oe,tileAnchorY:ue,featureIndex:me}=t.get(b);M.verticalIconBox={x1:I,y1:D,x2:O,y2:B,padding:V,projectedAnchorX:q,projectedAnchorY:ie,projectedAnchorZ:de,tileAnchorX:oe,tileAnchorY:ue},M.verticalIconFeatureIndex=me}return M}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const c=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,i){const c=t.placedSymbolArray.get(i),h=c.vertexStartIndex+4*c.numGlyphs;for(let p=c.vertexStartIndex;p<h;p+=4)t.indexArray.emplaceBack(p,p+1,p+2),t.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),c=Math.cos(t),h=[],p=[],y=[];for(let v=0;v<this.symbolInstances.length;++v){y.push(v);const b=this.symbolInstances.get(v);h.push(0|Math.round(i*b.tileAnchorX+c*b.tileAnchorY)),p.push(b.featureIndex)}return y.sort((v,b)=>h[v]-h[b]||p[b]-p[v]),y}addToSortKeyRanges(t,i){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===i?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const c=this.symbolInstances.get(i);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:v,placedIconSymbolIndex:b,verticalPlacedIconSymbolIndex:T}=c;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),p>=0&&p!==h&&this.addIndicesForPlacedSymbol(this.text,p),y>=0&&y!==p&&y!==h&&this.addIndicesForPlacedSymbol(this.text,y),v>=0&&this.addIndicesForPlacedSymbol(this.text,v),b>=0&&this.addIndicesForPlacedSymbol(this.icon,b),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}gt(za,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),za.MAX_GLYPHS=65535,za.addDynamicAttributes=Xm;const mL=new le({"symbol-placement":new U(Be.layout_symbol["symbol-placement"]),"symbol-spacing":new U(Be.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new U(Be.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new K(Be.layout_symbol["symbol-sort-key"]),"symbol-z-order":new U(Be.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new U(Be.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new U(Be.layout_symbol["icon-ignore-placement"]),"icon-optional":new U(Be.layout_symbol["icon-optional"]),"icon-rotation-alignment":new U(Be.layout_symbol["icon-rotation-alignment"]),"icon-size":new K(Be.layout_symbol["icon-size"]),"icon-text-fit":new U(Be.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new U(Be.layout_symbol["icon-text-fit-padding"]),"icon-image":new K(Be.layout_symbol["icon-image"]),"icon-rotate":new K(Be.layout_symbol["icon-rotate"]),"icon-padding":new U(Be.layout_symbol["icon-padding"]),"icon-keep-upright":new U(Be.layout_symbol["icon-keep-upright"]),"icon-offset":new K(Be.layout_symbol["icon-offset"]),"icon-anchor":new K(Be.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new U(Be.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new U(Be.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new U(Be.layout_symbol["text-rotation-alignment"]),"text-field":new K(Be.layout_symbol["text-field"]),"text-font":new K(Be.layout_symbol["text-font"]),"text-size":new K(Be.layout_symbol["text-size"]),"text-max-width":new K(Be.layout_symbol["text-max-width"]),"text-line-height":new K(Be.layout_symbol["text-line-height"]),"text-letter-spacing":new K(Be.layout_symbol["text-letter-spacing"]),"text-justify":new K(Be.layout_symbol["text-justify"]),"text-radial-offset":new K(Be.layout_symbol["text-radial-offset"]),"text-variable-anchor":new U(Be.layout_symbol["text-variable-anchor"]),"text-anchor":new K(Be.layout_symbol["text-anchor"]),"text-max-angle":new U(Be.layout_symbol["text-max-angle"]),"text-writing-mode":new U(Be.layout_symbol["text-writing-mode"]),"text-rotate":new K(Be.layout_symbol["text-rotate"]),"text-padding":new U(Be.layout_symbol["text-padding"]),"text-keep-upright":new U(Be.layout_symbol["text-keep-upright"]),"text-transform":new K(Be.layout_symbol["text-transform"]),"text-offset":new K(Be.layout_symbol["text-offset"]),"text-allow-overlap":new U(Be.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new U(Be.layout_symbol["text-ignore-placement"]),"text-optional":new U(Be.layout_symbol["text-optional"])});var Iv={paint:new le({"icon-opacity":new K(Be.paint_symbol["icon-opacity"]),"icon-color":new K(Be.paint_symbol["icon-color"]),"icon-halo-color":new K(Be.paint_symbol["icon-halo-color"]),"icon-halo-width":new K(Be.paint_symbol["icon-halo-width"]),"icon-halo-blur":new K(Be.paint_symbol["icon-halo-blur"]),"icon-translate":new U(Be.paint_symbol["icon-translate"]),"icon-translate-anchor":new U(Be.paint_symbol["icon-translate-anchor"]),"text-opacity":new K(Be.paint_symbol["text-opacity"]),"text-color":new K(Be.paint_symbol["text-color"],{runtimeType:ci,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new K(Be.paint_symbol["text-halo-color"]),"text-halo-width":new K(Be.paint_symbol["text-halo-width"]),"text-halo-blur":new K(Be.paint_symbol["text-halo-blur"]),"text-translate":new U(Be.paint_symbol["text-translate"]),"text-translate-anchor":new U(Be.paint_symbol["text-translate-anchor"])}),layout:mL};class ZT{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ua,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}gt(ZT,"FormatSectionOverride",{omit:["defaultValue"]});class Km extends zo{constructor(t){super(t,Iv)}recalculate(t,i){super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const h=[];for(const p of c)h.indexOf(p)<0&&h.push(p);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,i,c,h){const p=this.layout.get(t).evaluate(i,{},c,h),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||ba(y.value)||!p?p:function(v,b){return b.replace(/{([^{}]+)}/g,(T,M)=>M in v?String(v[M]):"")}(i.properties,p)}createBucket(t){return new za(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of Iv.paint.overridableProperties){if(!Km.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),c=new ZT(i),h=new yu(c,i.property.specification);let p=null;p=i.value.kind==="constant"||i.value.kind==="source"?new gd("source",h):new Gl("composite",h,i.value.zoomStops,i.value._interpolationType),this.paint._values[t]=new te(i.property,p,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,c){return!(!this.layout||i.isDataDriven()||c.isDataDriven())&&Km.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const c=t.get("text-field"),h=Iv.paint.properties[i];let p=!1;const y=v=>{for(const b of v)if(h.overrides&&h.overrides.hasOverride(b))return void(p=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Hr)y(c.value.value.sections);else if(c.value.kind==="source"){const v=T=>{p||(T instanceof Ss&&Nn(T.value)===Pl?y(T.value.sections):T instanceof Qo?y(T.sections):T.eachChild(v))},b=c.value;b._styleExpression&&v(b._styleExpression.expression)}return p}getProgramConfiguration(t){return new ka(this,t)}}var gL={paint:new le({"background-color":new U(Be.paint_background["background-color"]),"background-pattern":new U(Be.paint_background["background-pattern"]),"background-opacity":new U(Be.paint_background["background-opacity"])})},yL={paint:new le({"raster-opacity":new U(Be.paint_raster["raster-opacity"]),"raster-hue-rotate":new U(Be.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new U(Be.paint_raster["raster-brightness-min"]),"raster-brightness-max":new U(Be.paint_raster["raster-brightness-max"]),"raster-saturation":new U(Be.paint_raster["raster-saturation"]),"raster-contrast":new U(Be.paint_raster["raster-contrast"]),"raster-resampling":new U(Be.paint_raster["raster-resampling"]),"raster-fade-duration":new U(Be.paint_raster["raster-fade-duration"])})};class _L extends zo{constructor(t){super(t,{}),this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var vL={paint:new le({"sky-type":new U(Be.paint_sky["sky-type"]),"sky-atmosphere-sun":new U(Be.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new U(Be.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new U(Be.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new U(Be.paint_sky["sky-gradient-radius"]),"sky-gradient":new ae(Be.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new U(Be.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new U(Be.paint_sky["sky-atmosphere-color"]),"sky-opacity":new U(Be.paint_sky["sky-opacity"])})};function Av(r,t,i){const c=[0,0,1],h=hb([]);return fb(h,h,i?-xt(r)+Math.PI:xt(r)),db(h,h,-xt(t)),ab(c,c,h),Kr(c,c)}const xL={circle:class extends zo{constructor(r){super(r,A3)}createBucket(r){return new rv(r)}queryRadius(r){const t=r;return Lu("circle-radius",this,t)+Lu("circle-stroke-width",this,t)+Cm(this.paint.get("circle-translate"))}queryIntersectsFeature(r,t,i,c,h,p,y,v){const b=Rb(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return Ob(r,c,p,y,v,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",b,T)}getProgramIds(){return["circle"]}getProgramConfiguration(r){return new ka(this,r)}},heatmap:class extends zo{createBucket(r){return new Bb(r)}constructor(r){super(r,R3),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=av({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return Lu("heatmap-radius",this,r)}queryIntersectsFeature(r,t,i,c,h,p,y,v){const b=this.paint.get("heatmap-radius").evaluate(t,i);return Ob(r,c,p,y,v,!0,!0,new Te(0,0),b)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(r){return new ka(this,r)}},hillshade:class extends zo{constructor(r){super(r,O3)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends zo{constructor(r){super(r,J3)}getProgramIds(){const r=this.paint.get("fill-pattern"),t=r&&r.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(r){return new ka(this,r)}recalculate(r,t){super.recalculate(r,t);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Am(r)}queryRadius(){return Cm(this.paint.get("fill-translate"))}queryIntersectsFeature(r,t,i,c,h,p){return!r.queryGeometry.isAboveHorizon&&Ib(zb(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends zo{constructor(r){super(r,pD)}createBucket(r){return new Yd(r)}queryRadius(){return Cm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(r){return new ka(this,r)}queryIntersectsFeature(r,t,i,c,h,p,y,v,b){const T=Rb(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),M=this.paint.get("fill-extrusion-height").evaluate(t,i),I=this.paint.get("fill-extrusion-base").evaluate(t,i),D=[0,0],O=v&&p.elevation,B=p.elevation?p.elevation.exaggeration():1,V=r.tile.getBucket(this);if(O&&V instanceof Yd){const ue=V.centroidVertexArray,me=b+1;me<ue.length&&(D[0]=ue.geta_centroid_pos0(me),D[1]=ue.geta_centroid_pos1(me))}if(D[0]===0&&D[1]===1)return!1;p.projection.name==="globe"&&(c=nT([c],[new Te(0,0),new Te(Ct,Ct)],r.tileID.canonical).map(ue=>ue.polygon).flat());const q=O?v:null,[ie,de]=function(ue,me,pe,Le,Ie,Ne,Je,Re,We,Ze,Xe){return ue.projection.name==="globe"?function(rt,Fe,ut,vt,ht,Lt,it,Et,zt,nn,Rt){const Mt=[],Cn=[],Bt=rt.projection.upVectorScale(Rt,rt.center.lat,rt.worldSize).metersToTile,jt=[0,0,0,1],_n=[0,0,0,1],bn=(vn,Fn,Un,tr)=>{vn[0]=Fn,vn[1]=Un,vn[2]=tr,vn[3]=1},Tn=tT();ut>0&&(ut+=Tn),vt+=Tn;for(const vn of Fe){const Fn=[],Un=[];for(const tr of vn){const xn=tr.x+ht.x,dr=tr.y+ht.y,nr=rt.projection.projectTilePoint(xn,dr,Rt),Bn=rt.projection.upVector(Rt,tr.x,tr.y);let on=ut,rr=vt;if(it){const En=sT(xn,dr,ut,vt,it,Et,zt,nn);on+=En.base,rr+=En.top}ut!==0?bn(jt,nr.x+Bn[0]*Bt*on,nr.y+Bn[1]*Bt*on,nr.z+Bn[2]*Bt*on):bn(jt,nr.x,nr.y,nr.z),bn(_n,nr.x+Bn[0]*Bt*rr,nr.y+Bn[1]*Bt*rr,nr.z+Bn[2]*Bt*rr),qn(jt,jt,Lt),qn(_n,_n,Lt),Fn.push(new Ou(jt[0],jt[1],jt[2])),Un.push(new Ou(_n[0],_n[1],_n[2]))}Mt.push(Fn),Cn.push(Un)}return[Mt,Cn]}(ue,me,pe,Le,Ie,Ne,Je,Re,We,Ze,Xe):Je?function(rt,Fe,ut,vt,ht,Lt,it,Et,zt){const nn=[],Rt=[],Mt=[0,0,0,1];for(const Cn of rt){const Bt=[],jt=[];for(const _n of Cn){const bn=_n.x+vt.x,Tn=_n.y+vt.y,vn=sT(bn,Tn,Fe,ut,Lt,it,Et,zt);Mt[0]=bn,Mt[1]=Tn,Mt[2]=vn.base,Mt[3]=1,nc(Mt,Mt,ht),Mt[3]=Math.max(Mt[3],1e-5);const Fn=new Ou(Mt[0]/Mt[3],Mt[1]/Mt[3],Mt[2]/Mt[3]);Mt[0]=bn,Mt[1]=Tn,Mt[2]=vn.top,Mt[3]=1,nc(Mt,Mt,ht),Mt[3]=Math.max(Mt[3],1e-5);const Un=new Ou(Mt[0]/Mt[3],Mt[1]/Mt[3],Mt[2]/Mt[3]);Bt.push(Fn),jt.push(Un)}nn.push(Bt),Rt.push(jt)}return[nn,Rt]}(me,pe,Le,Ie,Ne,Je,Re,We,Ze):function(rt,Fe,ut,vt,ht){const Lt=[],it=[],Et=ht[8]*Fe,zt=ht[9]*Fe,nn=ht[10]*Fe,Rt=ht[11]*Fe,Mt=ht[8]*ut,Cn=ht[9]*ut,Bt=ht[10]*ut,jt=ht[11]*ut;for(const _n of rt){const bn=[],Tn=[];for(const vn of _n){const Fn=vn.x+vt.x,Un=vn.y+vt.y,tr=ht[0]*Fn+ht[4]*Un+ht[12],xn=ht[1]*Fn+ht[5]*Un+ht[13],dr=ht[2]*Fn+ht[6]*Un+ht[14],nr=ht[3]*Fn+ht[7]*Un+ht[15],Bn=tr+Et,on=xn+zt,rr=dr+nn,En=Math.max(nr+Rt,1e-5),Qr=tr+Mt,ir=xn+Cn,kr=dr+Bt,wr=Math.max(nr+jt,1e-5);bn.push(new Ou(Bn/En,on/En,rr/En)),Tn.push(new Ou(Qr/wr,ir/wr,kr/wr))}Lt.push(bn),it.push(Tn)}return[Lt,it]}(me,pe,Le,Ie,Ne)}(p,c,I,M,T,y,q,D,B,p.center.lat,r.tileID.canonical),oe=r.queryGeometry;return function(ue,me,pe){let Le=1/0;Ib(pe,me)&&(Le=oT(pe,me[0]));for(let Ie=0;Ie<me.length;Ie++){const Ne=me[Ie],Je=ue[Ie];for(let Re=0;Re<Ne.length-1;Re++){const We=Ne[Re],Ze=[We,Ne[Re+1],Je[Re+1],Je[Re],We];kb(pe,Ze)&&(Le=Math.min(Le,oT(pe,Ze)))}}return Le!==1/0&&Le}(ie,de,oe.isPointQuery()?oe.screenBounds:oe.screenGeometry)}},line:class extends zo{constructor(r){super(r,aT),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof rd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(r,t){super.recalculate(r,t),this.paint._values["line-floorwidth"]=lT.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Om(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(r){return new ka(this,r)}queryRadius(r){const t=r,i=cT(Lu("line-width",this,t),Lu("line-gap-width",this,t)),c=Lu("line-offset",this,t);return i/2+Math.abs(c)+Cm(this.paint.get("line-translate"))}queryIntersectsFeature(r,t,i,c,h,p){if(r.queryGeometry.isAboveHorizon)return!1;const y=zb(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,r.pixelToTileUnitsFactor),v=r.pixelToTileUnitsFactor/2*cT(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),b=this.paint.get("line-offset").evaluate(t,i);return b&&(c=function(T,M){const I=[],D=new Te(0,0);for(let O=0;O<T.length;O++){const B=T[O],V=[];for(let q=0;q<B.length;q++){const ie=B[q],de=B[q+1],oe=q===0?D:ie.sub(B[q-1])._unit()._perp(),ue=q===B.length-1?D:de.sub(ie)._unit()._perp(),me=oe._add(ue)._unit();me._mult(1/(me.x*ue.x+me.y*ue.y)),V.push(me._mult(M)._add(ie))}I.push(V)}return I}(c,b*r.pixelToTileUnitsFactor)),function(T,M,I){for(let D=0;D<M.length;D++){const O=M[D];if(T.length>=3){for(let B=0;B<O.length;B++)if(sc(T,O[B]))return!0}if(P3(T,O,I))return!0}return!1}(y,c,v)}isTileClipped(){return!0}},symbol:Km,background:class extends zo{constructor(r){super(r,gL)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends zo{constructor(r){super(r,yL)}getProgramIds(){return["raster"]}},sky:class extends zo{constructor(r){super(r,vL),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=av({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(r,t){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),h=!c,p=r.style.light,y=p.properties.get("position");return h&&p.properties.get("anchor")==="viewport"&&Rn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?Av(y.azimuthal,90-y.polar,t):Av(c[0],90-c[1],t)}const i=this.paint.get("sky-gradient-center");return Av(i[0],90-i[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}}};class cf{constructor(t,i,c,h){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(i,h)}update(t,i,c){const{width:h,height:p}=t,{context:y}=this,{gl:v}=y,{HTMLImageElement:b,HTMLCanvasElement:T,HTMLVideoElement:M,ImageData:I,ImageBitmap:D}=P;if(v.bindTexture(v.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!i||i.premultiply!==!1)),c||this.size&&this.size[0]===h&&this.size[1]===p){const{x:O,y:B}=c||{x:0,y:0};t instanceof b||t instanceof T||t instanceof M||t instanceof I||D&&t instanceof D?v.texSubImage2D(v.TEXTURE_2D,0,O,B,v.RGBA,v.UNSIGNED_BYTE,t):v.texSubImage2D(v.TEXTURE_2D,0,O,B,h,p,v.RGBA,v.UNSIGNED_BYTE,t.data)}else this.size=[h,p],t instanceof b||t instanceof T||t instanceof M||t instanceof I||D&&t instanceof D?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,t):v.texImage2D(v.TEXTURE_2D,0,this.format,h,p,0,this.format,v.UNSIGNED_BYTE,t.data);this.useMipmap=!!(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(t,i){const{context:c}=this,{gl:h}=c;h.bindTexture(h.TEXTURE_2D,this.texture),t!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,t),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?t===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:t),this.filter=t),i!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class wL{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class bL{constructor(){this.tasks={},this.taskQueue=[],Qt(["process"],this),this.invoker=new wL(this.process),this.nextId=0}add(t,i){const c=this.nextId++,h=function({type:p,isSymbolTile:y,zoom:v}){return v=v||0,p==="message"?0:p!=="maybePrepare"||y?p!=="parseTile"||y?p==="parseTile"&&y?300-v:p==="maybePrepare"&&y?400-v:500:200-v:100-v}(i);if(h===0){wo();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:t,metadata:i,priority:h,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){wo();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const i=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let t=null,i=1/0;for(let h=0;h<this.taskQueue.length;h++){const p=this.tasks[this.taskQueue[h]];p.priority<i&&(i=p.priority,t=h)}if(t===null)return null;const c=this.taskQueue[t];return this.taskQueue.splice(t,1),c}remove(){this.invoker.remove()}}class qT{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const c=t[i];this._stringToNumber[c]=i,this._numberToString[i]=c}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const TL=["tile","layer","source","sourceLayer","state"];class HT{constructor(t,i,c,h,p){this.type="Feature",this._vectorTileFeature=t,this._z=i,this._x=c,this._y=h,this.properties=t.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const i of TL)this[i]!==void 0&&(t[i]=this[i]);return t}}const lo=32,ss=33,Ra=new Uint16Array(8184);for(let r=0;r<2046;r++){let t=r+2,i=0,c=0,h=0,p=0,y=0,v=0;for(1&t?h=p=y=lo:i=c=v=lo;(t>>=1)>1;){const T=i+h>>1,M=c+p>>1;1&t?(h=i,p=c,i=y,c=v):(i=h,c=p,h=y,p=v),y=T,v=M}const b=4*r;Ra[b+0]=i,Ra[b+1]=c,Ra[b+2]=h,Ra[b+3]=p}const as=new Uint16Array(2178),Oa=new Uint8Array(1089),Ym=new Uint16Array(1089);function XT(r){return r===0?-.03125:r===32?.03125:0}var KT=Ee([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const YT={type:2,extent:Ct,loadGeometry:()=>[[new Te(0,0),new Te(Ct+1,0),new Te(Ct+1,Ct+1),new Te(0,Ct+1),new Te(0,0)]]};class Dv{constructor(t,i,c,h,p){this.tileID=t,this.uid=Wn(),this.uses=0,this.tileSize=i,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(t){const i=t+this.timeAdded;i<bo.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=lc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,i,c){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(h,p){const y={};if(!p)return y;for(const v of h){const b=v.layerIds.map(T=>p.getLayer(T)).filter(Boolean);if(b.length!==0){v.layers=b,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(T=>b.filter(M=>M.id===T)[0]));for(const T of b)y[T.id]=v}}return y}(t.buckets,i.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const p=this.buckets[h];if(p instanceof za){if(this.hasSymbolBuckets=!0,!c)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const p=this.buckets[h];if(p instanceof za&&p.hasRTLText){this.hasRTLText=!0,C.isLoading()||C.isLoaded()||w()!=="deferred"||S();break}}this.queryPadding=0;for(const h in this.buckets){const p=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(h).queryRadius(p))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new gn}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const h=this.buckets[c];h.uploadPending()&&h.upload(t)}const i=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new cf(t,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new cf(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new cf(t,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,i,c,h,p,y,v,b){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:v,transform:y,params:p,tileTransform:this.tileTransform},t,i,c):{}}querySourceFeatures(t,i){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const h=c.loadVTLayers(),p=i?i.sourceLayer:"",y=h._geojsonTileLayer||h[p];if(!y)return;const v=wu(i&&i.filter),{z:b,x:T,y:M}=this.tileID.canonical,I={z:b,x:T,y:M};for(let D=0;D<y.length;D++){const O=y.feature(D);if(v.needGeometry){const q=oc(O,!0);if(!v.filter(new k(this.tileID.overscaledZ),q,this.tileID.canonical))continue}else if(!v.filter(new k(this.tileID.overscaledZ),O))continue;const B=c.getId(O,p),V=new HT(O,b,T,M,B);V.tile=I,t.push(V)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const i=this.expirationTime;if(t.cacheControl){const c=li(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let h=!1;if(this.expirationTime>c)h=!1;else if(i)if(this.expirationTime<i)h=!0;else{const p=this.expirationTime-i;p?this.expirationTime=c+Math.max(p,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0||!i)return;const c=this.latestFeatureIndex.loadVTLayers(),h=i.style.listImages();for(const p in this.buckets){if(!i.style.hasLayer(p))continue;const y=this.buckets[p],v=y.layers[0].sourceLayer||"_geojsonTileLayer",b=c[v],T=t[v];if(!b||!T||Object.keys(T).length===0)continue;if(y.update(T,b,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof Om||y instanceof Am){const I=i.style._getSourceCache(y.layers[0].source);i._terrain&&i._terrain.enabled&&I&&y.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(I.id,this.tileID)}const M=i&&i.style&&i.style.getLayer(p);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<bo.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=bo.now()+t}setTexture(t,i){const c=i.context,h=c.gl;this.texture=this.texture||i.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new cf(c,t,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE))}setDependencies(t,i){const c={};for(const h of i)c[h]=!0;this.dependencies[t]=c}hasDependency(t,i){for(const c of t){const h=this.dependencies[c];if(h){for(const p of i)if(h[p])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const c=Fs(YT,this.tileID.canonical,this.tileTransform)[0],h=new Ye,p=new Si;for(let y=0;y<c.length;y++){const{x:v,y:b}=c[y];h.emplaceBack(v,b),p.emplaceBack(y)}p.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(p),this._tileDebugBuffer=t.createVertexBuffer(h,Nd.members),this._tileDebugSegments=Qn.simpleSegment(0,0,h.length,p.length)}_makeTileBoundsBuffers(t,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const c=Fs(YT,this.tileID.canonical,this.tileTransform)[0];let h,p;if(this.isRaster){const y=function(v,b){const T=lc(v,b),M=Math.pow(2,v.z);for(let q=0;q<ss;q++)for(let ie=0;ie<ss;ie++){const de=Ui((v.x+(ie+XT(ie))/lo)/M),oe=Or((v.y+(q+XT(q))/lo)/M),ue=b.project(de,oe),me=q*ss+ie;as[2*me+0]=Math.round((ue.x*T.scale-T.x)*Ct),as[2*me+1]=Math.round((ue.y*T.scale-T.y)*Ct)}Oa.fill(0),Ym.fill(0);for(let q=2045;q>=0;q--){const ie=4*q,de=Ra[ie+0],oe=Ra[ie+1],ue=Ra[ie+2],me=Ra[ie+3],pe=de+ue>>1,Le=oe+me>>1,Ie=pe+Le-oe,Ne=Le+de-pe,Je=oe*ss+de,Re=me*ss+ue,We=Le*ss+pe,Ze=Math.hypot((as[2*Je+0]+as[2*Re+0])/2-as[2*We+0],(as[2*Je+1]+as[2*Re+1])/2-as[2*We+1])>=16;Oa[We]=Oa[We]||(Ze?1:0),q<1022&&(Oa[We]=Oa[We]||Oa[(oe+Ne>>1)*ss+(de+Ie>>1)]||Oa[(me+Ne>>1)*ss+(ue+Ie>>1)])}const I=new $e,D=new wt;let O=0;function B(q,ie){const de=ie*ss+q;return Ym[de]===0&&(I.emplaceBack(as[2*de+0],as[2*de+1],q*Ct/lo,ie*Ct/lo),Ym[de]=++O),Ym[de]-1}function V(q,ie,de,oe,ue,me){const pe=q+de>>1,Le=ie+oe>>1;if(Math.abs(q-ue)+Math.abs(ie-me)>1&&Oa[Le*ss+pe])V(ue,me,q,ie,pe,Le),V(de,oe,ue,me,pe,Le);else{const Ie=B(q,ie),Ne=B(de,oe),Je=B(ue,me);D.emplaceBack(Ie,Ne,Je)}}return V(0,0,lo,lo,lo,0),V(lo,lo,0,0,0,lo),{vertices:I,indices:D}}(this.tileID.canonical,i);h=y.vertices,p=y.indices}else{h=new $e,p=new wt;for(const{x:v,y:b}of c)h.emplaceBack(v,b,0,0);const y=dv(h.int16,void 0,4);for(let v=0;v<y.length;v+=3)p.emplaceBack(y[v],y[v+1],y[v+2])}this._tileBoundsBuffer=t.createVertexBuffer(h,KT.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(p),this._tileBoundsSegments=Qn.simpleSegment(0,0,h.length,p.length)}_makeGlobeTileDebugBuffers(t,i){const c=i.projection;if(!c||c.name!=="globe"||i.freezeTileCoverage)return;const h=this.tileID.canonical,p=$d(_b(h,i)),y=Au(i.zoom);let v;y>0&&(v=N_(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,h,i,p,v,y),this._makeGlobeTileDebugTextBuffer(t,h,i,p,v,y)}_globePoint(t,i,c,h,p,y,v){let b=Vd(t,i,c);if(y){const T=1<<c.z,M=is(h.center.lng),I=os(h.center.lat),D=(c.x+.5)/T-M;let O=0;D>.5?O=-1:D<-.5&&(O=1);let B=(t/Ct+c.x)/T+O,V=(i/Ct+c.y)/T;B=(B-M)*h._pixelsPerMercatorPixel+M,V=(V-I)*h._pixelsPerMercatorPixel+I;const q=[B*h.worldSize,V*h.worldSize,0];qn(q,q,y),b=ic(b,q,v)}return qn(b,b,p)}_makeGlobeTileDebugBorderBuffer(t,i,c,h,p,y){const v=new Ye,b=new Si,T=new ke,M=(D,O,B,V,q)=>{const ie=(B-D)/(q-1),de=(V-O)/(q-1),oe=v.length;for(let ue=0;ue<q;ue++){const me=D+ue*ie,pe=O+ue*de;v.emplaceBack(me,pe);const Le=this._globePoint(me,pe,i,c,h,p,y);T.emplaceBack(Le[0],Le[1],Le[2]),b.emplaceBack(oe+ue)}},I=Ct;M(0,0,I,0,16),M(I,0,I,I,16),M(I,I,0,I,16),M(0,I,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(b),this._tileDebugBuffer=t.createVertexBuffer(v,Nd.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(T,mb.members),this._tileDebugSegments=Qn.simpleSegment(0,0,v.length,b.length)}_makeGlobeTileDebugTextBuffer(t,i,c,h,p,y){const v=Ct/4,b=new Ye,T=new wt,M=new ke,I=25;T.reserve(32),b.reserve(I),M.reserve(I);const D=(O,B)=>I*O+B;for(let O=0;O<I;O++){const B=O*v;for(let V=0;V<I;V++){const q=V*v;b.emplaceBack(q,B);const ie=this._globePoint(q,B,i,c,h,p,y);M.emplaceBack(ie[0],ie[1],ie[2])}}for(let O=0;O<4;O++)for(let B=0;B<4;B++){const V=D(O,B),q=D(O,B+1),ie=D(O+1,B),de=D(O+1,B+1);T.emplaceBack(V,q,ie),T.emplaceBack(ie,q,de)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(T),this._tileDebugTextBuffer=t.createVertexBuffer(b,Nd.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(M,mb.members),this._tileDebugTextSegments=Qn.simpleSegment(0,0,I,32)}}class EL{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,i,c){const h=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][h]=this.stateChanges[t][h]||{},ln(this.stateChanges[t][h],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const p in this.state[t])p!==h&&(this.deletedStates[t][p]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][h]===null){this.deletedStates[t][h]={};for(const p in this.state[t][h])c[p]||(this.deletedStates[t][h][p]=null)}else for(const p in c)this.deletedStates[t]&&this.deletedStates[t][h]&&this.deletedStates[t][h][p]===null&&delete this.deletedStates[t][h][p]}removeFeatureState(t,i,c){if(this.deletedStates[t]===null)return;const h=String(i);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&i!==void 0)this.deletedStates[t][h]!==null&&(this.deletedStates[t][h]=this.deletedStates[t][h]||{},this.deletedStates[t][h][c]=null);else if(i!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][h])for(c in this.deletedStates[t][h]={},this.stateChanges[t][h])this.deletedStates[t][h][c]=null;else this.deletedStates[t][h]=null;else this.deletedStates[t]=null}getState(t,i){const c=String(i),h=ln({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const p=this.deletedStates[t][i];if(p===null)return{};for(const y in p)delete h[y]}return h}initializeTileState(t,i){t.setFeatureState(this.state,i)}coalesceChanges(t,i){const c={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const p={};for(const y in this.stateChanges[h])this.state[h][y]||(this.state[h][y]={}),ln(this.state[h][y],this.stateChanges[h][y]),p[y]=this.state[h][y];c[h]=p}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const p={};if(this.deletedStates[h]===null)for(const y in this.state[h])p[y]={},this.state[h][y]={};else for(const y in this.deletedStates[h]){if(this.deletedStates[h][y]===null)this.state[h][y]={};else if(this.state[h][y])for(const v of Object.keys(this.deletedStates[h][y]))delete this.state[h][y][v];p[y]=this.state[h][y]}c[h]=c[h]||{},ln(c[h],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const h in t)t[h].setFeatureState(c,i)}}class JT{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,i){const c=this.toIdx(t,i);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(t,i){return this.leaves[this.toIdx(t,i)]}toIdx(t,i){return i*this.size+t}}function QT(r,t,i,c){let h=0,p=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(c[y])<1e-15){if(i[y]<r[y]||i[y]>t[y])return null}else{const v=1/c[y];let b=(r[y]-i[y])*v,T=(t[y]-i[y])*v;if(b>T){const M=b;b=T,T=M}if(b>h&&(h=b),T<p&&(p=T),h>p)return null}return h}function eE(r,t,i,c,h,p,y,v,b,T,M){const I=c-r,D=h-t,O=p-i,B=y-r,V=v-t,q=b-i,ie=M[1]*q-M[2]*V,de=M[2]*B-M[0]*q,oe=M[0]*V-M[1]*B,ue=I*ie+D*de+O*oe;if(Math.abs(ue)<1e-15)return null;const me=1/ue,pe=T[0]-r,Le=T[1]-t,Ie=T[2]-i,Ne=(pe*ie+Le*de+Ie*oe)*me;if(Ne<0||Ne>1)return null;const Je=Le*O-Ie*D,Re=Ie*I-pe*O,We=pe*D-Le*I,Ze=(M[0]*Je+M[1]*Re+M[2]*We)*me;return Ze<0||Ne+Ze>1?null:(B*Je+V*Re+q*We)*me}function tE(r,t,i){return(r-t)/(i-t)}function nE(r,t,i,c,h,p,y,v,b){const T=1<<i,M=p-c,I=y-h,D=(r+1)/T*M+c,O=(t+0)/T*I+h,B=(t+1)/T*I+h;v[0]=(r+0)/T*M+c,v[1]=O,b[0]=D,b[1]=B}class rE{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(p){const y=Math.ceil(Math.log2(p.dim/8)),v=[];let b=Math.ceil(Math.pow(2,y));const T=1/b,M=(O,B,V,q,ie)=>{const de=q?1:0,oe=(O+1)*V-de,ue=B*V,me=(B+1)*V-de;ie[0]=O*V,ie[1]=ue,ie[2]=oe,ie[3]=me};let I=new JT(b);const D=[];for(let O=0;O<b*b;O++){M(O%b,Math.floor(O/b),T,!1,D);const B=Fa(D[0],D[1],p),V=Fa(D[2],D[1],p),q=Fa(D[2],D[3],p),ie=Fa(D[0],D[3],p);I.minimums.push(Math.min(B,V,q,ie)),I.maximums.push(Math.max(B,V,q,ie)),I.leaves.push(1)}for(v.push(I),b/=2;b>=1;b/=2){const O=v[v.length-1];I=new JT(b);for(let B=0;B<b*b;B++){M(B%b,Math.floor(B/b),2,!0,D);const V=O.getElevation(D[0],D[1]),q=O.getElevation(D[2],D[1]),ie=O.getElevation(D[2],D[3]),de=O.getElevation(D[0],D[3]),oe=O.isLeaf(D[0],D[1]),ue=O.isLeaf(D[2],D[1]),me=O.isLeaf(D[2],D[3]),pe=O.isLeaf(D[0],D[3]),Le=Math.min(V.min,q.min,ie.min,de.min),Ie=Math.max(V.max,q.max,ie.max,de.max),Ne=oe&&ue&&me&&pe;I.maximums.push(Ie),I.minimums.push(Le),I.leaves.push(Ie-Le<=5&&Ne?1:0)}v.push(I)}return v}(this.dem),c=i.length-1,h=i[c];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(i,0,0,c,0)}raycastRoot(t,i,c,h,p,y,v=1){return QT([t,i,-100],[c,h,this.maximums[0]*v],p,y)}raycast(t,i,c,h,p,y,v=1){if(!this.nodeCount)return null;const b=this.raycastRoot(t,i,c,h,p,y,v);if(b==null)return null;const T=[],M=[],I=[],D=[],O=[{idx:0,t:b,nodex:0,nodey:0,depth:0}];for(;O.length>0;){const{idx:B,t:V,nodex:q,nodey:ie,depth:de}=O.pop();if(this.leaves[B]){nE(q,ie,de,t,i,c,h,I,D);const ue=1<<de,me=(q+0)/ue,pe=(q+1)/ue,Le=(ie+0)/ue,Ie=(ie+1)/ue,Ne=Fa(me,Le,this.dem)*v,Je=Fa(pe,Le,this.dem)*v,Re=Fa(pe,Ie,this.dem)*v,We=Fa(me,Ie,this.dem)*v,Ze=eE(I[0],I[1],Ne,D[0],I[1],Je,D[0],D[1],Re,p,y),Xe=eE(D[0],D[1],Re,I[0],D[1],We,I[0],I[1],Ne,p,y),rt=Math.min(Ze!==null?Ze:Number.MAX_VALUE,Xe!==null?Xe:Number.MAX_VALUE);if(rt!==Number.MAX_VALUE)return rt;{const Fe=Bd([],p,y,V);if(iE(Ne,Je,We,Re,tE(Fe[0],I[0],D[0]),tE(Fe[1],I[1],D[1]))>=Fe[2])return V}continue}let oe=0;for(let ue=0;ue<this._siblingOffset.length;ue++){nE((q<<1)+this._siblingOffset[ue][0],(ie<<1)+this._siblingOffset[ue][1],de+1,t,i,c,h,I,D),I[2]=-100,D[2]=this.maximums[this.childOffsets[B]+ue]*v;const me=QT(I,D,p,y);if(me!=null){const pe=me;T[ue]=pe;let Le=!1;for(let Ie=0;Ie<oe&&!Le;Ie++)pe>=T[M[Ie]]&&(M.splice(Ie,0,ue),Le=!0);Le||(M[oe]=ue),oe++}}for(let ue=0;ue<oe;ue++){const me=M[ue];O.push({idx:this.childOffsets[B]+me,t:T[me],nodex:(q<<1)+this._siblingOffset[me][0],nodey:(ie<<1)+this._siblingOffset[me][1],depth:de+1})}}return null}_addNode(t,i,c){return this.minimums.push(t),this.maximums.push(i),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(t,i,c,h,p){if(t[h].isLeaf(i,c)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const y=h-1,v=t[y];let b=0,T=0;for(let M=0;M<this._siblingOffset.length;M++){const I=2*i+this._siblingOffset[M][0],D=2*c+this._siblingOffset[M][1],O=v.getElevation(I,D),B=v.isLeaf(I,D),V=this._addNode(O.min,O.max,B);B&&(b|=1<<M),T||(T=V)}for(let M=0;M<this._siblingOffset.length;M++)b&1<<M||this._construct(t,2*i+this._siblingOffset[M][0],2*c+this._siblingOffset[M][1],y,T+M)}}function iE(r,t,i,c,h,p){return en(en(r,i,p),en(t,c,p),h)}function Fa(r,t,i){const c=i.dim,h=He(r*c-.5,0,c-1),p=He(t*c-.5,0,c-1),y=Math.floor(h),v=Math.floor(p),b=Math.min(y+1,c-1),T=Math.min(v+1,c-1);return iE(i.get(y,v),i.get(b,v),i.get(y,T),i.get(b,T),h-y,p-v)}const oE={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function SL(r,t,i){return(256*r*256+256*t+i)/10-1e4}function CL(r,t,i){return 256*r+t+i/256-32768}class Jm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,i,c,h=!1,p=!1){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return Rn(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const y=this.dim=i.height-2,v=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=c||"mapbox",this.borderReady=h,!h){for(let b=0;b<y;b++)v[this._idx(-1,b)]=v[this._idx(0,b)],v[this._idx(y,b)]=v[this._idx(y-1,b)],v[this._idx(b,-1)]=v[this._idx(b,0)],v[this._idx(b,y)]=v[this._idx(b,y-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(y,-1)]=v[this._idx(y-1,0)],v[this._idx(-1,y)]=v[this._idx(0,y-1)],v[this._idx(y,y)]=v[this._idx(y-1,y-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new rE(this)}get(t,i,c=!1){c&&(t=He(t,-1,this.dim),i=He(i,-1,this.dim));const h=4*this._idx(t,i);return(this.encoding==="terrarium"?CL:SL)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(t){return oE[t]}get unpackVector(){return oE[this.encoding]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}static pack(t,i){const c=[0,0,0,0],h=Jm.getUnpackVector(i);let p=Math.floor((t+h[3])/h[2]);return c[2]=p%256,p=Math.floor(p/256),c[1]=p%256,p=Math.floor(p/256),c[0]=p,c}getPixels(){return new Pi({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,i,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=i*this.dim,p=i*this.dim+this.dim,y=c*this.dim,v=c*this.dim+this.dim;switch(i){case-1:h=p-1;break;case 1:p=h+1}switch(c){case-1:y=v-1;break;case 1:v=y+1}const b=-i*this.dim,T=-c*this.dim;for(let M=y;M<v;M++)for(let I=h;I<p;I++){const D=4*this._idx(I,M),O=4*this._idx(I+b,M+T);this.pixels[D+0]=t.pixels[O+0],this.pixels[D+1]=t.pixels[O+1],this.pixels[D+2]=t.pixels[O+2],this.pixels[D+3]=t.pixels[O+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}gt(Jm,"DEMData"),gt(rE,"DemMinMaxQuadTree",{omit:["dem"]});class PL{constructor(t,i){this.max=t,this.onRemove=i,this.reset()}reset(){for(const t in this.data)for(const i of this.data[t])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(t,i,c){const h=t.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const p={value:i,timeout:void 0};if(c!==void 0&&(p.timeout=setTimeout(()=>{this.remove(t,p)},c)),this.data[h].push(p),this.order.push(h),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const i=this.data[t].shift();return i.timeout&&clearTimeout(i.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),i.value}getByKey(t){const i=this.data[t];return i?i[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,i){if(!this.has(t))return this;const c=t.wrapped().key,h=i===void 0?0:this.data[c].indexOf(i),p=this.data[c][h];return this.data[c].splice(h,1),p.timeout&&clearTimeout(p.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(p.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(t){const i=[];for(const c in this.data)for(const h of this.data[c])t(h.value)||i.push(h);for(const c of i)this.remove(c.value.tileID,c)}}class Zu{constructor(t,i,c){this.func=t,this.mask=i,this.range=c}}Zu.ReadOnly=!1,Zu.ReadWrite=!0,Zu.disabled=new Zu(519,Zu.ReadOnly,[0,1]);const Lv=7680;class zv{constructor(t,i,c,h,p,y){this.test=t,this.ref=i,this.mask=c,this.fail=h,this.depthFail=p,this.pass=y}}zv.disabled=new zv({func:519,mask:0},0,0,Lv,Lv,Lv);class ls{constructor(t,i,c){this.blendFunction=t,this.blendColor=i,this.mask=c}}ls.Replace=[1,0],ls.disabled=new ls(ls.Replace,Zn.transparent,[!1,!1,!1,!1]),ls.unblended=new ls(ls.Replace,Zn.transparent,[!0,!0,!0,!0]),ls.alphaBlended=new ls([1,771],Zn.transparent,[!0,!0,!0,!0]);const Rv=1029,Ov=2305;class No{constructor(t,i,c){this.enable=t,this.mode=i,this.frontFace=c}}No.disabled=new No(!1,Rv,Ov),No.backCCW=new No(!0,Rv,Ov),No.backCW=new No(!0,Rv,2304),No.frontCW=new No(!0,1028,2304),No.frontCCW=new No(!0,1028,Ov);class cc extends Cl{constructor(t,i,c){super(),this.id=t,this._onlySymbols=c,i.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new PL(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new EL,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const i=this._tiles[t];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,i){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,i)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const c=this._tiles[i];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return ur(this._tiles).map(t=>t.tileID).sort(sE).map(t=>t.key)}getRenderableIds(t){const i=[];for(const c in this._tiles)this._isIdRenderable(+c,t)&&i.push(this._tiles[c]);return t?i.sort((c,h)=>{const p=c.tileID,y=h.tileID,v=new Te(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),b=new Te(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-y.overscaledZ||b.y-v.y||b.x-v.x}).map(c=>c.tileID.key):i.map(c=>c.tileID).sort(sE).map(c=>c.key)}hasRenderableParent(t){const i=this.findLoadedParent(t,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(t,i){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(i||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,i){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=i),this._loadTile(c,this._tileLoaded.bind(this,c,t,i)))}_tileLoaded(t,i,c,h){if(h)if(t.state="errored",h.status!==404)this._source.fire(new To(h,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=bo.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(i,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Ts("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const i=this.getRenderableIds();for(let h=0;h<i.length;h++){const p=i[h];if(t.neighboringTiles&&t.neighboringTiles[p]){const y=this.getTileByID(p);c(t,y),c(y,t)}}function c(h,p){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let y=p.tileID.canonical.x-h.tileID.canonical.x;const v=p.tileID.canonical.y-h.tileID.canonical.y,b=Math.pow(2,h.tileID.canonical.z),T=p.tileID.key;y===0&&v===0||Math.abs(v)>1||(Math.abs(y)>1&&(Math.abs(y+b)===1?y+=b:Math.abs(y-b)===1&&(y-=b)),p.dem&&h.dem&&(h.dem.backfillBorder(p.dem,y,v),h.neighboringTiles&&h.neighboringTiles[T]&&(h.neighboringTiles[T].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,i,c,h){for(const p in this._tiles){let y=this._tiles[p];if(h[p]||!y.hasData()||y.tileID.overscaledZ<=i||y.tileID.overscaledZ>c)continue;let v=y.tileID;for(;y&&y.tileID.overscaledZ>i+1;){const T=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[T.key],y&&y.hasData()&&(v=T)}let b=v;for(;b.overscaledZ>i;)if(b=b.scaledTo(b.overscaledZ-1),t[b.key]){h[v.key]=v;break}}}findLoadedParent(t,i){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=i?c:null}for(let c=t.overscaledZ-1;c>=i;c--){const h=t.scaledTo(c),p=this._getLoadedTile(h);if(p)return p}}_getLoadedTile(t){const i=this._tiles[t.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,i){i=i||this._source.tileSize;const c=Math.ceil(t.width/i)+1,h=Math.ceil(t.height/i)+1,p=Math.floor(c*h*5),y=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,p):p,v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(v)}handleWrapJump(t){const i=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,i){const c={};for(const h in this._tiles){const p=this._tiles[h];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+i),c[p.tileID.key]=p}this._tiles=c;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(t,i,c){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let h;this.updateCacheSize(t,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new Jr(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(h=t.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(v=>this._source.hasTile(v)))):h=[];const p=this._updateRetainedTiles(h);if(aE(this._source.type)&&h.length!==0){const v={},b={},T=Object.keys(p);for(const I of T){const D=p[I],O=this._tiles[I];if(!O||O.fadeEndTime&&O.fadeEndTime<=bo.now())continue;const B=this.findLoadedParent(D,Math.max(D.overscaledZ-cc.maxOverzooming,this._source.minzoom));B&&(this._addTile(B.tileID),v[B.tileID.key]=B.tileID),b[I]=D}const M=h[h.length-1].overscaledZ;for(const I in this._tiles){const D=this._tiles[I];if(p[I]||!D.hasData())continue;let O=D.tileID;for(;O.overscaledZ>M;){O=O.scaledTo(O.overscaledZ-1);const B=this._tiles[O.key];if(B&&B.hasData()&&b[O.key]){p[I]=D.tileID;break}}}for(const I in v)p[I]||(this._coveredTiles[I]=!0,p[I]=v[I])}for(const v in p)this._tiles[v].clearFadeHold();const y=function(v,b){const T=[];for(const M in v)M in b||T.push(M);return T}(this._tiles,p);for(const v of y){const b=this._tiles[v];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const i={};if(t.length===0)return i;const c={},h=t.reduce((T,M)=>Math.min(T,M.overscaledZ),1/0),p=t[0].overscaledZ,y=Math.max(p-cc.maxOverzooming,this._source.minzoom),v=Math.max(p+cc.maxUnderzooming,this._source.minzoom),b={};for(const T of t){const M=this._addTile(T);i[T.key]=T,M.hasData()||h<this._source.maxzoom&&(b[T.key]=T)}this._retainLoadedChildren(b,h,v,i);for(const T of t){let M=this._tiles[T.key];if(M.hasData())continue;if(T.canonical.z>=this._source.maxzoom){const D=T.children(this._source.maxzoom)[0],O=this.getTile(D);if(O&&O.hasData()){i[D.key]=D;continue}}else{const D=T.children(this._source.maxzoom);if(i[D[0].key]&&i[D[1].key]&&i[D[2].key]&&i[D[3].key])continue}let I=M.wasRequested();for(let D=T.overscaledZ-1;D>=y;--D){const O=T.scaledTo(D);if(c[O.key]||(c[O.key]=!0,M=this.getTile(O),!M&&I&&(M=this._addTile(O)),M&&(i[O.key]=O,I=M.wasRequested(),M.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const i=[];let c,h=this._tiles[t].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){c=this._loadedParentTiles[h.key];break}i.push(h.key);const p=h.scaledTo(h.overscaledZ-1);if(c=this._getLoadedTile(p),c)break;h=p}for(const p of i)this._loadedParentTiles[p]=c}}_addTile(t){let i=this._tiles[t.key];if(i)return i;i=this._cache.getAndRemove(t),i&&(this._setTileReloadTimer(t.key,i),i.tileID=t,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,i)));const c=!!i;if(!c){const h=this.map?this.map.painter:null;i=new Dv(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,t.key,i.state))}return i?(i.uses++,this._tiles[t.key]=i,c||this._source.fire(new Ts("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(t,i){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=i.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const i=this._tiles[t];i&&(i.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,i,c){const h=[],p=this.transform;if(!p)return h;const y=p.projection.name==="globe",v=is(p.center.lng);for(const b in this._tiles){const T=this._tiles[b];if(c&&T.clearQueryDebugViz(),T.holdingForFade())continue;let M;if(y){const I=T.tileID.canonical;if(I.z===0){const D=[Math.abs(He(v,...uf(I,-1))-v),Math.abs(He(v,...uf(I,1))-v)];M=[0,2*D.indexOf(Math.min(...D))-1]}else{const D=[Math.abs(He(v,...uf(I,-1))-v),Math.abs(He(v,...uf(I,0))-v),Math.abs(He(v,...uf(I,1))-v)];M=[D.indexOf(Math.min(...D))-1]}}else M=[0];for(const I of M){const D=t.containsTile(T,p,i,I);D&&h.push(D)}}return h}getVisibleCoordinates(t){const i=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);for(const c of i)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(aE(this._source.type))for(const t in this._tiles){const i=this._tiles[t];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=bo.now())return!0}return!1}setFeatureState(t,i,c){this._state.updateState(t=t||"_geojsonTileLayer",i,c)}removeFeatureState(t,i,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",i,c)}getFeatureState(t,i){return this._state.getState(t=t||"_geojsonTileLayer",i)}setDependencies(t,i,c){const h=this._tiles[t];h&&h.setDependencies(i,c)}reloadTilesForDependencies(t,i){for(const c in this._tiles)this._tiles[c].hasDependency(t,i)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(t,i))}_preloadTiles(t,i){if(!this._sourceLoaded){const v=()=>{this._sourceLoaded&&(this._source.off("data",v),this._preloadTiles(t,i))};return void this._source.on("data",v)}const c=new Map,h=Array.isArray(t)?t:[t],p=this.map.painter.terrain,y=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const v of h){const b=v.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const T of b)c.set(T.key,T);this.usedForTerrain&&v.updateElevation(!1)}Nt(Array.from(c.values()),(v,b)=>{const T=new Dv(v,this._source.tileSize*v.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(T,M=>{this._source.type==="raster-dem"&&T.dem&&this._backfillDEM(T),b(M,T)})},i)}}function sE(r,t){const i=Math.abs(2*r.wrap)-+(r.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return r.overscaledZ-t.overscaledZ||c-i||t.canonical.y-r.canonical.y||t.canonical.x-r.canonical.x}function aE(r){return r==="raster"||r==="image"||r==="video"||r==="custom"}function uf(r,t){const i=1<<r.z;return[r.x/i+t,(r.x+1)/i+t]}cc.maxOverzooming=10,cc.maxUnderzooming=3;class Qm{constructor(t,i,c){this._demTile=t,this._dem=this._demTile.dem,this._scale=i,this._offset=c}static create(t,i,c){const h=c||t.findDEMTileFor(i);if(!h||!h.dem)return;const p=h.dem,y=h.tileID,v=1<<i.canonical.z-y.canonical.z;return new Qm(h,h.tileSize/Ct/v,[(i.canonical.x/v-y.canonical.x)*p.dim,(i.canonical.y/v-y.canonical.y)*p.dim])}tileCoordToPixel(t,i){const c=i*this._scale+this._offset[1],h=Math.floor(t*this._scale+this._offset[0]),p=Math.floor(c);return new Te(h,p)}getElevationAt(t,i,c,h){const p=t*this._scale+this._offset[0],y=i*this._scale+this._offset[1],v=Math.floor(p),b=Math.floor(y),T=this._dem;return h=!!h,c?en(en(T.get(v,b,h),T.get(v,b+1,h),y-b),en(T.get(v+1,b,h),T.get(v+1,b+1,h),y-b),p-v):T.get(v,b,h)}getElevationAtPixel(t,i,c){return this._dem.get(t,i,!!c)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Fo(1,t)*this._dem.stride}}class lE{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Is(Ct,16,0),this.featureIndexArray=new Yl,this.promoteId=i}insert(t,i,c,h,p,y=0){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,h,p,y);const b=this.grid;for(let T=0;T<i.length;T++){const M=i[T],I=[1/0,1/0,-1/0,-1/0];for(let D=0;D<M.length;D++){const O=M[D];I[0]=Math.min(I[0],O.x),I[1]=Math.min(I[1],O.y),I[2]=Math.max(I[2],O.x),I[3]=Math.max(I[3],O.y)}I[0]<Ct&&I[1]<Ct&&I[2]>=0&&I[3]>=0&&b.insert(v,I[0],I[1],I[2],I[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new gv(new jm(this.rawTileData)).layers,this.sourceLayerCoder=new qT(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,i,c,h){this.loadVTLayers();const p=t.params||{},y=wu(p.filter),v=t.tileResult,b=t.transform,T=v.bufferedTilespaceBounds,M=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(B,V,q,ie)=>Lb(v.bufferedTilespaceGeometry,B,V,q,ie));M.sort(ML);let I=null;b.elevation&&M.length>0&&(I=Qm.create(b.elevation,this.tileID));const D={};let O;for(let B=0;B<M.length;B++){const V=M[B];if(V===O)continue;O=V;const q=this.featureIndexArray.get(V);let ie=null;this.loadMatchingFeature(D,q,y,p.layers,p.availableImages,i,c,h,(de,oe,ue,me=0)=>(ie||(ie=Fs(de,this.tileID.canonical,t.tileTransform)),oe.queryIntersectsFeature(v,de,ue,ie,this.z,t.transform,t.pixelPosMatrix,I,me)))}return D}loadMatchingFeature(t,i,c,h,p,y,v,b,T){const{featureIndex:M,bucketIndex:I,sourceLayerIndex:D,layoutVertexArrayOffset:O}=i,B=this.bucketLayerIDs[I];if(h&&!function(de,oe){for(let ue=0;ue<de.length;ue++)if(oe.indexOf(de[ue])>=0)return!0;return!1}(h,B))return;const V=this.sourceLayerCoder.decode(D),q=this.vtLayers[V].feature(M);if(c.needGeometry){const de=oc(q,!0);if(!c.filter(new k(this.tileID.overscaledZ),de,this.tileID.canonical))return}else if(!c.filter(new k(this.tileID.overscaledZ),q))return;const ie=this.getId(q,V);for(let de=0;de<B.length;de++){const oe=B[de];if(h&&h.indexOf(oe)<0)continue;const ue=y[oe];if(!ue)continue;let me={};ie!==void 0&&b&&(me=b.getState(ue.sourceLayer||"_geojsonTileLayer",ie));const pe=ln({},v[oe]);pe.paint=cE(pe.paint,ue.paint,q,me,p),pe.layout=cE(pe.layout,ue.layout,q,me,p);const Le=!T||T(q,ue,me,O);if(!Le)continue;const Ie=new HT(q,this.z,this.x,this.y,ie);Ie.layer=pe;let Ne=t[oe];Ne===void 0&&(Ne=t[oe]=[]),Ne.push({featureIndex:M,feature:Ie,intersectionZ:Le})}}lookupSymbolFeatures(t,i,c,h,p,y,v,b){const T={};this.loadVTLayers();const M=wu(p);for(const I of t)this.loadMatchingFeature(T,{bucketIndex:c,sourceLayerIndex:h,featureIndex:I,layoutVertexArrayOffset:0},M,y,v,b,i);return T}loadFeature(t){const{featureIndex:i,sourceLayerIndex:c}=t;this.loadVTLayers();const h=this.sourceLayerCoder.decode(c),p=this.vtFeatures[h];if(p[i])return p[i];const y=this.vtLayers[h].feature(i);return p[i]=y,y}hasLayer(t){for(const i of this.bucketLayerIDs)for(const c of i)if(t===c)return!0;return!1}getId(t,i){let c=t.id;if(this.promoteId){const h=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];h!=null&&(c=t.properties[h]),typeof c=="boolean"&&(c=Number(c))}return c}}function cE(r,t,i,c,h){return Vt(r,(p,y)=>{const v=t instanceof re?t.get(y):null;return v&&v.evaluate?v.evaluate(i,c,h):v})}function ML(r,t){return t-r}gt(lE,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class uE{constructor(t,i){this.width=t,this.height=i,this.nextRow=0,this.image=new Bs({width:t,height:i}),this.positions={},this.uploaded=!1}getDash(t,i){const c=this.getKey(t,i);return this.positions[c]}trim(){const t=this.width,i=this.height=si(this.nextRow);this.image.resize({width:t,height:i})}getKey(t,i){return t.join(",")+i}getDashRanges(t,i,c){const h=[];let p=t.length%2==1?-t[t.length-1]*c:0,y=t[0]*c,v=!0;h.push({left:p,right:y,isDash:v,zeroLength:t[0]===0});let b=t[0];for(let T=1;T<t.length;T++){v=!v;const M=t[T];p=b*c,b+=M,y=b*c,h.push({left:p,right:y,isDash:v,zeroLength:M===0})}return h}addRoundDash(t,i,c){const h=i/2;for(let p=-c;p<=c;p++){const y=this.width*(this.nextRow+c+p);let v=0,b=t[v];for(let T=0;T<this.width;T++){T/b.right>1&&(b=t[++v]);const M=Math.abs(T-b.left),I=Math.abs(T-b.right),D=Math.min(M,I);let O;const B=p/c*(h+1);if(b.isDash){const V=h-Math.abs(B);O=Math.sqrt(D*D+V*V)}else O=h-Math.sqrt(D*D+B*B);this.image.data[y+T]=Math.max(0,Math.min(255,O+128))}}}addRegularDash(t,i){for(let b=t.length-1;b>=0;--b){const T=t[b],M=t[b+1];T.zeroLength?t.splice(b,1):M&&M.isDash===T.isDash&&(M.left=T.left,t.splice(b,1))}const c=t[0],h=t[t.length-1];c.isDash===h.isDash&&(c.left=h.left-this.width,h.right=c.right+this.width);const p=this.width*this.nextRow;let y=0,v=t[y];for(let b=0;b<this.width;b++){b/v.right>1&&(v=t[++y]);const T=Math.abs(b-v.left),M=Math.abs(b-v.right),I=Math.min(T,M);this.image.data[p+b]=Math.max(0,Math.min(255,(v.isDash?I:-I)+i+128))}}addDash(t,i){const c=this.getKey(t,i);if(this.positions[c])return this.positions[c];const h=i==="round",p=h?7:0,y=2*p+1;if(this.nextRow+y>this.height)return Rn("LineAtlas out of space"),null;t.length===0&&t.push(1);let v=0;for(let M=0;M<t.length;M++)t[M]<0&&(Rn("Negative value is found in line dasharray, replacing values with 0"),t[M]=0),v+=t[M];if(v!==0){const M=this.width/v,I=this.getDashRanges(t,this.width,M);h?this.addRoundDash(I,M,p):this.addRegularDash(I,i==="square"?.5*M:0)}const b=this.nextRow+p;this.nextRow+=y;const T={tl:[b,p],br:[v,0]};return this.positions[c]=T,T}}gt(uE,"LineAtlas");const hE=1*jo;class dE{constructor(t){const i={},c=[];for(const v in t){const b=t[v],T=i[v]={};for(const M in b.glyphs){const I=b.glyphs[+M];if(!I||I.bitmap.width===0||I.bitmap.height===0)continue;const D=I.metrics.localGlyph?hE:1,O={x:0,y:0,w:I.bitmap.width+2*D,h:I.bitmap.height+2*D};c.push(O),T[M]=O}}const{w:h,h:p}=xv(c),y=new Bs({width:h||1,height:p||1});for(const v in t){const b=t[v];for(const T in b.glyphs){const M=b.glyphs[+T];if(!M||M.bitmap.width===0||M.bitmap.height===0)continue;const I=i[v][T],D=M.metrics.localGlyph?hE:1;Bs.copy(M.bitmap,y,{x:0,y:0},{x:I.x+D,y:I.y+D},M.bitmap)}}this.image=y,this.positions=i}}gt(dE,"GlyphAtlas");class kL{constructor(t){this.tileID=new Jr(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=lc(t.tileID.canonical,t.projection),this.projection=t.projection}parse(t,i,c,h,p){this.status="parsing",this.data=t,this.collisionBoxArray=new gn;const y=new qT(Object.keys(t.layers).sort()),v=new lE(this.tileID,this.promoteId);v.bucketLayerIDs=[];const b={},T=new uE(256,256),M={featureIndex:v,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:T,availableImages:c},I=i.familiesBySource[this.source];for(const me in I){const pe=t.layers[me];if(!pe)continue;let Le=!1,Ie=!1;for(const Re of I[me])Re[0].type==="symbol"?Le=!0:Ie=!0;if(this.isSymbolTile===!0&&!Le||this.isSymbolTile===!1&&!Ie)continue;pe.version===1&&Rn(`Vector tile source "${this.source}" layer "${me}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ne=y.encode(me),Je=[];for(let Re=0;Re<pe.length;Re++){const We=pe.feature(Re),Ze=v.getId(We,me);Je.push({feature:We,id:Ze,index:Re,sourceLayerIndex:Ne})}for(const Re of I[me]){const We=Re[0];this.isSymbolTile!==void 0&&We.type==="symbol"!==this.isSymbolTile||We.minzoom&&this.zoom<Math.floor(We.minzoom)||We.maxzoom&&this.zoom>=We.maxzoom||We.visibility!=="none"&&(Fv(Re,this.zoom,c),(b[We.id]=We.createBucket({index:v.bucketLayerIDs.length,layers:Re,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ne,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(Je,M,this.tileID.canonical,this.tileTransform),v.bucketLayerIDs.push(Re.map(Ze=>Ze.id)))}}let D,O,B,V;T.trim();const q={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ie=()=>{if(D)return p(D);if(O&&B&&V){const me=new dE(O),pe=new vT(B,V);for(const Le in b){const Ie=b[Le];Ie instanceof za?(Fv(Ie.layers,this.zoom,c),tL(Ie,O,me.positions,B,pe.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):Ie.hasPattern&&(Ie instanceof Om||Ie instanceof Am||Ie instanceof Yd)&&(Fv(Ie.layers,this.zoom,c),Ie.addFeatures(M,this.tileID.canonical,pe.patternPositions,c,this.tileTransform))}this.status="done",p(null,{buckets:ur(b).filter(Le=>!Le.isEmpty()),featureIndex:v,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:me.image,lineAtlas:T,imageAtlas:pe,glyphMap:this.returnDependencies?O:null,iconMap:this.returnDependencies?B:null,glyphPositions:this.returnDependencies?me.positions:null})}},de=Vt(M.glyphDependencies,me=>Object.keys(me).map(Number));Object.keys(de).length?h.send("getGlyphs",{uid:this.uid,stacks:de},(me,pe)=>{D||(D=me,O=pe,ie())},void 0,!1,q):O={};const oe=Object.keys(M.iconDependencies);oe.length?h.send("getImages",{icons:oe,source:this.source,tileID:this.tileID,type:"icons"},(me,pe)=>{D||(D=me,B=pe,ie())},void 0,!1,q):B={};const ue=Object.keys(M.patternDependencies);ue.length?h.send("getImages",{icons:ue,source:this.source,tileID:this.tileID,type:"patterns"},(me,pe)=>{D||(D=me,V=pe,ie())},void 0,!1,q):V={},ie()}}function Fv(r,t,i){const c=new k(t);for(const h of r)h.recalculate(c,i)}class fE{constructor(t){this.entries={},this.scheduler=t}request(t,i,c,h){const p=this.entries[t]=this.entries[t]||{callbacks:[]};if(p.result){const[y,v]=p.result;return this.scheduler?this.scheduler.add(()=>{h(y,v)},i):h(y,v),()=>{}}return p.callbacks.push(h),p.cancel||(p.cancel=c((y,v)=>{p.result=[y,v];for(const b of p.callbacks)this.scheduler?this.scheduler.add(()=>{b(y,v)},i):b(y,v);setTimeout(()=>delete this.entries[t],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(y=>y!==h),p.callbacks.length||(p.cancel(),delete this.entries[t]))}}}function pE(r,t,i){const c=JSON.stringify(r.request);return r.data&&(this.deduped.entries[c]={result:[null,r.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},h=>{const p=la(r.request,(y,v,b,T)=>{y?h(y):v&&h(null,{vectorTile:i?void 0:new gv(new jm(v)),rawData:v,cacheControl:b,expires:T})});return()=>{p.cancel(),h()}},t)}const mE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Bv{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,c]=new Uint8Array(t,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=c>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const p=mE[15&c];if(!p)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new Bv(v,y,p,t)}constructor(t,i=64,c=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=c,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const p=mE.indexOf(this.ArrayType),y=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,b=(8-v%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${c}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+b,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+y+v+b),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+b,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t)}add(t,i){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=t,this.coords[this._pos++]=i,c}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return jv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,i,c,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:y,nodeSize:v}=this,b=[0,p.length-1,0],T=[];for(;b.length;){const M=b.pop()||0,I=b.pop()||0,D=b.pop()||0;if(I-D<=v){for(let q=D;q<=I;q++){const ie=y[2*q],de=y[2*q+1];ie>=t&&ie<=c&&de>=i&&de<=h&&T.push(p[q])}continue}const O=D+I>>1,B=y[2*O],V=y[2*O+1];B>=t&&B<=c&&V>=i&&V<=h&&T.push(p[O]),(M===0?t<=B:i<=V)&&(b.push(D),b.push(O-1),b.push(1-M)),(M===0?c>=B:h>=V)&&(b.push(O+1),b.push(I),b.push(1-M))}return T}within(t,i,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:p,nodeSize:y}=this,v=[0,h.length-1,0],b=[],T=c*c;for(;v.length;){const M=v.pop()||0,I=v.pop()||0,D=v.pop()||0;if(I-D<=y){for(let q=D;q<=I;q++)yE(p[2*q],p[2*q+1],t,i)<=T&&b.push(h[q]);continue}const O=D+I>>1,B=p[2*O],V=p[2*O+1];yE(B,V,t,i)<=T&&b.push(h[O]),(M===0?t-c<=B:i-c<=V)&&(v.push(D),v.push(O-1),v.push(1-M)),(M===0?t+c>=B:i+c>=V)&&(v.push(O+1),v.push(I),v.push(1-M))}return b}}function jv(r,t,i,c,h,p){if(h-c<=i)return;const y=c+h>>1;gE(r,t,y,c,h,p),jv(r,t,i,c,y-1,1-p),jv(r,t,i,y+1,h,1-p)}function gE(r,t,i,c,h,p){for(;h>c;){if(h-c>600){const T=h-c+1,M=i-c+1,I=Math.log(T),D=.5*Math.exp(2*I/3),O=.5*Math.sqrt(I*D*(T-D)/T)*(M-T/2<0?-1:1);gE(r,t,i,Math.max(c,Math.floor(i-M*D/T+O)),Math.min(h,Math.floor(i+(T-M)*D/T+O)),p)}const y=t[2*i+p];let v=c,b=h;for(hf(r,t,c,i),t[2*h+p]>y&&hf(r,t,c,h);v<b;){for(hf(r,t,v,b),v++,b--;t[2*v+p]<y;)v++;for(;t[2*b+p]>y;)b--}t[2*c+p]===y?hf(r,t,c,b):(b++,hf(r,t,b,h)),b<=i&&(c=b+1),i<=b&&(h=b-1)}}function hf(r,t,i,c){Nv(r,i,c),Nv(t,2*i,2*c),Nv(t,2*i+1,2*c+1)}function Nv(r,t,i){const c=r[t];r[t]=r[i],r[i]=c}function yE(r,t,i,c){const h=r-i,p=t-c;return h*h+p*p}a.ARRAY_TYPE=Ci,a.AUTH_ERR_MSG=ge,a.Aabb=Yr,a.Actor=class{constructor(r,t,i){this.target=r,this.parent=t,this.mapId=i,this.callbacks={},this.cancelCallbacks={},Qt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=wo()?r:P,this.scheduler=new bL}send(r,t,i,c,h=!1,p){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=p,this.callbacks[y]=i);const v=oa(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:r,hasCallback:!!i,targetMapId:c,mustQueue:h,sourceMapId:this.mapId,data:Ca(t,v)},v),{cancel:()=>{i&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(r){const t=r.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){const c=this.cancelCallbacks[i];delete this.cancelCallbacks[i],c&&c.cancel()}else if(t.mustQueue||wo()){const c=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,t),c&&c.metadata||{type:"message"})}else this.processTask(i,t)}processTask(r,t){if(t.type==="<response>"){const i=this.callbacks[r];delete this.callbacks[r],i&&(t.error?i(As(t.error)):i(null,As(t.data)))}else{const i=oa(this.globalScope)?void 0:[],c=t.hasCallback?(p,y)=>{delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:p?Ca(p):null,data:Ca(y,i)},i)}:p=>{},h=As(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,h,c);else if(this.parent.getWorkerSource){const p=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,p[0],h.source)[p[1]](h,c)}else c(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=Rm,a.Color=Zn,a.ColorMode=ls,a.CullFaceMode=No,a.DEMData=Jm,a.DataConstantProperty=U,a.DedupedRequest=fE,a.DepthMode=Zu,a.EXTENT=Ct,a.Elevation=class{isDataAvailableAtPoint(r){const t=this._source();if(this.isUsingMockSource()||!t||r.y<0||r.y>1)return!1;const i=t.getSource().maxzoom,c=1<<i,h=Math.floor(r.x),p=Math.floor((r.x-h)*c),y=Math.floor(r.y*c),v=this.findDEMTileFor(new Jr(i,h,i,p,y));return!(!v||!v.dem)}getAtPointOrZero(r,t=0){return this.getAtPoint(r,t)||0}getAtPoint(r,t,i=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const c=this._source();if(!c||r.y<0||r.y>1)return t;const h=c.getSource().maxzoom,p=1<<h,y=Math.floor(r.x),v=r.x-y,b=new Jr(h,y,h,Math.floor(v*p),Math.floor(r.y*p)),T=this.findDEMTileFor(b);if(!T||!T.dem)return t;const M=T.dem,I=1<<T.tileID.canonical.z,D=(v*I-T.tileID.canonical.x)*M.dim,O=(r.y*I-T.tileID.canonical.y)*M.dim,B=Math.floor(D),V=Math.floor(O);return(i?this.exaggeration():1)*en(en(M.get(B,V),M.get(B,V+1),O-V),en(M.get(B+1,V),M.get(B+1,V+1),O-V),D-B)}getAtTileOffset(r,t,i){const c=1<<r.canonical.z;return this.getAtPointOrZero(new Du(r.wrap+(r.canonical.x+t/Ct)/c,(r.canonical.y+i/Ct)/c))}getAtTileOffsetFunc(r,t,i,c){return h=>{const p=this.getAtTileOffset(r,h.x,h.y),y=c.upVector(r.canonical,h.x,h.y);return Ni(y,y,p*c.upVectorScale(r.canonical,t,i).metersToTile),y}}getForTilePoints(r,t,i,c){if(this.isUsingMockSource())return!1;const h=Qm.create(this,r,c);return!!h&&(t.forEach(p=>{p[2]=this.exaggeration()*h.getElevationAt(p[0],p[1],i)}),!0)}getMinMaxForTile(r){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(r);if(!t||!t.dem)return null;const i=t.dem.tree,c=t.tileID,h=1<<r.canonical.z-c.canonical.z;let p=r.canonical.x/h-c.canonical.x,y=r.canonical.y/h-c.canonical.y,v=0;for(let b=0;b<r.canonical.z-c.canonical.z&&!i.leaves[v];b++){p*=2,y*=2;const T=2*Math.floor(y)+Math.floor(p);v=i.childOffsets[v]+T,p%=1,y%=1}return{min:this.exaggeration()*i.minimums[v],max:this.exaggeration()*i.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,t,i){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=To,a.EvaluationParameters=k,a.Event=Ts,a.Evented=Cl,a.FillExtrusionBucket=Yd,a.Frustum=q_,a.FrustumCorners=Z_,a.GLOBE_RADIUS=ns,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=gb,a.GLOBE_ZOOM_THRESHOLD_MIN=H_,a.GlobeSharedBuffers=class{constructor(r){this._createGrid(r),this._createPoles(r)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const r of this._poleSegments)r.destroy();for(const r of this._gridSegments)r.withSkirts.destroy(),r.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const r of this._wireframeSegments)r.destroy()}}_fillGridMeshWithLods(r,t){const i=new Ye,c=new wt,h=[],p=r+1+2,y=t[0]+1,v=t[0]+1+(1+t.length),b=(T,M,I)=>{let D=T===p-1?T-2:T===0?T:T-1;return D+=I?24575:0,[D,M]};for(let T=0;T<p;++T)i.emplaceBack(...b(T,0,!0));for(let T=0;T<y;++T)for(let M=0;M<p;++M)i.emplaceBack(...b(M,T,(M===0||M===p-1)&&!0));for(let T=0;T<t.length;++T){const M=t[T];for(let I=0;I<p;++I)i.emplaceBack(...b(I,M,!0))}for(let T=0;T<t.length;++T){const M=c.length,I=t[T]+1+2,D=new wt;for(let V=0;V<I-1;V++){const q=V===I-2,ie=q?p*(v-t.length+T-V):p;for(let de=0;de<p-1;de++){const oe=V*p+de;V===0||q||de===0||de===p-2?(D.emplaceBack(oe+1,oe,oe+ie),D.emplaceBack(oe+ie,oe+ie+1,oe+1)):(c.emplaceBack(oe+1,oe,oe+ie),c.emplaceBack(oe+ie,oe+ie+1,oe+1))}}const O=Qn.simpleSegment(0,M,i.length,c.length-M);for(let V=0;V<D.uint16.length;V+=3)c.emplaceBack(D.uint16[V],D.uint16[V+1],D.uint16[V+2]);const B=Qn.simpleSegment(0,M,i.length,c.length-M);h.push({withoutSkirts:O,withSkirts:B})}return{vertices:i,indices:c,segments:h}}_createGrid(r){const t=this._fillGridMeshWithLods(rc,Ud);this._gridSegments=t.segments,this._gridBuffer=r.createVertexBuffer(t.vertices,Nd.members),this._gridIndexBuffer=r.createIndexBuffer(t.indices,!0)}_createPoles(r){const t=new wt;for(let h=0;h<=rc;h++)t.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=r.createIndexBuffer(t,!0);const i=new mn,c=new mn;this._poleSegments=[];for(let h=0,p=0;h<H_;h++){const y=360/(1<<h);i.emplaceBack(0,-ns,0,.5,0),c.emplaceBack(0,-ns,0,.5,1);for(let v=0;v<=rc;v++){const b=v/rc,T=en(0,y,b),[M,I,D]=ku(b3,T3,T,ns);i.emplaceBack(M,I,D,b,0),c.emplaceBack(M,I,D,b,1)}this._poleSegments.push(Qn.simpleSegment(p,0,66,64)),p+=66}this._poleNorthVertexBuffer=r.createVertexBuffer(i,pb,!1),this._poleSouthVertexBuffer=r.createVertexBuffer(c,pb,!1)}getGridBuffers(r,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[r].withSkirts:this._gridSegments[r].withoutSkirts]}getPoleBuffers(r){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[r]]}getWirefameBuffers(r,t){if(!this._wireframeSegments){const i=new xr,c=rc,h=c+1+2,p=1;this._wireframeSegments=[];for(let y=0,v=0;y<Ud.length;y++){const b=Ud[y];for(let M=p;M<b+p;M++)for(let I=p;I<c+p;I++){const D=M*h+I;i.emplaceBack(D,D+1),i.emplaceBack(D,D+h),i.emplaceBack(D,D+h+1)}const T=b*c*3;this._wireframeSegments.push(Qn.simpleSegment(0,v,(b+1)*h,T)),v+=T}this._wireframeIndexBuffer=r.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}},a.GlyphManager=Uu,a.ImagePosition=wv,a.KDBush=Bv,a.LivePerformanceUtils=p_,a.LngLat=yn,a.LngLatBounds=Ia,a.LocalGlyphMode=Ev,a.MAX_MERCATOR_LATITUDE=Fr,a.MercatorCoordinate=Du,a.ONE_EM=Mr,a.OverscaledTileID=Jr,a.PerformanceMarkers=ca,a.Point=Te,a.Properties=le,a.RGBAImage=Pi,a.Ray=W_,a.RequestManager=class{constructor(r,t,i){this._transformRequestFn=r,this._customAccessToken=t,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const r=function(){let t="";for(let i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Y,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,t){return this._transformRequestFn&&this._transformRequestFn(r,t)||{url:r}}normalizeStyleURL(r,t){if(!be(r))return r;const i=at(r);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeGlyphsURL(r,t){if(!be(r))return r;const i=at(r);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeSourceURL(r,t,i,c){if(!be(r))return r;const h=at(r);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),i&&h.params.push(`language=${i}`),c&&h.params.push(`worldview=${c}`),this._makeAPIURL(h,this._customAccessToken||t)}normalizeSpriteURL(r,t,i,c){const h=at(r);return be(r)?(h.path=`/styles/v1${h.path}/sprite${t}${i}`,this._makeAPIURL(h,this._customAccessToken||c)):(h.path+=`${t}${i}`,tt(h))}normalizeTileURL(r,t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!be(r))return r;const c=at(r);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||i&&c.authority!=="raster"&&i===512?"@2x":""}${j.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${F.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${F.TILE_URL_VERSION}${c.path}`);const h=this._customAccessToken||function(p){for(const y of p){const v=y.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(c.params)||F.ACCESS_TOKEN;return F.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,h)}canonicalizeTileURL(r,t){const i=at(r);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return r;let c="mapbox://";i.path.match(/^\/raster\/v1\//)?c+=`raster/${i.path.replace(`/${F.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${i.path.replace(`/${F.TILE_URL_VERSION}/`,"")}`;let h=i.params;return t&&(h=h.filter(p=>!p.match(/^access_token=/))),h.length&&(c+=`?${h.join("&")}`),c}canonicalizeTileset(r,t){const i=!!t&&be(t),c=[];for(const h of r.tiles||[])Me(h)?c.push(this.canonicalizeTileURL(h,i)):c.push(h);return c}_makeAPIURL(r,t){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=at(F.API_URL);if(r.protocol=c.protocol,r.authority=c.authority,r.protocol==="http"){const h=r.params.indexOf("secure");h>=0&&r.params.splice(h,1)}if(c.path!=="/"&&(r.path=`${c.path}${r.path}`),!F.REQUIRE_ACCESS_TOKEN)return tt(r);if(t=t||F.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(t[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return r.params=r.params.filter(h=>h.indexOf("access_token")===-1),r.params.push(`access_token=${t||""}`),tt(r)}},a.ResourceType=xs,a.SegmentVector=Qn,a.SourceCache=cc,a.StencilMode=zv,a.StructArrayLayout1ui2=Si,a.StructArrayLayout2f1f2i16=Pt,a.StructArrayLayout2i4=Ye,a.StructArrayLayout2ui4=xr,a.StructArrayLayout3f12=Zt,a.StructArrayLayout3ui6=wt,a.StructArrayLayout4i8=$e,a.StructArrayLayout5f20=mn,a.Texture=cf,a.Tile=Dv,a.Transitionable=N,a.Uniform1f=_m,a.Uniform1i=class extends zs{constructor(r){super(r),this.current=0}set(r,t,i){this.fetchUniformLocation(r,t)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},a.Uniform2f=class extends zs{constructor(r){super(r),this.current=[0,0]}set(r,t,i){this.fetchUniformLocation(r,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},a.Uniform3f=class extends zs{constructor(r){super(r),this.current=[0,0,0]}set(r,t,i){this.fetchUniformLocation(r,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},a.Uniform4f=Yw,a.UniformColor=Jw,a.UniformMatrix2f=class extends zs{constructor(r){super(r),this.current=s3}set(r,t,i){if(this.fetchUniformLocation(r,t)){for(let c=0;c<4;c++)if(i[c]!==this.current[c]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}}},a.UniformMatrix3f=class extends zs{constructor(r){super(r),this.current=o3}set(r,t,i){if(this.fetchUniformLocation(r,t)){for(let c=0;c<9;c++)if(i[c]!==this.current[c]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},a.UniformMatrix4f=class extends zs{constructor(r){super(r),this.current=i3}set(r,t,i){if(this.fetchUniformLocation(r,t)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let c=1;c<16;c++)if(i[c]!==this.current[c]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},a.UnwrappedTileID=iT,a.ValidationError=pt,a.VectorTileFeature=Lm,a.VectorTileWorkerSource=class extends Cl{constructor(r,t,i,c,h){super(),this.actor=r,this.layerIndex=t,this.availableImages=i,this.loadVectorData=h||pE,this.loading={},this.loaded={},this.deduped=new fE(r.scheduler),this.isSpriteLoaded=c,this.scheduler=r.scheduler}loadTile(r,t){const i=r.uid,c=r&&r.request,h=c&&c.collectResourceTiming,p=this.loading[i]=new kL(r);p.abort=this.loadVectorData(r,(y,v)=>{const b=!this.loading[i];if(delete this.loading[i],b||y||!v)return p.status="done",b||(this.loaded[i]=p),t(y);const T=v.rawData,M={};v.expires&&(M.expires=v.expires),v.cacheControl&&(M.cacheControl=v.cacheControl),p.vectorTile=v.vectorTile||new gv(new jm(T));const I=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(D,O)=>{if(D||!O)return t(D);const B={};if(h){const V=Fh(c);V.length>0&&(B.resourceTiming=JSON.parse(JSON.stringify(V)))}t(null,ln({rawTileData:T.slice(0)},O,M,B))})};this.isSpriteLoaded?I():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(I,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):I()}),this.loaded=this.loaded||{},this.loaded[i]=p})}reloadTile(r,t){const i=this.loaded,c=r.uid,h=this;if(i&&i[c]){const p=i[c];p.showCollisionBoxes=r.showCollisionBoxes,p.enableTerrain=!!r.enableTerrain,p.projection=r.projection,p.tileTransform=lc(r.tileID.canonical,r.projection);const y=(v,b)=>{const T=p.reloadCallback;T&&(delete p.reloadCallback,p.parse(p.vectorTile,h.layerIndex,this.availableImages,h.actor,T)),t(v,b)};p.status==="parsing"?p.reloadCallback=y:p.status==="done"&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(r,t){const i=r.uid,c=this.loading[i];c&&(c.abort&&c.abort(),delete this.loading[i]),t()}removeTile(r,t){const i=this.loaded,c=r.uid;i&&i[c]&&delete i[c],t()}},a.WritingMode=Vi,a.ZoomDependentExpression=Gl,a.add=Os,a.addDynamicAttributes=Xm,a.adjoint=function(r,t){var i=t[0],c=t[1],h=t[2],p=t[3],y=t[4],v=t[5],b=t[6],T=t[7],M=t[8];return r[0]=y*M-v*T,r[1]=h*T-c*M,r[2]=c*v-h*y,r[3]=v*b-p*M,r[4]=i*M-h*b,r[5]=h*p-i*v,r[6]=p*T-y*b,r[7]=c*b-i*T,r[8]=i*y-c*p,r},a.asyncAll=Nt,a.bezier=Kt,a.bindAll=Qt,a.boundsAttributes=KT,a.bufferConvexPolygon=function(r,t){const i=[];for(let c=0;c<r.length;c++){const h=yt(c-1,-1,r.length-1),p=yt(c+1,-1,r.length-1),y=r[c],v=r[p],b=r[h].sub(y).unit(),T=v.sub(y).unit(),M=T.angleWithSep(b.x,b.y),I=b.add(T).unit().mult(-1*t/Math.sin(M/2));i.push(y.add(I))}return i},a.cacheEntryPossiblyAdded=function(r){El++,El>Xc&&(r.getActor().send("enforceCacheSizeLimit",Hc),El=0)},a.calculateGlobeLabelMatrix=function(r,t){const{x:i,y:c}=r.point,h=wb(i,c,r.worldSize/r._pixelsPerMercatorPixel,0,0);return ec(h,h,Y_(rs(t)))},a.calculateGlobeMatrix=function(r){const{x:t,y:i}=r.point,{lng:c,lat:h}=r._center;return wb(t,i,r.worldSize,c,h)},a.calculateGlobeMercatorMatrix=function(r){const t=r.pixelsPerMeter,i=t/Fo(1,r.center.lat),c=Ro(new Float64Array(16));return zd(c,c,[r.point.x,r.point.y,0]),tc(c,c,[i,i,t]),Float32Array.from(c)},a.circumferenceAtLatitude=Q_,a.clamp=He,a.clearTileCache=function(r){if(!Tl())return;const t=P.caches.delete(sa);r&&t.catch(r).then(()=>r())},a.clipLine=DT,a.clone=function(r){var t=new Ci(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},a.clone$1=ai,a.collisionCircleLayout=PD,a.config=F,a.conjugate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r},a.create=function(){var r=new Ci(16);return Ci!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},a.create$1=tb,a.createExpression=Ta,a.createLayout=Ee,a.createStyleLayer=function(r){return r.type==="custom"?new _L(r):new xL[r.type](r)},a.cross=G_,a.degToRad=xt,a.distance=function(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1],t[2]-r[2])},a.div=function(r,t,i){return r[0]=t[0]/i[0],r[1]=t[1]/i[1],r[2]=t[2]/i[2],r},a.dot=oo,a.earthRadius=Gd,a.ease=st,a.easeCubicInOut=It,a.ecefToLatLng=function([r,t,i]){const c=Math.hypot(r,t,i),h=Math.atan2(r,i),p=.5*Math.PI-Math.acos(-t/c);return new yn(kt(h),kt(p))},a.emitValidationErrors=dm,a.endsWith=Sn,a.enforceCacheSizeLimit=function(r){vs(),xi&&xi.then(t=>{t.keys().then(i=>{for(let c=0;c<i.length-r;c++)t.delete(i[c])})})},a.evaluateSizeForFeature=Fm,a.evaluateSizeForZoom=Fu,a.evaluateVariableOffset=FT,a.evented=_,a.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]},a.exactEquals$1=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]},a.exported=bo,a.exported$1=j,a.extend=ln,a.extend$1=Eo,a.fillExtrusionHeightLift=tT,a.filterObject=xo,a.fromMat4=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[4],r[4]=t[5],r[5]=t[6],r[6]=t[8],r[7]=t[9],r[8]=t[10],r},a.fromQuat=function(r,t){var i=t[0],c=t[1],h=t[2],p=t[3],y=i+i,v=c+c,b=h+h,T=i*y,M=c*y,I=c*v,D=h*y,O=h*v,B=h*b,V=p*y,q=p*v,ie=p*b;return r[0]=1-I-B,r[1]=M+ie,r[2]=D-q,r[3]=0,r[4]=M-ie,r[5]=1-T-B,r[6]=O+V,r[7]=0,r[8]=D+q,r[9]=O-V,r[10]=1-T-I,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},a.fromRotation=function(r,t){var i=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=i,r[2]=0,r[3]=-i,r[4]=c,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},a.fromScaling=rb,a.furthestTileCorner=function(r){const t=Math.round((r+45+360)%360/90)%4;return lt[t]},a.getAABBPointSquareDist=function(r,t,i){let c=0;for(let h=0;h<2;++h){const p=i?i[h]:0;r[h]>p&&(c+=(r[h]-p)*(r[h]-p)),t[h]<p&&(c+=(p-t[h])*(p-t[h]))}return c},a.getAnchorAlignment=Tv,a.getAnchorJustification=Cv,a.getBounds=function(r){let t=1/0,i=1/0,c=-1/0,h=-1/0;for(const p of r)t=Math.min(t,p.x),i=Math.min(i,p.y),c=Math.max(c,p.x),h=Math.max(h,p.y);return{min:new Te(t,i),max:new Te(c,h)}},a.getColumn=Ko,a.getDefaultExportFromCjs=fe,a.getGridMatrix=function(r,t,i,c){const h=t.getNorth(),p=t.getSouth(),y=t.getWest(),v=t.getEast(),b=1<<r.z,T=v-y,M=h-p,I=T/rc,D=-M/Ud[i],O=[0,I,0,D,0,0,h,y,0];if(r.z>0){const B=180/c;nb(O,O,[B/T+1,0,0,0,B/M+1,0,-.5*B/I,.5*B/D,1])}return O[2]=b,O[5]=r.x,O[8]=r.y,O},a.getImage=ce,a.getJSON=function(r,t){return bs(ln(r,{type:"json"}),t)},a.getLatitudinalLod=function(r){const t=Fr-5;r=He(r,-t,t)/t*90;const i=Math.pow(Math.abs(Math.sin(xt(r))),3);return Math.round(i*(Ud.length-1))},a.getMapSessionAPI=yr,a.getPerformanceMeasurement=Fh,a.getProjection=WT,a.getRTLTextPluginStatus=w,a.getReferrer=ws,a.getTilePoint=function(r,{x:t,y:i},c=0){return new Te(((t-c)*r.scale-r.x)*Ct,(i*r.scale-r.y)*Ct)},a.getTileVec3=function(r,t,i=0){return Mu(((t.x-i)*r.scale-r.x)*Ct,(t.y*r.scale-r.y)*Ct,Sb(t.z,t.y))},a.getVideo=function(r,t){const i=P.document.createElement("video");i.muted=!0,i.onloadstart=function(){t(null,i)};for(let c=0;c<r.length;c++){const h=P.document.createElement("source");Kc(r[c])||(i.crossOrigin="Anonymous"),h.src=r[c],i.appendChild(h)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(r){const t=[0,0,0],i=Ro(new Float64Array(16));return ec(i,r.pixelMatrix,r.globeMatrix),qn(t,t,i),new Te(t[0],t[1])},a.globeDenormalizeECEF=Y_,a.globeECEFOrigin=function(r,t){const i=[0,0,0];return qn(i,i,$d(rs(t.canonical))),qn(i,i,r),i},a.globeMetersToEcef=wm,a.globeNormalizeECEF=$d,a.globePixelsToTileUnits=function(r,t){return Ct/(512*Math.pow(2,r))*Tm(rs(t))},a.globePoleMatrixForTile=function(r,t,i){const c=Ro(new Float64Array(16)),h=(t/(1<<r)-.5)*Math.PI*2;return xm(c,i.globeMatrix,h),Float32Array.from(c)},a.globeTileBounds=rs,a.globeTiltAtLngLat=bb,a.globeToMercatorTransition=Au,a.globeUseCustomAntiAliasing=function(r,t,i){const c=Au(i.zoom),h=r.style.map._antialias,p=!!t.extStandardDerivatives,y=t.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return c===0&&!h&&!y&&p},a.identity=Ro,a.identity$1=hb,a.invert=N_,a.isFullscreen=function(){return!!P.document.fullscreenElement||!!P.document.webkitFullscreenElement},a.isLngLatBehindGlobe=J_,a.isMapAuthenticated=function(r){return Ur.has(r)},a.isMapboxURL=be,a.isSafariWithAntialiasingBug=function(r){const t=r.navigator?r.navigator.userAgent:null;return!!oa(r)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=Or,a.latLngToECEF=Iu,a.len=m3,a.length=Rd,a.length$1=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},a.lngFromMercatorX=Ui,a.loadVectorTile=pE,a.makeRequest=bs,a.mapValue=function(r,t,i,c,h){return He((r-t)/(i-t)*(h-c)+c,c,h)},a.mercatorScale=Cb,a.mercatorXfromLng=is,a.mercatorYfromLat=os,a.mercatorZfromAltitude=Fo,a.mul=f3,a.mul$1=p3,a.multiply=ec,a.multiply$1=nb,a.multiply$2=sb,a.nextPowerOfTwo=si,a.normalize=Kr,a.normalize$1=g3,a.normalize$2=cb,a.number=en,a.ortho=function(r,t,i,c,h,p,y){var v=1/(t-i),b=1/(c-h),T=1/(p-y);return r[0]=-2*v,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*T,r[11]=0,r[12]=(t+i)*v,r[13]=(h+c)*b,r[14]=(y+p)*T,r[15]=1,r},a.pbf=hT,a.perspective=function(r,t,i,c,h){var p,y=1/Math.tan(t/2);return r[0]=y/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=y,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,h!=null&&h!==1/0?(r[10]=(h+c)*(p=1/(c-h)),r[14]=2*h*c*p):(r[10]=-1,r[14]=-2*c),r},a.pick=function(r,t){const i={};for(let c=0;c<t.length;c++){const h=t[c];h in r&&(i[h]=r[h])}return i},a.plugin=C,a.pointGeometry=je,a.polesInViewport=function(r){const t=Ro(new Float64Array(16));ec(t,r.pixelMatrix,r.globeMatrix);const i=[0,so,0],c=[0,ao,0];return qn(i,i,t),qn(c,c,t),[i[0]>0&&i[0]<=r.width&&i[1]>0&&i[1]<=r.height&&!J_(r,new yn(r.center.lat,90)),c[0]>0&&c[0]<=r.width&&c[1]>0&&c[1]<=r.height&&!J_(r,new yn(r.center.lat,-90))]},a.polygonContainsPoint=sc,a.polygonIntersectsBox=Lb,a.polygonIntersectsPolygon=kb,a.polygonizeBounds=function(r,t,i=0,c=!0){const h=new Te(i,i),p=r.sub(h),y=t.add(h),v=[p,new Te(y.x,p.y),y,new Te(p.x,y.y)];return c&&v.push(p.clone()),v},a.posAttributes=Nd,a.postMapLoadEvent=Kn,a.postPerformanceEvent=hr,a.postTurnstileEvent=Jt,a.potpack=xv,a.prevPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},a.radToDeg=kt,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(r){return r({pluginStatus:f,pluginURL:o}),_.on("pluginStateChange",r),r},a.removeAuthState=function(r){Ur.delete(r)},a.renderColorRamp=av,a.resample=Pb,a.rotateX=U_,a.rotateX$1=db,a.rotateY=xm,a.rotateY$1=fb,a.rotateZ=function(r,t,i){var c=Math.sin(i),h=Math.cos(i),p=t[0],y=t[1],v=t[2],b=t[3],T=t[4],M=t[5],I=t[6],D=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=p*h+T*c,r[1]=y*h+M*c,r[2]=v*h+I*c,r[3]=b*h+D*c,r[4]=T*h-p*c,r[5]=M*h-y*c,r[6]=I*h-v*c,r[7]=D*h-b*c,r},a.rotateZ$1=function(r,t,i){i*=.5;var c=t[0],h=t[1],p=t[2],y=t[3],v=Math.sin(i),b=Math.cos(i);return r[0]=c*b+h*v,r[1]=h*b-c*v,r[2]=p*b+y*v,r[3]=y*b-p*v,r},a.scale=tc,a.scale$1=lb,a.scale$2=Ni,a.scaleAndAdd=Bd,a.set=function(r,t,i,c){return r[0]=t,r[1]=i,r[2]=c,r},a.setCacheLimits=function(r,t){Hc=r,Xc=t},a.setColumn=function(r,t,i){r[4*t+0]=i[0],r[4*t+1]=i[1],r[4*t+2]=i[2],r[4*t+3]=i[3]},a.setRTLTextPlugin=function(r,t,i=!1){if(f===kd||f===Id||f===Ad)throw new Error("setRTLTextPlugin cannot be called multiple times.");o=bo.resolveURL(r),f=kd,Pa=t,m(),i||S()},a.smoothstep=bt,a.spec=Be,a.squaredLength=function(r){var t=r[0],i=r[1],c=r[2];return t*t+i*i+c*c},a.storeAuthState=function(r,t){t?Ur.add(r):Ur.delete(r)},a.sub=Oo,a.subtract=$_,a.symbolSize=MD,a.tileAABB=function(r,t,i,c,h,p,y,v,b){if(b.name==="globe")return w3(r,t,new Rm(i,c,h));const T=lc({z:i,x:c,y:h},b);return new Yr([(p+T.x/T.scale)*t,t*(T.y/T.scale),y],[(p+T.x2/T.scale)*t,t*(T.y2/T.scale),v])},a.tileCornersToBounds=bm,a.tileTransform=lc,a.transformMat3=function(r,t,i){var c=t[0],h=t[1],p=t[2];return r[0]=c*i[0]+h*i[3]+p*i[6],r[1]=c*i[1]+h*i[4]+p*i[7],r[2]=c*i[2]+h*i[5]+p*i[8],r},a.transformMat4=qn,a.transformMat4$1=nc,a.transformQuat=ab,a.transitionTileAABBinECEF=_b,a.translate=zd,a.transpose=function(r,t){if(r===t){var i=t[1],c=t[2],h=t[5];r[1]=t[3],r[2]=t[6],r[3]=i,r[5]=t[7],r[6]=c,r[7]=h}else r[0]=t[0],r[1]=t[3],r[2]=t[6],r[3]=t[1],r[4]=t[4],r[5]=t[7],r[6]=t[2],r[7]=t[5],r[8]=t[8];return r},a.triggerPluginCompletionEvent=u,a.uniqueId=Wn,a.updateGlobeVertexNormal=function(r,t,i,c,h){const p=5*t+2;r.float32[p+0]=i,r.float32[p+1]=c,r.float32[p+2]=h},a.validateCustomStyleLayer=function(r){const t=[],i=r.id;return i===void 0&&t.push({message:`layers.${i}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${i}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},a.validateFilter=r=>Ei(Xl(r)),a.validateFog=r=>Ei(cm(r)),a.validateLayer=r=>Ei(om(r)),a.validateLight=r=>Ei(lm(r)),a.validateSource=r=>Ei(am(r)),a.validateStyle=hm,a.validateTerrain=r=>Ei(Ed(r)),a.values=ur,a.vectorTile=Dm,a.version=A,a.warnOnce=Rn,a.window=P,a.wrap=yt}),x(["./shared"],function(a){function P(he){if(typeof he=="number"||typeof he=="boolean"||typeof he=="string"||he==null)return JSON.stringify(he);if(Array.isArray(he)){let G="[";for(const ce of he)G+=`${P(ce)},`;return`${G}]`}let $="{";for(const G of Object.keys(he).sort())$+=`${G}:${P(he[G])},`;return`${$}}`}function A(he){let $="";for(const G of a.refProperties)$+=`/${P(he[G])}`;return $}class R{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,G){for(const ge of $)this._layerConfigs[ge.id]=ge,(this._layers[ge.id]=a.createStyleLayer(ge)).compileFilter(),this.keyCache[ge.id]&&delete this.keyCache[ge.id];for(const ge of G)delete this.keyCache[ge],delete this._layerConfigs[ge],delete this._layers[ge];this.familiesBySource={};const ce=function(ge,be){const Me={};for(let we=0;we<ge.length;we++){const Oe=be&&be[ge[we].id]||A(ge[we]);be&&(be[ge[we].id]=Oe);let ot=Me[Oe];ot||(ot=Me[Oe]=[]),ot.push(ge[we])}const Pe=[];for(const we in Me)Pe.push(Me[we]);return Pe}(a.values(this._layerConfigs),this.keyCache);for(const ge of ce){const be=ge.map(at=>this._layers[at.id]),Me=be[0];if(Me.visibility==="none")continue;const Pe=Me.source||"";let we=this.familiesBySource[Pe];we||(we=this.familiesBySource[Pe]={});const Oe=Me.sourceLayer||"_geojsonTileLayer";let ot=we[Oe];ot||(ot=we[Oe]=[]),ot.push(be)}}}class F{loadTile($,G){const{uid:ce,encoding:ge,rawImageData:be,padding:Me,buildQuadTree:Pe}=$,we=a.window.ImageBitmap&&be instanceof a.window.ImageBitmap?this.getImageData(be,Me):be;G(null,new a.DEMData(ce,we,ge,Me<1,Pe))}getImageData($,G){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas($.width,$.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=$.width,this.offscreenCanvas.height=$.height,this.offscreenCanvasContext.drawImage($,0,0,$.width,$.height);const ce=this.offscreenCanvasContext.getImageData(-G,-G,$.width+2*G,$.height+2*G);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ce}}function j(he,$){if(he.length!==0){Z(he[0],$);for(var G=1;G<he.length;G++)Z(he[G],!$)}}function Z(he,$){for(var G=0,ce=0,ge=0,be=he.length,Me=be-1;ge<be;Me=ge++){var Pe=(he[ge][0]-he[Me][0])*(he[Me][1]+he[ge][1]),we=G+Pe;ce+=Math.abs(G)>=Math.abs(Pe)?G-we+Pe:Pe-we+G,G=we}G+ce>=0!=!!$&&he.reverse()}var se=a.getDefaultExportFromCjs(function he($,G){var ce,ge=$&&$.type;if(ge==="FeatureCollection")for(ce=0;ce<$.features.length;ce++)he($.features[ce],G);else if(ge==="GeometryCollection")for(ce=0;ce<$.geometries.length;ce++)he($.geometries[ce],G);else if(ge==="Feature")he($.geometry,G);else if(ge==="Polygon")j($.coordinates,G);else if(ge==="MultiPolygon")for(ce=0;ce<$.coordinates.length;ce++)j($.coordinates[ce],G);return $});const ve=a.VectorTileFeature.prototype.toGeoJSON;var X={exports:{}},H=a.pointGeometry,Y=a.vectorTile.VectorTileFeature,fe=Ce;function Ce(he,$){this.options=$||{},this.features=he,this.length=he.length}function Ue(he,$){this.id=typeof he.id=="number"?he.id:void 0,this.type=he.type,this.rawGeometry=he.type===1?[he.geometry]:he.geometry,this.properties=he.tags,this.extent=$||4096}Ce.prototype.feature=function(he){return new Ue(this.features[he],this.options.extent)},Ue.prototype.loadGeometry=function(){var he=this.rawGeometry;this.geometry=[];for(var $=0;$<he.length;$++){for(var G=he[$],ce=[],ge=0;ge<G.length;ge++)ce.push(new H(G[ge][0],G[ge][1]));this.geometry.push(ce)}return this.geometry},Ue.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var he=this.geometry,$=1/0,G=-1/0,ce=1/0,ge=-1/0,be=0;be<he.length;be++)for(var Me=he[be],Pe=0;Pe<Me.length;Pe++){var we=Me[Pe];$=Math.min($,we.x),G=Math.max(G,we.x),ce=Math.min(ce,we.y),ge=Math.max(ge,we.y)}return[$,ce,G,ge]},Ue.prototype.toGeoJSON=Y.prototype.toGeoJSON;var Ge=a.pbf,je=fe;function nt(he){var $=new Ge;return function(G,ce){for(var ge in G.layers)ce.writeMessage(3,Te,G.layers[ge])}(he,$),$.finish()}function Te(he,$){var G;$.writeVarintField(15,he.version||1),$.writeStringField(1,he.name||""),$.writeVarintField(5,he.extent||4096);var ce={keys:[],values:[],keycache:{},valuecache:{}};for(G=0;G<he.length;G++)ce.feature=he.feature(G),$.writeMessage(2,mt,ce);var ge=ce.keys;for(G=0;G<ge.length;G++)$.writeStringField(3,ge[G]);var be=ce.values;for(G=0;G<be.length;G++)$.writeMessage(4,It,be[G])}function mt(he,$){var G=he.feature;G.id!==void 0&&$.writeVarintField(1,G.id),$.writeMessage(2,Dt,he),$.writeVarintField(3,G.type),$.writeMessage(4,lt,G)}function Dt(he,$){var G=he.feature,ce=he.keys,ge=he.values,be=he.keycache,Me=he.valuecache;for(var Pe in G.properties){var we=G.properties[Pe],Oe=be[Pe];if(we!==null){Oe===void 0&&(ce.push(Pe),be[Pe]=Oe=ce.length-1),$.writeVarint(Oe);var ot=typeof we;ot!=="string"&&ot!=="boolean"&&ot!=="number"&&(we=JSON.stringify(we));var at=ot+":"+we,tt=Me[at];tt===void 0&&(ge.push(we),Me[at]=tt=ge.length-1),$.writeVarint(tt)}}}function xt(he,$){return($<<3)+(7&he)}function kt(he){return he<<1^he>>31}function lt(he,$){for(var G=he.loadGeometry(),ce=he.type,ge=0,be=0,Me=G.length,Pe=0;Pe<Me;Pe++){var we=G[Pe],Oe=1;ce===1&&(Oe=we.length),$.writeVarint(xt(1,Oe));for(var ot=ce===3?we.length-1:we.length,at=0;at<ot;at++){at===1&&ce!==1&&$.writeVarint(xt(2,ot-1));var tt=we[at].x-ge,Ot=we[at].y-be;$.writeVarint(kt(tt)),$.writeVarint(kt(Ot)),ge+=tt,be+=Ot}ce===3&&$.writeVarint(xt(7,1))}}function It(he,$){var G=typeof he;G==="string"?$.writeStringField(1,he):G==="boolean"?$.writeBooleanField(7,he):G==="number"&&(he%1!=0?$.writeDoubleField(3,he):he<0?$.writeSVarintField(6,he):$.writeVarintField(5,he))}X.exports=nt,X.exports.fromVectorTileJs=nt,X.exports.fromGeojsonVt=function(he,$){$=$||{};var G={};for(var ce in he)G[ce]=new je(he[ce].features,$),G[ce].name=ce,G[ce].version=$.version,G[ce].extent=$.extent;return nt({layers:G})},X.exports.GeoJSONWrapper=je;var Kt=a.getDefaultExportFromCjs(X.exports);const st={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:he=>he},He=Math.fround||(bt=new Float32Array(1),he=>(bt[0]=+he,bt[0]));var bt;const yt=3,Nt=5,ur=6;class ln{constructor($){this.options=Object.assign(Object.create(st),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){const{log:G,minZoom:ce,maxZoom:ge}=this.options;G&&console.time("total time");const be=`prepare ${$.length} points`;G&&console.time(be),this.points=$;const Me=[];for(let we=0;we<$.length;we++){const Oe=$[we];if(!Oe.geometry)continue;const[ot,at]=Oe.geometry.coordinates,tt=He(Xn(ot)),Ot=He(si(at));Me.push(tt,Ot,1/0,we,-1,1),this.options.reduce&&Me.push(0)}let Pe=this.trees[ge+1]=this._createTree(Me);G&&console.timeEnd(be);for(let we=ge;we>=ce;we--){const Oe=+Date.now();Pe=this.trees[we]=this._createTree(this._cluster(Pe,we)),G&&console.log("z%d: %d clusters in %dms",we,Pe.numItems,+Date.now()-Oe)}return G&&console.timeEnd("total time"),this}getClusters($,G){let ce=(($[0]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,$[1]));let be=$[2]===180?180:(($[2]+180)%360+360)%360-180;const Me=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)ce=-180,be=180;else if(ce>be){const at=this.getClusters([ce,ge,180,Me],G),tt=this.getClusters([-180,ge,be,Me],G);return at.concat(tt)}const Pe=this.trees[this._limitZoom(G)],we=Pe.range(Xn(ce),si(Me),Xn(be),si(ge)),Oe=Pe.data,ot=[];for(const at of we){const tt=this.stride*at;ot.push(Oe[tt+Nt]>1?pr(Oe,tt,this.clusterProps):this.points[Oe[tt+yt]])}return ot}getChildren($){const G=this._getOriginId($),ce=this._getOriginZoom($),ge="No cluster with the specified id.",be=this.trees[ce];if(!be)throw new Error(ge);const Me=be.data;if(G*this.stride>=Me.length)throw new Error(ge);const Pe=this.options.radius/(this.options.extent*Math.pow(2,ce-1)),we=be.within(Me[G*this.stride],Me[G*this.stride+1],Pe),Oe=[];for(const ot of we){const at=ot*this.stride;Me[at+4]===$&&Oe.push(Me[at+Nt]>1?pr(Me,at,this.clusterProps):this.points[Me[at+yt]])}if(Oe.length===0)throw new Error(ge);return Oe}getLeaves($,G,ce){const ge=[];return this._appendLeaves(ge,$,G=G||10,ce=ce||0,0),ge}getTile($,G,ce){const ge=this.trees[this._limitZoom($)],be=Math.pow(2,$),{extent:Me,radius:Pe}=this.options,we=Pe/Me,Oe=(ce-we)/be,ot=(ce+1+we)/be,at={features:[]};return this._addTileFeatures(ge.range((G-we)/be,Oe,(G+1+we)/be,ot),ge.data,G,ce,be,at),G===0&&this._addTileFeatures(ge.range(1-we/be,Oe,1,ot),ge.data,be,ce,be,at),G===be-1&&this._addTileFeatures(ge.range(0,Oe,we/be,ot),ge.data,-1,ce,be,at),at.features.length?at:null}getClusterExpansionZoom($){let G=this._getOriginZoom($)-1;for(;G<=this.options.maxZoom;){const ce=this.getChildren($);if(G++,ce.length!==1)break;$=ce[0].properties.cluster_id}return G}_appendLeaves($,G,ce,ge,be){const Me=this.getChildren(G);for(const Pe of Me){const we=Pe.properties;if(we&&we.cluster?be+we.point_count<=ge?be+=we.point_count:be=this._appendLeaves($,we.cluster_id,ce,ge,be):be<ge?be++:$.push(Pe),$.length===ce)break}return be}_createTree($){const G=new a.KDBush($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ce=0;ce<$.length;ce+=this.stride)G.add($[ce],$[ce+1]);return G.finish(),G.data=$,G}_addTileFeatures($,G,ce,ge,be,Me){for(const Pe of $){const we=Pe*this.stride,Oe=G[we+Nt]>1;let ot,at,tt;if(Oe)ot=Wn(G,we,this.clusterProps),at=G[we],tt=G[we+1];else{const Ft=this.points[G[we+yt]];ot=Ft.properties;const[Wt,Jt]=Ft.geometry.coordinates;at=Xn(Wt),tt=si(Jt)}const Ot={type:1,geometry:[[Math.round(this.options.extent*(at*be-ce)),Math.round(this.options.extent*(tt*be-ge))]],tags:ot};let Gt;Gt=Oe||this.options.generateId?G[we+yt]:this.points[G[we+yt]].id,Gt!==void 0&&(Ot.id=Gt),Me.features.push(Ot)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,G){const{radius:ce,extent:ge,reduce:be,minPoints:Me}=this.options,Pe=ce/(ge*Math.pow(2,G)),we=$.data,Oe=[],ot=this.stride;for(let at=0;at<we.length;at+=ot){if(we[at+2]<=G)continue;we[at+2]=G;const tt=we[at],Ot=we[at+1],Gt=$.within(we[at],we[at+1],Pe),Ft=we[at+Nt];let Wt=Ft;for(const Jt of Gt){const On=Jt*ot;we[On+2]>G&&(Wt+=we[On+Nt])}if(Wt>Ft&&Wt>=Me){let Jt,On=tt*Ft,Kn=Ot*Ft,Lr=-1;const hr=((at/ot|0)<<5)+(G+1)+this.points.length;for(const Ji of Gt){const yr=Ji*ot;if(we[yr+2]<=G)continue;we[yr+2]=G;const Ur=we[yr+Nt];On+=we[yr]*Ur,Kn+=we[yr+1]*Ur,we[yr+4]=hr,be&&(Jt||(Jt=this._map(we,at,!0),Lr=this.clusterProps.length,this.clusterProps.push(Jt)),be(Jt,this._map(we,yr)))}we[at+4]=hr,Oe.push(On/Wt,Kn/Wt,1/0,hr,-1,Wt),be&&Oe.push(Lr)}else{for(let Jt=0;Jt<ot;Jt++)Oe.push(we[at+Jt]);if(Wt>1)for(const Jt of Gt){const On=Jt*ot;if(!(we[On+2]<=G)){we[On+2]=G;for(let Kn=0;Kn<ot;Kn++)Oe.push(we[On+Kn])}}}}return Oe}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,G,ce){if($[G+Nt]>1){const Me=this.clusterProps[$[G+ur]];return ce?Object.assign({},Me):Me}const ge=this.points[$[G+yt]].properties,be=this.options.map(ge);return ce&&be===ge?Object.assign({},be):be}}function pr(he,$,G){return{type:"Feature",id:he[$+yt],properties:Wn(he,$,G),geometry:{type:"Point",coordinates:[(ce=he[$],360*(ce-.5)),$t(he[$+1])]}};var ce}function Wn(he,$,G){const ce=he[$+Nt],ge=ce>=1e4?`${Math.round(ce/1e3)}k`:ce>=1e3?Math.round(ce/100)/10+"k":ce,be=he[$+ur],Me=be===-1?{}:Object.assign({},G[be]);return Object.assign(Me,{cluster:!0,cluster_id:he[$+yt],point_count:ce,point_count_abbreviated:ge})}function Xn(he){return he/360+.5}function si(he){const $=Math.sin(he*Math.PI/180),G=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return G<0?0:G>1?1:G}function $t(he){const $=(180-360*he)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function Qt(he,$,G,ce){for(var ge,be=ce,Me=G-$>>1,Pe=G-$,we=he[$],Oe=he[$+1],ot=he[G],at=he[G+1],tt=$+3;tt<G;tt+=3){var Ot=Sn(he[tt],he[tt+1],we,Oe,ot,at);if(Ot>be)ge=tt,be=Ot;else if(Ot===be){var Gt=Math.abs(tt-Me);Gt<Pe&&(ge=tt,Pe=Gt)}}be>ce&&(ge-$>3&&Qt(he,$,ge,ce),he[ge+2]=be,G-ge>3&&Qt(he,ge,G,ce))}function Sn(he,$,G,ce,ge,be){var Me=ge-G,Pe=be-ce;if(Me!==0||Pe!==0){var we=((he-G)*Me+($-ce)*Pe)/(Me*Me+Pe*Pe);we>1?(G=ge,ce=be):we>0&&(G+=Me*we,ce+=Pe*we)}return(Me=he-G)*Me+(Pe=$-ce)*Pe}function Vt(he,$,G,ce){var ge={id:he===void 0?null:he,type:$,geometry:G,tags:ce,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(be){var Me=be.geometry,Pe=be.type;if(Pe==="Point"||Pe==="MultiPoint"||Pe==="LineString")xo(be,Me);else if(Pe==="Polygon"||Pe==="MultiLineString")for(var we=0;we<Me.length;we++)xo(be,Me[we]);else if(Pe==="MultiPolygon")for(we=0;we<Me.length;we++)for(var Oe=0;Oe<Me[we].length;Oe++)xo(be,Me[we][Oe])}(ge),ge}function xo(he,$){for(var G=0;G<$.length;G+=3)he.minX=Math.min(he.minX,$[G]),he.minY=Math.min(he.minY,$[G+1]),he.maxX=Math.max(he.maxX,$[G]),he.maxY=Math.max(he.maxY,$[G+1])}function ai(he,$,G,ce){if($.geometry){var ge=$.geometry.coordinates,be=$.geometry.type,Me=Math.pow(G.tolerance/((1<<G.maxZoom)*G.extent),2),Pe=[],we=$.id;if(G.promoteId?we=$.properties[G.promoteId]:G.generateId&&(we=ce||0),be==="Point")xl(ge,Pe);else if(be==="MultiPoint")for(var Oe=0;Oe<ge.length;Oe++)xl(ge[Oe],Pe);else if(be==="LineString")Rn(ge,Pe,Me,!1);else if(be==="MultiLineString"){if(G.lineMetrics){for(Oe=0;Oe<ge.length;Oe++)Rn(ge[Oe],Pe=[],Me,!1),he.push(Vt(we,"LineString",Pe,$.properties));return}vi(ge,Pe,Me,!1)}else if(be==="Polygon")vi(ge,Pe,Me,!0);else{if(be!=="MultiPolygon"){if(be==="GeometryCollection"){for(Oe=0;Oe<$.geometry.geometries.length;Oe++)ai(he,{id:we,geometry:$.geometry.geometries[Oe],properties:$.properties},G,ce);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Oe=0;Oe<ge.length;Oe++){var ot=[];vi(ge[Oe],ot,Me,!0),Pe.push(ot)}}he.push(Vt(we,be,Pe,$.properties))}}function xl(he,$){$.push(qc(he[0])),$.push(wo(he[1])),$.push(0)}function Rn(he,$,G,ce){for(var ge,be,Me=0,Pe=0;Pe<he.length;Pe++){var we=qc(he[Pe][0]),Oe=wo(he[Pe][1]);$.push(we),$.push(Oe),$.push(0),Pe>0&&(Me+=ce?(ge*Oe-we*be)/2:Math.sqrt(Math.pow(we-ge,2)+Math.pow(Oe-be,2))),ge=we,be=Oe}var ot=$.length-3;$[2]=1,Qt($,0,ot,G),$[ot+2]=1,$.size=Math.abs(Me),$.start=0,$.end=$.size}function vi(he,$,G,ce){for(var ge=0;ge<he.length;ge++){var be=[];Rn(he[ge],be,G,ce),$.push(be)}}function qc(he){return he/360+.5}function wo(he){var $=Math.sin(he*Math.PI/180),G=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return G<0?0:G>1?1:G}function li(he,$,G,ce,ge,be,Me,Pe){if(ce/=$,be>=(G/=$)&&Me<ce)return he;if(Me<G||be>=ce)return null;for(var we=[],Oe=0;Oe<he.length;Oe++){var ot=he[Oe],at=ot.geometry,tt=ot.type,Ot=ge===0?ot.minX:ot.minY,Gt=ge===0?ot.maxX:ot.maxY;if(Ot>=G&&Gt<ce)we.push(ot);else if(!(Gt<G||Ot>=ce)){var Ft=[];if(tt==="Point"||tt==="MultiPoint")wl(at,Ft,G,ce,ge);else if(tt==="LineString")oa(at,Ft,G,ce,ge,!1,Pe.lineMetrics);else if(tt==="MultiLineString")Ko(at,Ft,G,ce,ge,!1);else if(tt==="Polygon")Ko(at,Ft,G,ce,ge,!0);else if(tt==="MultiPolygon")for(var Wt=0;Wt<at.length;Wt++){var Jt=[];Ko(at[Wt],Jt,G,ce,ge,!0),Jt.length&&Ft.push(Jt)}if(Ft.length){if(Pe.lineMetrics&&tt==="LineString"){for(Wt=0;Wt<Ft.length;Wt++)we.push(Vt(ot.id,tt,Ft[Wt],ot.tags));continue}tt!=="LineString"&&tt!=="MultiLineString"||(Ft.length===1?(tt="LineString",Ft=Ft[0]):tt="MultiLineString"),tt!=="Point"&&tt!=="MultiPoint"||(tt=Ft.length===3?"Point":"MultiPoint"),we.push(Vt(ot.id,tt,Ft,ot.tags))}}}return we.length?we:null}function wl(he,$,G,ce,ge){for(var be=0;be<he.length;be+=3){var Me=he[be+ge];Me>=G&&Me<=ce&&($.push(he[be]),$.push(he[be+1]),$.push(he[be+2]))}}function oa(he,$,G,ce,ge,be,Me){for(var Pe,we,Oe=bl(he),ot=ge===0?Hc:Xc,at=he.start,tt=0;tt<he.length-3;tt+=3){var Ot=he[tt],Gt=he[tt+1],Ft=he[tt+2],Wt=he[tt+3],Jt=he[tt+4],On=ge===0?Ot:Gt,Kn=ge===0?Wt:Jt,Lr=!1;Me&&(Pe=Math.sqrt(Math.pow(Ot-Wt,2)+Math.pow(Gt-Jt,2))),On<G?Kn>G&&(we=ot(Oe,Ot,Gt,Wt,Jt,G),Me&&(Oe.start=at+Pe*we)):On>ce?Kn<ce&&(we=ot(Oe,Ot,Gt,Wt,Jt,ce),Me&&(Oe.start=at+Pe*we)):sa(Oe,Ot,Gt,Ft),Kn<G&&On>=G&&(we=ot(Oe,Ot,Gt,Wt,Jt,G),Lr=!0),Kn>ce&&On<=ce&&(we=ot(Oe,Ot,Gt,Wt,Jt,ce),Lr=!0),!be&&Lr&&(Me&&(Oe.end=at+Pe*we),$.push(Oe),Oe=bl(he)),Me&&(at+=Pe)}var hr=he.length-3;Ot=he[hr],Gt=he[hr+1],Ft=he[hr+2],(On=ge===0?Ot:Gt)>=G&&On<=ce&&sa(Oe,Ot,Gt,Ft),hr=Oe.length-3,be&&hr>=3&&(Oe[hr]!==Oe[0]||Oe[hr+1]!==Oe[1])&&sa(Oe,Oe[0],Oe[1],Oe[2]),Oe.length&&$.push(Oe)}function bl(he){var $=[];return $.size=he.size,$.start=he.start,$.end=he.end,$}function Ko(he,$,G,ce,ge,be){for(var Me=0;Me<he.length;Me++)oa(he[Me],$,G,ce,ge,be,!1)}function sa(he,$,G,ce){he.push($),he.push(G),he.push(ce)}function Hc(he,$,G,ce,ge,be){var Me=(be-$)/(ce-$);return he.push(be),he.push(G+(ge-G)*Me),he.push(1),Me}function Xc(he,$,G,ce,ge,be){var Me=(be-G)/(ge-G);return he.push($+(ce-$)*Me),he.push(be),he.push(1),Me}function xi(he,$){for(var G=[],ce=0;ce<he.length;ce++){var ge,be=he[ce],Me=be.type;if(Me==="Point"||Me==="MultiPoint"||Me==="LineString")ge=Yo(be.geometry,$);else if(Me==="MultiLineString"||Me==="Polygon"){ge=[];for(var Pe=0;Pe<be.geometry.length;Pe++)ge.push(Yo(be.geometry[Pe],$))}else if(Me==="MultiPolygon")for(ge=[],Pe=0;Pe<be.geometry.length;Pe++){for(var we=[],Oe=0;Oe<be.geometry[Pe].length;Oe++)we.push(Yo(be.geometry[Pe][Oe],$));ge.push(we)}G.push(Vt(be.id,Me,ge,be.tags))}return G}function Yo(he,$){var G=[];G.size=he.size,he.start!==void 0&&(G.start=he.start,G.end=he.end);for(var ce=0;ce<he.length;ce+=3)G.push(he[ce]+$,he[ce+1],he[ce+2]);return G}function Tl(he,$){if(he.transformed)return he;var G,ce,ge,be=1<<he.z,Me=he.x,Pe=he.y;for(G=0;G<he.features.length;G++){var we=he.features[G],Oe=we.geometry,ot=we.type;if(we.geometry=[],ot===1)for(ce=0;ce<Oe.length;ce+=2)we.geometry.push(vs(Oe[ce],Oe[ce+1],$,be,Me,Pe));else for(ce=0;ce<Oe.length;ce++){var at=[];for(ge=0;ge<Oe[ce].length;ge+=2)at.push(vs(Oe[ce][ge],Oe[ce][ge+1],$,be,Me,Pe));we.geometry.push(at)}}return he.transformed=!0,he}function vs(he,$,G,ce,ge,be){return[Math.round(G*(he*ce-ge)),Math.round(G*($*ce-be))]}function aa(he,$,G,ce,ge){for(var be=$===ge.maxZoom?0:ge.tolerance/((1<<$)*ge.extent),Me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:G,y:ce,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Pe=0;Pe<he.length;Pe++){Me.numFeatures++,El(Me,he[Pe],be,ge);var we=he[Pe].minX,Oe=he[Pe].minY,ot=he[Pe].maxX,at=he[Pe].maxY;we<Me.minX&&(Me.minX=we),Oe<Me.minY&&(Me.minY=Oe),ot>Me.maxX&&(Me.maxX=ot),at>Me.maxY&&(Me.maxY=at)}return Me}function El(he,$,G,ce){var ge=$.geometry,be=$.type,Me=[];if(be==="Point"||be==="MultiPoint")for(var Pe=0;Pe<ge.length;Pe+=3)Me.push(ge[Pe]),Me.push(ge[Pe+1]),he.numPoints++,he.numSimplified++;else if(be==="LineString")xs(Me,ge,he,G,!1,!1);else if(be==="MultiLineString"||be==="Polygon")for(Pe=0;Pe<ge.length;Pe++)xs(Me,ge[Pe],he,G,be==="Polygon",Pe===0);else if(be==="MultiPolygon")for(var we=0;we<ge.length;we++){var Oe=ge[we];for(Pe=0;Pe<Oe.length;Pe++)xs(Me,Oe[Pe],he,G,!0,Pe===0)}if(Me.length){var ot=$.tags||null;if(be==="LineString"&&ce.lineMetrics){for(var at in ot={},$.tags)ot[at]=$.tags[at];ot.mapbox_clip_start=ge.start/ge.size,ot.mapbox_clip_end=ge.end/ge.size}var tt={geometry:Me,type:be==="Polygon"||be==="MultiPolygon"?3:be==="LineString"||be==="MultiLineString"?2:1,tags:ot};$.id!==null&&(tt.id=$.id),he.features.push(tt)}}function xs(he,$,G,ce,ge,be){var Me=ce*ce;if(ce>0&&$.size<(ge?Me:ce))G.numPoints+=$.length/3;else{for(var Pe=[],we=0;we<$.length;we+=3)(ce===0||$[we+2]>Me)&&(G.numSimplified++,Pe.push($[we]),Pe.push($[we+1])),G.numPoints++;ge&&function(Oe,ot){for(var at=0,tt=0,Ot=Oe.length,Gt=Ot-2;tt<Ot;Gt=tt,tt+=2)at+=(Oe[tt]-Oe[Gt])*(Oe[tt+1]+Oe[Gt+1]);if(at>0===ot)for(tt=0,Ot=Oe.length;tt<Ot/2;tt+=2){var Ft=Oe[tt],Wt=Oe[tt+1];Oe[tt]=Oe[Ot-2-tt],Oe[tt+1]=Oe[Ot-1-tt],Oe[Ot-2-tt]=Ft,Oe[Ot-1-tt]=Wt}}(Pe,be),he.push(Pe)}}function Jo(he,$){var G=($=this.options=function(ge,be){for(var Me in be)ge[Me]=be[Me];return ge}(Object.create(this.options),$)).debug;if(G&&console.time("preprocess data"),$.maxZoom<0||$.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if($.promoteId&&$.generateId)throw new Error("promoteId and generateId cannot be used together.");var ce=function(ge,be){var Me=[];if(ge.type==="FeatureCollection")for(var Pe=0;Pe<ge.features.length;Pe++)ai(Me,ge.features[Pe],be,Pe);else ai(Me,ge.type==="Feature"?ge:{geometry:ge},be);return Me}(he,$);this.tiles={},this.tileCoords=[],G&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",$.indexMaxZoom,$.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ce=function(ge,be){var Me=be.buffer/be.extent,Pe=ge,we=li(ge,1,-1-Me,Me,0,-1,2,be),Oe=li(ge,1,1-Me,2+Me,0,-1,2,be);return(we||Oe)&&(Pe=li(ge,1,-Me,1+Me,0,-1,2,be)||[],we&&(Pe=xi(we,1).concat(Pe)),Oe&&(Pe=Pe.concat(xi(Oe,-1)))),Pe}(ce,$),ce.length&&this.splitTile(ce,0,0,0),G&&(ce.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ws(he,$,G){return 32*((1<<he)*G+$)+he}function bs(he,$){const G=he.tileID.canonical;if(!this._geoJSONIndex)return $(null,null);const ce=this._geoJSONIndex.getTile(G.z,G.x,G.y);if(!ce)return $(null,null);const ge=new class{constructor(Me){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=Me.length,this._features=Me}feature(Me){return new class{constructor(Pe){this._feature=Pe,this.extent=a.EXTENT,this.type=Pe.type,this.properties=Pe.tags,"id"in Pe&&!isNaN(Pe.id)&&(this.id=parseInt(Pe.id,10))}loadGeometry(){if(this._feature.type===1){const Pe=[];for(const we of this._feature.geometry)Pe.push([new a.Point(we[0],we[1])]);return Pe}{const Pe=[];for(const we of this._feature.geometry){const Oe=[];for(const ot of we)Oe.push(new a.Point(ot[0],ot[1]));Pe.push(Oe)}return Pe}}toGeoJSON(Pe,we,Oe){return ve.call(this,Pe,we,Oe)}}(this._features[Me])}}(ce.features);let be=Kt(ge);be.byteOffset===0&&be.byteLength===be.buffer.byteLength||(be=new Uint8Array(be)),$(null,{vectorTile:ge,rawData:be.buffer})}Jo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Jo.prototype.splitTile=function(he,$,G,ce,ge,be,Me){for(var Pe=[he,$,G,ce],we=this.options,Oe=we.debug;Pe.length;){ce=Pe.pop(),G=Pe.pop(),$=Pe.pop(),he=Pe.pop();var ot=1<<$,at=ws($,G,ce),tt=this.tiles[at];if(!tt&&(Oe>1&&console.time("creation"),tt=this.tiles[at]=aa(he,$,G,ce,we),this.tileCoords.push({z:$,x:G,y:ce}),Oe)){Oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",$,G,ce,tt.numFeatures,tt.numPoints,tt.numSimplified),console.timeEnd("creation"));var Ot="z"+$;this.stats[Ot]=(this.stats[Ot]||0)+1,this.total++}if(tt.source=he,ge){if($===we.maxZoom||$===ge)continue;var Gt=1<<ge-$;if(G!==Math.floor(be/Gt)||ce!==Math.floor(Me/Gt))continue}else if($===we.indexMaxZoom||tt.numPoints<=we.indexMaxPoints)continue;if(tt.source=null,he.length!==0){Oe>1&&console.time("clipping");var Ft,Wt,Jt,On,Kn,Lr,hr=.5*we.buffer/we.extent,Ji=.5-hr,yr=.5+hr,Ur=1+hr;Ft=Wt=Jt=On=null,Kn=li(he,ot,G-hr,G+yr,0,tt.minX,tt.maxX,we),Lr=li(he,ot,G+Ji,G+Ur,0,tt.minX,tt.maxX,we),he=null,Kn&&(Ft=li(Kn,ot,ce-hr,ce+yr,1,tt.minY,tt.maxY,we),Wt=li(Kn,ot,ce+Ji,ce+Ur,1,tt.minY,tt.maxY,we),Kn=null),Lr&&(Jt=li(Lr,ot,ce-hr,ce+yr,1,tt.minY,tt.maxY,we),On=li(Lr,ot,ce+Ji,ce+Ur,1,tt.minY,tt.maxY,we),Lr=null),Oe>1&&console.timeEnd("clipping"),Pe.push(Ft||[],$+1,2*G,2*ce),Pe.push(Wt||[],$+1,2*G,2*ce+1),Pe.push(Jt||[],$+1,2*G+1,2*ce),Pe.push(On||[],$+1,2*G+1,2*ce+1)}}},Jo.prototype.getTile=function(he,$,G){var ce=this.options,ge=ce.extent,be=ce.debug;if(he<0||he>24)return null;var Me=1<<he,Pe=ws(he,$=($%Me+Me)%Me,G);if(this.tiles[Pe])return Tl(this.tiles[Pe],ge);be>1&&console.log("drilling down to z%d-%d-%d",he,$,G);for(var we,Oe=he,ot=$,at=G;!we&&Oe>0;)Oe--,ot=Math.floor(ot/2),at=Math.floor(at/2),we=this.tiles[ws(Oe,ot,at)];return we&&we.source?(be>1&&console.log("found parent tile z%d-%d-%d",Oe,ot,at),be>1&&console.time("drilling down"),this.splitTile(we.source,Oe,ot,at,he,$,G),be>1&&console.timeEnd("drilling down"),this.tiles[Pe]?Tl(this.tiles[Pe],ge):null):null};class la extends a.VectorTileWorkerSource{constructor($,G,ce,ge,be){super($,G,ce,ge,bs),be&&(this.loadGeoJSON=be)}loadData($,G){const ce=$&&$.request,ge=ce&&ce.collectResourceTiming;this.loadGeoJSON($,(be,Me)=>{if(be||!Me)return G(be);if(typeof Me!="object")return G(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));{se(Me,!0);try{if($.filter){const we=a.createExpression($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(we.result==="error")throw new Error(we.value.map(ot=>`${ot.key}: ${ot.message}`).join(", "));Me={type:"FeatureCollection",features:Me.features.filter(ot=>we.value.evaluate({zoom:0},ot))}}this._geoJSONIndex=$.cluster?new ln(function({superclusterOptions:we,clusterProperties:Oe}){if(!Oe||!we)return we;const ot={},at={},tt={accumulated:null,zoom:0},Ot={properties:null},Gt=Object.keys(Oe);for(const Ft of Gt){const[Wt,Jt]=Oe[Ft],On=a.createExpression(Jt),Kn=a.createExpression(typeof Wt=="string"?[Wt,["accumulated"],["get",Ft]]:Wt);ot[Ft]=On.value,at[Ft]=Kn.value}return we.map=Ft=>{Ot.properties=Ft;const Wt={};for(const Jt of Gt)Wt[Jt]=ot[Jt].evaluate(tt,Ot);return Wt},we.reduce=(Ft,Wt)=>{Ot.properties=Wt;for(const Jt of Gt)tt.accumulated=Ft[Jt],Ft[Jt]=at[Jt].evaluate(tt,Ot)},we}($)).load(Me.features):function(we,Oe){return new Jo(we,Oe)}(Me,$.geojsonVtOptions)}catch(we){return G(we)}this.loaded={};const Pe={};if(ge){const we=a.getPerformanceMeasurement(ce);we&&(Pe.resourceTiming={},Pe.resourceTiming[$.source]=JSON.parse(JSON.stringify(we)))}G(null,Pe)}})}reloadTile($,G){const ce=this.loaded;return ce&&ce[$.uid]?super.reloadTile($,G):this.loadTile($,G)}loadGeoJSON($,G){if($.request)a.getJSON($.request,G);else{if(typeof $.data!="string")return G(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));try{return G(null,JSON.parse($.data))}catch{return G(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom($,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom($.clusterId))}catch(ce){G(ce)}}getClusterChildren($,G){try{G(null,this._geoJSONIndex.getChildren($.clusterId))}catch(ce){G(ce)}}getClusterLeaves($,G){try{G(null,this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset))}catch(ce){G(ce)}}}class Kc{constructor($){this.self=$,this.actor=new a.Actor($,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:la},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(G,ce)=>{if(this.workerSourceTypes[G])throw new Error(`Worker source with name "${G}" already registered.`);this.workerSourceTypes[G]=ce},this.self.registerRTLTextPlugin=G=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=G.applyArabicShaping,a.plugin.processBidirectionalText=G.processBidirectionalText,a.plugin.processStyledBidirectionalText=G.processStyledBidirectionalText}}clearCaches($,G,ce){delete this.layerIndexes[$],delete this.availableImages[$],delete this.workerSources[$],delete this.demWorkerSources[$],ce()}checkIfReady($,G,ce){ce()}setReferrer($,G){this.referrer=G}spriteLoaded($,G){this.isSpriteLoaded[$]=G;for(const ce in this.workerSources[$]){const ge=this.workerSources[$][ce];for(const be in ge)ge[be]instanceof a.VectorTileWorkerSource&&(ge[be].isSpriteLoaded=G,ge[be].fire(new a.Event("isSpriteLoaded")))}}setImages($,G,ce){this.availableImages[$]=G;for(const ge in this.workerSources[$]){const be=this.workerSources[$][ge];for(const Me in be)be[Me].availableImages=G}ce()}enableTerrain($,G,ce){this.terrain=G,ce()}setProjection($,G){this.projections[$]=a.getProjection(G)}setLayers($,G,ce){this.getLayerIndex($).replace(G),ce()}updateLayers($,G,ce){this.getLayerIndex($).update(G.layers,G.removedIds),ce()}loadTile($,G,ce){const ge=this.enableTerrain?a.extend({enableTerrain:this.terrain},G):G;ge.projection=this.projections[$]||this.defaultProjection,this.getWorkerSource($,G.type,G.source).loadTile(ge,ce)}loadDEMTile($,G,ce){const ge=this.enableTerrain?a.extend({buildQuadTree:this.terrain},G):G;this.getDEMWorkerSource($,G.source).loadTile(ge,ce)}reloadTile($,G,ce){const ge=this.enableTerrain?a.extend({enableTerrain:this.terrain},G):G;ge.projection=this.projections[$]||this.defaultProjection,this.getWorkerSource($,G.type,G.source).reloadTile(ge,ce)}abortTile($,G,ce){this.getWorkerSource($,G.type,G.source).abortTile(G,ce)}removeTile($,G,ce){this.getWorkerSource($,G.type,G.source).removeTile(G,ce)}removeSource($,G,ce){if(!this.workerSources[$]||!this.workerSources[$][G.type]||!this.workerSources[$][G.type][G.source])return;const ge=this.workerSources[$][G.type][G.source];delete this.workerSources[$][G.type][G.source],ge.removeSource!==void 0?ge.removeSource(G,ce):ce()}loadWorkerSource($,G,ce){try{this.self.importScripts(G.url),ce()}catch(ge){ce(ge.toString())}}syncRTLPluginState($,G,ce){try{a.plugin.setState(G);const ge=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&ge!=null){this.self.importScripts(ge);const be=a.plugin.isParsed();ce(be?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ge}`),be)}}catch(ge){ce(ge.toString())}}getAvailableImages($){let G=this.availableImages[$];return G||(G=[]),G}getLayerIndex($){let G=this.layerIndexes[$];return G||(G=this.layerIndexes[$]=new R),G}getWorkerSource($,G,ce){if(this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][G]||(this.workerSources[$][G]={}),!this.workerSources[$][G][ce]){const ge={send:(be,Me,Pe,we,Oe,ot)=>{this.actor.send(be,Me,Pe,$,Oe,ot)},scheduler:this.actor.scheduler};this.workerSources[$][G][ce]=new this.workerSourceTypes[G](ge,this.getLayerIndex($),this.getAvailableImages($),this.isSpriteLoaded[$])}return this.workerSources[$][G][ce]}getDEMWorkerSource($,G){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][G]||(this.demWorkerSources[$][G]=new F),this.demWorkerSources[$][G]}enforceCacheSizeLimit($,G){a.enforceCacheSizeLimit(G)}getWorkerPerformanceMetrics($,G,ce){ce(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Kc(self)),Kc}),x(["./shared"],function(a){function P(f,o){if(Array.isArray(f)){if(!Array.isArray(o)||f.length!==o.length)return!1;for(let u=0;u<f.length;u++)if(!P(f[u],o[u]))return!1;return!0}if(typeof f=="object"&&f!==null&&o!==null){if(typeof o!="object"||Object.keys(f).length!==Object.keys(o).length)return!1;for(const u in f)if(!P(f[u],o[u]))return!1;return!0}return f===o}var A=R;function R(f){return!function(o){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,_,w=new Blob([""],{type:"text/javascript"}),S=URL.createObjectURL(w);try{_=new Worker(S),m=!0}catch{m=!1}return _&&_.terminate(),URL.revokeObjectURL(S),m}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var m=document.createElement("canvas");m.width=m.height=1;var _=m.getContext("2d");if(!_)return!1;var w=_.getImageData(0,0,1,1);return w&&w.width===m.width}()?(F[u=o&&o.failIfMajorPerformanceCaveat]===void 0&&(F[u]=function(m){var _,w=function(S){var C=document.createElement("canvas"),k=Object.create(R.webGLContextAttributes);return k.failIfMajorPerformanceCaveat=S,C.getContext("webgl",k)||C.getContext("experimental-webgl",k)}(m);if(!w)return!1;try{_=w.createShader(w.VERTEX_SHADER)}catch{return!1}return!(!_||w.isContextLost())&&(w.shaderSource(_,"void main() {}"),w.compileShader(_),w.getShaderParameter(_,w.COMPILE_STATUS)===!0)}(u)),F[u]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var u}(f)}var F={};function j(f,o,u){const m=a.window.document.createElement(f);return o!==void 0&&(m.className=o),u&&u.appendChild(m),m}function Z(f,o,u){const m=a.window.document.createElementNS("http://www.w3.org/2000/svg",f);for(const _ of Object.keys(o))m.setAttributeNS(null,_,o[_]);return u&&u.appendChild(m),m}R.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const se=a.window.document&&a.window.document.documentElement.style,ve=se&&se.userSelect!==void 0?"userSelect":"WebkitUserSelect";let X;function H(){se&&ve&&(X=se[ve],se[ve]="none")}function Y(){se&&ve&&(se[ve]=X)}function fe(f){f.preventDefault(),f.stopPropagation(),a.window.removeEventListener("click",fe,!0)}function Ce(){a.window.addEventListener("click",fe,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",fe,!0)},0)}function Ue(f,o){const u=f.getBoundingClientRect();return nt(f,u,o)}function Ge(f,o){const u=f.getBoundingClientRect(),m=[];for(let _=0;_<o.length;_++)m.push(nt(f,u,o[_]));return m}function je(f){return a.window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function nt(f,o,u){const m=f.offsetWidth===o.width?1:f.offsetWidth/o.width;return new a.Point((u.clientX-o.left)*m,(u.clientY-o.top)*m)}function Te(f,o){var u=o[0],m=o[1],_=o[2],w=o[3],S=u*w-_*m;return S?(f[0]=w*(S=1/S),f[1]=-m*S,f[2]=-_*S,f[3]=u*S,f):null}function mt(f){const{userImage:o}=f;return!!(o&&o.render&&o.render())&&(f.data.replace(new Uint8Array(o.data.buffer)),!0)}class Dt extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:u,callback:m}of this.requestors)this._notify(u,m);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,u){this._validate(o,u)&&(this.images[o]=u)}_validate(o,u){let m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),m=!1),this._validateContent(u.content,u)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),m=!1),m}_validateStretch(o,u){if(!o)return!0;let m=0;for(const _ of o){if(_[0]<m||_[1]<_[0]||u<_[1])return!1;m=_[1]}return!0}_validateContent(o,u){return!(o&&(o.length!==4||o[0]<0||u.data.width<o[0]||o[1]<0||u.data.height<o[1]||o[2]<0||u.data.width<o[2]||o[3]<0||u.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,u){u.version=this.images[o].version+1,this.images[o]=u,this.updatedImages[o]=!0}removeImage(o){const u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,u){let m=!0;if(!this.isLoaded())for(const _ of o)this.images[_]||(m=!1);this.isLoaded()||m?this._notify(o,u):this.requestors.push({ids:o,callback:u})}_notify(o,u){const m={};for(const _ of o){this.images[_]||this.fire(new a.Event("styleimagemissing",{id:_}));const w=this.images[_];w?m[_]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:!!(w.userImage&&w.userImage.render)}:a.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,m)}getPixelSize(){const{width:o,height:u}=this.atlasImage;return{width:o,height:u}}getPattern(o){const u=this.patterns[o],m=this.getImage(o);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{const _={w:m.data.width+2,h:m.data.height+2,x:0,y:0},w=new a.ImagePosition(_,m);this.patterns[o]={bin:_,position:w}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,u.RGBA),this.atlasTexture&&this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const w in this.patterns)o.push(this.patterns[w].bin);const{w:u,h:m}=a.potpack(o),_=this.atlasImage;_.resize({width:u||1,height:m||1});for(const w in this.patterns){const{bin:S}=this.patterns[w],C=S.x+1,k=S.y+1,z=this.images[w].data,L=z.width,N=z.height;a.RGBAImage.copy(z,_,{x:0,y:0},{x:C,y:k},{width:L,height:N}),a.RGBAImage.copy(z,_,{x:0,y:N-1},{x:C,y:k-1},{width:L,height:1}),a.RGBAImage.copy(z,_,{x:0,y:0},{x:C,y:k+N},{width:L,height:1}),a.RGBAImage.copy(z,_,{x:L-1,y:0},{x:C-1,y:k},{width:1,height:N}),a.RGBAImage.copy(z,_,{x:0,y:0},{x:C+L,y:k},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const u of o){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const m=this.images[u];mt(m)&&this.updateImage(u,m)}}}const xt=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(f,o){return function([u,m,_]){const w=a.degToRad(m+90),S=a.degToRad(_);return{x:u*Math.cos(w)*Math.sin(S),y:u*Math.sin(w)*Math.sin(S),z:u*Math.cos(S),azimuthal:m,polar:_}}(f.expression.evaluate(o))}interpolate(f,o,u){return{x:a.number(f.x,o.x,u),y:a.number(f.y,o.y,u),z:a.number(f.z,o.z,u),azimuthal:a.number(f.azimuthal,o.azimuthal,u),polar:a.number(f.polar,o.polar,u)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)});class kt extends a.Evented{constructor(o){super(),this._transitionable=new a.Transitionable(xt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,u={}){if(!this._validate(a.validateLight,o,u))for(const m in o){const _=o[m];a.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),_):this._transitionable.setValue(m,_)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,m){return(!m||m.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const lt=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)});let It=class extends a.Evented{constructor(f,o){super(),this._transitionable=new a.Transitionable(lt),this.set(f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(f){for(const o in f){const u=f[o];a.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),u):this._transitionable.setValue(o,u)}}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}};function Kt(f,o,u,m){const _=a.smoothstep(45,65,u),[w,S]=st(f,m),C=a.length(o);let k=1-Math.min(1,Math.exp((C-w)/(S-w)*-6));return k*=k*k,k=Math.min(1,1.00747*k),k*_*f.alpha}function st(f,o){const u=.5/Math.tan(.5*o);return[f.range[0]+u,f.range[1]+u]}const He=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])});class bt extends a.Evented{constructor(o,u){super(),this._transitionable=new a.Transitionable(He),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=u}get state(){const o=this._transform,u=o.projection.name==="globe",m=a.globeToMercatorTransition(o.zoom),_=this.properties.get("range"),w=[.5,3];return{range:u?[a.number(w[0],_[0],m),a.number(w[1],_[1],m)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,u={}){if(!this._validate(a.validateFog,o,u)){for(const m of Object.keys(a.spec.fog))o&&o[m]===void 0&&(o[m]=a.spec.fog[m].default);for(const m in o){const _=o[m];a.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),_):this._transitionable.setValue(m,_)}}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.smoothstep(45,65,o))*u.a}getOpacityAtLatLng(o,u){return this._transform.projection.supportsFog?function(m,_,w){const S=a.MercatorCoordinate.fromLngLat(_),C=w.elevation?w.elevation.getAtPointOrZero(S):0,k=[S.x,S.y,C];return a.transformMat4(k,k,w.mercatorFogMatrix),Kt(m,k,w.pitch,w._fov)}(this.state,o,u):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?st(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,m){return(!m||m.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class yt{constructor(o,u){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const m=this.workerPool.acquire(this.id);for(let _=0;_<m.length;_++){const w=new yt.Actor(m[_],u,this.id);w.name=`Worker ${_}`,this.actors.push(w)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,u,m){a.asyncAll(this.actors,(_,w)=>{_.send(o,u,w)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Nt(f,o,u){return o*(a.EXTENT/(f.tileSize*Math.pow(2,u-f.tileID.overscaledZ)))}yt.Actor=a.Actor;class ur{constructor(o,u,m,_){this.screenBounds=o,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(o,u){let m,_;if(o instanceof a.Point||typeof o[0]=="number"){const w=a.Point.convert(o);m=[w],_=u.isPointAboveHorizon(w)}else{const w=a.Point.convert(o[0]),S=a.Point.convert(o[1]);m=[w,S],_=a.polygonizeBounds(w,S).every(C=>u.isPointAboveHorizon(C))}return new ur(m,u.getCameraPoint(),_,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const u=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],_=a.polygonizeBounds(u,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<m.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?_[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(_[3]=this.cameraPoint)),a.bufferConvexPolygon(_,o)}bufferedCameraGeometryGlobe(o){const u=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],_=a.polygonizeBounds(u,m,o),w=this.cameraPoint.clone();switch(3*((w.y>u.y)+(w.y>m.y))+((w.x>u.x)+(w.x>m.x))){case 0:_[0]=w,_[4]=w.clone();break;case 1:_.splice(1,0,w);break;case 2:_[1]=w;break;case 3:_.splice(4,0,w);break;case 5:_.splice(2,0,w);break;case 6:_[3]=w;break;case 7:_.splice(3,0,w);break;case 8:_[2]=w}return _}containsTile(o,u,m,_=0){const w=o.queryPadding/u._pixelsPerMercatorPixel+1,S=m?this._bufferedCameraMercator(w,u):this._bufferedScreenMercator(w,u);let C=o.tileID.wrap+(S.unwrapped?_:0);const k=S.polygon.map(re=>a.getTilePoint(o.tileTransform,re,C));if(!a.polygonIntersectsBox(k,0,0,a.EXTENT,a.EXTENT))return;C=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const z=this.screenGeometryMercator.polygon.map(re=>a.getTileVec3(o.tileTransform,re,C)),L=z.map(re=>new a.Point(re[0],re[1])),N=u.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),W=a.getTileVec3(o.tileTransform,N,C),J=z.map(re=>{const U=a.sub(re,re,W);return a.normalize(U,U),new a.Ray(W,U)}),ne=Nt(o,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:L,tilespaceRays:J,bufferedTilespaceGeometry:k,bufferedTilespaceBounds:(te=a.getBounds(k),te.min.x=a.clamp(te.min.x,0,a.EXTENT),te.min.y=a.clamp(te.min.y,0,a.EXTENT),te.max.x=a.clamp(te.max.x,0,a.EXTENT),te.max.y=a.clamp(te.max.y,0,a.EXTENT),te),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:ne};var te}_bufferedScreenMercator(o,u){const m=Wn(o);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let _;return _=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),u):{polygon:this.bufferedScreenGeometry(o).map(w=>u.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[m]=_,_}}_bufferedCameraMercator(o,u){const m=Wn(o);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let _;return _=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),u):{polygon:this.bufferedCameraGeometry(o).map(w=>u.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[m]=_,_}}_projectAndResample(o,u){const m=function(w,S){const C=a.multiply([],S.pixelMatrix,S.globeMatrix),k=[0,-a.GLOBE_RADIUS,0,1],z=[0,a.GLOBE_RADIUS,0,1],L=[0,0,0,1];a.transformMat4$1(k,k,C),a.transformMat4$1(z,z,C),a.transformMat4$1(L,L,C);const N=new a.Point(k[0]/k[3],k[1]/k[3]),W=new a.Point(z[0]/z[3],z[1]/z[3]),J=a.polygonContainsPoint(w,N)&&k[3]<L[3],ne=a.polygonContainsPoint(w,W)&&z[3]<L[3];if(!J&&!ne)return null;const te=function(_e,Se,Ee){for(let De=1;De<_e.length;De++){const Ye=pr(Se.pointCoordinate3D(_e[De-1]).x),ke=pr(Se.pointCoordinate3D(_e[De]).x);if(Ee<0){if(Ye<ke)return{idx:De,t:-Ye/(ke-1-Ye)}}else if(ke<Ye)return{idx:De,t:(1-Ye)/(ke+1-Ye)}}return null}(w,S,J?-1:1);if(!te)return null;const{idx:re,t:U}=te;let K=re>1?ln(w.slice(0,re),S):[],ae=re<w.length?ln(w.slice(re),S):[];K=K.map(_e=>new a.Point(pr(_e.x),_e.y)),ae=ae.map(_e=>new a.Point(pr(_e.x),_e.y));const le=[...K];le.length===0&&le.push(ae[ae.length-1]);const ye=a.number(le[le.length-1].y,(ae.length===0?K[0]:ae[0]).y,U);let xe;return xe=J?[new a.Point(0,ye),new a.Point(0,0),new a.Point(1,0),new a.Point(1,ye)]:[new a.Point(1,ye),new a.Point(1,1),new a.Point(0,1),new a.Point(0,ye)],le.push(...xe),ae.length===0?le.push(K[0]):le.push(...ae),{polygon:le.map(_e=>new a.MercatorCoordinate(_e.x,_e.y)),unwrapped:!1}}(o,u);if(m)return m;const _=function(w,S){let C=!1,k=-1/0,z=0;for(let N=0;N<w.length-1;N++)w[N].x>k&&(k=w[N].x,z=N);for(let N=0;N<w.length-1;N++){const W=(z+N)%(w.length-1),J=w[W],ne=w[W+1];Math.abs(J.x-ne.x)>.5&&(J.x<ne.x?(J.x+=1,W===0&&(w[w.length-1].x+=1)):(ne.x+=1,W+1===w.length-1&&(w[0].x+=1)),C=!0)}const L=a.mercatorXfromLng(S.center.lng);return C&&L<Math.abs(L-1)&&w.forEach(N=>{N.x-=1}),{polygon:w,unwrapped:C}}(ln(o,u).map(w=>new a.Point(pr(w.x),w.y)),u);return{polygon:_.polygon.map(w=>new a.MercatorCoordinate(w.x,w.y)),unwrapped:_.unwrapped}}}function ln(f,o){return a.resample(f,u=>{const m=o.pointCoordinate3D(u);u.x=m.x,u.y=m.y},1/256)}function pr(f){return f<0?1+f%1:f%1}function Wn(f){return 100*f|0}function Xn(f,o,u,m,_){const w=function(S,C){if(S)return _(S);if(C){f.url&&C.tiles&&f.tiles&&delete f.tiles;const k=a.pick(a.extend(C,f),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(k.vectorLayers=C.vector_layers,k.vectorLayerIds=k.vectorLayers.map(z=>z.id)),k.tiles=o.canonicalizeTileset(k,f.url),_(null,k)}};return f.url?a.getJSON(o.transformRequest(o.normalizeSourceURL(f.url,null,u,m),a.ResourceType.Source),w):a.exported.frame(()=>w(null,f))}class si{constructor(o,u,m){this.bounds=a.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=u||0,this.maxzoom=m||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const u=Math.pow(2,o.z),m=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*u),_=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*u),w=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*u),S=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*u);return o.x>=m&&o.x<w&&o.y>=_&&o.y<S}}class $t{constructor(o,u,m){this.context=o;const _=o.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Qt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Sn{constructor(o,u,m,_){this.length=u.length,this.attributes=m,this.itemSize=u.bytesPerElement,this.dynamicDraw=_,this.context=o;const w=o.gl;this.buffer=w.createBuffer(),o.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,u){for(let m=0;m<this.attributes.length;m++){const _=u.attributes[this.attributes[m].name];_!==void 0&&o.enableVertexAttribArray(_)}}setVertexAttribPointers(o,u,m){for(let _=0;_<this.attributes.length;_++){const w=this.attributes[_],S=u.attributes[w.name];S!==void 0&&o.vertexAttribPointer(S,w.components,o[Qt[w.type]],!1,this.itemSize,w.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Vt{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class xo extends Vt{getDefault(){return a.Color.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class ai extends Vt{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class xl extends Vt{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Rn extends Vt{getDefault(){return[!0,!0,!0,!0]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class vi extends Vt{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class qc extends Vt{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class wo extends Vt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class li extends Vt{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class wl extends Vt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}}class oa extends Vt{getDefault(){return[0,1]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class bl extends Vt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}}class Ko extends Vt{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class sa extends Vt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}}class Hc extends Vt{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Xc extends Vt{getDefault(){return a.Color.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class xi extends Vt{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Yo extends Vt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}}class Tl extends Vt{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class vs extends Vt{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let aa,El=class extends Vt{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class xs extends Vt{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Jo extends Vt{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class ws extends Vt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class bs extends Vt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class la extends Vt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Kc extends Vt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class he extends Vt{getDefault(){return null}set(o){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class $ extends Vt{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class G extends Vt{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class ce extends Vt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class ge extends Vt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class be extends Vt{constructor(o,u){super(o),this.context=o,this.parent=u}getDefault(){return null}}class Me extends be{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Pe extends be{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class we extends Pe{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Oe{constructor(o,u,m,_){this.context=o,this.width=u,this.height=m;const w=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Me(o,w),_&&(this.depthAttachment=new Pe(o,w))}destroy(){const o=this.context.gl,u=this.colorAttachment.get();if(u&&o.deleteTexture(u),this.depthAttachment){const m=this.depthAttachment.get();m&&o.deleteRenderbuffer(m)}o.deleteFramebuffer(this.framebuffer)}}class ot{constructor(o,u=!1){if(this.gl=o,this.isWebGL2=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),u){const m=o;this.extVertexArrayObject={createVertexArrayOES:m.createVertexArray.bind(o),deleteVertexArrayOES:m.deleteVertexArray.bind(o),bindVertexArrayOES:m.bindVertexArray.bind(o)}}this.clearColor=new xo(this),this.clearDepth=new ai(this),this.clearStencil=new xl(this),this.colorMask=new Rn(this),this.depthMask=new vi(this),this.stencilMask=new qc(this),this.stencilFunc=new wo(this),this.stencilOp=new li(this),this.stencilTest=new wl(this),this.depthRange=new oa(this),this.depthTest=new bl(this),this.depthFunc=new Ko(this),this.blend=new sa(this),this.blendFunc=new Hc(this),this.blendColor=new Xc(this),this.blendEquation=new xi(this),this.cullFace=new Yo(this),this.cullFaceSide=new Tl(this),this.frontFace=new vs(this),this.program=new El(this),this.activeTexture=new xs(this),this.viewport=new Jo(this),this.bindFramebuffer=new ws(this),this.bindRenderbuffer=new bs(this),this.bindTexture=new la(this),this.bindVertexBuffer=new Kc(this),this.bindElementBuffer=new he(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $(this),this.pixelStoreUnpack=new G(this),this.pixelStoreUnpackPremultiplyAlpha=new ce(this),this.pixelStoreUnpackFlipY=new ge(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),u||(this.extTextureHalfFloat=o.getExtension("OES_texture_half_float")),(u||this.extTextureHalfFloat&&o.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=u||o.getExtension("OES_standard_derivatives"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,u){return new $t(this,o,u)}createVertexBuffer(o,u,m){return new Sn(this,o,u,m)}createRenderbuffer(o,u,m){const _=this.gl,w=_.createRenderbuffer();return this.bindRenderbuffer.set(w),_.renderbufferStorage(_.RENDERBUFFER,o,u,m),this.bindRenderbuffer.set(null),w}createFramebuffer(o,u,m){return new Oe(this,o,u,m)}clear({color:o,depth:u,stencil:m}){const _=this.gl;let w=0;o&&(w|=_.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(w|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),m!==void 0&&(w|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),_.clear(w)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){P(o.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class at extends a.Evented{constructor(o,u,m,_){if(super(),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(u,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(o){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map._worldview;this._tileJSONRequest=Xn(this._options,this.map._requestManager,u,m,(_,w)=>{this._tileJSONRequest=null,this._loaded=!0,_?(u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),m&&m.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new a.ErrorEvent(_))):w&&(a.extend(this,w),w.bounds&&(this.tileBounds=new si(w.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(w.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(_)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(o,u){const m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(m,a.ResourceType.Tile),data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=u:o.request=o.actor.send("reloadTile",_,w.bind(this));else if(o.actor=this._tileWorkers[m]=this._tileWorkers[m]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",_,w.bind(this),void 0,!0);else{const S=a.loadVectorTile.call({deduped:this._deduped},_,(C,k)=>{C||!k?w.call(this,C):(_.data={cacheControl:k.cacheControl,expires:k.expires,rawData:k.rawData.slice(0)},o.actor&&o.actor.send("loadTile",_,w.bind(this),void 0,!0))},!0);o.request={cancel:S}}function w(S,C){return delete o.request,o.aborted?u(null):S&&S.status!==404?u(S):(C&&C.resourceTiming&&(o.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&o.setExpiryData(C),o.loadVectorData(C,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id})}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class tt extends a.Evented{constructor(o,u,m,_){super(),this.id=o,this.dispatcher=m,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},u),a.extend(this,a.pick(u,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Xn(this._options,this.map._requestManager,null,null,(u,m)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new a.ErrorEvent(u)):m&&(a.extend(this,m),m.bounds&&(this.tileBounds=new si(m.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(m.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(u)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,u){const m=a.exported.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(_,a.ResourceType.Tile),(w,S,C,k)=>(delete o.request,o.aborted?(o.state="unloaded",u(null)):w?(o.state="errored",u(w)):S?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:C,expires:k}),o.setTexture(S,this.map.painter),o.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void u(null)):u(null)))}static loadTileData(o,u,m){o.setTexture(u,m)}static unloadTileData(o,u){o.texture&&u.saveTileTexture(o.texture)}abortTile(o,u){o.request&&(o.request.cancel(),delete o.request),u()}unloadTile(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Ot(f,o,u,m,_,w,S,C){const k=[f,u,_,o,m,w,1,1,1],z=[S,C,1],L=a.adjoint([],k),[N,W,J]=a.transformMat3(z,z,a.transpose(L,L));return a.multiply$1(k,[N,0,0,0,W,0,0,0,J],k)}class Gt extends a.Evented{constructor(o,u,m,_){super(),this.id=o,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=u,this._dirty=!1}load(o,u){this._loaded=u||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(m,_)=>{if(this._imageRequest=null,this._loaded=!0,m)this.fire(new a.ErrorEvent(m));else if(_){const{HTMLImageElement:w}=a.window;this.image=_ instanceof w?a.exported.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const u=o.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(m){let _=1/0,w=1/0,S=-1/0,C=-1/0;for(const N of m)_=Math.min(_,N.x),w=Math.min(w,N.y),S=Math.max(S,N.x),C=Math.max(C,N.y);const k=Math.max(S-_,C-w),z=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),L=Math.pow(2,z);return new a.CanonicalTileID(z,Math.floor((_+S)/2*L),Math.floor((w+C)/2*L))}(u),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const k in this.tiles){const z=this.tiles[k];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture)}if(this._boundsArray)return;const u=a.tileTransform(this.tileID,this.map.transform.projection),[m,_,w,S]=this.coordinates.map(k=>{const z=u.projection.project(k[0],k[1]);return a.getTilePoint(u,z)._round()});this.perspectiveTransform=function(k,z,L,N,W,J,ne,te,re,U){const K=Ot(0,0,k,0,0,z,k,z),ae=Ot(L,N,W,J,ne,te,re,U);return a.multiply$1(ae,a.adjoint(K,K),ae),[ae[6]/ae[8]*k/a.EXTENT,ae[7]/ae[8]*z/a.EXTENT]}(this.width,this.height,m.x,m.y,_.x,_.y,S.x,S.y,w.x,w.y);const C=this._boundsArray=new a.StructArrayLayout4i8;C.emplaceBack(m.x,m.y,0,0),C.emplaceBack(_.x,_.y,a.EXTENT,0),C.emplaceBack(S.x,S.y,0,a.EXTENT),C.emplaceBack(w.x,w.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(C,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,u=o.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(o)}loadTile(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ft={vector:at,raster:tt,"raster-dem":class extends tt{constructor(f,o,u,m){super(f,o,u,m),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(f,o){const u=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(_,w){_&&(f.state="errored",o(_)),w&&(f.dem=w,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",o(null))}f.request=a.getImage(this.map._requestManager.transformRequest(u,a.ResourceType.Tile),(function(_,w,S,C){if(delete f.request,f.aborted)f.state="unloaded",o(null);else if(_)f.state="errored",o(_);else if(w){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:S,expires:C});const k=a.window.ImageBitmap&&w instanceof a.window.ImageBitmap&&(aa==null&&(aa=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),aa),z=1-(w.width-a.prevPowerOfTwo(w.width))/2;z<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const L=k?w:a.exported.getImageData(w,z),N={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:L,encoding:this.encoding,padding:z};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",N,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const o=f.canonical,u=Math.pow(2,o.z),m=(o.x-1+u)%u,_=o.x===0?f.wrap-1:f.wrap,w=(o.x+1+u)%u,S=o.x+1===u?f.wrap+1:f.wrap,C={};return C[new a.OverscaledTileID(f.overscaledZ,_,o.z,m,o.y).key]={backfilled:!1},C[new a.OverscaledTileID(f.overscaledZ,S,o.z,w,o.y).key]={backfilled:!1},o.y>0&&(C[new a.OverscaledTileID(f.overscaledZ,_,o.z,m,o.y-1).key]={backfilled:!1},C[new a.OverscaledTileID(f.overscaledZ,f.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},C[new a.OverscaledTileID(f.overscaledZ,S,o.z,w,o.y-1).key]={backfilled:!1}),o.y+1<u&&(C[new a.OverscaledTileID(f.overscaledZ,_,o.z,m,o.y+1).key]={backfilled:!1},C[new a.OverscaledTileID(f.overscaledZ,f.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},C[new a.OverscaledTileID(f.overscaledZ,S,o.z,w,o.y+1).key]={backfilled:!1}),C}unloadTile(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded"}},geojson:class extends a.Evented{constructor(f,o,u,m){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(m),this._data=o.data,this._options=a.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const _=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*_,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*_,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:a.EXTENT,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*_,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}getClusterExpansionZoom(f,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},o),this}getClusterChildren(f,o){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},o),this}getClusterLeaves(f,o,u,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:o,offset:u},m),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const f=a.extend({},this.workerOptions),o=this._data;typeof o=="string"?(f.request=this.map._requestManager.transformRequest(a.exported.resolveURL(o),a.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(u,m)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new a.ErrorEvent(u));else{const _={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&m&&m.resourceTiming&&m.resourceTiming[this.id]&&(_.resourceTiming=m.resourceTiming[this.id]),this.fire(new a.Event("data",_)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,o){const u=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(u,{type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(m,_)=>(delete f.request,f.unloadVectorData(),f.aborted?o(null):m?o(m):(f.loadVectorData(_,this.map.painter,u==="reloadTile"),o(null))),void 0,u==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Gt{constructor(f,o,u,m){super(f,o,u,m),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const o of f.urls)this.urls.push(this.map._requestManager.transformRequest(o,a.ResourceType.Source).url);a.getVideo(this.urls,(o,u)=>{this._loaded=!0,o?this.fire(new a.ErrorEvent(o)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const o=this.video.seekable;f<o.start(0)||f>o.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,o=f.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(f,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Gt,canvas:class extends Gt{constructor(f,o,u,m){super(f,o,u,m),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(w=>typeof w!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${f}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${f}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends a.Evented{constructor(f,o,u,m){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=o,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new si(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this._map=f,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:o,y:u,z:m}=f.canonical;return this._implementation.hasTile({x:o,y:u,z:m})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,o){const{x:u,y:m,z:_}=f.tileID.canonical,w=new a.window.AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:u,y:m,z:_},{signal:w.signal})).then((function(S){return delete f.request,f.aborted?(f.state="unloaded",o(null)):S===void 0?(f.state="errored",o(null)):S===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",o(null)):function(C){return C instanceof a.window.ImageData||C instanceof a.window.HTMLCanvasElement||C instanceof a.window.ImageBitmap||C instanceof a.window.HTMLImageElement}(S)?(this.loadTileData(f,S),f.state="loaded",void o(null)):(f.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(S=>{S.code!==20&&(f.state="errored",o(S))}),f.request.cancel=()=>w.abort()}loadTileData(f,o){tt.loadTileData(f,o,this._map.painter)}unloadTileData(f){tt.unloadTileData(f,this._map.painter)}unloadTile(f,o){if(this.unloadTileData(f),this._implementation.unloadTile){const{x:u,y:m,z:_}=f.tileID.canonical;this._implementation.unloadTile({x:u,y:m,z:_})}o()}abortTile(f,o){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Wt=function(f,o,u,m){const _=new Ft[o.type](f,o,u,m);if(_.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${_.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],_),_};function Jt(f,o){const u=a.identity([]);return a.scale(u,u,[.5*f.width,.5*-f.height,1]),a.translate(u,u,[1,-1,0]),a.multiply(u,u,f.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(u)}function On(f,o,u,m,_,w,S,C=!1){const k=f.tilesIn(m,S,C);k.sort(Lr);const z=[];for(const N of k)z.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(o,u,f._state,N,_,w,Jt(f.transform,N.tile.tileID),C)});const L=function(N){const W={},J={};for(const ne of N){const te=ne.queryResults,re=ne.wrappedTileID,U=J[re]=J[re]||{};for(const K in te){const ae=te[K],le=U[K]=U[K]||{},ye=W[K]=W[K]||[];for(const xe of ae)le[xe.featureIndex]||(le[xe.featureIndex]=!0,ye.push(xe))}}return W}(z);for(const N in L)L[N].forEach(W=>{const J=W.feature,ne=J.layer;ne&&ne.type!=="background"&&ne.type!=="sky"&&(J.source=ne.source,ne["source-layer"]&&(J.sourceLayer=ne["source-layer"]),J.state=J.id!==void 0?f.getFeatureState(ne["source-layer"],J.id):{})});return L}function Kn(f,o){const u=f.getRenderableIds().map(w=>f.getTileByID(w)),m=[],_={};for(let w=0;w<u.length;w++){const S=u[w],C=S.tileID.canonical.key;_[C]||(_[C]=!0,S.querySourceFeatures(m,o))}return m}function Lr(f,o){const u=f.tileID,m=o.tileID;return u.overscaledZ-m.overscaledZ||u.canonical.y-m.canonical.y||u.wrap-m.wrap||u.canonical.x-m.canonical.x}function hr(){return Pa.workerClass!=null?new Pa.workerClass:new a.window.Worker(Pa.workerUrl)}const Ji="mapboxgl_preloaded_worker_pool";class yr{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<yr.workerCount;)this.workers.push(new hr);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ji]}numActive(){return Object.keys(this.active).length}}let Ur;function ca(){return Ur||(Ur=new yr),Ur}function p_(f,o){const u={};for(const m in f)m!=="ref"&&(u[m]=f[m]);return a.refProperties.forEach(m=>{m in o&&(u[m]=o[m])}),u}function kp(f){f=f.slice();const o=Object.create(null);for(let u=0;u<f.length;u++)o[f[u].id]=f[u];for(let u=0;u<f.length;u++)"ref"in f[u]&&(f[u]=p_(f[u],o[f[u].ref]));return f}yr.workerCount=2;const cn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Fh(f,o,u){u.push({command:cn.addSource,args:[f,o[f]]})}function Sl(f,o,u){o.push({command:cn.removeSource,args:[f]}),u[f]=!0}function Bh(f,o,u,m){Sl(f,u,m),Fh(f,o,u)}function Yc(f,o,u){let m;for(m in f[u])if(f[u].hasOwnProperty(m)&&m!=="data"&&!P(f[u][m],o[u][m]))return!1;for(m in o[u])if(o[u].hasOwnProperty(m)&&m!=="data"&&!P(f[u][m],o[u][m]))return!1;return!0}function Qi(f,o,u,m,_,w){let S;for(S in o=o||{},f=f||{})f.hasOwnProperty(S)&&(P(f[S],o[S])||u.push({command:w,args:[m,S,o[S],_]}));for(S in o)o.hasOwnProperty(S)&&!f.hasOwnProperty(S)&&(P(f[S],o[S])||u.push({command:w,args:[m,S,o[S],_]}))}function bo(f){return f.id}function jh(f,o){return f[o.id]=o,f}class Nh{constructor(o,u){this.reset(o,u)}reset(o,u){this.points=o||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=a.clamp(o,0,1);let u=1,m=this._distances[u];const _=o*this.paddedLength+this.padding;for(;m<_&&u<this._distances.length;)m=this._distances[++u];const w=u-1,S=this._distances[w],C=m-S,k=C>0?(_-S)/C:0;return this.points[w].mult(1-k).add(this.points[u].mult(k))}}class Ts{constructor(o,u,m){const _=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(o/m),this.yCellCount=Math.ceil(u/m);for(let S=0;S<this.xCellCount*this.yCellCount;S++)_.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=u,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,u,m,_,w){this._forEachCell(u,m,_,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(_),this.bboxes.push(w)}insertCircle(o,u,m,_){this._forEachCell(u-_,m-_,u+_,m+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(u),this.circles.push(m),this.circles.push(_)}_insertBoxCell(o,u,m,_,w,S){this.boxCells[w].push(S)}_insertCircleCell(o,u,m,_,w,S){this.circleCells[w].push(S)}_query(o,u,m,_,w,S){if(m<0||o>this.width||_<0||u>this.height)return!w&&[];const C=[];if(o<=0&&u<=0&&this.width<=m&&this.height<=_){if(w)return!0;for(let k=0;k<this.boxKeys.length;k++)C.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const z=this.circles[3*k],L=this.circles[3*k+1],N=this.circles[3*k+2];C.push({key:this.circleKeys[k],x1:z-N,y1:L-N,x2:z+N,y2:L+N})}return S?C.filter(S):C}return this._forEachCell(o,u,m,_,this._queryCell,C,{hitTest:w,seenUids:{box:{},circle:{}}},S),w?C.length>0:C}_queryCircle(o,u,m,_,w){const S=o-m,C=o+m,k=u-m,z=u+m;if(C<0||S>this.width||z<0||k>this.height)return!_&&[];const L=[];return this._forEachCell(S,k,C,z,this._queryCellCircle,L,{hitTest:_,circle:{x:o,y:u,radius:m},seenUids:{box:{},circle:{}}},w),_?L.length>0:L}query(o,u,m,_,w){return this._query(o,u,m,_,!1,w)}hitTest(o,u,m,_,w){return this._query(o,u,m,_,!0,w)}hitTestCircle(o,u,m,_){return this._queryCircle(o,u,m,!0,_)}_queryCell(o,u,m,_,w,S,C,k){const z=C.seenUids,L=this.boxCells[w];if(L!==null){const W=this.bboxes;for(const J of L)if(!z.box[J]){z.box[J]=!0;const ne=4*J;if(o<=W[ne+2]&&u<=W[ne+3]&&m>=W[ne+0]&&_>=W[ne+1]&&(!k||k(this.boxKeys[J]))){if(C.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[J],x1:W[ne],y1:W[ne+1],x2:W[ne+2],y2:W[ne+3]})}}}const N=this.circleCells[w];if(N!==null){const W=this.circles;for(const J of N)if(!z.circle[J]){z.circle[J]=!0;const ne=3*J;if(this._circleAndRectCollide(W[ne],W[ne+1],W[ne+2],o,u,m,_)&&(!k||k(this.circleKeys[J]))){if(C.hitTest)return S.push(!0),!0;{const te=W[ne],re=W[ne+1],U=W[ne+2];S.push({key:this.circleKeys[J],x1:te-U,y1:re-U,x2:te+U,y2:re+U})}}}}}_queryCellCircle(o,u,m,_,w,S,C,k){const z=C.circle,L=C.seenUids,N=this.boxCells[w];if(N!==null){const J=this.bboxes;for(const ne of N)if(!L.box[ne]){L.box[ne]=!0;const te=4*ne;if(this._circleAndRectCollide(z.x,z.y,z.radius,J[te+0],J[te+1],J[te+2],J[te+3])&&(!k||k(this.boxKeys[ne])))return S.push(!0),!0}}const W=this.circleCells[w];if(W!==null){const J=this.circles;for(const ne of W)if(!L.circle[ne]){L.circle[ne]=!0;const te=3*ne;if(this._circlesCollide(J[te],J[te+1],J[te+2],z.x,z.y,z.radius)&&(!k||k(this.circleKeys[ne])))return S.push(!0),!0}}}_forEachCell(o,u,m,_,w,S,C,k){const z=this._convertToXCellCoord(o),L=this._convertToYCellCoord(u),N=this._convertToXCellCoord(m),W=this._convertToYCellCoord(_);for(let J=z;J<=N;J++)for(let ne=L;ne<=W;ne++)if(w.call(this,o,u,m,_,this.xCellCount*ne+J,S,C,k))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,u,m,_,w,S){const C=_-o,k=w-u,z=m+S;return z*z>C*C+k*k}_circleAndRectCollide(o,u,m,_,w,S,C){const k=(S-_)/2,z=Math.abs(o-(_+k));if(z>k+m)return!1;const L=(C-w)/2,N=Math.abs(u-(w+L));if(N>L+m)return!1;if(z<=k||N<=L)return!0;const W=z-k,J=N-L;return W*W+J*J<=m*m}}const To={unknown:0,flipRequired:1,flipNotRequired:2},Cl=Math.tan(85*Math.PI/180);function Be(f,o,u,m,_,w,S){const C=a.create();if(u)if(w.name==="globe"){const k=a.calculateGlobeLabelMatrix(_,o);a.multiply(C,C,k)}else{const k=Te([],S);C[0]=k[0],C[1]=k[1],C[4]=k[2],C[5]=k[3],m||a.rotateZ(C,C,_.angle)}else a.multiply(C,_.labelPlaneMatrix,f);return C}function Eo(f,o,u,m,_,w,S){const C=Be(f,o,u,m,_,w,S);return w.name==="globe"&&u||(C[2]=C[6]=C[10]=C[14]=0),C}function Yn(f,o,u,m,_,w,S){if(u){if(w.name==="globe"){const C=Be(f,o,u,m,_,w,S);return a.invert(C,C),a.multiply(C,f,C),C}{const C=a.clone(f),k=a.identity([]);return k[0]=S[0],k[1]=S[1],k[4]=S[2],k[5]=S[3],a.multiply(C,C,k),m||a.rotateZ(C,C,-_.angle),C}}return _.glCoordMatrix}function _r(f,o,u,m){const _=[f,o,u,1];u?a.transformMat4$1(_,_,m):Ht(_,_,m);const w=_[3];return _[0]/=w,_[1]/=w,_[2]/=w,_}function Ip(f,o){return Math.min(.5+f/o*.5,1.5)}function eo(f,o){const u=f[0]/f[3],m=f[1]/f[3];return u>=-o[0]&&u<=o[0]&&m>=-o[1]&&m<=o[1]}function Uh(f,o,u,m,_,w,S,C,k,z){const L=u.transform,N=m?f.textSizeData:f.iconSizeData,W=a.evaluateSizeForZoom(N,u.transform.zoom),J=L.projection.name==="globe",ne=[256/u.width*2+1,256/u.height*2+1],te=m?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;te.clear();let re=null;J&&(re=m?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const U=f.lineVertexArray,K=m?f.text.placedSymbolArray:f.icon.placedSymbolArray,ae=u.transform.width/u.transform.height;let le,ye=!1;for(let xe=0;xe<K.length;xe++){const _e=K.get(xe),{numGlyphs:Se,writingMode:Ee}=_e;if(Ee!==a.WritingMode.vertical||ye||le===a.WritingMode.horizontal||(ye=!0),le=Ee,(_e.hidden||Ee===a.WritingMode.vertical)&&!ye){Fi(Se,te);continue}ye=!1;const De=new a.Point(_e.tileAnchorX,_e.tileAnchorY);let{x:Ye,y:ke,z:$e}=L.projection.projectTilePoint(De.x,De.y,z.canonical);if(k){const[At,_t,Pt]=k(De);Ye+=At,ke+=_t,$e+=Pt}const ze=[Ye,ke,$e,1];if(a.transformMat4$1(ze,ze,o),!eo(ze,ne)){Fi(Se,te);continue}const Ke=Ip(u.transform.cameraToCenterDistance,ze[3]),Ae=a.evaluateSizeForFeature(N,W,_e),Ve=S?Ae/Ke:Ae*Ke,Qe=_r(Ye,ke,$e,_);if(Qe[3]<=0){Fi(Se,te);continue}let qe={};const et=S?null:k,Tt=ft(_e,Ve,!1,C,o,_,w,f.glyphOffsetArray,U,te,re,Qe,De,qe,ae,et,L.projection,z,S);ye=Tt.useVertical,et&&Tt.needsFlipping&&(qe={}),(Tt.notEnoughRoom||ye||Tt.needsFlipping&&ft(_e,Ve,!0,C,o,_,w,f.glyphOffsetArray,U,te,re,Qe,De,qe,ae,et,L.projection,z,S).notEnoughRoom)&&Fi(Se,te)}m?(f.text.dynamicLayoutVertexBuffer.updateData(te),re&&f.text.globeExtVertexBuffer.updateData(re)):(f.icon.dynamicLayoutVertexBuffer.updateData(te),re&&f.icon.globeExtVertexBuffer.updateData(re))}function Ap(f,o,u,m,_,w,S,C,k,z,L,N,W,J,ne,te){const{lineStartIndex:re,glyphStartIndex:U,segment:K}=C,ae=U+C.numGlyphs,le=re+C.lineLength,ye=o.getoffsetX(U),xe=o.getoffsetX(ae-1),_e=ci(f*ye,u,m,_,w,S,K,re,le,k,z,L,N,W,!0,J,ne,te);if(!_e)return null;const Se=ci(f*xe,u,m,_,w,S,K,re,le,k,z,L,N,W,!0,J,ne,te);return Se?{first:_e,last:Se}:null}function ua(f,o,u,m){return f===a.WritingMode.horizontal&&Math.abs(m)>Math.abs(u)?{useVertical:!0}:f===a.WritingMode.vertical?m>0?{needsFlipping:!0}:null:o!==To.unknown&&function(_,w){return _===0||Math.abs(w/_)>Cl}(u,m)?o===To.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function ft(f,o,u,m,_,w,S,C,k,z,L,N,W,J,ne,te,re,U,K){const ae=o/24,le=f.lineOffsetX*ae,ye=f.lineOffsetY*ae,{lineStartIndex:xe,glyphStartIndex:_e,numGlyphs:Se,segment:Ee,writingMode:De,flipState:Ye}=f,ke=xe+f.lineLength,$e=ze=>{if(L){const[Qe,qe,et]=ze.up,Tt=z.length;a.updateGlobeVertexNormal(L,Tt+0,Qe,qe,et),a.updateGlobeVertexNormal(L,Tt+1,Qe,qe,et),a.updateGlobeVertexNormal(L,Tt+2,Qe,qe,et),a.updateGlobeVertexNormal(L,Tt+3,Qe,qe,et)}const[Ke,Ae,Ve]=ze.point;a.addDynamicAttributes(z,Ke,Ae,Ve,ze.angle)};if(Se>1){const ze=Ap(ae,C,le,ye,u,N,W,f,k,w,J,te,!1,re,U,K);if(!ze)return{notEnoughRoom:!0};if(m&&!u){let[Ke,Ae,Ve]=ze.first.point,[Qe,qe,et]=ze.last.point;[Ke,Ae]=_r(Ke,Ae,Ve,S),[Qe,qe]=_r(Qe,qe,et,S);const Tt=ua(De,Ye,(Qe-Ke)*ne,qe-Ae);if(f.flipState=Tt&&Tt.needsFlipping?To.flipRequired:To.flipNotRequired,Tt)return Tt}$e(ze.first);for(let Ke=_e+1;Ke<_e+Se-1;Ke++){const Ae=ci(ae*C.getoffsetX(Ke),le,ye,u,N,W,Ee,xe,ke,k,w,J,te,!1,!1,re,U,K);if(!Ae)return z.length-=4*(Ke-_e),{notEnoughRoom:!0};$e(Ae)}$e(ze.last)}else{if(m&&!u){const Ke=_r(W.x,W.y,0,_),Ae=xe+Ee+1,Ve=new a.Point(k.getx(Ae),k.gety(Ae)),Qe=_r(Ve.x,Ve.y,0,_),qe=Qe[3]>0?Qe:qt(W,Ve,Ke,1,_,void 0,re,U.canonical),et=ua(De,Ye,(qe[0]-Ke[0])*ne,qe[1]-Ke[1]);if(f.flipState=et&&et.needsFlipping?To.flipRequired:To.flipNotRequired,et)return et}const ze=ci(ae*C.getoffsetX(_e),le,ye,u,N,W,Ee,xe,ke,k,w,J,te,!1,!1,re,U,K);if(!ze)return{notEnoughRoom:!0};$e(ze)}return{}}function Yt(f,o,u,m,_){const{x:w,y:S,z:C}=m.projectTilePoint(f.x,f.y,o);if(!_)return _r(w,S,C,u);const[k,z,L]=_(f);return _r(w+k,S+z,C+L,u)}function qt(f,o,u,m,_,w,S,C){const k=Yt(f.sub(o)._unit()._add(f),C,_,S,w);return a.sub(k,u,k),a.normalize(k,k),a.scaleAndAdd(k,u,k,m)}function ci(f,o,u,m,_,w,S,C,k,z,L,N,W,J,ne,te,re,U){const K=m?f-o:f+o;let ae=K>0?1:-1,le=0;m&&(ae*=-1,le=Math.PI),ae<0&&(le+=Math.PI);let ye=C+S+(ae>0?0:1)|0,xe=_,_e=_,Se=0,Ee=0;const De=Math.abs(K),Ye=[],ke=[];let $e=w,ze=$e;const Ke=()=>qt(ze,$e,_e,De-Se+1,L,W,te,re.canonical);for(;Se+Ee<=De;){if(ye+=ae,ye<C||ye>=k)return null;if(_e=xe,ze=$e,Ye.push(_e),J&&ke.push(ze),$e=new a.Point(z.getx(ye),z.gety(ye)),xe=N[ye],!xe){const Pt=Yt($e,re.canonical,L,te,W);xe=Pt[3]>0?N[ye]=Pt:Ke()}Se+=Ee,Ee=a.distance(_e,xe)}ne&&W&&(N[ye]&&(xe=Ke(),Ee=a.distance(_e,xe)),N[ye]=xe);const Ae=(De-Se)/Ee,Ve=$e.sub(ze)._mult(Ae)._add(ze),Qe=a.sub([],xe,_e),qe=a.scaleAndAdd([],_e,Qe,Ae);let et=[0,0,1],Tt=Qe[0],At=Qe[1];if(U&&(et=te.upVector(re.canonical,Ve.x,Ve.y),et[0]!==0||et[1]!==0||et[2]!==1)){const Pt=[et[2],0,-et[0]],Xt=a.cross([],et,Pt);a.normalize(Pt,Pt),a.normalize(Xt,Xt),Tt=a.dot(Qe,Pt),At=a.dot(Qe,Xt)}if(u){const Pt=a.cross([],et,Qe);a.normalize(Pt,Pt),a.scaleAndAdd(qe,qe,Pt,u*ae)}const _t=le+Math.atan2(At,Tt);return Ye.push(qe),J&&ke.push(Ve),{point:qe,angle:_t,path:Ye,tilePath:ke,up:et}}function Fi(f,o){const u=o.length,m=u+4*f;o.resize(m),o.float32.fill(-1/0,4*u,4*m)}function Ht(f,o,u){const m=o[0],_=o[1];return f[0]=u[0]*m+u[4]*_+u[12],f[1]=u[1]*m+u[5]*_+u[13],f[3]=u[3]*m+u[7]*_+u[15],f}const ui=100;class Pl{constructor(o,u,m=new Ts(o.width+200,o.height+200,25),_=new Ts(o.width+200,o.height+200,25)){this.transform=o,this.grid=m,this.ignoredGrid=_,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+ui,this.screenBottomBoundary=o.height+ui,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=u}placeCollisionBox(o,u,m,_,w,S,C,k){let z=m.projectedAnchorX,L=m.projectedAnchorY,N=m.projectedAnchorZ;const W=m.elevation,J=m.tileID,ne=o.getProjection();if(W&&J){const[xe,_e,Se]=ne.upVector(J.canonical,m.tileAnchorX,m.tileAnchorY),Ee=ne.upVectorScale(J.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=xe*W*Ee,L+=_e*W*Ee,N+=Se*W*Ee}const te=this.projectAndGetPerspectiveRatio(C,z,L,N,m.tileID,ne.name==="globe"||!!W||this.transform.pitch>0,ne),re=S*te.perspectiveRatio,U=(m.x1*u+_.x-m.padding)*re+te.point.x,K=(m.y1*u+_.y-m.padding)*re+te.point.y,ae=(m.x2*u+_.x+m.padding)*re+te.point.x,le=(m.y2*u+_.y+m.padding)*re+te.point.y,ye=te.perspectiveRatio<=.55||te.occluded;return!this.isInsideGrid(U,K,ae,le)||!w&&this.grid.hitTest(U,K,ae,le,k)||ye?{box:[],offscreen:!1,occluded:te.occluded}:{box:[U,K,ae,le],offscreen:this.isOffscreen(U,K,ae,le),occluded:!1}}placeCollisionCircles(o,u,m,_,w,S,C,k,z,L,N,W,J,ne,te){const re=[],U=this.transform.elevation,K=o.getProjection(),ae=U?U.getAtTileOffsetFunc(te,this.transform.center.lat,this.transform.worldSize,K):null,le=new a.Point(m.tileAnchorX,m.tileAnchorY);let{x:ye,y:xe,z:_e}=K.projectTilePoint(le.x,le.y,te.canonical);if(ae){const[Ve,Qe,qe]=ae(le);ye+=Ve,xe+=Qe,_e+=qe}const Se=K.name==="globe",Ee=this.projectAndGetPerspectiveRatio(C,ye,xe,_e,te,Se||!!U||this.transform.pitch>0,K),{perspectiveRatio:De}=Ee,Ye=(N?S/De:S*De)/a.ONE_EM,ke=_r(ye,xe,_e,k),$e=Ee.signedDistanceFromCamera>0?Ap(Ye,w,m.lineOffsetX*Ye,m.lineOffsetY*Ye,!1,ke,le,m,_,k,{},U&&!N?ae:null,N&&!!U,K,te,N):null;let ze=!1,Ke=!1,Ae=!0;if($e&&!Ee.occluded){const Ve=.5*J*De+ne,Qe=new a.Point(-100,-100),qe=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),et=new Nh,{first:Tt,last:At}=$e,_t=Tt.path.length;let Pt=[];for(let wt=_t-1;wt>=1;wt--)Pt.push(Tt.path[wt]);for(let wt=1;wt<At.path.length;wt++)Pt.push(At.path[wt]);const Xt=2.5*Ve;z&&(Pt=Pt.map(([wt,hn,fn],pn)=>(ae&&!Se&&(fn=ae(pn<_t-1?Tt.tilePath[_t-1-pn]:At.tilePath[pn-_t+2])[2]),_r(wt,hn,fn,z))),Pt.some(wt=>wt[3]<=0)&&(Pt=[]));let Zt=[];if(Pt.length>0){let wt=1/0,hn=-1/0,fn=1/0,pn=-1/0;for(const mn of Pt)wt=Math.min(wt,mn[0]),fn=Math.min(fn,mn[1]),hn=Math.max(hn,mn[0]),pn=Math.max(pn,mn[1]);hn>=Qe.x&&wt<=qe.x&&pn>=Qe.y&&fn<=qe.y&&(Zt=[Pt.map(mn=>new a.Point(mn[0],mn[1]))],(wt<Qe.x||hn>qe.x||fn<Qe.y||pn>qe.y)&&(Zt=a.clipLine(Zt,Qe.x,Qe.y,qe.x,qe.y)))}for(const wt of Zt){et.reset(wt,.25*Ve);let hn=0;hn=et.length<=.5*Ve?1:Math.ceil(et.paddedLength/Xt)+1;for(let fn=0;fn<hn;fn++){const pn=fn/Math.max(hn-1,1),mn=et.lerp(pn),Rr=mn.x+ui,xr=mn.y+ui;re.push(Rr,xr,Ve,0);const Si=Rr-Ve,io=xr-Ve,zn=Rr+Ve,gn=xr+Ve;if(Ae=Ae&&this.isOffscreen(Si,io,zn,gn),Ke=Ke||this.isInsideGrid(Si,io,zn,gn),!u&&this.grid.hitTestCircle(Rr,xr,Ve,W)&&(ze=!0,!L))return{circles:[],offscreen:!1,collisionDetected:ze,occluded:!1}}}}return{circles:!L&&ze||!Ke?[]:re,offscreen:Ae,collisionDetected:ze,occluded:Ee.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let m=1/0,_=1/0,w=-1/0,S=-1/0;for(const L of o){const N=new a.Point(L.x+ui,L.y+ui);m=Math.min(m,N.x),_=Math.min(_,N.y),w=Math.max(w,N.x),S=Math.max(S,N.y),u.push(N)}const C=this.grid.query(m,_,w,S).concat(this.ignoredGrid.query(m,_,w,S)),k={},z={};for(const L of C){const N=L.key;if(k[N.bucketInstanceId]===void 0&&(k[N.bucketInstanceId]={}),k[N.bucketInstanceId][N.featureIndex])continue;const W=[new a.Point(L.x1,L.y1),new a.Point(L.x2,L.y1),new a.Point(L.x2,L.y2),new a.Point(L.x1,L.y2)];a.polygonIntersectsPolygon(u,W)&&(k[N.bucketInstanceId][N.featureIndex]=!0,z[N.bucketInstanceId]===void 0&&(z[N.bucketInstanceId]=[]),z[N.bucketInstanceId].push(N.featureIndex))}return z}insertCollisionBox(o,u,m,_,w){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:_,collisionGroupID:w},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,u,m,_,w){const S=u?this.ignoredGrid:this.grid,C={bucketInstanceId:m,featureIndex:_,collisionGroupID:w};for(let k=0;k<o.length;k+=4)S.insertCircle(C,o[k],o[k+1],o[k+2])}projectAndGetPerspectiveRatio(o,u,m,_,w,S,C){const k=[u,m,_,1];let z=!1;_||this.transform.pitch>0?(a.transformMat4$1(k,k,o),this.fogState&&w&&C.name!=="globe"&&(z=function(W,J,ne,te,re,U){const K=U.calculateFogTileMatrix(re),ae=[J,ne,te];return a.transformMat4(ae,ae,K),Kt(W,ae,U.pitch,U._fov)}(this.fogState,u,m,_,w.toUnwrapped(),this.transform)>.9)):Ht(k,k,o);const L=k[3];return{point:new a.Point((k[0]/L+1)/2*this.transform.width+ui,(-k[1]/L+1)/2*this.transform.height+ui),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(C)/L*.5,1.5),signedDistanceFromCamera:L,occluded:S&&k[2]>L||z}}isOffscreen(o,u,m,_){return m<ui||o>=this.screenRightBoundary||_<ui||u>this.screenBottomBoundary}isInsideGrid(o,u,m,_){return m>=0&&o<this.gridRightBoundary&&_>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const o=a.identity([]);return a.translate(o,o,[-100,-100,0]),o}}function Es(f,o,u){const m=o.createTileMatrix(f,f.worldSize,u.toUnwrapped());return a.multiply(new Float32Array(16),f.projMatrix,m)}function wi(f,o,u){if(o.projection.name===u.projection.name)return f.projMatrix;const m=u.clone();return m.setProjection(o.projection),Es(m,o.getProjection(),f)}function Ln(f,o,u){return o.name===u.projection.name?f.projMatrix:Es(u,o,f)}class Dp{constructor(o,u,m,_){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?u:-u))):_&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class So{constructor(o,u,m,_,w,S=!1){this.text=new Dp(o?o.text:null,u,m,w),this.icon=new Dp(o?o.icon:null,u,_,w),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ml{constructor(o,u,m,_=!1){this.text=o,this.icon=u,this.skipFade=m,this.clipped=_}}class kl{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Vh{constructor(o,u,m,_,w){this.bucketInstanceId=o,this.featureIndex=u,this.sourceLayerIndex=m,this.bucketIndex=_,this.tileID=w}}class Lp{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const u=++this.maxGroupID;this.collisionGroups[o]={ID:u,predicate:m=>m.collisionGroupID===u}}return this.collisionGroups[o]}}function Il(f,o,u,m,_){const{horizontalAlign:w,verticalAlign:S}=a.getAnchorAlignment(f),C=-(w-.5)*o,k=-(S-.5)*u,z=a.evaluateVariableOffset(f,m);return new a.Point(C+z[0]*_,k+z[1]*_)}function Al(f,o,u,m,_){const w=new a.Point(f,o);return u&&w._rotate(m?_:-_),w}class Jc{constructor(o,u,m,_,w){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new Pl(this.transform,w),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Lp(m),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,u,m,_){const w=m.getBucket(u),S=m.latestFeatureIndex;if(!w||!S||u.id!==w.layerIds[0])return;const C=w.layers[0].layout,k=m.collisionBoxArray,z=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),L=m.tileSize/a.EXTENT,N=m.tileID.toUnwrapped();this.transform.setProjection(w.projection);const W=(J=m.tileID,ne=w.getProjection(),te=this.transform,ne.name===this.projection?te.calculateProjMatrix(J.toUnwrapped()):Es(te,ne,J));var J,ne,te;const re=C.get("text-pitch-alignment")==="map",U=C.get("text-rotation-alignment")==="map";u.compileFilter();const K=u.dynamicFilter(),ae=u.dynamicFilterNeedsFeature(),le=this.transform.calculatePixelsToTileUnitsMatrix(m),ye=Eo(W,m.tileID.canonical,re,U,this.transform,w.getProjection(),le);let xe=null;if(re){const Ee=Yn(W,m.tileID.canonical,re,U,this.transform,w.getProjection(),le);xe=a.multiply([],this.transform.labelPlaneMatrix,Ee)}let _e=null;K&&m.latestFeatureIndex&&(_e={unwrappedTileID:N,dynamicFilter:K,dynamicFilterNeedsFeature:ae,featureIndex:m.latestFeatureIndex}),this.retainedQueryData[w.bucketInstanceId]=new Vh(w.bucketInstanceId,S,w.sourceLayerIndex,w.index,m.tileID);const Se={bucket:w,layout:C,posMatrix:W,textLabelPlaneMatrix:ye,labelToScreenMatrix:xe,clippingData:_e,scale:z,textPixelRatio:L,holdingForFade:m.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(w.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(_)for(const Ee of w.sortKeyRanges){const{sortKey:De,symbolInstanceStart:Ye,symbolInstanceEnd:ke}=Ee;o.push({sortKey:De,symbolInstanceStart:Ye,symbolInstanceEnd:ke,parameters:Se})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Se})}attemptAnchorPlacement(o,u,m,_,w,S,C,k,z,L,N,W,J,ne,te,re,U,K){const{textOffset0:ae,textOffset1:le,crossTileID:ye}=W,xe=[ae,le],_e=Il(o,m,_,xe,w),Se=this.collisionIndex.placeCollisionBox(ne,w,u,Al(_e.x,_e.y,S,C,this.transform.angle),N,k,z,L.predicate);if(re){const Ee=ne.getSymbolInstanceIconSize(K,this.transform.zoom,W.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ne,Ee,re,Al(_e.x,_e.y,S,C,this.transform.angle),N,k,z,L.predicate).box.length===0)return}if(Se.box.length>0){let Ee;return this.prevPlacement&&this.prevPlacement.variableOffsets[ye]&&this.prevPlacement.placements[ye]&&this.prevPlacement.placements[ye].text&&(Ee=this.prevPlacement.variableOffsets[ye].anchor),this.variableOffsets[ye]={textOffset:xe,width:m,height:_,anchor:o,textScale:w,prevAnchor:Ee},this.markUsedJustification(ne,o,W,te),ne.allowVerticalPlacement&&(this.markUsedOrientation(ne,te,W),this.placedOrientations[ye]=te),{shift:_e,placedGlyphBoxes:Se}}}placeLayerBucketPart(o,u,m,_){const{bucket:w,layout:S,posMatrix:C,textLabelPlaneMatrix:k,labelToScreenMatrix:z,clippingData:L,textPixelRatio:N,holdingForFade:W,collisionBoxArray:J,partiallyEvaluatedTextSize:ne,partiallyEvaluatedIconSize:te,collisionGroup:re}=o.parameters,U=S.get("text-optional"),K=S.get("icon-optional"),ae=S.get("text-allow-overlap"),le=S.get("icon-allow-overlap"),ye=S.get("text-rotation-alignment")==="map",xe=S.get("text-pitch-alignment")==="map",_e=S.get("icon-text-fit")!=="none",Se=S.get("symbol-z-order")==="viewport-y";this.transform.setProjection(w.projection);let Ee=ae&&(le||!w.hasIconData()||K),De=le&&(ae||!w.hasTextData()||U);!w.collisionArrays&&J&&w.deserializeCollisionBoxes(J),m&&_&&w.updateCollisionDebugBuffers(this.transform.zoom,J);const Ye=(ke,$e,ze)=>{const{crossTileID:Ke,numVerticalGlyphVertices:Ae}=ke;if(L){const zn={zoom:this.transform.zoom,pitch:this.transform.pitch};let gn=null;if(L.dynamicFilterNeedsFeature){const rn=this.retainedQueryData[w.bucketInstanceId];gn=L.featureIndex.loadFeature({featureIndex:ke.featureIndex,bucketIndex:rn.bucketIndex,sourceLayerIndex:rn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,L.dynamicFilter)(zn,gn,this.retainedQueryData[w.bucketInstanceId].tileID.canonical,new a.Point(ke.tileAnchorX,ke.tileAnchorY),this.transform.calculateDistanceTileData(L.unwrappedTileID)))return this.placements[Ke]=new Ml(!1,!1,!1,!0),void u.add(Ke)}if(u.has(Ke))return;if(W)return void(this.placements[Ke]=new Ml(!1,!1,!1));let Ve=!1,Qe=!1,qe=!0,et=!1,Tt=!1,At=null,_t={box:null,offscreen:null,occluded:null},Pt={box:null,offscreen:null,occluded:null},Xt=null,Zt=null,wt=null,hn=0,fn=0,pn=0;ze.textFeatureIndex?hn=ze.textFeatureIndex:ke.useRuntimeCollisionCircles&&(hn=ke.featureIndex),ze.verticalTextFeatureIndex&&(fn=ze.verticalTextFeatureIndex);const mn=zn=>{zn.tileID=this.retainedQueryData[w.bucketInstanceId].tileID;const gn=this.transform.elevation;(gn||zn.elevation)&&(zn.elevation=gn?gn.getAtTileOffset(zn.tileID,zn.tileAnchorX,zn.tileAnchorY):0)},Rr=ze.textBox;if(Rr){mn(Rr);const zn=rn=>{let Jn=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!rn&&this.prevPlacement){const Vr=this.prevPlacement.placedOrientations[Ke];Vr&&(this.placedOrientations[Ke]=Vr,Jn=Vr,this.markUsedOrientation(w,Jn,ke))}return Jn},gn=(rn,Jn)=>{if(w.allowVerticalPlacement&&Ae>0&&ze.verticalTextBox){for(const Vr of w.writingModes)if(Vr===a.WritingMode.vertical?(_t=Jn(),Pt=_t):_t=rn(),_t&&_t.box&&_t.box.length)break}else _t=rn()};if(S.get("text-variable-anchor")){let rn=S.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ke]){const Mn=this.prevPlacement.variableOffsets[Ke];rn.indexOf(Mn.anchor)>0&&(rn=rn.filter(Xr=>Xr!==Mn.anchor),rn.unshift(Mn.anchor))}const Jn=(Mn,Xr,Su)=>{const Ds=w.getSymbolInstanceTextSize(ne,ke,this.transform.zoom,$e),Yl=(Mn.x2-Mn.x1)*Ds+2*Mn.padding,Do=(Mn.y2-Mn.y1)*Ds+2*Mn.padding,ts=_e&&!le?Xr:null;ts&&mn(ts);let Ls={box:[],offscreen:!1,occluded:!1};const Cu=ae?2*rn.length:rn.length;for(let Jl=0;Jl<Cu;++Jl){const Dd=this.attemptAnchorPlacement(rn[Jl%rn.length],Mn,Yl,Do,Ds,ye,xe,N,C,re,Jl>=rn.length,ke,$e,w,Su,ts,ne,te);if(Dd&&(Ls=Dd.placedGlyphBoxes,Ls&&Ls.box&&Ls.box.length)){Ve=!0,At=Dd.shift;break}}return Ls};gn(()=>Jn(Rr,ze.iconBox,a.WritingMode.horizontal),()=>{const Mn=ze.verticalTextBox;return Mn&&mn(Mn),w.allowVerticalPlacement&&!(_t&&_t.box&&_t.box.length)&&Ae>0&&Mn?Jn(Mn,ze.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),_t&&(Ve=_t.box,qe=_t.offscreen,et=_t.occluded);const Vr=zn(!(!_t||!_t.box));if(!Ve&&this.prevPlacement){const Mn=this.prevPlacement.variableOffsets[Ke];Mn&&(this.variableOffsets[Ke]=Mn,this.markUsedJustification(w,Mn.anchor,ke,Vr))}}else{const rn=(Jn,Vr)=>{const Mn=w.getSymbolInstanceTextSize(ne,ke,this.transform.zoom,$e),Xr=this.collisionIndex.placeCollisionBox(w,Mn,Jn,new a.Point(0,0),ae,N,C,re.predicate);return Xr&&Xr.box&&Xr.box.length&&(this.markUsedOrientation(w,Vr,ke),this.placedOrientations[Ke]=Vr),Xr};gn(()=>rn(Rr,a.WritingMode.horizontal),()=>{const Jn=ze.verticalTextBox;return w.allowVerticalPlacement&&Ae>0&&Jn?(mn(Jn),rn(Jn,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),zn(!!(_t&&_t.box&&_t.box.length))}}if(Xt=_t,Ve=Xt&&Xt.box&&Xt.box.length>0,qe=Xt&&Xt.offscreen,et=Xt&&Xt.occluded,ke.useRuntimeCollisionCircles){const zn=w.text.placedSymbolArray.get(ke.centerJustifiedTextSymbolIndex>=0?ke.centerJustifiedTextSymbolIndex:ke.verticalPlacedTextSymbolIndex),gn=a.evaluateSizeForFeature(w.textSizeData,ne,zn),rn=S.get("text-padding");Zt=this.collisionIndex.placeCollisionCircles(w,ae,zn,w.lineVertexArray,w.glyphOffsetArray,gn,C,k,z,m,xe,re.predicate,ke.collisionCircleDiameter*gn/a.ONE_EM,rn,this.retainedQueryData[w.bucketInstanceId].tileID),Ve=ae||Zt.circles.length>0&&!Zt.collisionDetected,qe=qe&&Zt.offscreen,et=Zt.occluded}if(ze.iconFeatureIndex&&(pn=ze.iconFeatureIndex),ze.iconBox){const zn=gn=>{mn(gn);const rn=_e&&At?Al(At.x,At.y,ye,xe,this.transform.angle):new a.Point(0,0),Jn=w.getSymbolInstanceIconSize(te,this.transform.zoom,ke.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(w,Jn,gn,rn,le,N,C,re.predicate)};Pt&&Pt.box&&Pt.box.length&&ze.verticalIconBox?(wt=zn(ze.verticalIconBox),Qe=wt.box.length>0):(wt=zn(ze.iconBox),Qe=wt.box.length>0),qe=qe&&wt.offscreen,Tt=wt.occluded}const xr=U||ke.numHorizontalGlyphVertices===0&&Ae===0,Si=K||ke.numIconVertices===0;if(xr||Si?Si?xr||(Qe=Qe&&Ve):Ve=Qe&&Ve:Qe=Ve=Qe&&Ve,Ve&&Xt&&Xt.box&&this.collisionIndex.insertCollisionBox(Xt.box,S.get("text-ignore-placement"),w.bucketInstanceId,Pt&&Pt.box&&fn?fn:hn,re.ID),Qe&&wt&&this.collisionIndex.insertCollisionBox(wt.box,S.get("icon-ignore-placement"),w.bucketInstanceId,pn,re.ID),Zt&&(Ve&&this.collisionIndex.insertCollisionCircles(Zt.circles,S.get("text-ignore-placement"),w.bucketInstanceId,hn,re.ID),m)){const zn=w.bucketInstanceId;let gn=this.collisionCircleArrays[zn];gn===void 0&&(gn=this.collisionCircleArrays[zn]=new kl);for(let rn=0;rn<Zt.circles.length;rn+=4)gn.circles.push(Zt.circles[rn+0]),gn.circles.push(Zt.circles[rn+1]),gn.circles.push(Zt.circles[rn+2]),gn.circles.push(Zt.collisionDetected?1:0)}const io=w.projection.name!=="globe";Ee=Ee&&(io||!et),De=De&&(io||!Tt),this.placements[Ke]=new Ml(Ve||Ee,Qe||De,qe||w.justReloaded),u.add(Ke)};if(Se){const ke=w.getSortedSymbolIndexes(this.transform.angle);for(let $e=ke.length-1;$e>=0;--$e){const ze=ke[$e];Ye(w.symbolInstances.get(ze),ze,w.collisionArrays[ze])}}else for(let ke=o.symbolInstanceStart;ke<o.symbolInstanceEnd;ke++)Ye(w.symbolInstances.get(ke),ke,w.collisionArrays[ke]);if(m&&w.bucketInstanceId in this.collisionCircleArrays){const ke=this.collisionCircleArrays[w.bucketInstanceId];a.invert(ke.invProjMatrix,C),ke.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(o,u,m,_){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:C,verticalPlacedTextSymbolIndex:k,crossTileID:z}=m,L=a.getAnchorJustification(u),N=_===a.WritingMode.vertical?k:L==="left"?w:L==="center"?S:L==="right"?C:-1;w>=0&&(o.text.placedSymbolArray.get(w).crossTileID=N>=0&&w!==N?0:z),S>=0&&(o.text.placedSymbolArray.get(S).crossTileID=N>=0&&S!==N?0:z),C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=N>=0&&C!==N?0:z),k>=0&&(o.text.placedSymbolArray.get(k).crossTileID=N>=0&&k!==N?0:z)}markUsedOrientation(o,u,m){const _=u===a.WritingMode.horizontal||u===a.WritingMode.horizontalOnly?u:0,w=u===a.WritingMode.vertical?u:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:z}=m,L=o.text.placedSymbolArray;S>=0&&(L.get(S).placedOrientation=_),C>=0&&(L.get(C).placedOrientation=_),k>=0&&(L.get(k).placedOrientation=_),z>=0&&(L.get(z).placedOrientation=w)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let m=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const _=u?u.symbolFadeChange(o):1,w=u?u.opacities:{},S=u?u.variableOffsets:{},C=u?u.placedOrientations:{};for(const k in this.placements){const z=this.placements[k],L=w[k];L?(this.opacities[k]=new So(L,_,z.text,z.icon,null,z.clipped),m=m||z.text!==L.text.placed||z.icon!==L.icon.placed):(this.opacities[k]=new So(null,_,z.text,z.icon,z.skipFade,z.clipped),m=m||z.text||z.icon)}for(const k in w){const z=w[k];if(!this.opacities[k]){const L=new So(z,_,!1,!1);L.isHidden()||(this.opacities[k]=L,m=m||z.text.placed||z.icon.placed)}}for(const k in S)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=S[k]);for(const k in C)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=C[k]);m?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:o)}updateLayerOpacities(o,u){const m=new Set;for(const _ of u){const w=_.getBucket(o);w&&_.latestFeatureIndex&&o.id===w.layerIds[0]&&this.updateBucketOpacities(w,m,_.collisionBoxArray)}}updateBucketOpacities(o,u,m){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const _=o.layers[0].layout,w=!!o.layers[0].dynamicFilter(),S=new So(null,0,!1,!1,!0),C=_.get("text-allow-overlap"),k=_.get("icon-allow-overlap"),z=_.get("text-variable-anchor"),L=_.get("text-rotation-alignment")==="map",N=_.get("text-pitch-alignment")==="map",W=_.get("icon-text-fit")!=="none",J=new So(null,0,C&&(k||!o.hasIconData()||_.get("icon-optional")),k&&(C||!o.hasTextData()||_.get("text-optional")),!0);!o.collisionArrays&&m&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(m);const ne=(re,U,K)=>{for(let ae=0;ae<U/4;ae++)re.opacityVertexArray.emplaceBack(K)};let te=0;for(let re=0;re<o.symbolInstances.length;re++){const U=o.symbolInstances.get(re),{numHorizontalGlyphVertices:K,numVerticalGlyphVertices:ae,crossTileID:le,numIconVertices:ye}=U,xe=u.has(le);let _e=this.opacities[le];xe?_e=S:_e||(_e=J,this.opacities[le]=_e),u.add(le);const Se=K>0||ae>0,Ee=ye>0,De=this.placedOrientations[le],Ye=De===a.WritingMode.vertical,ke=De===a.WritingMode.horizontal||De===a.WritingMode.horizontalOnly;if(!Se&&!Ee||_e.isHidden()||te++,Se){const $e=Dl(_e.text);ne(o.text,K,Ye?Nn:$e),ne(o.text,ae,ke?Nn:$e);const ze=_e.text.isHidden(),{leftJustifiedTextSymbolIndex:Ke,centerJustifiedTextSymbolIndex:Ae,rightJustifiedTextSymbolIndex:Ve,verticalPlacedTextSymbolIndex:Qe}=U,qe=o.text.placedSymbolArray,et=ze||Ye?1:0;Ke>=0&&(qe.get(Ke).hidden=et),Ae>=0&&(qe.get(Ae).hidden=et),Ve>=0&&(qe.get(Ve).hidden=et),Qe>=0&&(qe.get(Qe).hidden=ze||ke?1:0);const Tt=this.variableOffsets[le];Tt&&this.markUsedJustification(o,Tt.anchor,U,De);const At=this.placedOrientations[le];At&&(this.markUsedJustification(o,"left",U,At),this.markUsedOrientation(o,At,U))}if(Ee){const $e=Dl(_e.icon),{placedIconSymbolIndex:ze,verticalPlacedIconSymbolIndex:Ke}=U,Ae=o.icon.placedSymbolArray,Ve=_e.icon.isHidden()?1:0;ze>=0&&(ne(o.icon,ye,Ye?Nn:$e),Ae.get(ze).hidden=Ve),Ke>=0&&(ne(o.icon,U.numVerticalIconVertices,ke?Nn:$e),Ae.get(Ke).hidden=Ve)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const $e=o.collisionArrays[re];if($e){let ze=new a.Point(0,0),Ke=!0;if($e.textBox||$e.verticalTextBox){if(z){const Ve=this.variableOffsets[le];Ve?(ze=Il(Ve.anchor,Ve.width,Ve.height,Ve.textOffset,Ve.textScale),L&&ze._rotate(N?this.transform.angle:-this.transform.angle)):Ke=!1}w&&(Ke=!_e.clipped),$e.textBox&&ha(o.textCollisionBox.collisionVertexArray,_e.text.placed,!Ke||Ye,ze.x,ze.y),$e.verticalTextBox&&ha(o.textCollisionBox.collisionVertexArray,_e.text.placed,!Ke||ke,ze.x,ze.y)}const Ae=Ke&&!!(!ke&&$e.verticalIconBox);$e.iconBox&&ha(o.iconCollisionBox.collisionVertexArray,_e.icon.placed,Ae,W?ze.x:0,W?ze.y:0),$e.verticalIconBox&&ha(o.iconCollisionBox.collisionVertexArray,_e.icon.placed,!Ae,W?ze.x:0,W?ze.y:0)}}}if(o.fullyClipped=te===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const re=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=re.invProjMatrix,o.placementViewportMatrix=re.viewportMatrix,o.collisionCircleArray=re.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,u){const m=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*m>o}setStale(){this.stale=!0}}function ha(f,o,u,m,_){f.emplaceBack(o?1:0,u?1:0,m||0,_||0),f.emplaceBack(o?1:0,u?1:0,m||0,_||0),f.emplaceBack(o?1:0,u?1:0,m||0,_||0),f.emplaceBack(o?1:0,u?1:0,m||0,_||0)}const qr=Math.pow(2,25),Zn=Math.pow(2,24),$h=Math.pow(2,17),Gh=Math.pow(2,16),Hr=Math.pow(2,9),bi=Math.pow(2,8),zp=Math.pow(2,1);function Dl(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const o=f.placed?1:0,u=Math.floor(127*f.opacity);return u*qr+o*Zn+u*$h+o*Gh+u*Hr+o*bi+u*zp+o}const Nn=0;class Ll{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,u,m,_,w){const S=this._bucketParts;for(;this._currentTileIndex<o.length;)if(u.getBucketParts(S,_,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((C,k)=>C.sortKey-k.sortKey));this._currentPartIndex<S.length;){const C=S[this._currentPartIndex];if(u.placeLayerBucketPart(C,this._seenCrossTileIDs,m,C.symbolInstanceStart===0),this._currentPartIndex++,w())return!0}return!1}}class Wh{constructor(o,u,m,_,w,S,C,k){this.placement=new Jc(o,w,S,C,k),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(o,u,m){const _=a.exported.now(),w=()=>{const S=a.exported.now()-_;return!this._forceFullPlacement&&S>2};for(;this._currentPlacementIndex>=0;){const S=u[o[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=C)&&(!S.maxzoom||S.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Ll(S)),this._inProgressLayer.continuePlacement(m[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Ss=512/a.EXTENT/2;class Pr{constructor(o,u,m){this.tileID=o,this.bucketInstanceId=m,this.index=new a.KDBush(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const _=o.canonical.x*a.EXTENT,w=o.canonical.y*a.EXTENT;for(let S=0;S<u.length;S++){const{key:C,crossTileID:k,tileAnchorX:z,tileAnchorY:L}=u.get(S),N=Math.floor((_+z)*Ss),W=Math.floor((w+L)*Ss);this.index.add(N,W),this.keys.push(C),this.crossTileIDs.push(k)}this.index.finish()}findMatches(o,u,m){const _=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),w=Ss/Math.pow(2,u.canonical.z-this.tileID.canonical.z),S=u.canonical.x*a.EXTENT,C=u.canonical.y*a.EXTENT;for(let k=0;k<o.length;k++){const z=o.get(k);if(z.crossTileID)continue;const{key:L,tileAnchorX:N,tileAnchorY:W}=z,J=Math.floor((S+N)*w),ne=Math.floor((C+W)*w),te=this.index.range(J-_,ne-_,J+_,ne+_);for(const re of te){const U=this.crossTileIDs[re];if(this.keys[re]===L&&!m.has(U)){m.add(U),z.crossTileID=U;break}}}}}class Zh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class qh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const u=Math.round((o-this.lng)/360);if(u!==0)for(const m in this.indexes){const _=this.indexes[m],w={};for(const S in _){const C=_[S];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+u),w[C.tileID.key]=C}this.indexes[m]=w}this.lng=o}addBucket(o,u,m){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let w=0;w<u.symbolInstances.length;w++)u.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const _=this.usedCrossTileIDs[o.overscaledZ];for(const w in this.indexes){const S=this.indexes[w];if(Number(w)>o.overscaledZ)for(const C in S){const k=S[C];k.tileID.isChildOf(o)&&k.findMatches(u.symbolInstances,o,_)}else{const C=S[o.scaledTo(Number(w)).key];C&&C.findMatches(u.symbolInstances,o,_)}}for(let w=0;w<u.symbolInstances.length;w++){const S=u.symbolInstances.get(w);S.crossTileID||(S.crossTileID=m.generate(),_.add(S.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Pr(o,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(o,u){for(const m of u.crossTileIDs)this.usedCrossTileIDs[o].delete(m)}removeStaleBuckets(o){let u=!1;for(const m in this.indexes){const _=this.indexes[m];for(const w in _)o[_[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,_[w]),delete _[w],u=!0)}return u}}class Co{constructor(){this.layerIndexes={},this.crossTileIDs=new Zh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,u,m,_){let w=this.layerIndexes[o.id];w===void 0&&(w=this.layerIndexes[o.id]=new qh);let S=!1;const C={};_.name!=="globe"&&w.handleWrapJump(m);for(const k of u){const z=k.getBucket(o);z&&o.id===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(k.tileID,z,this.crossTileIDs)&&(S=!0),C[z.bucketInstanceId]=!0)}return w.removeStaleBuckets(C)&&(S=!0),S}pruneUnusedLayers(o){const u={};o.forEach(m=>{u[m]=!0});for(const m in this.layerIndexes)u[m]||delete this.layerIndexes[m]}}const Qo=(f,o)=>a.emitValidationErrors(f,o&&o.filter(u=>u.identifier!=="source.canvas")),Qc=a.pick(cn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),m_=a.pick(cn,["setCenter","setZoom","setBearing","setPitch"]),Hh={version:8,layers:[],sources:{}},da={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class to extends a.Evented{constructor(o,u={}){super(),this.map=o,this.dispatcher=new yt(ca(),this),this.imageManager=new Dt,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(o._requestManager,u.localFontFamily?a.LocalGlyphMode.all:u.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.crossTileSymbolIndex=new Co,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const m=this;this._rtlTextPluginCallback=to.registerForPluginStateChange(_=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(w,S)=>{if(a.triggerPluginCompletionEvent(w),S&&S.every(C=>C))for(const C in m._sourceCaches){const k=m._sourceCaches[C],z=k.getSource().type;z!=="vector"&&z!=="geojson"||k.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const w=this.getSource(_.sourceId);if(w&&w.vectorLayerIds)for(const S in this._layers){const C=this._layers[S];C.source===w.id&&this._validateLayer(C)}})}loadURL(o,u={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const m=typeof u.validate=="boolean"?u.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,u.accessToken);const _=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(_,(w,S)=>{this._request=null,w?this.fire(new a.ErrorEvent(w)):S&&this._load(S,m)})}loadJSON(o,u={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(o,u.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Hh,!1)}_updateLayerCount(o,u){const m=u?1:-1;o.is3D()&&(this._num3DLayers+=m),o.type==="circle"&&(this._numCircleLayers+=m),o.type==="symbol"&&(this._numSymbolLayers+=m)}_load(o,u){if(u&&Qo(this,a.validateStyle(o)))return;this._loaded=!0,this.stylesheet=a.clone$1(o),this._updateMapProjection();for(const _ in o.sources)this.addSource(_,o.sources[_],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const m=kp(this.stylesheet.layers);this._order=m.map(_=>_.id),this._layers={},this._serializedLayers={};for(const _ of m){const w=a.createStyleLayer(_);w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new kt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(o){this._spriteRequest=function(u,m,_){let w,S,C;const k=a.exported.devicePixelRatio>1?"@2x":"";let z=a.getJSON(m.transformRequest(m.normalizeSpriteURL(u,k,".json"),a.ResourceType.SpriteJSON),(W,J)=>{z=null,C||(C=W,w=J,N())}),L=a.getImage(m.transformRequest(m.normalizeSpriteURL(u,k,".png"),a.ResourceType.SpriteImage),(W,J)=>{L=null,C||(C=W,S=J,N())});function N(){if(C)_(C);else if(w&&S){const W=a.exported.getImageData(S),J={};for(const ne in w){const{width:te,height:re,x:U,y:K,sdf:ae,pixelRatio:le,stretchX:ye,stretchY:xe,content:_e}=w[ne],Se=new a.RGBAImage({width:te,height:re});a.RGBAImage.copy(W,Se,{x:U,y:K},{x:0,y:0},{width:te,height:re}),J[ne]={data:Se,pixelRatio:le,sdf:ae,stretchX:ye,stretchY:xe,content:_e}}_(null,J)}}return{cancel(){z&&(z.cancel(),z=null),L&&(L.cancel(),L=null)}}}(o,this.map._requestManager,(u,m)=>{if(this._spriteRequest=null,u)this.fire(new a.ErrorEvent(u));else if(m)for(const _ in m)this.imageManager.addImage(_,m[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(o){const u=this.getSource(o.source);if(!u)return;const m=o.sourceLayer;m&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(m)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${u.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const u=[];for(const m of o){const _=this._layers[m];_.type!=="custom"&&u.push(_.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&(typeof o.isLayerDraped=="function"?o.isLayerDraped():da[o.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const u=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(_.length||w.length)&&this._updateWorkerLayers(_,w);for(const S in this._updatedSources){const C=this._updatedSources[S];C==="reload"?this._reloadSource(S):C==="clear"&&this._clearSource(S)}this._updateTilesForChangedImages();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const m={};for(const _ in this._sourceCaches){const w=this._sourceCaches[_];m[_]=w.used,w.used=!1}for(const _ of this._order){const w=this._layers[_];if(w.recalculate(o,this._availableImages),!w.isHidden(o.zoom)){const C=this._getLayerSourceCache(w);C&&(C.used=!0)}const S=this.map.painter;if(S){const C=w.getProgramIds();if(!C)continue;const k=w.getProgramConfiguration(o.zoom);for(const z of C)S.useProgram(z,k)}}for(const _ in m){const w=this._sourceCaches[_];m[_]!==w.used&&w.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:w.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),Qo(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=kp(o.layers);const u=function(_,w){if(!_)return[{command:cn.setStyle,args:[w]}];let S=[];try{if(!P(_.version,w.version))return[{command:cn.setStyle,args:[w]}];P(_.center,w.center)||S.push({command:cn.setCenter,args:[w.center]}),P(_.zoom,w.zoom)||S.push({command:cn.setZoom,args:[w.zoom]}),P(_.bearing,w.bearing)||S.push({command:cn.setBearing,args:[w.bearing]}),P(_.pitch,w.pitch)||S.push({command:cn.setPitch,args:[w.pitch]}),P(_.sprite,w.sprite)||S.push({command:cn.setSprite,args:[w.sprite]}),P(_.glyphs,w.glyphs)||S.push({command:cn.setGlyphs,args:[w.glyphs]}),P(_.transition,w.transition)||S.push({command:cn.setTransition,args:[w.transition]}),P(_.light,w.light)||S.push({command:cn.setLight,args:[w.light]}),P(_.fog,w.fog)||S.push({command:cn.setFog,args:[w.fog]}),P(_.projection,w.projection)||S.push({command:cn.setProjection,args:[w.projection]});const C={},k=[];(function(N,W,J,ne){let te;for(te in W=W||{},N=N||{})N.hasOwnProperty(te)&&(W.hasOwnProperty(te)||Sl(te,J,ne));for(te in W){if(!W.hasOwnProperty(te))continue;const re=W[te];N.hasOwnProperty(te)?P(N[te],re)||(N[te].type==="geojson"&&re.type==="geojson"&&Yc(N,W,te)?J.push({command:cn.setGeoJSONSourceData,args:[te,re.data]}):Bh(te,W,J,ne)):Fh(te,W,J)}})(_.sources,w.sources,k,C);const z=[];_.layers&&_.layers.forEach(N=>{N.source&&C[N.source]?S.push({command:cn.removeLayer,args:[N.id]}):z.push(N)});let L=_.terrain;L&&C[L.source]&&(S.push({command:cn.setTerrain,args:[void 0]}),L=void 0),S=S.concat(k),P(L,w.terrain)||S.push({command:cn.setTerrain,args:[w.terrain]}),function(N,W,J){W=W||[];const ne=(N=N||[]).map(bo),te=W.map(bo),re=N.reduce(jh,{}),U=W.reduce(jh,{}),K=ne.slice(),ae=Object.create(null);let le,ye,xe,_e,Se,Ee,De;for(le=0,ye=0;le<ne.length;le++)xe=ne[le],U.hasOwnProperty(xe)?ye++:(J.push({command:cn.removeLayer,args:[xe]}),K.splice(K.indexOf(xe,ye),1));for(le=0,ye=0;le<te.length;le++)xe=te[te.length-1-le],K[K.length-1-le]!==xe&&(re.hasOwnProperty(xe)?(J.push({command:cn.removeLayer,args:[xe]}),K.splice(K.lastIndexOf(xe,K.length-ye),1)):ye++,Ee=K[K.length-le],J.push({command:cn.addLayer,args:[U[xe],Ee]}),K.splice(K.length-le,0,xe),ae[xe]=!0);for(le=0;le<te.length;le++)if(xe=te[le],_e=re[xe],Se=U[xe],!ae[xe]&&!P(_e,Se))if(P(_e.source,Se.source)&&P(_e["source-layer"],Se["source-layer"])&&P(_e.type,Se.type)){for(De in Qi(_e.layout,Se.layout,J,xe,null,cn.setLayoutProperty),Qi(_e.paint,Se.paint,J,xe,null,cn.setPaintProperty),P(_e.filter,Se.filter)||J.push({command:cn.setFilter,args:[xe,Se.filter]}),P(_e.minzoom,Se.minzoom)&&P(_e.maxzoom,Se.maxzoom)||J.push({command:cn.setLayerZoomRange,args:[xe,Se.minzoom,Se.maxzoom]}),_e)_e.hasOwnProperty(De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?Qi(_e[De],Se[De],J,xe,De.slice(6),cn.setPaintProperty):P(_e[De],Se[De])||J.push({command:cn.setLayerProperty,args:[xe,De,Se[De]]}));for(De in Se)Se.hasOwnProperty(De)&&!_e.hasOwnProperty(De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?Qi(_e[De],Se[De],J,xe,De.slice(6),cn.setPaintProperty):P(_e[De],Se[De])||J.push({command:cn.setLayerProperty,args:[xe,De,Se[De]]}))}else J.push({command:cn.removeLayer,args:[xe]}),Ee=K[K.lastIndexOf(xe)+1],J.push({command:cn.addLayer,args:[Se,Ee]})}(z,w.layers,S)}catch(C){console.warn("Unable to compute style diff:",C),S=[{command:cn.setStyle,args:[w]}]}return S}(this.serialize(),o).filter(_=>!(_.command in m_));if(u.length===0)return!1;const m=u.filter(_=>!(_.command in Qc));if(m.length>0)throw new Error(`Unimplemented: ${m.map(_=>_.command).join(", ")}.`);return u.forEach(_=>{_.command!=="setTransition"&&_.command!=="setProjection"&&this[_.command].apply(this,_.args)}),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,u){return this.getImage(o)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,u),this._afterImageUpdated(o),this)}updateImage(o,u){this.imageManager.updateImage(o,u)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,u,m={}){if(this._checkLoaded(),this.getSource(o)!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.validateSource,`sources.${o}`,u,null,m))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const _=Wt(o,u,this.dispatcher,this);_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:_.serialize(),sourceId:o}));const w=S=>{const C=(S?"symbol:":"other:")+o,k=this._sourceCaches[C]=new a.SourceCache(C,_,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[o]=k,k.style=this,k.onAdd(this.map)};w(!1),u.type!=="vector"&&u.type!=="geojson"||w(!0),_.onAdd&&_.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const u=this.getSource(o);if(!u)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===o)return this.fire(new a.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new a.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const m=this._getSourceCaches(o);for(const _ of m)delete this._sourceCaches[_.id],delete this._updatedSources[_.id],_.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,u){this._checkLoaded(),this.getSource(o).setData(u),this._changed=!0}getSource(o){const u=this._getSourceCache(o);return u&&u.getSource()}_getSources(){const o=[];for(const u in this._otherSourceCaches){const m=this._getSourceCache(u);m&&o.push(m.getSource())}return o}addLayer(o,u,m={}){this._checkLoaded();const _=o.id;if(this.getLayer(_))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${_}" already exists on this map`)));let w;if(o.type==="custom"){if(Qo(this,a.validateCustomStyleLayer(o)))return;w=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(_,o.source),o=a.clone$1(o),o=a.extend(o,{source:_})),this._validate(a.validateLayer,`layers.${_}`,o,{arrayIndex:-1},m))return;w=a.createStyleLayer(o),this._validateLayer(w),w.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}const S=u?this._order.indexOf(u):this._order.length;if(u&&S===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(S,0,_),this._layerOrderChanged=!0,this._layers[_]=w;const C=this._getLayerSourceCache(w);if(this._removedLayers[_]&&w.source&&C&&w.type!=="custom"){const k=this._removedLayers[_];delete this._removedLayers[_],k.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",C.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,u){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===u)return;const m=this._order.indexOf(o);this._order.splice(m,1);const _=u?this._order.indexOf(u):this._order.length;u&&_===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(_,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const u=this._layers[o];if(!u)return void this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const m=this._order.indexOf(o);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const u in this._layers)if(this._layers[u].type===o)return!0;return!1}setLayerZoomRange(o,u,m){this._checkLoaded();const _=this.getLayer(o);_?_.minzoom===u&&_.maxzoom===m||(u!=null&&(_.minzoom=u),m!=null&&(_.maxzoom=m),this._updateLayer(_)):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,u,m={}){this._checkLoaded();const _=this.getLayer(o);if(_){if(!P(_.filter,u))return u==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(a.validateFilter,`layers.${_.id}.filter`,u,{layerType:_.type},m)||(_.filter=a.clone$1(u),this._updateLayer(_)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const u=this.getLayer(o);return u&&a.clone$1(u.filter)}setLayoutProperty(o,u,m,_={}){this._checkLoaded();const w=this.getLayer(o);w?P(w.getLayoutProperty(u),m)||(w.setLayoutProperty(u,m,_),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,u){const m=this.getLayer(o);if(m)return m.getLayoutProperty(u);this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,u,m,_={}){this._checkLoaded();const w=this.getLayer(o);w?P(w.getPaintProperty(u),m)||(w.setPaintProperty(u,m,_)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,u){const m=this.getLayer(o);return m&&m.getPaintProperty(u)}setFeatureState(o,u){this._checkLoaded();const m=o.source,_=o.sourceLayer,w=this.getSource(m);if(!w)return void this.fire(new a.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const S=w.type;if(S==="geojson"&&_)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!_)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const C=this._getSourceCaches(m);for(const k of C)k.setFeatureState(_,o.id,u)}removeFeatureState(o,u){this._checkLoaded();const m=o.source,_=this.getSource(m);if(!_)return void this.fire(new a.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const w=_.type,S=w==="vector"?o.sourceLayer:void 0;if(w==="vector"&&!S)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const C=this._getSourceCaches(m);for(const k of C)k.removeFeatureState(S,o.id,u)}getFeatureState(o){this._checkLoaded();const u=o.source,m=o.sourceLayer,_=this.getSource(u);if(_){if(_.type!=="vector"||m)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(m,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const u in this._sourceCaches){const m=this._sourceCaches[u].getSource();o[m.id]||(o[m.id]=m.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},u=>u!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0;const u=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&u&&u.getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",u.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const u=S=>this._layers[S].type==="fill-extrusion",m={},_=[];for(let S=this._order.length-1;S>=0;S--){const C=this._order[S];if(u(C)){m[C]=S;for(const k of o){const z=k[C];if(z)for(const L of z)_.push(L)}}}_.sort((S,C)=>C.intersectionZ-S.intersectionZ);const w=[];for(let S=this._order.length-1;S>=0;S--){const C=this._order[S];if(u(C))for(let k=_.length-1;k>=0;k--){const z=_[k].feature;if(m[z.layer.id]<S)break;w.push(z),_.pop()}else for(const k of o){const z=k[C];if(z)for(const L of z)w.push(L.feature)}}return w}queryRenderedFeatures(o,u,m){u&&u.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",u.filter,null,u);const _={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const k of u.layers){const z=this._layers[k];if(!z)return this.fire(new a.ErrorEvent(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];_[z.source]=!0}}const w=[];u.availableImages=this._availableImages;const S=u&&u.layers?u.layers.some(k=>{const z=this.getLayer(k);return z&&z.is3D()}):this.has3DLayers(),C=ur.createFromScreenPoints(o,m);for(const k in this._sourceCaches){const z=this._sourceCaches[k].getSource().id;u.layers&&!_[z]||w.push(On(this._sourceCaches[k],this._layers,this._serializedLayers,C,u,m,S,!!this.map._showQueryGeometry))}return this.placement&&w.push(function(k,z,L,N,W,J,ne){const te={},re=J.queryRenderedSymbols(N),U=[];for(const K of Object.keys(re).map(Number))U.push(ne[K]);U.sort(Lr);for(const K of U){const ae=K.featureIndex.lookupSymbolFeatures(re[K.bucketInstanceId],z,K.bucketIndex,K.sourceLayerIndex,W.filter,W.layers,W.availableImages,k);for(const le in ae){const ye=te[le]=te[le]||[],xe=ae[le];xe.sort((_e,Se)=>{const Ee=K.featureSortOrder;if(Ee){const De=Ee.indexOf(_e.featureIndex);return Ee.indexOf(Se.featureIndex)-De}return Se.featureIndex-_e.featureIndex});for(const _e of xe)ye.push(_e)}}for(const K in te)te[K].forEach(ae=>{const le=ae.feature,ye=L(k[K]);if(!ye)return;const xe=ye.getFeatureState(le.layer["source-layer"],le.id);le.source=le.layer.source,le.layer["source-layer"]&&(le.sourceLayer=le.layer["source-layer"]),le.state=xe});return te}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),C.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(o,u){u&&u.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",u.filter,null,u);const m=this._getSourceCaches(o);let _=[];for(const w of m)_=_.concat(Kn(w,u));return _}addSourceType(o,u,m){return to.getSourceType(o)?m(new Error(`A source type called "${o}" already exists.`)):(to.setSourceType(o,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(o,u={}){this._checkLoaded();const m=this.light.getLight();let _=!1;for(const S in o)if(!P(o[S],m[S])){_=!0;break}if(!_)return;const w=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(o,u),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,u=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let m=o;if(u===1){if(typeof m.source=="object"){const _="terrain-dem-src";this.addSource(_,m.source),m=a.clone$1(m),m=a.extend(m,{source:_})}if(this._validate(a.validateTerrain,"terrain",m))return}if(!this.terrain||this.terrain&&u!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,u)}else{const _=this.terrain,w=_.get();for(const S of Object.keys(a.spec.terrain))!m.hasOwnProperty(S)&&a.spec.terrain[S].default&&(m[S]=a.spec.terrain[S].default);for(const S in m)if(!P(m[S],w[S])){_.set(m),this.stylesheet.terrain=m;const C=this._setTransitionParameters({duration:0});_.updateTransitions(C);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const u=this.fog=new bt(o,this.map.transform);this.stylesheet.fog=o;const m=this._setTransitionParameters({duration:0});u.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,m=u.get();Object.keys(o).length===0&&u.set(o);for(const _ in o)if(!P(o[_],m[_])){u.set(o),this.stylesheet.fog=o;const w=this._setTransitionParameters({duration:0});u.updateTransitions(w);break}}else this._createFog(o);this._markersNeedUpdate=!0}_setTransitionParameters(o){return{now:a.exported.now(),transition:a.extend(o,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter(m=>this.isLayerDraped(this._layers[m])),u=this._order.filter(m=>!this.isLayerDraped(this._layers[m]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...u)}_createTerrain(o,u){const m=this.terrain=new It(o,u);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const _=this._setTransitionParameters({duration:0});m.updateTransitions(_)}_force3DLayerUpdate(){for(const o in this._layers){const u=this._layers[o];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const u=this._layers[o];u.type==="symbol"&&this._updateLayer(u)}}_validate(o,u,m,_,w={}){return(!w||w.validate!==!1)&&Qo(this,o.call(a.validateStyle,a.extend({key:u,style:this.serialize(),value:m,styleSpec:a.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const u=this._getSourceCaches(o);for(const m of u)m.clearTiles()}_reloadSource(o){const u=this._getSourceCaches(o);for(const m of u)m.resume(),m.reload()}_reloadSources(){for(const o of this._getSources())o.reload&&o.reload()}_updateSources(o){for(const u in this._sourceCaches)this._sourceCaches[u].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const u=this._sourceCaches[o];u.resume(),u.reload()}}_updatePlacement(o,u,m,_,w=!1){let S=!1,C=!1;const k={};for(const z of this._order){const L=this._layers[z];if(L.type!=="symbol")continue;if(!k[L.source]){const W=this._getLayerSourceCache(L);if(!W)continue;k[L.source]=W.getRenderableIds(!0).map(J=>W.getTileByID(J)).sort((J,ne)=>ne.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(ne.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(L,k[L.source],o.center.lng,o.projection);S=S||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),w=w||this._layerOrderChanged||m===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(w||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),o.zoom))&&(this.pauseablePlacement=new Wh(o,this._order,w,u,m,_,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),C=!0),S&&this.pauseablePlacement.placement.setStale()),C||S)for(const z of this._order){const L=this._layers[z];L.type==="symbol"&&this.placement.updateLayerOpacities(L,k[L.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,u,m){this.imageManager.getImages(u.icons,m),this._updateTilesForChangedImages();const _=w=>{w&&w.setDependencies(u.tileID.key,u.type,u.icons)};_(this._otherSourceCaches[u.source]),_(this._symbolSourceCaches[u.source])}getGlyphs(o,u,m){this.glyphManager.getGlyphs(u.stacks,m)}getResource(o,u,m){return a.makeRequest(u,m)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const u=[];return this._otherSourceCaches[o]&&u.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&u.push(this._symbolSourceCaches[o]),u}_isSourceCacheLoaded(o){const u=this._getSourceCaches(o);return u.length===0?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):u.every(m=>m.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}to.getSourceType=function(f){return Ft[f]},to.setSourceType=function(f,o){Ft[f]=o},to.registerForPluginStateChange=a.registerForPluginStateChange;var Xh=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Cs="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Po=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,zl=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Mo=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let eu={},fa={};const Rl=[];pa(Xh,Rl),pa(Po,Rl),pa(zl,Rl),pa(Mo,Rl),eu=un("",Po),fa=un(Mo,zl);const Rp=un(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),tu=Xh,Kh=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Yh={background:un(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:un(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:un(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:un("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:un(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:un(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:un("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:un("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:un("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:un(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:un(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:un(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:un(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:un(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:un(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:un(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:un(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:un(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:un(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:un(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:un(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:un(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:un(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:un(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:un(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:un(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Cs),skyboxGradient:un(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Cs),skyboxCapture:un(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:un(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:un(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function pa(f,o){const u=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of u)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=m.split(" ");for(const w of _)o.includes(w)||o.push(w)}}function un(f,o){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),_={},w=[...Rl];return pa(f,w),pa(o,w),{fragmentSource:f=f.replace(u,(S,C,k,z,L)=>(_[L]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${L}
varying ${k} ${z} ${L};
#else
uniform ${k} ${z} u_${L};
#endif
`:`
#ifdef HAS_UNIFORM_u_${L}
    ${k} ${z} ${L} = u_${L};
#endif
`)),vertexSource:o=o.replace(u,(S,C,k,z,L)=>{const N=z==="float"?"vec2":"vec4",W=L.match(/color/)?"color":N;return _[L]?C==="define"?`
#ifndef HAS_UNIFORM_u_${L}
uniform lowp float u_${L}_t;
attribute ${k} ${N} a_${L};
varying ${k} ${z} ${L};
#else
uniform ${k} ${z} u_${L};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${L}
    ${L} = a_${L};
#else
    ${k} ${z} ${L} = u_${L};
#endif
`:`
#ifndef HAS_UNIFORM_u_${L}
    ${L} = unpack_mix_${W}(a_${L}, u_${L}_t);
#else
    ${k} ${z} ${L} = u_${L};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${L}
uniform lowp float u_${L}_t;
attribute ${k} ${N} a_${L};
#else
uniform ${k} ${z} u_${L};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${L}
    ${k} ${z} ${L} = a_${L};
#else
    ${k} ${z} ${L} = u_${L};
#endif
`:`
#ifndef HAS_UNIFORM_u_${L}
    ${k} ${z} ${L} = unpack_mix_${W}(a_${L}, u_${L}_t);
#else
    ${k} ${z} ${L} = u_${L};
#endif
`}),staticAttributes:m,usedDefines:w}}class g_{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,u,m,_,w,S,C){this.context=o;let k=this.boundPaintVertexBuffers.length!==_.length;for(let L=0;!k&&L<_.length;L++)this.boundPaintVertexBuffers[L]!==_[L]&&(k=!0);let z=this.boundDynamicVertexBuffers.length!==C.length;for(let L=0;!z&&L<C.length;L++)this.boundDynamicVertexBuffers[L]!==C[L]&&(z=!0);if(!o.extVertexArrayObject||!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==m||k||z||this.boundIndexBuffer!==w||this.boundVertexOffset!==S)this.freshBind(u,m,_,w,S,C);else{o.bindVertexArrayOES.set(this.vao);for(const L of C)L&&L.bind();w&&w.dynamicDraw&&w.bind()}}freshBind(o,u,m,_,w,S){let C;const k=o.numAttributes,z=this.context,L=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),C=0,this.boundProgram=o,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=_,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=S;else{C=z.currentNumAttributes||0;for(let N=k;N<C;N++)L.disableVertexAttribArray(N)}u.enableAttributes(L,o),u.bind(),u.setVertexAttribPointers(L,o,w);for(const N of m)N.enableAttributes(L,o),N.bind(),N.setVertexAttribPointers(L,o,w);for(const N of S)N&&(N.enableAttributes(L,o),N.bind(),N.setVertexAttribPointers(L,o,w));_&&_.bind(),z.currentNumAttributes=k}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Jh(f,o){const u=Math.pow(2,o.canonical.z),m=o.canonical.y;return[new a.MercatorCoordinate(0,m/u).toLngLat().lat,new a.MercatorCoordinate(0,(m+1)/u).toLngLat().lat]}function Op(f,o,u,m,_,w,S){const C=f.context,k=C.gl,z=u.fbo;if(!z)return;f.prepareDrawTile();const L=f.useProgram("hillshade");C.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,z.colorAttachment.get());const N=((te,re,U,K)=>{const ae=U.paint.get("hillshade-shadow-color"),le=U.paint.get("hillshade-highlight-color"),ye=U.paint.get("hillshade-accent-color");let xe=U.paint.get("hillshade-illumination-direction")*(Math.PI/180);U.paint.get("hillshade-illumination-anchor")==="viewport"&&(xe-=te.transform.angle);const _e=!te.options.moving;return{u_matrix:K||te.transform.calculateProjMatrix(re.tileID.toUnwrapped(),_e),u_image:0,u_latrange:Jh(0,re.tileID),u_light:[U.paint.get("hillshade-exaggeration"),xe],u_shadow:ae,u_highlight:le,u_accent:ye}})(f,u,m,f.terrain?o.projMatrix:null);f.prepareDrawProgram(C,L,o.toUnwrapped());const{tileBoundsBuffer:W,tileBoundsIndexBuffer:J,tileBoundsSegments:ne}=f.getTileBoundsBuffers(u);L.draw(C,k.TRIANGLES,_,w,S,a.CullFaceMode.disabled,N,m.id,W,J,ne)}function Qh(f,o,u){if(!o.needsDEMTextureUpload)return;const m=f.context,_=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||f.getTileTexture(u.stride);const w=u.getPixels();o.demTexture?o.demTexture.update(w,{premultiply:!1}):o.demTexture=new a.Texture(m,w,_.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function Fp(f,o,u,m,_,w){const S=f.context,C=S.gl;if(!o.dem)return;const k=o.dem;if(S.activeTexture.set(C.TEXTURE1),Qh(f,o,k),!o.demTexture)return;o.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);const z=k.dim;S.activeTexture.set(C.TEXTURE0);let L=o.fbo;if(!L){const ne=new a.Texture(S,{width:z,height:z,data:null},C.RGBA);ne.bind(C.LINEAR,C.CLAMP_TO_EDGE),L=o.fbo=S.createFramebuffer(z,z,!0),L.colorAttachment.set(ne.texture)}S.bindFramebuffer.set(L.framebuffer),S.viewport.set([0,0,z,z]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:W,tileBoundsSegments:J}=f.getMercatorTileBoundsBuffers();f.useProgram("hillshadePrepare").draw(S,C.TRIANGLES,m,_,w,a.CullFaceMode.disabled,((ne,te)=>{const re=te.stride,U=a.create();return a.ortho(U,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(U,U,[0,-a.EXTENT,0]),{u_matrix:U,u_image:1,u_dimension:[re,re],u_zoom:ne.overscaledZ,u_unpack:te.unpackVector}})(o.tileID,k),u.id,N,W,J),o.needsHillshadePrepare=!1}const ed=f=>({u_matrix:new a.UniformMatrix4f(f),u_image0:new a.Uniform1i(f),u_skirt_height:new a.Uniform1f(f)}),ma=(f,o)=>({u_matrix:f,u_image0:0,u_skirt_height:o}),nu=(f,o,u,m,_,w,S,C,k,z,L,N,W,J,ne)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:u,u_zoom_transition:_,u_merc_center:w,u_image0:0,u_frustum_tl:S,u_frustum_tr:C,u_frustum_br:k,u_frustum_bl:z,u_globe_pos:L,u_globe_radius:N,u_viewport:W,u_grid_matrix:ne?Float32Array.from(ne):new Float32Array(9),u_skirt_height:J});function ga(f,o){return f!=null&&o!=null&&!(!f.hasData()||!o.hasData())&&f.demTexture!=null&&o.demTexture!=null&&f.tileID.key!==o.tileID.key}const ko=new class{constructor(){this.operations={}}newMorphing(f,o,u,m,_){if(f in this.operations){const w=this.operations[f];w.to.tileID.key!==u.tileID.key&&(w.queued=u)}else this.operations[f]={startTime:m,phase:0,duration:_,from:o,to:u,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const o=this.operations[f];return{from:o.from,to:o.to,phase:o.phase}}update(f){for(const o in this.operations){const u=this.operations[o];for(u.phase=(f-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,f)){delete this.operations[o];break}}}_nextOp(f,o){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=o,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},Ps={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function ru(f){return 6*Math.pow(1.5,22-f)}function Bp(f,o){const u=1<<f.z;return!o&&(f.x===0||f.x===u-1)||f.y===0||f.y===u-1}const Ol=f=>({u_matrix:f});function td(f,o,u,m,_){if(_>0){const w=a.exported.now(),S=(w-f.timeAdded)/_,C=o?(w-o.timeAdded)/_:-1,k=u.getSource(),z=m.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),L=!o||Math.abs(o.tileID.overscaledZ-z)>Math.abs(f.tileID.overscaledZ-z),N=L&&f.refreshedUponExpiration?1:a.clamp(L?S:1-C,0,1);return f.refreshedUponExpiration&&S>=1&&(f.refreshedUponExpiration=!1),o?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}class nd extends a.SourceCache{constructor(o){const u={type:"raster-dem",maxzoom:o.transform.maxZoom},m=new yt(ca(),null),_=Wt("mock-dem",u,m,o.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,u){o.state="loaded",u(null)}}class iu extends a.SourceCache{constructor(o){const u=Wt("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new yt(ca(),null),o.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,u,m){if(o.freezeTileCoverage)return;this.transform=o;const _=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,S)=>{if(w[S.key]="",!this._tiles[S.key]){const C=new a.Tile(S,this._source.tileSize*S.overscaleFactor(),o.tileZoom);C.state="loaded",this._tiles[S.key]=C}return w},{});for(const w in this._tiles)w in _||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(o){const u=this.proxyCachedFBO[o];if(u!==void 0){const m=Object.values(u);this.renderCachePool.push(...m),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ou extends a.OverscaledTileID{constructor(o,u,m){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=u,this.projMatrix=m}}class rd extends a.Elevation{constructor(o,u){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,_,w]=function(k){const z=new a.StructArrayLayout2i4,L=new a.StructArrayLayout3ui6,N=131;z.reserve(17161),L.reserve(33800);const W=a.EXTENT/128,J=a.EXTENT+W/2,ne=J+W;for(let re=-W;re<ne;re+=W)for(let U=-W;U<ne;U+=W){const K=U<0||U>J||re<0||re>J?24575:0,ae=a.clamp(Math.round(U),0,a.EXTENT),le=a.clamp(Math.round(re),0,a.EXTENT);z.emplaceBack(ae+K,le)}const te=(re,U)=>{const K=U*N+re;L.emplaceBack(K+1,K,K+N),L.emplaceBack(K+N,K+N+1,K+1)};for(let re=1;re<129;re++)for(let U=1;U<129;U++)te(U,re);return[0,129].forEach(re=>{for(let U=0;U<130;U++)te(U,re),te(re,U)}),[z,L,32768]}(),S=o.context;this.gridBuffer=S.createVertexBuffer(m,a.posAttributes.members),this.gridIndexBuffer=S.createIndexBuffer(_),this.gridSegments=a.SegmentVector.simpleSegment(0,0,m.length,_.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,m.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new iu(u.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.EXTENT,0,a.EXTENT,0,1);const C=S.gl;this._overlapStencilMode=new a.StencilMode({func:C.GEQUAL,mask:255},0,255,C.KEEP,C.KEEP,C.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new nd(u.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,u,m){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const _=o.terrain.properties;this.sourceCache=o.terrain.drapeRenderMode===0?this._mockSourceCache:o._getSourceCache(_.get("source")),this._exaggeration=_.get("exaggeration");const w=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const S=this.getScaledDemTileSize();this.sourceCache.update(u,S,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),u.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||o.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=u.getIds().map(k=>{const z=u.getTileByID(k).tileID;return z.projMatrix=m.calculateProjMatrix(z.toUnwrapped()),z});(function(k,z){const L=z.transform.pointCoordinate(z.transform.getCameraPoint()),N=new a.Point(L.x,L.y);k.sort((W,J)=>{if(J.overscaledZ-W.overscaledZ)return J.overscaledZ-W.overscaledZ;const ne=new a.Point(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),te=new a.Point(J.canonical.x+(1<<J.canonical.z)*J.wrap,J.canonical.y),re=N.mult(1<<W.canonical.z);return re.x-=.5,re.y-=.5,re.distSqr(ne)-re.distSqr(te)})})(_,this.painter),this._previousZoom=m.zoom;const w=this.proxyToSource||{};this.proxyToSource={},_.forEach(k=>{this.proxyToSource[k.key]={}}),this.terrainTileForTile={};const S=this._style._sourceCaches;for(const k in S){const z=S[k];if(!z.used||(z!==this.sourceCache&&this.resetTileLookupCache(z.id),this._setupProxiedCoordsForOrtho(z,o[k],w),z.usedForTerrain))continue;const L=o[k];z.getSource().reparseOverscaled&&this._assignTerrainTiles(L)}this.proxiedCoords[u.id]=_.map(k=>new ou(k,k.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const C={};this._visibleDemTiles=[];for(const k of this.proxyCoords){const z=this.terrainTileForTile[k.key];if(!z)continue;const L=z.tileID.key;L in C||(this._visibleDemTiles.push(z),C[L]=L)}}_assignTerrainTiles(o){this._initializing||o.forEach(u=>{if(this.terrainTileForTile[u.key])return;const m=this._findTileCoveringTileID(u,this.sourceCache);m&&(this.terrainTileForTile[u.key]=m)})}_prepareDEMTextures(){const o=this.painter.context,u=o.gl;for(const m in this.terrainTileForTile){const _=this.terrainTileForTile[m],w=_.dem;!w||_.demTexture&&!_.needsDEMTextureUpload||(o.activeTexture.set(u.TEXTURE1),Qh(this.painter,_,w))}}_prepareDemTileUniforms(o,u,m,_){if(!u||u.demTexture==null)return!1;const w=o.tileID.canonical,S=Math.pow(2,u.tileID.canonical.z-w.z),C=_||"";return m[`u_dem_tl${C}`]=[w.x*S%1,w.y*S%1],m[`u_dem_scale${C}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,u=o.gl;if(!this._emptyDepthBufferTexture){const m=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(o,m,u.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const u=this._visibleDemTiles.reduce((m,_)=>{if(!_.dem)return m;const w=_.dem.tree.minimums[0];return w>0&&o++,m+w},0);return o?u/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,u=o.gl;o.activeTexture.set(u.TEXTURE2);const m=this._getLoadedAreaMinimum(),_=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(m,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(_,{premultiply:!1}):w=this._emptyDEMTexture=new a.Texture(o,_,u.RGBA,{premultiply:!1}),w}setupElevationDraw(o,u,m){const _=this.painter.context,w=_.gl,S=(C=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(C),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var C;S.u_dem_size=this.sourceCache.getSource().tileSize,S.u_exaggeration=this.exaggeration();let k=null,z=null,L=1;if(m&&m.morphing&&this._useVertexMorphing){const N=m.morphing.srcDemTile,W=m.morphing.dstDemTile;L=m.morphing.phase,N&&W&&(this._prepareDemTileUniforms(o,N,S,"_prev")&&(z=N),this._prepareDemTileUniforms(o,W,S)&&(k=W))}if(z&&k?(_.activeTexture.set(w.TEXTURE2),k.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),_.activeTexture.set(w.TEXTURE4),z.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),S.u_dem_lerp=L):(k=this.terrainTileForTile[o.tileID.key],_.activeTexture.set(w.TEXTURE2),(this._prepareDemTileUniforms(o,k,S)?k.demTexture:this.emptyDEMTexture).bind(w.NEAREST,w.CLAMP_TO_EDGE)),_.activeTexture.set(w.TEXTURE3),m&&m.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),this._depthFBO&&(S.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),S.u_depth_size_inv=[1,1]),m&&m.useMeterToDem&&k){const N=(1<<k.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=N}if(m&&m.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),u.setTerrainUniformValues(_,S),this.painter.transform.projection.name==="globe"){const N=this.globeUniformValues(this.painter.transform,o.tileID.canonical,m&&m.useDenormalizedUpVectorScale);u.setGlobeUniformValues(_,N)}}globeUniformValues(o,u,m){const _=o.projection;return{u_tile_tl_up:_.upVector(u,0,0),u_tile_tr_up:_.upVector(u,a.EXTENT,0),u_tile_br_up:_.upVector(u,a.EXTENT,a.EXTENT),u_tile_bl_up:_.upVector(u,0,a.EXTENT),u_tile_up_scale:m?a.globeMetersToEcef(1):_.upVectorScale(u,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const u=this.painter,m=this.painter.context;o.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,w,S,C,k){if(_.transform.projection.name==="globe")(function(z,L,N,W,J){const ne=z.context,te=ne.gl;let re,U;const K=z.options.showTerrainWireframe?2:0,ae=z.transform,le=a.globeUseCustomAntiAliasing(z,ne,ae),ye=(Ke,Ae)=>{if(U===Ke)return;const Ve=[Ps[Ke],"PROJECTION_GLOBE_VIEW"];le&&Ve.push("CUSTOM_ANTIALIASING"),Ae&&Ve.push(Ps[K]),re=z.useProgram("globeRaster",null,Ve),U=Ke},xe=z.colorModeForRenderPass(),_e=new a.DepthMode(te.LEQUAL,a.DepthMode.ReadWrite,z.depthRangeFor3D);ko.update(J);const Se=a.calculateGlobeMercatorMatrix(ae),Ee=[a.mercatorXfromLng(ae.center.lng),a.mercatorYfromLat(ae.center.lat)],De=K?[!1,!0]:[!1],Ye=z.globeSharedBuffers,ke=[ae.width*a.exported.devicePixelRatio,ae.height*a.exported.devicePixelRatio],$e=Float32Array.from(ae.globeMatrix),ze={useDenormalizedUpVectorScale:!0};if(De.forEach(Ke=>{const Ae=z.transform,Ve=ru(Ae.zoom)*L.exaggeration();U=-1;const Qe=Ke?te.LINES:te.TRIANGLES;for(const qe of W){const et=N.getTile(qe),Tt=a.StencilMode.disabled,At=L.prevTerrainTileForTile[qe.key],_t=L.terrainTileForTile[qe.key];ga(At,_t)&&ko.newMorphing(qe.key,At,_t,J,250),ne.activeTexture.set(te.TEXTURE0),et.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE);const Pt=ko.getMorphValuesForProxy(qe.key),Xt=Pt?1:0;Pt&&a.extend$1(ze,{morphing:{srcDemTile:Pt.from,dstDemTile:Pt.to,phase:a.easeCubicInOut(Pt.phase)}});const Zt=a.tileCornersToBounds(qe.canonical),wt=a.getLatitudinalLod(Zt.getCenter().lat),hn=a.getGridMatrix(qe.canonical,Zt,wt,Ae.worldSize/Ae._pixelsPerMercatorPixel),fn=a.globeNormalizeECEF(a.globeTileBounds(qe.canonical)),pn=nu(Ae.projMatrix,$e,Se,fn,a.globeToMercatorTransition(Ae.zoom),Ee,Ae.frustumCorners.TL,Ae.frustumCorners.TR,Ae.frustumCorners.BR,Ae.frustumCorners.BL,Ae.globeCenterInViewSpace,Ae.globeRadius,ke,Ve,hn);if(ye(Xt,Ke),L.setupElevationDraw(et,re,ze),z.prepareDrawProgram(ne,re,qe.toUnwrapped()),Ye){const[mn,Rr,xr]=Ke?Ye.getWirefameBuffers(z.context,wt):Ye.getGridBuffers(wt,Ve!==0);re.draw(ne,Qe,_e,Tt,xe,a.CullFaceMode.backCCW,pn,"globe_raster",mn,Rr,xr)}}}),Ye){const Ke=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];le&&Ke.push("CUSTOM_ANTIALIASING"),re=z.useProgram("globeRaster",null,Ke);for(const Ae of W){const{x:Ve,y:Qe,z:qe}=Ae.canonical,et=Qe===0,Tt=Qe===(1<<qe)-1,[At,_t,Pt,Xt]=Ye.getPoleBuffers(qe);if(Xt&&(et||Tt)){const Zt=N.getTile(Ae);ne.activeTexture.set(te.TEXTURE0),Zt.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE);let wt=a.globePoleMatrixForTile(qe,Ve,ae);const hn=a.globeNormalizeECEF(a.globeTileBounds(Ae.canonical)),fn=(pn,mn)=>pn.draw(ne,te.TRIANGLES,_e,a.StencilMode.disabled,xe,a.CullFaceMode.disabled,nu(ae.projMatrix,wt,wt,hn,0,Ee,ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.globeCenterInViewSpace,ae.globeRadius,ke,0),"globe_pole_raster",mn,Pt,Xt);L.setupElevationDraw(Zt,re,ze),z.prepareDrawProgram(ne,re,Ae.toUnwrapped()),et&&fn(re,At),Tt&&(wt=a.scale(a.create(),wt,[1,-1,1]),fn(re,_t))}}}})(_,w,S,C,k);else{const z=_.context,L=z.gl;let N,W;const J=_.options.showTerrainWireframe?2:0,ne=(ae,le)=>{if(W===ae)return;const ye=[Ps[ae]];le&&ye.push(Ps[J]),N=_.useProgram("terrainRaster",null,ye),W=ae},te=_.colorModeForRenderPass(),re=new a.DepthMode(L.LEQUAL,a.DepthMode.ReadWrite,_.depthRangeFor3D);ko.update(k);const U=_.transform,K=ru(U.zoom)*w.exaggeration();(J?[!1,!0]:[!1]).forEach(ae=>{W=-1;const le=ae?L.LINES:L.TRIANGLES,[ye,xe]=ae?w.getWirefameBuffer():[w.gridIndexBuffer,w.gridSegments];for(const _e of C){const Se=S.getTile(_e),Ee=a.StencilMode.disabled,De=w.prevTerrainTileForTile[_e.key],Ye=w.terrainTileForTile[_e.key];ga(De,Ye)&&ko.newMorphing(_e.key,De,Ye,k,250),z.activeTexture.set(L.TEXTURE0),Se.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);const ke=ko.getMorphValuesForProxy(_e.key),$e=ke?1:0;let ze;ke&&(ze={morphing:{srcDemTile:ke.from,dstDemTile:ke.to,phase:a.easeCubicInOut(ke.phase)}});const Ke=ma(_e.projMatrix,Bp(_e.canonical,U.renderWorldCopies)?K/10:K);ne($e,ae),w.setupElevationDraw(Se,N,ze),_.prepareDrawProgram(z,N,_e.toUnwrapped()),N.draw(z,le,re,Ee,te,a.CullFaceMode.backCCW,Ke,"terrain_raster",w.gridBuffer,ye,xe)}})}}(u,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const u=this.painter,m=this.painter.context,_=this.proxySourceCache,w=this.proxiedCoords[_.id],S=this._drapedRenderBatches.shift(),C=[],k=u.style.order;let z=0;for(const L of w){const N=_.getTileByID(L.proxyTileKey),W=_.proxyCachedFBO[L.key]?_.proxyCachedFBO[L.key][o]:void 0,J=W!==void 0?_.renderCache[W]:this.pool[z++],ne=W!==void 0;if(N.texture=J.tex,ne&&!J.dirty){C.push(N.tileID);continue}let te;m.bindFramebuffer.set(J.fb.framebuffer),this.renderedToTile=!1,J.dirty&&(m.clear({color:a.Color.transparent,stencil:0}),J.dirty=!1);for(let re=S.start;re<=S.end;++re){const U=u.style._layers[k[re]];if(U.isHidden(u.transform.zoom))continue;const K=u.style._getLayerSourceCache(U),ae=K?this.proxyToSource[L.key][K.id]:[L];if(!ae)continue;const le=ae;m.viewport.set([0,0,J.fb.width,J.fb.height]),te!==(K?K.id:null)&&(this._setupStencil(J,ae,U,K),te=K?K.id:null),u.renderLayer(u,K,U,le)}this.renderedToTile?(J.dirty=!0,C.push(N.tileID)):ne||--z,z===5&&(z=0,this.renderToBackBuffer(C))}return this.renderToBackBuffer(C),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),S.end+1}postRender(){}renderCacheEfficiency(o){const u=o.order.length;if(u===0)return{efficiency:100};let m,_=0,w=0,S=!1;for(let C=0;C<u;++C){const k=o._layers[o.order[C]];this._style.isLayerDraped(k)?(S&&++_,++w):S||(S=!0,m=k.id)}return w===0?{efficiency:100}:{efficiency:100*(1-_/w),firstUndrapedLayer:m}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{o=Math.min(o,u.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,u,m){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const S=w.tileID,C=1<<S.overscaledZ,{x:k,y:z}=S.canonical,L=k/C,N=(k+1)/C,W=z/C,J=(z+1)/C;return{minx:L,miny:W,maxx:N,maxy:J,t:w.dem.tree.raycastRoot(L,W,N,J,o,u,m),tile:w}});_.sort((w,S)=>(w.t!==null?w.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(const w of _){if(w.t==null)return null;const S=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,o,u,m);if(S!=null)return S}return null}_createFBO(){const o=this.painter.context,u=o.gl,m=this.drapeBufferSize;o.activeTexture.set(u.TEXTURE0);const _=new a.Texture(o,{width:m[0],height:m[1],data:null},u.RGBA);_.bind(u.LINEAR,u.CLAMP_TO_EDGE);const w=o.createFramebuffer(m[0],m[1],!1);return w.colorAttachment.set(_.texture),w.depthAttachment=new we(o,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:w,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const u=this._style._layers[o],m=u.isHidden(this.painter.transform.zoom);return u.type==="custom"?!m&&u.shouldRedrape():!m&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const m of this._style._getSources())if(m instanceof at){o=!0;break}if(!o)return;const u={};for(let m=0;m<this._style.order.length;++m){const _=this._style._layers[this._style.order[m]],w=this._style._getLayerSourceCache(_);if(w&&!u[w.id]&&!_.isHidden(this.painter.transform.zoom)&&_.type==="line"&&_.widthExpression()instanceof a.ZoomDependentExpression){u[w.id]=!0;for(const S of this.proxyCoords){const C=this.proxyToSource[S.key][w.id];if(C)for(const k of C)this._clearRenderCacheForTile(w.id,k)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const m in this._style._sourceCaches)if(this._style._sourceCaches[m]._source instanceof tt){o=!0;break}if(!o)return;const u={};for(let m=0;m<this._style.order.length;++m){const _=this._style._layers[this._style.order[m]],w=this._style._getLayerSourceCache(_);if(!w||u[w.id]||_.isHidden(this.painter.transform.zoom)||_.type!=="raster")continue;const S=_.paint.get("raster-fade-duration");for(const C of this.proxyCoords){const k=this.proxyToSource[C.key][w.id];if(k)for(const z of k){const L=td(w.getTile(z),w.findLoadedParent(z,0),w,this.painter.transform,S);(L.opacity!==1||L.mix!==0)&&this._clearRenderCacheForTile(w.id,z)}}}}_setupDrapedRenderBatches(){const o=this._style.order,u=o.length;if(u===0)return;const m=[];let _,w=0,S=this._style._layers[o[w]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++w<u;)S=this._style._layers[o[w]];for(;w<u;++w){const C=this._style._layers[o[w]];C.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(C)?_===void 0&&(_=w):_!==void 0&&(m.push({start:_,end:w-1}),_=void 0))}_!==void 0&&m.push({start:_,end:w-1}),this._drapedRenderBatches=m}_setupRenderCache(o){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const S=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let C=0;C<S.length;++C){const k=Object.values(S[C]);u.renderCachePool.push(...k)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,_=this._tilesDirty;for(let S=m.length-1;S>=0;S--){const C=m[S];if(u.getTileByID(C.key),u.proxyCachedFBO[C.key]!==void 0){const k=o[C.key],z=this.proxyToSource[C.key];let L=0;for(const N in z){const W=z[N],J=k[N];if(!J||J.length!==W.length||W.some((ne,te)=>ne!==J[te]||_[N]&&_[N].hasOwnProperty(ne.key))){L=-1;break}++L}for(const N in u.proxyCachedFBO[C.key])u.renderCache[u.proxyCachedFBO[C.key][N]].dirty=L<0||L!==Object.values(k).length}}const w=[...this._drapedRenderBatches];w.sort((S,C)=>C.end-C.start-(S.end-S.start));for(const S of w)for(const C of m){if(u.proxyCachedFBO[C.key])continue;let k=u.renderCachePool.pop();k===void 0&&u.renderCache.length<50&&(k=u.renderCache.length,u.renderCache.push(this._createFBO())),k!==void 0&&(u.proxyCachedFBO[C.key]={},u.proxyCachedFBO[C.key][S.start]=k,u.renderCache[k].dirty=!0)}this._tilesDirty={}}_setupStencil(o,u,m,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,S=w.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let C;if(m.isTileClipped())C=u.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);C=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+C>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=C,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(o,u){const m=this.painter,_=this.painter.context,w=_.gl;m._tileClippingMaskIDs={},_.setColorMode(a.ColorMode.disabled),_.setDepthMode(a.DepthMode.disabled);const S=m.useProgram("clippingMask");for(const C of o){const k=m._tileClippingMaskIDs[C.key]=--u;S.draw(_,w.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:w.ALWAYS,mask:0},k,255,w.KEEP,w.KEEP,w.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Ol(C.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(o){const u=this.painter.transform;if(o.x<0||o.x>u.width||o.y<0||o.y>u.height)return null;const m=[o.x,o.y,1,1];a.transformMat4$1(m,m,u.pixelMatrixInverse),a.scale$1(m,m,1/m[3]),m[0]/=u.worldSize,m[1]/=u.worldSize;const _=u._camera.position,w=a.mercatorZfromAltitude(1,u.center.lat),S=[_[0],_[1],_[2]/w,0],C=a.subtract([],m.slice(0,3),S);a.normalize(C,C);const k=this.raycast(S,C,this._exaggeration);return k!==null&&k?(a.scaleAndAdd(S,S,C,k),S[3]=S[2],S[2]*=w,S):null}drawDepth(){const o=this.painter,u=o.context,m=this.proxySourceCache,_=Math.ceil(o.width),w=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===_&&this._depthFBO.height===w||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const S=u.gl,C=u.createFramebuffer(_,w,!0);u.activeTexture.set(S.TEXTURE0);const k=new a.Texture(u,{width:_,height:w,data:null},S.RGBA);k.bind(S.NEAREST,S.CLAMP_TO_EDGE),C.colorAttachment.set(k.texture);const z=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,_,w);C.depthAttachment.set(z),this._depthFBO=C,this._depthTexture=k}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,_,w]),function(S,C,k,z){if(S.transform.projection.name==="globe")return;const L=S.context,N=L.gl;L.clear({depth:1});const W=S.useProgram("terrainDepth"),J=new a.DepthMode(N.LESS,a.DepthMode.ReadWrite,S.depthRangeFor3D);for(const ne of z){const te=k.getTile(ne),re=ma(ne.projMatrix,0);C.setupElevationDraw(te,W),W.draw(L,N.TRIANGLES,J,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,re,"terrain_depth",C.gridBuffer,C.gridIndexBuffer,C.gridNoSkirtSegments)}}(o,this,m,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,u,m){if(o.getSource()instanceof Gt)return this._setupProxiedCoordsForImageSource(o,u,m);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const _=this.proxiedCoords[o.id]=[],w=this.proxyCoords;for(let C=0;C<w.length;C++){const k=w[C],z=this._findTileCoveringTileID(k,o);if(z){const L=this._createProxiedId(k,z,m[k.key]&&m[k.key][o.id]);_.push(L),this.proxyToSource[k.key][o.id]=[L]}}let S=!1;for(let C=0;C<u.length;C++){const k=o.getTile(u[C]);if(!k||!k.hasData())continue;const z=this._findTileCoveringTileID(k.tileID,this.proxySourceCache);if(z&&z.tileID.canonical.z!==k.tileID.canonical.z){const L=this.proxyToSource[z.tileID.key][o.id],N=this._createProxiedId(z.tileID,k,m[z.tileID.key]&&m[z.tileID.key][o.id]);L?L.splice(L.length-1,0,N):this.proxyToSource[z.tileID.key][o.id]=[N],_.push(N),S=!0}}this._sourceTilesOverlap[o.id]=S}_setupProxiedCoordsForImageSource(o,u,m){if(!o.getSource().loaded())return;const _=this.proxiedCoords[o.id]=[],w=this.proxyCoords,S=o.getSource(),C=new a.Point(S.tileID.x,S.tileID.y)._div(1<<S.tileID.z),k=S.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((L,N)=>(L.min.x=Math.min(L.min.x,N.x-C.x),L.min.y=Math.min(L.min.y,N.y-C.y),L.max.x=Math.max(L.max.x,N.x-C.x),L.max.y=Math.max(L.max.y,N.y-C.y),L),{min:new a.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),z=(L,N)=>{const W=L.wrap+L.canonical.x/(1<<L.canonical.z),J=L.canonical.y/(1<<L.canonical.z),ne=a.EXTENT/(1<<L.canonical.z),te=N.wrap+N.canonical.x/(1<<N.canonical.z),re=N.canonical.y/(1<<N.canonical.z);return W+ne<te+k.min.x||W>te+k.max.x||J+ne<re+k.min.y||J>re+k.max.y};for(let L=0;L<w.length;L++){const N=w[L];for(let W=0;W<u.length;W++){const J=o.getTile(u[W]);if(!J||!J.hasData()||z(N,J.tileID))continue;const ne=this._createProxiedId(N,J,m[N.key]&&m[N.key][o.id]),te=this.proxyToSource[N.key][o.id];te?te.push(ne):this.proxyToSource[N.key][o.id]=[ne],_.push(ne)}}}_createProxiedId(o,u,m){let _=this.orthoMatrix;if(m){const w=m.find(S=>S.key===u.tileID.key);if(w)return w}if(u.tileID.key!==o.key){const w=o.canonical.z-u.tileID.canonical.z;let S,C,k;_=a.create();const z=u.tileID.wrap-o.wrap<<o.overscaledZ;w>0?(S=a.EXTENT>>w,C=S*((u.tileID.canonical.x<<w)-o.canonical.x+z),k=S*((u.tileID.canonical.y<<w)-o.canonical.y)):(S=a.EXTENT<<-w,C=a.EXTENT*(u.tileID.canonical.x-(o.canonical.x+z<<-w)),k=a.EXTENT*(u.tileID.canonical.y-(o.canonical.y<<-w))),a.ortho(_,0,S,0,S,0,1),a.translate(_,_,[C,k,0])}return new ou(u.tileID,o.key,_)}_findTileCoveringTileID(o,u){let m=u.getTile(o);if(m&&m.hasData())return m;const _=this._findCoveringTileCache[u.id],w=_[o.key];if(m=w?u.getTileByID(w):null,m&&m.hasData()||w===null)return m;let S=m?m.tileID:o,C=S.overscaledZ;const k=u.getSource().minzoom,z=[];if(!w){const N=u.getSource().maxzoom;if(o.canonical.z>=N){const W=o.canonical.z-N;u.getSource().reparseOverscaled?(C=Math.max(o.canonical.z+2,u.transform.tileZoom),S=new a.OverscaledTileID(C,o.wrap,N,o.canonical.x>>W,o.canonical.y>>W)):W!==0&&(C=N,S=new a.OverscaledTileID(C,o.wrap,N,o.canonical.x>>W,o.canonical.y>>W))}S.key!==o.key&&(z.push(S.key),m=u.getTile(S))}const L=N=>{z.forEach(W=>{_[W]=N}),z.length=0};for(C-=1;C>=k&&(!m||!m.hasData());C--){m&&L(m.tileID.key);const N=S.calculateScaledKey(C);if(m=u.getTileByID(N),m&&m.hasData())break;const W=_[N];if(W===null)break;W===void 0?z.push(N):m=u.getTileByID(W)}return L(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,u){let m=this._tilesDirty[o];m||(m=this._tilesDirty[o]={}),m[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=function(u){let m=0;const _=new a.StructArrayLayout2ui4,w=131;for(let S=1;S<129;S++){for(let C=1;C<129;C++)m=S*w+C,_.emplaceBack(m,m+1),_.emplaceBack(m,m+w),_.emplaceBack(m+1,m+w),S===128&&_.emplaceBack(m+w,m+w+1);_.emplaceBack(m+1,m+1+w)}return _}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class en{static cacheKey(o,u,m,_){let w=`${u}${_?_.cacheKey:""}`;for(const S of m)o.usedDefines.includes(S)&&(w+=`/${S}`);return w}constructor(o,u,m,_,w,S){const C=o.gl;this.program=C.createProgram();const k=function(U){const K=[];for(let ae=0;ae<U.length;ae++){if(U[ae]===null)continue;const le=U[ae].split(" ");K.push(le.pop())}return K}(m.staticAttributes),z=_?_.getBinderAttributes():[],L=k.concat(z);let N=_?_.defines():[];N=N.concat(S.map(U=>`#define ${U}`));const W=o.isWebGL2?`#version 300 es
`:"",J=W+N.concat(o.extStandardDerivatives&&W.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Kh):Kh,Kh,tu,Rp.fragmentSource,fa.fragmentSource,m.fragmentSource).join(`
`),ne=W+N.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,tu,Rp.vertexSource,fa.vertexSource,eu.vertexSource,m.vertexSource).join(`
`),te=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(te,J),C.compileShader(te),C.attachShader(this.program,te);const re=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(re,ne),C.compileShader(re),C.attachShader(this.program,re),this.attributes={},this.numAttributes=L.length;for(let U=0;U<this.numAttributes;U++)L[U]&&(C.bindAttribLocation(this.program,U,L[U]),this.attributes[L[U]]=U);C.linkProgram(this.program),C.deleteShader(re),C.deleteShader(te),this.fixedUniforms=w(o),this.binderUniforms=_?_.getUniforms(o):[],S.includes("TERRAIN")&&(this.terrainUniforms=(U=>({u_dem:new a.Uniform1i(U),u_dem_prev:new a.Uniform1i(U),u_dem_unpack:new a.Uniform4f(U),u_dem_tl:new a.Uniform2f(U),u_dem_scale:new a.Uniform1f(U),u_dem_tl_prev:new a.Uniform2f(U),u_dem_scale_prev:new a.Uniform1f(U),u_dem_size:new a.Uniform1f(U),u_dem_lerp:new a.Uniform1f(U),u_exaggeration:new a.Uniform1f(U),u_depth:new a.Uniform1i(U),u_depth_size_inv:new a.Uniform2f(U),u_meter_to_dem:new a.Uniform1f(U),u_label_plane_matrix_inv:new a.UniformMatrix4f(U)}))(o)),S.includes("GLOBE")&&(this.globeUniforms=(U=>({u_tile_tl_up:new a.Uniform3f(U),u_tile_tr_up:new a.Uniform3f(U),u_tile_br_up:new a.Uniform3f(U),u_tile_bl_up:new a.Uniform3f(U),u_tile_up_scale:new a.Uniform1f(U)}))(o)),S.includes("FOG")&&(this.fogUniforms=(U=>({u_fog_matrix:new a.UniformMatrix4f(U),u_fog_range:new a.Uniform2f(U),u_fog_color:new a.Uniform4f(U),u_fog_horizon_blend:new a.Uniform1f(U),u_fog_temporal_offset:new a.Uniform1f(U),u_frustum_tl:new a.Uniform3f(U),u_frustum_tr:new a.Uniform3f(U),u_frustum_br:new a.Uniform3f(U),u_frustum_bl:new a.Uniform3f(U),u_globe_pos:new a.Uniform3f(U),u_globe_radius:new a.Uniform1f(U),u_globe_transition:new a.Uniform1f(U),u_is_globe:new a.Uniform1i(U),u_viewport:new a.Uniform2f(U)}))(o))}}setTerrainUniformValues(o,u){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const _ in u)m[_]&&m[_].set(this.program,_,u[_])}}setGlobeUniformValues(o,u){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const _ in u)m[_]&&m[_].set(this.program,_,u[_])}}setFogUniformValues(o,u){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const _ in u)m[_].set(this.program,_,u[_])}}draw(o,u,m,_,w,S,C,k,z,L,N,W,J,ne,te){const re=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(m),o.setStencilMode(_),o.setColorMode(w),o.setCullFace(S);for(const K of Object.keys(this.fixedUniforms))this.fixedUniforms[K].set(this.program,K,C[K]);ne&&ne.setUniforms(this.program,o,this.binderUniforms,W,{zoom:J});const U={[re.LINES]:2,[re.TRIANGLES]:3,[re.LINE_STRIP]:1}[u];for(const K of N.get()){const ae=K.vaos||(K.vaos={});(ae[k]||(ae[k]=new g_)).bind(o,this,z,ne?ne.getPaintVertexBuffers():[],L,K.vertexOffset,te||[]),re.drawElements(u,K.primitiveLength*U,re.UNSIGNED_SHORT,K.primitiveOffset*U*2)}}}function Fl(f,o){const u=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,f.transform.tileZoom)/u,_=m*(o.tileID.canonical.x+o.tileID.wrap*u),w=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_tile_units_to_pixels:1/Nt(o,1,f.transform.tileZoom),u_pixel_coord_upper:[_>>16,w>>16],u_pixel_coord_lower:[65535&_,65535&w]}}const jp=a.create(),id=(f,o,u,m,_,w,S,C,k,z,L)=>{const N=o.style.light,W=N.properties.get("position"),J=[W.x,W.y,W.z],ne=a.create$1();N.properties.get("anchor")==="viewport"&&(a.fromRotation(ne,-o.transform.angle),a.transformMat3(J,J,ne));const te=N.properties.get("color"),re=o.transform,U={u_matrix:f,u_lightpos:J,u_lightintensity:N.properties.get("intensity"),u_lightcolor:[te.r,te.g,te.b],u_vertical_gradient:+u,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:jp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:_,u_edge_radius:w};return re.projection.name==="globe"&&(U.u_tile_id=[S.canonical.x,S.canonical.y,1<<S.canonical.z],U.u_zoom_transition=k,U.u_inv_rot_matrix=L,U.u_merc_center=z,U.u_up_dir=re.projection.upVector(new a.CanonicalTileID(0,0,0),z[0]*a.EXTENT,z[1]*a.EXTENT),U.u_height_lift=C),U},Np=(f,o,u,m,_,w,S,C,k,z,L,N)=>{const W=id(f,o,u,m,_,w,S,k,z,L,N),J={u_height_factor:-Math.pow(2,S.overscaledZ)/C.tileSize/8};return a.extend(W,Fl(o,C),J)},Ms=f=>({u_matrix:f}),od=(f,o,u)=>a.extend(Ms(f),Fl(o,u)),y_=(f,o)=>({u_matrix:f,u_world:o}),__=(f,o,u,m)=>a.extend(od(f,o,u),{u_world:m}),v_=a.create(),sd=(f,o,u,m,_,w)=>{const S=f.transform,C=S.projection.name==="globe";let k;if(w.paint.get("circle-pitch-alignment")==="map")if(C){const L=a.globePixelsToTileUnits(S.zoom,o.canonical)*S._pixelsPerMercatorPixel;k=Float32Array.from([L,0,0,L])}else k=S.calculatePixelsToTileUnitsMatrix(u);else k=new Float32Array([S.pixelsToGLUnits[0],0,0,S.pixelsToGLUnits[1]]);const z={u_camera_to_center_distance:S.cameraToCenterDistance,u_matrix:f.translatePosMatrix(o.projMatrix,u,w.paint.get("circle-translate"),w.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:k,u_inv_rot_matrix:v_,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(C){z.u_inv_rot_matrix=m,z.u_merc_center=_,z.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],z.u_zoom_transition=a.globeToMercatorTransition(S.zoom);const L=_[0]*a.EXTENT,N=_[1]*a.EXTENT;z.u_up_dir=S.projection.upVector(new a.CanonicalTileID(0,0,0),L,N)}return z},ad=f=>{const o=[];return f.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),f.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o},ld=(f,o,u,m)=>{const _=a.EXTENT/u.tileSize;return{u_matrix:f,u_camera_to_center_distance:o.getCameraToCenterDistance(m),u_extrude_scale:[o.pixelsToGLUnits[0]/_,o.pixelsToGLUnits[1]/_]}},su=(f,o,u=1)=>({u_matrix:f,u_color:o,u_overlay:0,u_overlay_scale:u}),Up=a.create(),Vp=(f,o,u,m,_,w,S)=>{const C=f.transform,k=C.projection.name==="globe",z=k?a.globePixelsToTileUnits(C.zoom,o.canonical)*C._pixelsPerMercatorPixel:Nt(u,1,w),L={u_matrix:o.projMatrix,u_extrude_scale:z,u_intensity:S,u_inv_rot_matrix:Up,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(k){L.u_inv_rot_matrix=m,L.u_merc_center=_,L.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],L.u_zoom_transition=a.globeToMercatorTransition(C.zoom);const N=_[0]*a.EXTENT,W=_[1]*a.EXTENT;L.u_up_dir=C.projection.upVector(new a.CanonicalTileID(0,0,0),N,W)}return L},x_=(f,o,u,m,_,w,S)=>{const C=f.transform,k=C.calculatePixelsToTileUnitsMatrix(o);return{u_matrix:cd(f,o,u,m),u_pixels_to_tile_units:k,u_device_pixel_ratio:w,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:jl(u)?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:ya(o,f.transform),u_alpha_discard_threshold:0,u_trim_offset:S}},Bl=(f,o,u,m,_)=>{const w=f.transform;return{u_matrix:cd(f,o,u,m),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:w.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:_,u_image:0,u_tile_units_to_pixels:ya(o,w),u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ya(f,o){return 1/Nt(f,1,o.tileZoom)}function cd(f,o,u,m){return f.translatePosMatrix(m||o.tileID.projMatrix,o,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}function jl(f){const o=f.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}const ud=(f,o,u,m,_,w)=>{return{u_matrix:f,u_tl_parent:o,u_scale_parent:u,u_fade_t:m.mix,u_opacity:m.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(C=_.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(S=_.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:no(_.paint.get("raster-hue-rotate")),u_perspective_transform:w};var S,C};function no(f){f*=Math.PI/180;const o=Math.sin(f),u=Math.cos(f);return[(2*u+1)/3,(-Math.sqrt(3)*o-u+1)/3,(Math.sqrt(3)*o-u+1)/3]}const au=a.create(),hd=(f,o,u,m,_,w,S,C,k,z,L,N,W,J,ne,te)=>{const re=_.transform,U={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:re.cameraToCenterDistance,u_rotate_symbol:+u,u_aspect_ratio:re.width/re.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:C,u_is_text:+k,u_pitch_with_map:+m,u_texsize:z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:au,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:au,u_up_vector:[0,-1,0]};return te.name==="globe"&&(U.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],U.u_zoom_transition=N,U.u_inv_rot_matrix=J,U.u_merc_center=W,U.u_camera_forward=re._camera.forward(),U.u_ecef_origin=a.globeECEFOrigin(re.globeMatrix,L.toUnwrapped()),U.u_tile_matrix=Float32Array.from(re.globeMatrix),U.u_up_vector=ne),U},lu=(f,o,u,m,_,w,S,C,k,z,L,N,W,J,ne,te,re)=>a.extend(hd(f,o,u,m,_,w,S,C,k,z,N,W,J,ne,te,re),{u_gamma_scale:m?_.transform.cameraToCenterDistance*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+L}),$p=(f,o,u,m,_,w,S,C,k,z,L,N,W,J,ne,te)=>a.extend(lu(f,o,u,m,_,w,S,C,!0,k,!0,L,N,W,J,ne,te),{u_texsize_icon:z,u_texture_icon:1}),dd=(f,o,u)=>({u_matrix:f,u_opacity:o,u_color:u}),w_=(f,o,u,m,_)=>a.extend(function(w,S,C){const k=S.imageManager.getPattern(w.toString()),{width:z,height:L}=S.imageManager.getPixelSize(),N=Math.pow(2,C.tileID.overscaledZ),W=C.tileSize*Math.pow(2,S.transform.tileZoom)/N,J=W*(C.tileID.canonical.x+C.tileID.wrap*N),ne=W*C.tileID.canonical.y;return{u_image:0,u_pattern_tl:k.tl,u_pattern_br:k.br,u_texsize:[z,L],u_pattern_size:k.displaySize,u_tile_units_to_pixels:1/Nt(C,1,S.transform.tileZoom),u_pixel_coord_upper:[J>>16,ne>>16],u_pixel_coord_lower:[65535&J,65535&ne]}}(m,u,_),{u_matrix:f,u_opacity:o}),fd={fillExtrusion:f=>({u_matrix:new a.UniformMatrix4f(f),u_lightpos:new a.Uniform3f(f),u_lightintensity:new a.Uniform1f(f),u_lightcolor:new a.Uniform3f(f),u_vertical_gradient:new a.Uniform1f(f),u_opacity:new a.Uniform1f(f),u_edge_radius:new a.Uniform1f(f),u_ao:new a.Uniform2f(f),u_tile_id:new a.Uniform3f(f),u_zoom_transition:new a.Uniform1f(f),u_inv_rot_matrix:new a.UniformMatrix4f(f),u_merc_center:new a.Uniform2f(f),u_up_dir:new a.Uniform3f(f),u_height_lift:new a.Uniform1f(f)}),fillExtrusionPattern:f=>({u_matrix:new a.UniformMatrix4f(f),u_lightpos:new a.Uniform3f(f),u_lightintensity:new a.Uniform1f(f),u_lightcolor:new a.Uniform3f(f),u_vertical_gradient:new a.Uniform1f(f),u_height_factor:new a.Uniform1f(f),u_edge_radius:new a.Uniform1f(f),u_ao:new a.Uniform2f(f),u_tile_id:new a.Uniform3f(f),u_zoom_transition:new a.Uniform1f(f),u_inv_rot_matrix:new a.UniformMatrix4f(f),u_merc_center:new a.Uniform2f(f),u_up_dir:new a.Uniform3f(f),u_height_lift:new a.Uniform1f(f),u_image:new a.Uniform1i(f),u_texsize:new a.Uniform2f(f),u_pixel_coord_upper:new a.Uniform2f(f),u_pixel_coord_lower:new a.Uniform2f(f),u_tile_units_to_pixels:new a.Uniform1f(f),u_opacity:new a.Uniform1f(f)}),fill:f=>({u_matrix:new a.UniformMatrix4f(f)}),fillPattern:f=>({u_matrix:new a.UniformMatrix4f(f),u_image:new a.Uniform1i(f),u_texsize:new a.Uniform2f(f),u_pixel_coord_upper:new a.Uniform2f(f),u_pixel_coord_lower:new a.Uniform2f(f),u_tile_units_to_pixels:new a.Uniform1f(f)}),fillOutline:f=>({u_matrix:new a.UniformMatrix4f(f),u_world:new a.Uniform2f(f)}),fillOutlinePattern:f=>({u_matrix:new a.UniformMatrix4f(f),u_world:new a.Uniform2f(f),u_image:new a.Uniform1i(f),u_texsize:new a.Uniform2f(f),u_pixel_coord_upper:new a.Uniform2f(f),u_pixel_coord_lower:new a.Uniform2f(f),u_tile_units_to_pixels:new a.Uniform1f(f)}),circle:f=>({u_camera_to_center_distance:new a.Uniform1f(f),u_extrude_scale:new a.UniformMatrix2f(f),u_device_pixel_ratio:new a.Uniform1f(f),u_matrix:new a.UniformMatrix4f(f),u_inv_rot_matrix:new a.UniformMatrix4f(f),u_merc_center:new a.Uniform2f(f),u_tile_id:new a.Uniform3f(f),u_zoom_transition:new a.Uniform1f(f),u_up_dir:new a.Uniform3f(f)}),collisionBox:f=>({u_matrix:new a.UniformMatrix4f(f),u_camera_to_center_distance:new a.Uniform1f(f),u_extrude_scale:new a.Uniform2f(f)}),collisionCircle:f=>({u_matrix:new a.UniformMatrix4f(f),u_inv_matrix:new a.UniformMatrix4f(f),u_camera_to_center_distance:new a.Uniform1f(f),u_viewport_size:new a.Uniform2f(f)}),debug:f=>({u_color:new a.UniformColor(f),u_matrix:new a.UniformMatrix4f(f),u_overlay:new a.Uniform1i(f),u_overlay_scale:new a.Uniform1f(f)}),clippingMask:f=>({u_matrix:new a.UniformMatrix4f(f)}),heatmap:f=>({u_extrude_scale:new a.Uniform1f(f),u_intensity:new a.Uniform1f(f),u_matrix:new a.UniformMatrix4f(f),u_inv_rot_matrix:new a.UniformMatrix4f(f),u_merc_center:new a.Uniform2f(f),u_tile_id:new a.Uniform3f(f),u_zoom_transition:new a.Uniform1f(f),u_up_dir:new a.Uniform3f(f)}),heatmapTexture:f=>({u_image:new a.Uniform1i(f),u_color_ramp:new a.Uniform1i(f),u_opacity:new a.Uniform1f(f)}),hillshade:f=>({u_matrix:new a.UniformMatrix4f(f),u_image:new a.Uniform1i(f),u_latrange:new a.Uniform2f(f),u_light:new a.Uniform2f(f),u_shadow:new a.UniformColor(f),u_highlight:new a.UniformColor(f),u_accent:new a.UniformColor(f)}),hillshadePrepare:f=>({u_matrix:new a.UniformMatrix4f(f),u_image:new a.Uniform1i(f),u_dimension:new a.Uniform2f(f),u_zoom:new a.Uniform1f(f),u_unpack:new a.Uniform4f(f)}),line:f=>({u_matrix:new a.UniformMatrix4f(f),u_pixels_to_tile_units:new a.UniformMatrix2f(f),u_device_pixel_ratio:new a.Uniform1f(f),u_units_to_pixels:new a.Uniform2f(f),u_dash_image:new a.Uniform1i(f),u_gradient_image:new a.Uniform1i(f),u_image_height:new a.Uniform1f(f),u_texsize:new a.Uniform2f(f),u_tile_units_to_pixels:new a.Uniform1f(f),u_alpha_discard_threshold:new a.Uniform1f(f),u_trim_offset:new a.Uniform2f(f)}),linePattern:f=>({u_matrix:new a.UniformMatrix4f(f),u_texsize:new a.Uniform2f(f),u_pixels_to_tile_units:new a.UniformMatrix2f(f),u_device_pixel_ratio:new a.Uniform1f(f),u_image:new a.Uniform1i(f),u_units_to_pixels:new a.Uniform2f(f),u_tile_units_to_pixels:new a.Uniform1f(f),u_alpha_discard_threshold:new a.Uniform1f(f)}),raster:f=>({u_matrix:new a.UniformMatrix4f(f),u_tl_parent:new a.Uniform2f(f),u_scale_parent:new a.Uniform1f(f),u_fade_t:new a.Uniform1f(f),u_opacity:new a.Uniform1f(f),u_image0:new a.Uniform1i(f),u_image1:new a.Uniform1i(f),u_brightness_low:new a.Uniform1f(f),u_brightness_high:new a.Uniform1f(f),u_saturation_factor:new a.Uniform1f(f),u_contrast_factor:new a.Uniform1f(f),u_spin_weights:new a.Uniform3f(f),u_perspective_transform:new a.Uniform2f(f)}),symbolIcon:f=>({u_is_size_zoom_constant:new a.Uniform1i(f),u_is_size_feature_constant:new a.Uniform1i(f),u_size_t:new a.Uniform1f(f),u_size:new a.Uniform1f(f),u_camera_to_center_distance:new a.Uniform1f(f),u_rotate_symbol:new a.Uniform1i(f),u_aspect_ratio:new a.Uniform1f(f),u_fade_change:new a.Uniform1f(f),u_matrix:new a.UniformMatrix4f(f),u_label_plane_matrix:new a.UniformMatrix4f(f),u_coord_matrix:new a.UniformMatrix4f(f),u_is_text:new a.Uniform1i(f),u_pitch_with_map:new a.Uniform1i(f),u_texsize:new a.Uniform2f(f),u_tile_id:new a.Uniform3f(f),u_zoom_transition:new a.Uniform1f(f),u_inv_rot_matrix:new a.UniformMatrix4f(f),u_merc_center:new a.Uniform2f(f),u_camera_forward:new a.Uniform3f(f),u_tile_matrix:new a.UniformMatrix4f(f),u_up_vector:new a.Uniform3f(f),u_ecef_origin:new a.Uniform3f(f),u_texture:new a.Uniform1i(f)}),symbolSDF:f=>({u_is_size_zoom_constant:new a.Uniform1i(f),u_is_size_feature_constant:new a.Uniform1i(f),u_size_t:new a.Uniform1f(f),u_size:new a.Uniform1f(f),u_camera_to_center_distance:new a.Uniform1f(f),u_rotate_symbol:new a.Uniform1i(f),u_aspect_ratio:new a.Uniform1f(f),u_fade_change:new a.Uniform1f(f),u_matrix:new a.UniformMatrix4f(f),u_label_plane_matrix:new a.UniformMatrix4f(f),u_coord_matrix:new a.UniformMatrix4f(f),u_is_text:new a.Uniform1i(f),u_pitch_with_map:new a.Uniform1i(f),u_texsize:new a.Uniform2f(f),u_texture:new a.Uniform1i(f),u_gamma_scale:new a.Uniform1f(f),u_device_pixel_ratio:new a.Uniform1f(f),u_tile_id:new a.Uniform3f(f),u_zoom_transition:new a.Uniform1f(f),u_inv_rot_matrix:new a.UniformMatrix4f(f),u_merc_center:new a.Uniform2f(f),u_camera_forward:new a.Uniform3f(f),u_tile_matrix:new a.UniformMatrix4f(f),u_up_vector:new a.Uniform3f(f),u_ecef_origin:new a.Uniform3f(f),u_is_halo:new a.Uniform1i(f)}),symbolTextAndIcon:f=>({u_is_size_zoom_constant:new a.Uniform1i(f),u_is_size_feature_constant:new a.Uniform1i(f),u_size_t:new a.Uniform1f(f),u_size:new a.Uniform1f(f),u_camera_to_center_distance:new a.Uniform1f(f),u_rotate_symbol:new a.Uniform1i(f),u_aspect_ratio:new a.Uniform1f(f),u_fade_change:new a.Uniform1f(f),u_matrix:new a.UniformMatrix4f(f),u_label_plane_matrix:new a.UniformMatrix4f(f),u_coord_matrix:new a.UniformMatrix4f(f),u_is_text:new a.Uniform1i(f),u_pitch_with_map:new a.Uniform1i(f),u_texsize:new a.Uniform2f(f),u_texsize_icon:new a.Uniform2f(f),u_texture:new a.Uniform1i(f),u_texture_icon:new a.Uniform1i(f),u_gamma_scale:new a.Uniform1f(f),u_device_pixel_ratio:new a.Uniform1f(f),u_is_halo:new a.Uniform1i(f)}),background:f=>({u_matrix:new a.UniformMatrix4f(f),u_opacity:new a.Uniform1f(f),u_color:new a.UniformColor(f)}),backgroundPattern:f=>({u_matrix:new a.UniformMatrix4f(f),u_opacity:new a.Uniform1f(f),u_image:new a.Uniform1i(f),u_pattern_tl:new a.Uniform2f(f),u_pattern_br:new a.Uniform2f(f),u_texsize:new a.Uniform2f(f),u_pattern_size:new a.Uniform2f(f),u_pixel_coord_upper:new a.Uniform2f(f),u_pixel_coord_lower:new a.Uniform2f(f),u_tile_units_to_pixels:new a.Uniform1f(f)}),terrainRaster:ed,terrainDepth:ed,skybox:f=>({u_matrix:new a.UniformMatrix4f(f),u_sun_direction:new a.Uniform3f(f),u_cubemap:new a.Uniform1i(f),u_opacity:new a.Uniform1f(f),u_temporal_offset:new a.Uniform1f(f)}),skyboxGradient:f=>({u_matrix:new a.UniformMatrix4f(f),u_color_ramp:new a.Uniform1i(f),u_center_direction:new a.Uniform3f(f),u_radius:new a.Uniform1f(f),u_opacity:new a.Uniform1f(f),u_temporal_offset:new a.Uniform1f(f)}),skyboxCapture:f=>({u_matrix_3f:new a.UniformMatrix3f(f),u_sun_direction:new a.Uniform3f(f),u_sun_intensity:new a.Uniform1f(f),u_color_tint_r:new a.Uniform4f(f),u_color_tint_m:new a.Uniform4f(f),u_luminance:new a.Uniform1f(f)}),globeRaster:f=>({u_proj_matrix:new a.UniformMatrix4f(f),u_globe_matrix:new a.UniformMatrix4f(f),u_normalize_matrix:new a.UniformMatrix4f(f),u_merc_matrix:new a.UniformMatrix4f(f),u_zoom_transition:new a.Uniform1f(f),u_merc_center:new a.Uniform2f(f),u_image0:new a.Uniform1i(f),u_grid_matrix:new a.UniformMatrix3f(f),u_skirt_height:new a.Uniform1f(f),u_frustum_tl:new a.Uniform3f(f),u_frustum_tr:new a.Uniform3f(f),u_frustum_br:new a.Uniform3f(f),u_frustum_bl:new a.Uniform3f(f),u_globe_pos:new a.Uniform3f(f),u_globe_radius:new a.Uniform1f(f),u_viewport:new a.Uniform2f(f)}),globeAtmosphere:f=>({u_frustum_tl:new a.Uniform3f(f),u_frustum_tr:new a.Uniform3f(f),u_frustum_br:new a.Uniform3f(f),u_frustum_bl:new a.Uniform3f(f),u_horizon:new a.Uniform1f(f),u_transition:new a.Uniform1f(f),u_fadeout_range:new a.Uniform1f(f),u_color:new a.Uniform4f(f),u_high_color:new a.Uniform4f(f),u_space_color:new a.Uniform4f(f),u_star_intensity:new a.Uniform1f(f),u_star_density:new a.Uniform1f(f),u_star_size:new a.Uniform1f(f),u_temporal_offset:new a.Uniform1f(f),u_horizon_angle:new a.Uniform1f(f),u_rotation_matrix:new a.UniformMatrix4f(f)})};let cu;function Nl(f,o,u,m,_,w,S){const C=f.context,k=C.gl,z=f.transform,L=f.useProgram("collisionBox"),N=[];let W=0,J=0;for(let le=0;le<m.length;le++){const ye=m[le],xe=o.getTile(ye),_e=xe.getBucket(u);if(!_e)continue;const Se=wi(ye,_e,z);let Ee=Se;_[0]===0&&_[1]===0||(Ee=f.translatePosMatrix(Se,xe,_,w));const De=S?_e.textCollisionBox:_e.iconCollisionBox,Ye=_e.collisionCircleArray;if(Ye.length>0){const ke=a.create(),$e=Ee;a.mul(ke,_e.placementInvProjMatrix,z.glCoordMatrix),a.mul(ke,ke,_e.placementViewportMatrix),N.push({circleArray:Ye,circleOffset:J,transform:$e,invTransform:ke,projection:_e.getProjection()}),W+=Ye.length/4,J=W}De&&(f.terrain&&f.terrain.setupElevationDraw(xe,L),L.draw(C,k.LINES,a.DepthMode.disabled,a.StencilMode.disabled,f.colorModeForRenderPass(),a.CullFaceMode.disabled,ld(Ee,z,xe,_e.getProjection()),u.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,null,z.zoom,null,[De.collisionVertexBuffer,De.collisionVertexBufferExt]))}if(!S||!N.length)return;const ne=f.useProgram("collisionCircle"),te=new a.StructArrayLayout2f1f2i16;te.resize(4*W),te._trim();let re=0;for(const le of N)for(let ye=0;ye<le.circleArray.length/4;ye++){const xe=4*ye,_e=le.circleArray[xe+0],Se=le.circleArray[xe+1],Ee=le.circleArray[xe+2],De=le.circleArray[xe+3];te.emplace(re++,_e,Se,Ee,De,0),te.emplace(re++,_e,Se,Ee,De,1),te.emplace(re++,_e,Se,Ee,De,2),te.emplace(re++,_e,Se,Ee,De,3)}(!cu||cu.length<2*W)&&(cu=function(le){const ye=2*le,xe=new a.StructArrayLayout3ui6;xe.resize(ye),xe._trim();for(let _e=0;_e<ye;_e++){const Se=6*_e;xe.uint16[Se+0]=4*_e+0,xe.uint16[Se+1]=4*_e+1,xe.uint16[Se+2]=4*_e+2,xe.uint16[Se+3]=4*_e+2,xe.uint16[Se+4]=4*_e+3,xe.uint16[Se+5]=4*_e+0}return xe}(W));const U=C.createIndexBuffer(cu,!0),K=C.createVertexBuffer(te,a.collisionCircleLayout.members,!0);for(const le of N){const ye={u_matrix:le.transform,u_inv_matrix:le.invTransform,u_camera_to_center_distance:(ae=z).getCameraToCenterDistance(le.projection),u_viewport_size:[ae.width,ae.height]};ne.draw(C,k.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,f.colorModeForRenderPass(),a.CullFaceMode.disabled,ye,u.id,K,U,a.SegmentVector.simpleSegment(0,2*le.circleOffset,le.circleArray.length,le.circleArray.length/2),null,z.zoom)}var ae;K.destroy(),U.destroy()}const Gp=a.create();function pd({width:f,height:o,anchor:u,textOffset:m,textScale:_},w){const{horizontalAlign:S,verticalAlign:C}=a.getAnchorAlignment(u),k=-(S-.5)*f,z=-(C-.5)*o,L=a.evaluateVariableOffset(u,m);return new a.Point((k/_+L[0])*w,(z/_+L[1])*w)}function b_(f,o,u,m,_,w,S,C,k,z,L){const N=f.text.placedSymbolArray,W=f.text.dynamicLayoutVertexArray,J=f.icon.dynamicLayoutVertexArray,ne={},te=f.getProjection(),re=Ln(C,te,w),U=w.elevation,K=te.upVectorScale(C.canonical,w.center.lat,w.worldSize).metersToTile;W.clear();for(let ae=0;ae<N.length;ae++){const le=N.get(ae),{tileAnchorX:ye,tileAnchorY:xe,numGlyphs:_e}=le,Se=le.hidden||!le.crossTileID||f.allowVerticalPlacement&&!le.placedOrientation?null:m[le.crossTileID];if(Se){let Ee=0,De=0,Ye=0;if(U){const et=U?U.getAtTileOffset(C,ye,xe):0,[Tt,At,_t]=te.upVector(C.canonical,ye,xe);Ee=et*Tt*K,De=et*At*K,Ye=et*_t*K}let[ke,$e,ze,Ke]=_r(le.projectedAnchorX+Ee,le.projectedAnchorY+De,le.projectedAnchorZ+Ye,u?re:S);const Ae=Ip(w.getCameraToCenterDistance(te),Ke);let Ve=_.evaluateSizeForFeature(f.textSizeData,z,le)*Ae/a.ONE_EM;u&&(Ve*=f.tilePixelRatio/k);const Qe=pd(Se,Ve);u?({x:ke,y:$e,z:ze}=te.projectTilePoint(ye+Qe.x,xe+Qe.y,C.canonical),[ke,$e,ze]=_r(ke+Ee,$e+De,ze+Ye,S)):(o&&Qe._rotate(-w.angle),ke+=Qe.x,$e+=Qe.y,ze=0);const qe=f.allowVerticalPlacement&&le.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let et=0;et<_e;et++)a.addDynamicAttributes(W,ke,$e,ze,qe);L&&le.associatedIconIndex>=0&&(ne[le.associatedIconIndex]={x:ke,y:$e,z:ze,angle:qe})}else Fi(_e,W)}if(L){J.clear();const ae=f.icon.placedSymbolArray;for(let le=0;le<ae.length;le++){const ye=ae.get(le),{numGlyphs:xe}=ye,_e=ne[le];if(ye.hidden||!_e)Fi(xe,J);else{const{x:Se,y:Ee,z:De,angle:Ye}=_e;for(let ke=0;ke<xe;ke++)a.addDynamicAttributes(J,Se,Ee,De,Ye)}}f.icon.dynamicLayoutVertexBuffer.updateData(J)}f.text.dynamicLayoutVertexBuffer.updateData(W)}function md(f,o,u){return u.iconsInText&&o?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function Wp(f,o,u,m,_,w,S,C,k,z,L,N){const W=f.context,J=W.gl,ne=f.transform,te=C==="map",re=k==="map",U=te&&u.layout.get("symbol-placement")!=="point",K=te&&!re&&!U,ae=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let le=!1;const ye=f.depthModeForSublayer(0,a.DepthMode.ReadOnly),xe=[a.mercatorXfromLng(ne.center.lng),a.mercatorYfromLat(ne.center.lat)],_e=u.layout.get("text-variable-anchor"),Se=ne.projection.name==="globe",Ee=[],De=[0,-1,0];let Ye=De;!Se&&!ne.mercatorFromTransition||te||(Ye=function(ke){const $e=ke._camera.getWorldToCamera(ke.worldSize,1),ze=a.multiply([],$e,ke.globeMatrix);a.invert(ze,ze);const Ke=[0,0,0],Ae=[0,1,0,0];return a.transformMat4$1(Ae,Ae,ze),Ke[0]=Ae[0],Ke[1]=Ae[1],Ke[2]=Ae[2],a.normalize(Ke,Ke),Ke}(ne));for(const ke of m){const $e=o.getTile(ke),ze=$e.getBucket(u);if(!ze||ze.projection.name==="mercator"&&Se)continue;const Ke=_?ze.text:ze.icon;if(!Ke||ze.fullyClipped||!Ke.segments.get().length)continue;const Ae=Ke.programConfigurations.get(u.id),Ve=_||ze.sdfIcons,Qe=_?ze.textSizeData:ze.iconSizeData,qe=re||ne.pitch!==0,et=a.evaluateSizeForZoom(Qe,ne.zoom);let Tt,At,_t,Pt,Xt=[0,0],Zt=null;if(_)At=$e.glyphAtlasTexture,_t=J.LINEAR,Tt=$e.glyphAtlasTexture.size,ze.iconsInText&&(Xt=$e.imageAtlasTexture.size,Zt=$e.imageAtlasTexture,Pt=qe||f.options.rotating||f.options.zooming||Qe.kind==="composite"||Qe.kind==="camera"?J.LINEAR:J.NEAREST);else{const Do=u.layout.get("icon-size").constantOr(0)!==1||ze.iconsNeedLinear;At=$e.imageAtlasTexture,_t=Ve||f.options.rotating||f.options.zooming||Do||qe?J.LINEAR:J.NEAREST,Tt=$e.imageAtlasTexture.size}const wt=ze.projection.name==="globe",hn=wt?Ye:De,fn=wt?a.globeToMercatorTransition(ne.zoom):0,pn=Ln(ke,ze.getProjection(),ne),mn=ne.calculatePixelsToTileUnitsMatrix($e),Rr=Be(pn,$e.tileID.canonical,re,te,ne,ze.getProjection(),mn),xr=f.terrain&&re&&U?a.invert(a.create(),Rr):Gp,Si=Yn(pn,$e.tileID.canonical,re,te,ne,ze.getProjection(),mn),io=_e&&ze.hasTextData(),zn=u.layout.get("icon-text-fit")!=="none"&&io&&ze.hasIconData();if(U){const Do=ne.elevation,ts=Do?Do.getAtTileOffsetFunc(ke,ne.center.lat,ne.worldSize,ze.getProjection()):null,Ls=Eo(pn,$e.tileID.canonical,re,te,ne,ze.getProjection(),mn);Uh(ze,pn,f,_,Ls,Si,re,z,ts,ke)}const gn=U||_&&_e||zn,rn=f.translatePosMatrix(pn,$e,w,S),Jn=gn?Gp:Rr,Vr=f.translatePosMatrix(Si,$e,w,S,!0),Mn=ze.getProjection().createInversionMatrix(ne,ke.canonical),Xr=[];f.terrainRenderModeElevated()&&re&&Xr.push("PITCH_WITH_MAP_TERRAIN"),wt&&Xr.push("PROJECTION_GLOBE_VIEW"),gn&&Xr.push("PROJECTED_POS_ON_VIEWPORT");const Su=Ve&&u.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ds;Ds=Ve?ze.iconsInText?$p(Qe.kind,et,K,re,f,rn,Jn,Vr,Tt,Xt,ke,fn,xe,Mn,hn,ze.getProjection()):lu(Qe.kind,et,K,re,f,rn,Jn,Vr,_,Tt,!0,ke,fn,xe,Mn,hn,ze.getProjection()):hd(Qe.kind,et,K,re,f,rn,Jn,Vr,_,Tt,ke,fn,xe,Mn,hn,ze.getProjection());const Yl={program:f.useProgram(md(Ve,_,ze),Ae,Xr),buffers:Ke,uniformValues:Ds,atlasTexture:At,atlasTextureIcon:Zt,atlasInterpolation:_t,atlasInterpolationIcon:Pt,isSDF:Ve,hasHalo:Su,tile:$e,labelPlaneMatrixInv:xr};if(ae&&ze.canOverlap){le=!0;const Do=Ke.segments.get();for(const ts of Do)Ee.push({segments:new a.SegmentVector([ts]),sortKey:ts.sortKey,state:Yl})}else Ee.push({segments:Ke.segments,sortKey:0,state:Yl})}le&&Ee.sort((ke,$e)=>ke.sortKey-$e.sortKey);for(const ke of Ee){const $e=ke.state;if(f.terrain&&f.terrain.setupElevationDraw($e.tile,$e.program,{useDepthForOcclusion:!Se,labelPlaneMatrixInv:$e.labelPlaneMatrixInv}),W.activeTexture.set(J.TEXTURE0),$e.atlasTexture.bind($e.atlasInterpolation,J.CLAMP_TO_EDGE),$e.atlasTextureIcon&&(W.activeTexture.set(J.TEXTURE1),$e.atlasTextureIcon&&$e.atlasTextureIcon.bind($e.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),$e.isSDF){const ze=$e.uniformValues;$e.hasHalo&&(ze.u_is_halo=1,Ul($e.buffers,ke.segments,u,f,$e.program,ye,L,N,ze)),ze.u_is_halo=0}Ul($e.buffers,ke.segments,u,f,$e.program,ye,L,N,$e.uniformValues)}}function Ul(f,o,u,m,_,w,S,C,k){const z=m.context,L=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.globeExtVertexBuffer];_.draw(z,z.gl.TRIANGLES,w,S,C,a.CullFaceMode.disabled,k,u.id,f.layoutVertexBuffer,f.indexBuffer,o,u.paint,m.transform.zoom,f.programConfigurations.get(u.id),L)}function Zp(f,o,u,m,_,w,S){const C=f.context.gl,k=u.paint.get("fill-pattern"),z=k&&k.constantOr(1);let L,N,W,J,ne;S?(N=z&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",L=C.LINES):(N=z?"fillPattern":"fill",L=C.TRIANGLES);for(const te of m){const re=o.getTile(te);if(z&&!re.patternsLoaded())continue;const U=re.getBucket(u);if(!U)continue;f.prepareDrawTile();const K=U.programConfigurations.get(u.id),ae=f.useProgram(N,K);z&&(f.context.activeTexture.set(C.TEXTURE0),re.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),K.updatePaintBuffers());const le=k.constantOr(null);if(le&&re.imageAtlas){const xe=re.imageAtlas.patternPositions[le.toString()];xe&&K.setConstantPatternPositions(xe)}const ye=f.translatePosMatrix(te.projMatrix,re,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(S){J=U.indexBuffer2,ne=U.segments2;const xe=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[C.drawingBufferWidth,C.drawingBufferHeight];W=N==="fillOutlinePattern"&&z?__(ye,f,re,xe):y_(ye,xe)}else J=U.indexBuffer,ne=U.segments,W=z?od(ye,f,re):Ms(ye);f.prepareDrawProgram(f.context,ae,te.toUnwrapped()),ae.draw(f.context,L,_,f.stencilModeForClipping(te),w,a.CullFaceMode.disabled,W,u.id,U.layoutVertexBuffer,J,ne,u.paint,f.transform.zoom,K)}}function uu(f,o,u,m,_,w,S){const C=f.context,k=C.gl,z=f.transform,L=u.paint.get("fill-extrusion-pattern"),N=L.constantOr(1),W=u.paint.get("fill-extrusion-opacity"),J=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),u.paint.get("fill-extrusion-ambient-occlusion-radius")],ne=u.layout.get("fill-extrusion-edge-radius"),te=ne>0&&!u.paint.get("fill-extrusion-rounded-roof"),re=te?0:ne,U=z.projection.name==="globe"?a.fillExtrusionHeightLift():0,K=z.projection.name==="globe",ae=K?a.globeToMercatorTransition(z.zoom):0,le=[a.mercatorXfromLng(z.center.lng),a.mercatorYfromLat(z.center.lat)],ye=[];K&&ye.push("PROJECTION_GLOBE_VIEW"),J[0]>0&&ye.push("FAUX_AO"),te&&ye.push("ZERO_ROOF_RADIUS");for(const xe of m){const _e=o.getTile(xe),Se=_e.getBucket(u);if(!Se||Se.projection.name!==z.projection.name)continue;const Ee=Se.programConfigurations.get(u.id),De=f.useProgram(N?"fillExtrusionPattern":"fillExtrusion",Ee,ye);if(f.terrain){const Ve=f.terrain;if(f.style.terrainSetForDrapingOnly())Ve.setupElevationDraw(_e,De,{useMeterToDem:!0});else{if(!Se.enableTerrain)continue;if(Ve.setupElevationDraw(_e,De,{useMeterToDem:!0}),qp(C,o,xe,Se,u,Ve),!Se.centroidVertexBuffer){const Qe=De.attributes.a_centroid_pos;Qe!==void 0&&k.vertexAttrib2f(Qe,0,0)}}}N&&(f.context.activeTexture.set(k.TEXTURE0),_e.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Ee.updatePaintBuffers());const Ye=L.constantOr(null);if(Ye&&_e.imageAtlas){const Ve=_e.imageAtlas.patternPositions[Ye.toString()];Ve&&Ee.setConstantPatternPositions(Ve)}const ke=f.translatePosMatrix(xe.projMatrix,_e,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),$e=z.projection.createInversionMatrix(z,xe.canonical),ze=u.paint.get("fill-extrusion-vertical-gradient"),Ke=N?Np(ke,f,ze,W,J,re,xe,_e,U,ae,le,$e):id(ke,f,ze,W,J,re,xe,U,ae,le,$e);f.prepareDrawProgram(C,De,xe.toUnwrapped());const Ae=[];f.terrain&&Ae.push(Se.centroidVertexBuffer),K&&Ae.push(Se.layoutVertexExtBuffer),De.draw(C,C.gl.TRIANGLES,_,w,S,a.CullFaceMode.backCCW,Ke,u.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,u.paint,f.transform.zoom,Ee,Ae)}}function qp(f,o,u,m,_,w){const S=[U=>{let K=U.canonical.x-1,ae=U.wrap;return K<0&&(K=(1<<U.canonical.z)-1,ae--),new a.OverscaledTileID(U.overscaledZ,ae,U.canonical.z,K,U.canonical.y)},U=>{let K=U.canonical.x+1,ae=U.wrap;return K===1<<U.canonical.z&&(K=0,ae++),new a.OverscaledTileID(U.overscaledZ,ae,U.canonical.z,K,U.canonical.y)},U=>new a.OverscaledTileID(U.overscaledZ,U.wrap,U.canonical.z,U.canonical.x,(U.canonical.y===0?1<<U.canonical.z:U.canonical.y)-1),U=>new a.OverscaledTileID(U.overscaledZ,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y===(1<<U.canonical.z)-1?0:U.canonical.y+1)],C=U=>{const K=o.getSource().minzoom,ae=ye=>{const xe=o.getTileByID(ye);if(xe&&xe.hasData())return xe.getBucket(_)},le=[0,-1,1];for(const ye of le){if(U.overscaledZ+ye<K)continue;const xe=ae(U.calculateScaledKey(U.overscaledZ+ye));if(xe)return xe}},k=[0,0,0],z=(U,K)=>(k[0]=Math.min(U.min.y,K.min.y),k[1]=Math.max(U.max.y,K.max.y),k[2]=a.EXTENT-K.min.x>U.max.x?K.min.x-a.EXTENT:U.max.x,k),L=(U,K)=>(k[0]=Math.min(U.min.x,K.min.x),k[1]=Math.max(U.max.x,K.max.x),k[2]=a.EXTENT-K.min.y>U.max.y?K.min.y-a.EXTENT:U.max.y,k),N=[(U,K)=>z(U,K),(U,K)=>z(K,U),(U,K)=>L(U,K),(U,K)=>L(K,U)],W=new a.Point(0,0);let J,ne,te;const re=(U,K,ae,le,ye)=>{const xe=[[le?ae:U,le?U:ae,0],[le?ae:K,le?K:ae,0]],_e=ye<0?a.EXTENT+ye:ye,Se=[le?_e:(U+K)/2,le?(U+K)/2:_e,0];return ae===0&&ye<0||ae!==0&&ye>0?w.getForTilePoints(te,[Se],!0,ne):xe.push(Se),w.getForTilePoints(u,xe,!0,J),Math.max(xe[0][2],xe[1][2],Se[2])/w.exaggeration()};for(let U=0;U<4;U++){const K=(U<2?1:5)-U,ae=m.borders[U];if(ae.length===0)continue;const le=te=S[U](u),ye=C(le);if(!(ye&&ye instanceof a.FillExtrusionBucket&&ye.enableTerrain)||m.borderDoneWithNeighborZ[U]===ye.canonical.z&&ye.borderDoneWithNeighborZ[K]===m.canonical.z||(ne=w.findDEMTileFor(le),!ne||!ne.dem))continue;if(!J){const Ee=w.findDEMTileFor(u);if(!Ee||!Ee.dem)return;J=Ee}const xe=ye.borders[K];let _e=0;const Se=ye.borderDoneWithNeighborZ[K]!==m.canonical.z;if(m.canonical.z===ye.canonical.z){for(let Ee=0;Ee<ae.length;Ee++){const De=m.featuresOnBorder[ae[Ee]],Ye=De.borders[U];let ke;for(;_e<xe.length&&(ke=ye.featuresOnBorder[xe[_e]],!(ke.borders[K][1]>Ye[0]+3));)Se&&ye.encodeCentroid(void 0,ke,!1),_e++;if(ke&&_e<xe.length){const $e=_e;let ze=0;for(;!(ke.borders[K][0]>Ye[1]-3)&&(ze++,++_e!==xe.length);)ke=ye.featuresOnBorder[xe[_e]];if(ke=ye.featuresOnBorder[xe[$e]],De.intersectsCount()>1||ke.intersectsCount()>1||ze!==1){ze!==1&&(_e=$e),m.encodeCentroid(void 0,De,!1),Se&&ye.encodeCentroid(void 0,ke,!1);continue}const Ke=N[U](De,ke),Ae=U%2?a.EXTENT-1:0;W.x=re(Ke[0],Math.min(a.EXTENT-1,Ke[1]),Ae,U<2,Ke[2]),W.y=0,m.encodeCentroid(W,De,!1),Se&&ye.encodeCentroid(W,ke,!1)}else m.encodeCentroid(void 0,De,!1)}m.borderDoneWithNeighborZ[U]=ye.canonical.z,m.needsCentroidUpdate=!0,Se&&(ye.borderDoneWithNeighborZ[K]=m.canonical.z,ye.needsCentroidUpdate=!0)}else{for(const Ee of ae)m.encodeCentroid(void 0,m.featuresOnBorder[Ee],!1);if(Se){for(const Ee of xe)ye.encodeCentroid(void 0,ye.featuresOnBorder[Ee],!1);ye.borderDoneWithNeighborZ[K]=m.canonical.z,ye.needsCentroidUpdate=!0}m.borderDoneWithNeighborZ[U]=ye.canonical.z,m.needsCentroidUpdate=!0}}(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(f)}const _a=new a.Color(1,0,0,1),T_=new a.Color(0,1,0,1),E_=new a.Color(0,0,1,1),S_=new a.Color(1,0,1,1),C_=new a.Color(0,1,1,1);function P_(f,o,u){const m=f.context,_=f.transform,w=m.gl,S=_.projection.name==="globe",C=S?["PROJECTION_GLOBE_VIEW"]:null;let k=u.projMatrix;if(S&&a.globeToMercatorTransition(_.zoom)>0){const De=a.transitionTileAABBinECEF(u.canonical,_),Ye=a.globeDenormalizeECEF(De);k=a.multiply(new Float32Array(16),_.globeMatrix,Ye),a.multiply(k,_.projMatrix,k)}const z=f.useProgram("debug",null,C),L=o.getTileByID(u.key);f.terrain&&f.terrain.setupElevationDraw(L,z);const N=a.DepthMode.disabled,W=a.StencilMode.disabled,J=f.colorModeForRenderPass(),ne="$debug";m.activeTexture.set(w.TEXTURE0),f.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),S?L._makeGlobeTileDebugBuffers(f.context,_):L._makeDebugTileBoundsBuffers(f.context,_.projection);const te=L._tileDebugBuffer||f.debugBuffer,re=L._tileDebugIndexBuffer||f.debugIndexBuffer,U=L._tileDebugSegments||f.debugSegments;z.draw(m,w.LINE_STRIP,N,W,J,a.CullFaceMode.disabled,su(k,a.Color.red),ne,te,re,U,null,null,null,[L._globeTileDebugBorderBuffer]);const K=L.latestRawTileData,ae=Math.floor((K&&K.byteLength||0)/1024),le=o.getTile(u).tileSize,ye=512/Math.min(le,512)*(u.overscaledZ/_.zoom)*.5;let xe=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(xe+=` => ${u.overscaledZ}`),xe+=` ${ae}kb`,function(De,Ye){De.initDebugOverlayCanvas();const ke=De.debugOverlayCanvas,$e=De.context.gl,ze=De.debugOverlayCanvas.getContext("2d");ze.clearRect(0,0,ke.width,ke.height),ze.shadowColor="white",ze.shadowBlur=2,ze.lineWidth=1.5,ze.strokeStyle="white",ze.textBaseline="top",ze.font="bold 36px Open Sans, sans-serif",ze.fillText(Ye,5,5),ze.strokeText(Ye,5,5),De.debugOverlayTexture.update(ke),De.debugOverlayTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE)}(f,xe);const _e=L._tileDebugTextBuffer||f.debugBuffer,Se=L._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,Ee=L._tileDebugTextSegments||f.debugSegments;z.draw(m,w.TRIANGLES,N,W,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,su(k,a.Color.transparent,ye),ne,_e,Se,Ee,null,null,null,[L._globeTileDebugTextBuffer])}function Hp(f,o,u,m){va(f,0,o+u/2,f.transform.width,u,m)}function hu(f,o,u,m){va(f,o-u/2,0,u,f.transform.height,m)}function va(f,o,u,m,_,w){const S=f.context,C=S.gl;C.enable(C.SCISSOR_TEST),C.scissor(o*a.exported.devicePixelRatio,u*a.exported.devicePixelRatio,m*a.exported.devicePixelRatio,_*a.exported.devicePixelRatio),S.clear({color:w}),C.disable(C.SCISSOR_TEST)}const Xp=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Kp}=Xp;function Io(f,o,u,m){f.emplaceBack(o,u,m)}class du{constructor(o){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,Io(this.vertexArray,-1,-1,1),Io(this.vertexArray,1,-1,1),Io(this.vertexArray,-1,1,1),Io(this.vertexArray,1,1,1),Io(this.vertexArray,-1,-1,-1),Io(this.vertexArray,1,-1,-1),Io(this.vertexArray,-1,1,-1),Io(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Kp),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function Ti(f,o,u,m,_,w){const S=f.gl,C=o.paint.get("sky-atmosphere-color"),k=o.paint.get("sky-atmosphere-halo-color"),z=o.paint.get("sky-atmosphere-sun-intensity"),L=((N,W,J,ne,te)=>({u_matrix_3f:N,u_sun_direction:W,u_sun_intensity:J,u_color_tint_r:[ne.r,ne.g,ne.b,ne.a],u_color_tint_m:[te.r,te.g,te.b,te.a],u_luminance:5e-5}))(a.fromMat4(a.create$1(),m),_,z,C,k);S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+w,o.skyboxTexture,0),u.draw(f,S.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,L,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const Vl=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Yp{constructor(o){const u=new a.StructArrayLayout5f20;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const m=new a.StructArrayLayout3ui6;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(u,Vl.members),this.indexBuffer=o.createIndexBuffer(m),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ks={symbol:function(f,o,u,m,_){if(f.renderPass!=="translucent")return;const w=a.StencilMode.disabled,S=f.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(C,k,z,L,N,W,J){const ne=k.transform,te=N==="map",re=W==="map";for(const U of C){const K=L.getTile(U),ae=K.getBucket(z);if(!ae||!ae.text||!ae.text.segments.get().length)continue;const le=a.evaluateSizeForZoom(ae.textSizeData,ne.zoom),ye=Ln(U,ae.getProjection(),ne),xe=ne.calculatePixelsToTileUnitsMatrix(K),_e=Be(ye,K.tileID.canonical,re,te,ne,ae.getProjection(),xe),Se=z.layout.get("icon-text-fit")!=="none"&&ae.hasIconData();if(le){const Ee=Math.pow(2,ne.zoom-K.tileID.overscaledZ);b_(ae,te,re,J,a.symbolSize,ne,_e,U,Ee,le,Se)}}}(m,f,u,o,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),_),u.paint.get("icon-opacity").constantOr(1)!==0&&Wp(f,o,u,m,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),w,S),u.paint.get("text-opacity").constantOr(1)!==0&&Wp(f,o,u,m,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),w,S),o.map.showCollisionBoxes&&(Nl(f,o,u,m,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Nl(f,o,u,m,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(f,o,u,m){if(f.renderPass!=="translucent")return;const _=u.paint.get("circle-opacity"),w=u.paint.get("circle-stroke-width"),S=u.paint.get("circle-stroke-opacity"),C=u.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)===0&&(w.constantOr(1)===0||S.constantOr(1)===0))return;const k=f.context,z=k.gl,L=f.transform,N=f.depthModeForSublayer(0,a.DepthMode.ReadOnly),W=a.StencilMode.disabled,J=f.colorModeForRenderPass(),ne=L.projection.name==="globe",te=[a.mercatorXfromLng(L.center.lng),a.mercatorYfromLat(L.center.lat)],re=[];for(let K=0;K<m.length;K++){const ae=m[K],le=o.getTile(ae),ye=le.getBucket(u);if(!ye||ye.projection.name!==L.projection.name)continue;const xe=ye.programConfigurations.get(u.id),_e=ad(u);ne&&_e.push("PROJECTION_GLOBE_VIEW");const Se=f.useProgram("circle",xe,_e),Ee=ye.layoutVertexBuffer,De=ye.globeExtVertexBuffer,Ye=ye.indexBuffer,ke=L.projection.createInversionMatrix(L,ae.canonical),$e={programConfiguration:xe,program:Se,layoutVertexBuffer:Ee,globeExtVertexBuffer:De,indexBuffer:Ye,uniformValues:sd(f,ae,le,ke,te,u),tile:le};if(C){const ze=ye.segments.get();for(const Ke of ze)re.push({segments:new a.SegmentVector([Ke]),sortKey:Ke.sortKey,state:$e})}else re.push({segments:ye.segments,sortKey:0,state:$e})}C&&re.sort((K,ae)=>K.sortKey-ae.sortKey);const U={useDepthForOcclusion:!ne};for(const K of re){const{programConfiguration:ae,program:le,layoutVertexBuffer:ye,globeExtVertexBuffer:xe,indexBuffer:_e,uniformValues:Se,tile:Ee}=K.state,De=K.segments;f.terrain&&f.terrain.setupElevationDraw(Ee,le,U),f.prepareDrawProgram(k,le,Ee.tileID.toUnwrapped()),le.draw(k,z.TRIANGLES,N,W,J,a.CullFaceMode.disabled,Se,u.id,ye,_e,De,u.paint,L.zoom,ae,[xe])}},heatmap:function(f,o,u,m){if(u.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const _=f.context,w=_.gl,S=a.StencilMode.disabled,C=new a.ColorMode([w.ONE,w.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(J,ne,te,re){const U=J.gl,K=ne.width*re,ae=ne.height*re;J.activeTexture.set(U.TEXTURE1),J.viewport.set([0,0,K,ae]);let le=te.heatmapFbo;if(!le||le&&(le.width!==K||le.height!==ae)){le&&le.destroy();const ye=U.createTexture();U.bindTexture(U.TEXTURE_2D,ye),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_WRAP_S,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_WRAP_T,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.LINEAR),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MAG_FILTER,U.LINEAR),le=te.heatmapFbo=J.createFramebuffer(K,ae,!1),function(xe,_e,Se,Ee,De,Ye){const ke=xe.gl;ke.texImage2D(ke.TEXTURE_2D,0,xe.isWebGL2&&xe.extRenderToTextureHalfFloat?ke.RGBA16F:ke.RGBA,De,Ye,0,ke.RGBA,xe.extRenderToTextureHalfFloat?xe.isWebGL2?ke.HALF_FLOAT:xe.extTextureHalfFloat.HALF_FLOAT_OES:ke.UNSIGNED_BYTE,null),Ee.colorAttachment.set(Se)}(J,0,ye,le,K,ae)}else U.bindTexture(U.TEXTURE_2D,le.colorAttachment.get()),J.bindFramebuffer.set(le.framebuffer)})(_,f,u,f.transform.projection.name==="globe"?.5:.25),_.clear({color:a.Color.transparent});const k=f.transform,z=k.projection.name==="globe",L=z?["PROJECTION_GLOBE_VIEW"]:null,N=z?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,W=[a.mercatorXfromLng(k.center.lng),a.mercatorYfromLat(k.center.lat)];for(let J=0;J<m.length;J++){const ne=m[J];if(o.hasRenderableParent(ne))continue;const te=o.getTile(ne),re=te.getBucket(u);if(!re||re.projection.name!==k.projection.name)continue;const U=re.programConfigurations.get(u.id),K=f.useProgram("heatmap",U,L),{zoom:ae}=f.transform;f.terrain&&f.terrain.setupElevationDraw(te,K),f.prepareDrawProgram(_,K,ne.toUnwrapped());const le=k.projection.createInversionMatrix(k,ne.canonical);K.draw(_,w.TRIANGLES,a.DepthMode.disabled,S,C,N,Vp(f,ne,te,le,W,ae,u.paint.get("heatmap-intensity")),u.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,u.paint,f.transform.zoom,U,z?[re.globeExtVertexBuffer]:null)}_.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(_,w){const S=_.context,C=S.gl,k=w.heatmapFbo;if(!k)return;S.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,k.colorAttachment.get()),S.activeTexture.set(C.TEXTURE1);let z=w.colorRampTexture;z||(z=w.colorRampTexture=new a.Texture(S,w.colorRamp,C.RGBA)),z.bind(C.LINEAR,C.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(S,C.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,_.colorModeForRenderPass(),a.CullFaceMode.disabled,((L,N,W,J)=>({u_image:0,u_color_ramp:1,u_opacity:N.paint.get("heatmap-opacity")}))(0,w),w.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,w.paint,_.transform.zoom)}(f,u))},line:function(f,o,u,m){if(f.renderPass!=="translucent")return;const _=u.paint.get("line-opacity"),w=u.paint.get("line-width");if(_.constantOr(1)===0||w.constantOr(1)===0)return;const S=f.depthModeForSublayer(0,a.DepthMode.ReadOnly),C=f.colorModeForRenderPass(),k=f.terrain&&f.terrain.renderingToTexture?1:a.exported.devicePixelRatio,z=u.paint.get("line-dasharray"),L=z.constantOr(1),N=u.layout.get("line-cap"),W=u.paint.get("line-pattern"),J=W.constantOr(1),ne=u.paint.get("line-gradient"),te=J?"linePattern":"line",re=f.context,U=re.gl,K=(le=>{const ye=[];jl(le)&&ye.push("RENDER_LINE_DASH"),le.paint.get("line-gradient")&&ye.push("RENDER_LINE_GRADIENT");const xe=le.paint.get("line-trim-offset");xe[0]===0&&xe[1]===0||ye.push("RENDER_LINE_TRIM_OFFSET");const _e=le.paint.get("line-pattern").constantOr(1),Se=le.paint.get("line-opacity").constantOr(1)!==1;return!_e&&Se&&ye.push("RENDER_LINE_ALPHA_DISCARD"),ye})(u);let ae=K.includes("RENDER_LINE_ALPHA_DISCARD");f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(ae=!1);for(const le of m){const ye=o.getTile(le);if(J&&!ye.patternsLoaded())continue;const xe=ye.getBucket(u);if(!xe)continue;f.prepareDrawTile();const _e=xe.programConfigurations.get(u.id),Se=f.useProgram(te,_e,K),Ee=W.constantOr(null);if(Ee&&ye.imageAtlas){const Ve=ye.imageAtlas.patternPositions[Ee.toString()];Ve&&_e.setConstantPatternPositions(Ve)}const De=z.constantOr(null),Ye=N.constantOr(null);if(!J&&De&&Ye&&ye.lineAtlas){const Ve=ye.lineAtlas.getDash(De,Ye);Ve&&_e.setConstantPatternPositions(Ve)}let[ke,$e]=u.paint.get("line-trim-offset");(Ye==="round"||Ye==="square")&&ke!==$e&&(ke===0&&(ke-=1),$e===1&&($e+=1));const ze=f.terrain?le.projMatrix:null,Ke=J?Bl(f,ye,u,ze,k):x_(f,ye,u,ze,xe.lineClipsArray.length,k,[ke,$e]);if(ne){const Ve=xe.gradients[u.id];let Qe=Ve.texture;if(u.gradientVersion!==Ve.version){let qe=256;if(u.stepInterpolant){const et=o.getSource().maxzoom,Tt=le.canonical.z===et?Math.ceil(1<<f.transform.maxZoom-le.canonical.z):1;qe=a.clamp(a.nextPowerOfTwo(xe.maxLineLength/a.EXTENT*1024*Tt),256,re.maxTextureSize)}Ve.gradient=a.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:qe,image:Ve.gradient||void 0,clips:xe.lineClipsArray}),Ve.texture?Ve.texture.update(Ve.gradient):Ve.texture=new a.Texture(re,Ve.gradient,U.RGBA),Ve.version=u.gradientVersion,Qe=Ve.texture}re.activeTexture.set(U.TEXTURE1),Qe.bind(u.stepInterpolant?U.NEAREST:U.LINEAR,U.CLAMP_TO_EDGE)}L&&(re.activeTexture.set(U.TEXTURE0),ye.lineAtlasTexture.bind(U.LINEAR,U.REPEAT),_e.updatePaintBuffers()),J&&(re.activeTexture.set(U.TEXTURE0),ye.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),_e.updatePaintBuffers()),f.prepareDrawProgram(re,Se,le.toUnwrapped());const Ae=Ve=>{Se.draw(re,U.TRIANGLES,S,Ve,C,a.CullFaceMode.disabled,Ke,u.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,u.paint,f.transform.zoom,_e,[xe.layoutVertexBuffer2])};if(ae){const Ve=f.stencilModeForClipping(le).ref;Ve===0&&f.terrain&&re.clear({stencil:0});const Qe={func:U.EQUAL,mask:255};Ke.u_alpha_discard_threshold=.8,Ae(new a.StencilMode(Qe,Ve,255,U.KEEP,U.KEEP,U.INVERT)),Ke.u_alpha_discard_threshold=0,Ae(new a.StencilMode(Qe,Ve,255,U.KEEP,U.KEEP,U.KEEP))}else Ae(f.stencilModeForClipping(le))}ae&&(f.resetStencilClippingMasks(),f.terrain&&re.clear({stencil:0}))},fill:function(f,o,u,m){const _=u.paint.get("fill-color"),w=u.paint.get("fill-opacity");if(w.constantOr(1)===0)return;const S=f.colorModeForRenderPass(),C=u.paint.get("fill-pattern"),k=f.opaquePassEnabledForLayer()&&!C.constantOr(1)&&_.constantOr(a.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===k){const z=f.depthModeForSublayer(1,f.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);Zp(f,o,u,m,z,S,!1)}if(f.renderPass==="translucent"&&u.paint.get("fill-antialias")){const z=f.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);Zp(f,o,u,m,z,S,!0)}},"fill-extrusion":function(f,o,u,m){const _=u.paint.get("fill-extrusion-opacity");if(_!==0&&f.renderPass==="translucent"){const w=new a.DepthMode(f.context.gl.LEQUAL,a.DepthMode.ReadWrite,f.depthRangeFor3D);if(_!==1||u.paint.get("fill-extrusion-pattern").constantOr(1))uu(f,o,u,m,w,a.StencilMode.disabled,a.ColorMode.disabled),uu(f,o,u,m,w,f.stencilModeFor3D(),f.colorModeForRenderPass()),f.resetStencilClippingMasks();else{const S=f.colorModeForRenderPass();uu(f,o,u,m,w,a.StencilMode.disabled,S)}}},hillshade:function(f,o,u,m){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const _=f.context,w=f.depthModeForSublayer(0,a.DepthMode.ReadOnly),S=f.colorModeForRenderPass(),C=f.terrain&&f.terrain.renderingToTexture,[k,z]=f.renderPass!=="translucent"||C?[{},m]:f.stencilConfigForOverlap(m);for(const L of z){const N=o.getTile(L);if(N.needsHillshadePrepare&&f.renderPass==="offscreen")Fp(f,N,u,w,a.StencilMode.disabled,S);else if(f.renderPass==="translucent"){const W=C&&f.terrain?f.terrain.stencilModeForRTTOverlap(L):k[L.overscaledZ];Op(f,L,N,u,w,W,S)}}_.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,o,u,m,_,w){if(f.renderPass!=="translucent"||u.paint.get("raster-opacity")===0||!m.length)return;const S=f.context,C=S.gl,k=o.getSource(),z=f.useProgram("raster"),L=f.colorModeForRenderPass(),N=f.terrain&&f.terrain.renderingToTexture,[W,J]=k instanceof Gt||N?[{},m]:f.stencilConfigForOverlap(m),ne=J[J.length-1].overscaledZ,te=!f.options.moving;for(const re of J){const U=N?a.DepthMode.disabled:f.depthModeForSublayer(re.overscaledZ-ne,u.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,C.LESS),K=re.toUnwrapped(),ae=o.getTile(re);if(N&&(!ae||!ae.hasData()))continue;const le=N?re.projMatrix:f.transform.calculateProjMatrix(K,te),ye=f.terrain&&N?f.terrain.stencilModeForRTTOverlap(re):W[re.overscaledZ],xe=w?0:u.paint.get("raster-fade-duration");ae.registerFadeDuration(xe);const _e=o.findLoadedParent(re,0),Se=td(ae,_e,o,f.transform,xe);let Ee,De;f.terrain&&f.terrain.prepareDrawTile();const Ye=u.paint.get("raster-resampling")==="nearest"?C.NEAREST:C.LINEAR;S.activeTexture.set(C.TEXTURE0),ae.texture.bind(Ye,C.CLAMP_TO_EDGE),S.activeTexture.set(C.TEXTURE1),_e?(_e.texture.bind(Ye,C.CLAMP_TO_EDGE),Ee=Math.pow(2,_e.tileID.overscaledZ-ae.tileID.overscaledZ),De=[ae.tileID.canonical.x*Ee%1,ae.tileID.canonical.y*Ee%1]):ae.texture.bind(Ye,C.CLAMP_TO_EDGE),ae.texture.useMipmap&&S.extTextureFilterAnisotropic&&f.transform.pitch>20&&C.texParameterf(C.TEXTURE_2D,S.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,S.extTextureFilterAnisotropicMax);const ke=ud(le,De||[0,0],Ee||1,Se,u,k instanceof Gt?k.perspectiveTransform:[0,0]);if(f.prepareDrawProgram(S,z,K),k instanceof Gt)k.boundsBuffer&&k.boundsSegments&&z.draw(S,C.TRIANGLES,U,a.StencilMode.disabled,L,a.CullFaceMode.disabled,ke,u.id,k.boundsBuffer,f.quadTriangleIndexBuffer,k.boundsSegments);else{const{tileBoundsBuffer:$e,tileBoundsIndexBuffer:ze,tileBoundsSegments:Ke}=f.getTileBoundsBuffers(ae);z.draw(S,C.TRIANGLES,U,ye,L,a.CullFaceMode.disabled,ke,u.id,$e,ze,Ke)}}f.resetStencilClippingMasks()},background:function(f,o,u,m){const _=u.paint.get("background-color"),w=u.paint.get("background-opacity");if(w===0)return;const S=f.context,C=S.gl,k=f.transform,z=k.tileSize,L=u.paint.get("background-pattern");if(f.isPatternMissing(L))return;const N=!L&&_.a===1&&w===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==N)return;const W=a.StencilMode.disabled,J=f.depthModeForSublayer(0,N==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),ne=f.colorModeForRenderPass(),te=f.useProgram(L?"backgroundPattern":"background");let re,U=m;U||(re=f.getBackgroundTiles(),U=Object.values(re).map(K=>K.tileID)),L&&(S.activeTexture.set(C.TEXTURE0),f.imageManager.bind(f.context));for(const K of U){const ae=K.toUnwrapped(),le=m?K.projMatrix:f.transform.calculateProjMatrix(ae);f.prepareDrawTile();const ye=o?o.getTile(K):re?re[K.key]:new a.Tile(K,z,k.zoom,f),xe=L?w_(le,w,f,L,{tileID:K,tileSize:z}):dd(le,w,_);f.prepareDrawProgram(S,te,ae);const{tileBoundsBuffer:_e,tileBoundsIndexBuffer:Se,tileBoundsSegments:Ee}=f.getTileBoundsBuffers(ye);te.draw(S,C.TRIANGLES,J,W,ne,a.CullFaceMode.disabled,xe,u.id,_e,Se,Ee)}},sky:function(f,o,u){const m=f.transform,_=m.projection.name==="mercator"||m.projection.name==="globe"?1:a.smoothstep(7,8,m.zoom),w=u.paint.get("sky-opacity")*_;if(w===0)return;const S=f.context,C=u.paint.get("sky-type"),k=new a.DepthMode(S.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),z=f.frameCounter/1e3%1;C==="atmosphere"?f.renderPass==="offscreen"?u.needsSkyboxCapture(f)&&(function(L,N,W,J){const ne=L.context,te=ne.gl;let re=N.skyboxFbo;if(!re){re=N.skyboxFbo=ne.createFramebuffer(32,32,!1),N.skyboxGeometry=new du(ne),N.skyboxTexture=ne.gl.createTexture(),te.bindTexture(te.TEXTURE_CUBE_MAP,N.skyboxTexture),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_WRAP_S,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_WRAP_T,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_MIN_FILTER,te.LINEAR),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_MAG_FILTER,te.LINEAR);for(let le=0;le<6;++le)te.texImage2D(te.TEXTURE_CUBE_MAP_POSITIVE_X+le,0,te.RGBA,32,32,0,te.RGBA,te.UNSIGNED_BYTE,null)}ne.bindFramebuffer.set(re.framebuffer),ne.viewport.set([0,0,32,32]);const U=N.getCenter(L,!0),K=L.useProgram("skyboxCapture"),ae=new Float64Array(16);a.identity(ae),a.rotateY(ae,ae,.5*-Math.PI),Ti(ne,N,K,ae,U,0),a.identity(ae),a.rotateY(ae,ae,.5*Math.PI),Ti(ne,N,K,ae,U,1),a.identity(ae),a.rotateX(ae,ae,.5*-Math.PI),Ti(ne,N,K,ae,U,2),a.identity(ae),a.rotateX(ae,ae,.5*Math.PI),Ti(ne,N,K,ae,U,3),a.identity(ae),Ti(ne,N,K,ae,U,4),a.identity(ae),a.rotateY(ae,ae,Math.PI),Ti(ne,N,K,ae,U,5),ne.viewport.set([0,0,L.width,L.height])}(f,u),u.markSkyboxValid(f)):f.renderPass==="sky"&&function(L,N,W,J,ne){const te=L.context,re=te.gl,U=L.transform,K=L.useProgram("skybox");te.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_CUBE_MAP,N.skyboxTexture);const ae=((le,ye,xe,_e,Se)=>({u_matrix:le,u_sun_direction:ye,u_cubemap:0,u_opacity:_e,u_temporal_offset:Se}))(U.skyboxMatrix,N.getCenter(L,!1),0,J,ne);L.prepareDrawProgram(te,K),K.draw(te,re.TRIANGLES,W,a.StencilMode.disabled,L.colorModeForRenderPass(),a.CullFaceMode.backCW,ae,"skybox",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(f,u,k,w,z):C==="gradient"&&f.renderPass==="sky"&&function(L,N,W,J,ne){const te=L.context,re=te.gl,U=L.transform,K=L.useProgram("skyboxGradient");N.skyboxGeometry||(N.skyboxGeometry=new du(te)),te.activeTexture.set(re.TEXTURE0);let ae=N.colorRampTexture;ae||(ae=N.colorRampTexture=new a.Texture(te,N.colorRamp,re.RGBA)),ae.bind(re.LINEAR,re.CLAMP_TO_EDGE);const le=((ye,xe,_e,Se,Ee)=>({u_matrix:ye,u_color_ramp:0,u_center_direction:xe,u_radius:a.degToRad(_e),u_opacity:Se,u_temporal_offset:Ee}))(U.skyboxMatrix,N.getCenter(L,!1),N.paint.get("sky-gradient-radius"),J,ne);L.prepareDrawProgram(te,K),K.draw(te,re.TRIANGLES,W,a.StencilMode.disabled,L.colorModeForRenderPass(),a.CullFaceMode.backCW,le,"skyboxGradient",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(f,u,k,w,z)},debug:function(f,o,u){for(let m=0;m<u.length;m++)P_(f,o,u[m])},custom:function(f,o,u,m){const _=f.context,w=u.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&u.isLayerDraped()){if(f.renderPass==="offscreen"){const S=w.prerender;if(S){if(f.setCustomLayerDefaults(),_.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const C=f.transform.pointMerc;S.call(w,_.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(f.transform.zoom),[C.x,C.y],f.transform.pixelsPerMeterRatio)}else S.call(w,_.gl,f.transform.customLayerMatrix());_.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const C=w.renderToTile;if(C){const k=m[0].canonical,z=new a.MercatorCoordinate(k.x+m[0].wrap*(1<<k.z),k.y,k.z);_.setDepthMode(a.DepthMode.disabled),_.setStencilMode(a.StencilMode.disabled),_.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),C.call(w,_.gl,z),_.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),_.setColorMode(f.colorModeForRenderPass()),_.setStencilMode(a.StencilMode.disabled);const S=w.renderingMode==="3d"?new a.DepthMode(f.context.gl.LEQUAL,a.DepthMode.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,a.DepthMode.ReadOnly);if(_.setDepthMode(S),f.transform.projection.name==="globe"){const C=f.transform.pointMerc;w.render(_.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(f.transform.zoom),[C.x,C.y],f.transform.pixelsPerMeterRatio)}else w.render(_.gl,f.transform.customLayerMatrix());_.setDirty(),f.setBaseState(),_.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class xa{constructor(o,u,m=!1){this.context=new ot(o,m),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,u){const m=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new rd(this,o));const _=this._terrain;this.transform.elevation=m?_:null,_.update(o,this.transform,u)}_updateFog(o){const u=o.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,_]=u.getFovAdjustedRange(this.transform._fov);if(m>_)return void(this.transform.fogCullDistSq=null);const w=m+.78*(_-m);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,u){if(this.width=o*a.exported.devicePixelRatio,this.height=u*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._layers[m].resize()}setup(){const o=this.context,u=new a.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(a.EXTENT,0),u.emplaceBack(0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(u,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const m=new a.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(a.EXTENT,0),m.emplaceBack(0,a.EXTENT),m.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=o.createVertexBuffer(m,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const _=new a.StructArrayLayout2i4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(_,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const w=new a.StructArrayLayout4i8;w.emplaceBack(0,0,0,0),w.emplaceBack(a.EXTENT,0,a.EXTENT,0),w.emplaceBack(0,a.EXTENT,0,a.EXTENT),w.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(w,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(S);const C=new a.StructArrayLayout1ui2;for(const z of[0,1,3,2,0])C.emplaceBack(z);this.debugIndexBuffer=o.createIndexBuffer(C),this.emptyTexture=new a.Texture(o,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=a.create();const k=this.context.gl;this.stencilClearMode=new a.StencilMode({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new Yp(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,u=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,u.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,Ol(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,u,m){if(!u||this.currentStencilSource===u.id||!o.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let C=!1;for(const k of m)if(this._tileClippingMaskIDs[k.key]===void 0){C=!0;break}if(!C)return}this.currentStencilSource=u.id;const _=this.context,w=_.gl;this.nextStencilID+m.length>256&&this.clearStencil(),_.setColorMode(a.ColorMode.disabled),_.setDepthMode(a.DepthMode.disabled);const S=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const C of m){const k=u.getTile(C),z=this._tileClippingMaskIDs[C.key]=this.nextStencilID++,{tileBoundsBuffer:L,tileBoundsIndexBuffer:N,tileBoundsSegments:W}=this.getTileBoundsBuffers(k);S.draw(_,w.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:w.ALWAYS,mask:0},z,255,w.KEEP,w.KEEP,w.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Ol(C.projMatrix),"$clipping",L,N,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,u=this.context.gl;return new a.StencilMode({func:u.NOTEQUAL,mask:255},o,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const u=this.context.gl;return new a.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(o){const u=this.context.gl,m=o.sort((S,C)=>C.overscaledZ-S.overscaledZ),_=m[m.length-1].overscaledZ,w=m[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const S={};for(let C=0;C<w;C++)S[C+_]=new a.StencilMode({func:u.GEQUAL,mask:255},C+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=w,[S,m]}return[{[_]:a.StencilMode.disabled},m]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([o.CONSTANT_COLOR,o.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(o,u,m){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new a.DepthMode(m||this.context.gl.LEQUAL,u,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,u){this.style=o,this.options=u,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const m=this.style.order,_=this.style._sourceCaches;for(const z in _){const L=_[z];L.used&&L.prepare(this.context)}const w={},S={},C={};for(const z in _){const L=_[z];w[z]=L.getVisibleCoordinates(),S[z]=w[z].slice().reverse(),C[z]=L.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<m.length;z++)if(this.style._layers[m[z]].is3D()){this.opaquePassCutoff=z;break}if(this.terrain&&(this.terrain.updateTileBinding(C),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const z of m){const L=this.style._layers[z],N=o._getLayerSourceCache(L);if(!L.hasOffscreenPass()||L.isHidden(this.transform.zoom))continue;const W=N?S[N.id]:void 0;(L.type==="custom"||L.isSky()||W&&W.length)&&this.renderLayer(this,N,L,W)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon];const k=this.terrain;if(k&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&k.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:u.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[m[this.currentLayer]],L=o._getLayerSourceCache(z);if(z.isSky())continue;const N=L?S[L.id]:void 0;this._renderTileClippingMasks(z,L,N),this.renderLayer(this,L,z,N)}if(this.style.fog&&this.transform.projection.supportsFog&&function(z,L){const N=z.context,W=N.gl,J=z.transform,ne=new a.DepthMode(W.LEQUAL,a.DepthMode.ReadOnly,[0,1]),te=z.useProgram("globeAtmosphere",null,J.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),re=a.globeToMercatorTransition(J.zoom),U=L.properties.get("color").toArray01(),K=L.properties.get("high-color").toArray01(),ae=L.properties.get("space-color").toArray01PremultipliedAlpha(),le=a.identity$1([]);a.rotateY$1(le,le,-a.degToRad(J._center.lng)),a.rotateX$1(le,le,a.degToRad(J._center.lat)),a.rotateZ$1(le,le,J.angle),a.rotateX$1(le,le,-J._pitch);const ye=a.fromQuat(new Float32Array(16),le),xe=a.mapValue(L.properties.get("star-intensity"),0,1,0,.25),_e=5e-4,Se=a.mapValue(L.properties.get("horizon-blend"),0,1,_e,.25),Ee=a.globeUseCustomAntiAliasing(z,N,J)&&Se===_e?J.worldSize/(2*Math.PI*1.025)-1:J.globeRadius,De=z.frameCounter/1e3%1,Ye=a.length(J.globeCenterInViewSpace),ke=Math.sqrt(Math.pow(Ye,2)-Math.pow(Ee,2)),$e=Math.acos(ke/Ye),ze=((Ae,Ve,Qe,qe,et,Tt,At,_t,Pt,Xt,Zt,wt,hn,fn)=>({u_frustum_tl:Ae,u_frustum_tr:Ve,u_frustum_br:Qe,u_frustum_bl:qe,u_horizon:et,u_transition:Tt,u_fadeout_range:At,u_color:_t,u_high_color:Pt,u_space_color:Xt,u_star_intensity:Zt,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:wt,u_horizon_angle:hn,u_rotation_matrix:fn}))(J.frustumCorners.TL,J.frustumCorners.TR,J.frustumCorners.BR,J.frustumCorners.BL,J.frustumCorners.horizon,re,Se,U,K,ae,xe,De,$e,ye);z.prepareDrawProgram(N,te);const Ke=z.atmosphereBuffer;Ke&&te.draw(N,W.TRIANGLES,ne,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,ze,"skybox",Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const z=this.style._layers[m[this.currentLayer]],L=o._getLayerSourceCache(z);z.isSky()&&this.renderLayer(this,L,z,L?S[L.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;){const z=this.style._layers[m[this.currentLayer]],L=o._getLayerSourceCache(z);if(z.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(z)){if(z.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const N=L?(z.type==="symbol"?C:S)[L.id]:void 0;this._renderTileClippingMasks(z,L,L?w[L.id]:void 0),this.renderLayer(this,L,z,N),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let z=null;a.values(this.style._layers).forEach(L=>{const N=o._getLayerSourceCache(L);N&&!L.isHidden(this.transform.zoom)&&(!z||z.getSource().maxzoom<N.getSource().maxzoom)&&(z=N)}),z&&this.options.showTileBoundaries&&ks.debug(this,z,z.getVisibleCoordinates())}this.options.showPadding&&function(z){const L=z.transform.padding;Hp(z,z.transform.height-(L.top||0),3,_a),Hp(z,L.bottom||0,3,T_),hu(z,L.left||0,3,E_),hu(z,z.transform.width-(L.right||0),3,S_);const N=z.transform.centerPoint;(function(W,J,ne,te){va(W,J-1,ne-10,2,20,te),va(W,J-10,ne-1,20,2,te)})(z,N.x,z.transform.height-N.y,C_)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,u,m,_){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||_&&_.length)&&(this.id=m.id,this.gpuTimingStart(m),(!o.transform.projection.unsupportedLayers||!o.transform.projection.unsupportedLayers.includes(m.type)||o.terrain&&m.type==="custom")&&ks[m.type](o,u,m,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let m=this.gpuTimers[o.id];m||(m=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),m.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,m.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,u=o.createQueryEXT();this.deferredRenderGpuTimeQueries.push(u),o.beginQueryEXT(o.TIME_ELAPSED_EXT,u)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const u={};for(const m in o){const _=o[m],w=this.context.extTimerQuery,S=w.getQueryObjectEXT(_.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(_.query),u[m]=S}return u}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.extTimerQuery;let m=0;for(const _ of o)m+=u.getQueryObjectEXT(_,u.QUERY_RESULT_EXT)/1e6,u.deleteQueryEXT(_);return m}translatePosMatrix(o,u,m,_,w){if(!m[0]&&!m[1])return o;const S=w?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(S){const z=Math.sin(S),L=Math.cos(S);m=[m[0]*L-m[1]*z,m[0]*z+m[1]*L]}const C=[w?m[0]:Nt(u,m[0],this.transform.zoom),w?m[1]:Nt(u,m[1],this.transform.zoom),0],k=new Float32Array(16);return a.translate(k,o,C),k}saveTileTexture(o){const u=this._tileTextures[o.size[0]];u?u.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const u=this._tileTextures[o];return u&&u.length>0?u.pop():null}isPatternMissing(o){return o===null||o!==void 0&&!this.imageManager.getPattern(o.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,u=this.terrain&&this.terrain.exaggeration()===0,m=this.style&&this.style.fog,_=[];return this.terrainRenderModeElevated()&&_.push("TERRAIN"),this.transform.projection.name==="globe"&&_.push("GLOBE"),u&&_.push("ZERO_EXAGGERATION"),m&&!o&&m.getOpacity(this.transform.pitch)!==0&&_.push("FOG"),o&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(o,u,m){this.cache=this.cache||{};const _=m||[],w=this.currentGlobalDefines().concat(_),S=en.cacheKey(Yh[o],o,w,u);return this.cache[S]||(this.cache[S]=new en(this.context,o,Yh[o],u,fd[o],w)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,u,m){if(this.terrain&&this.terrain.renderingToTexture)return;const _=this.style.fog;if(_){const w=_.getOpacity(this.transform.pitch),S=((C,k,z,L,N,W,J,ne,te,re,U)=>{const K=C.transform,ae=k.properties.get("color").toArray01();ae[3]=L;const le=C.frameCounter/1e3%1;return{u_fog_matrix:z?K.calculateFogTileMatrix(z):C.identityMat,u_fog_range:k.getFovAdjustedRange(K._fov),u_fog_color:ae,u_fog_horizon_blend:k.properties.get("horizon-blend"),u_fog_temporal_offset:le,u_frustum_tl:N,u_frustum_tr:W,u_frustum_br:J,u_frustum_bl:ne,u_globe_pos:te,u_globe_radius:re,u_viewport:U,u_globe_transition:a.globeToMercatorTransition(K.zoom),u_is_globe:+(K.projection.name==="globe")}})(this,_,m,w,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);u.setFogUniformValues(o,S)}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,u=o.createTexture();return o.bindTexture(o.TEXTURE_2D,u),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,u=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const _ of m)u[_.key]=o[_.key]||new a.Tile(_,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}}class fu{constructor(o=0,u=0,m=0,_=0){if(isNaN(o)||o<0||isNaN(u)||u<0||isNaN(m)||m<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=u,this.left=m,this.right=_}interpolate(o,u,m){return u.top!=null&&o.top!=null&&(this.top=a.number(o.top,u.top,m)),u.bottom!=null&&o.bottom!=null&&(this.bottom=a.number(o.bottom,u.bottom,m)),u.left!=null&&o.left!=null&&(this.left=a.number(o.left,u.left,m)),u.right!=null&&o.right!=null&&(this.right=a.number(o.right,u.right,m)),this}getCenter(o,u){const m=a.clamp((this.left+o-this.right)/2,0,o),_=a.clamp((this.top+u-this.bottom)/2,0,u);return new a.Point(m,_)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new fu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function pu(f,o){const u=a.getColumn(f,3);a.fromQuat(f,o),a.setColumn(f,3,u)}function tn(f,o){const u=a.identity$1([]);return a.rotateZ$1(u,u,-o),a.rotateX$1(u,u,-f),u}function $l(f,o){const u=[f[0],f[1],0],m=[o[0],o[1],0];if(a.length(u)>=1e-15){const S=a.normalize([],u);a.scale$2(m,S,a.dot(m,S)),o[0]=m[0],o[1]=m[1]}const _=a.cross([],o,f);if(a.len(_)<1e-15)return null;const w=Math.atan2(-_[1],_[0]);return tn(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),w)}class Jp{constructor(o,u){this.position=o,this.orientation=u}get position(){return this._position}set position(o){if(o){const u=o instanceof a.MercatorCoordinate?o:new a.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(u.x=a.wrap(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(o,u){if(this.orientation=null,!this.position)return;const m=this.position,_=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(o)):0,w=a.MercatorCoordinate.fromLngLat(o,_),S=[w.x-m.x,w.y-m.y,w.z-m.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=$l(S,u)}setPitchBearing(o,u){this.orientation=tn(a.degToRad(o),a.degToRad(-u))}}class mu{constructor(o,u){this._transform=a.identity([]),this.orientation=u,this.position=o}get mercatorPosition(){const o=this.position;return new a.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=a.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var u;o&&a.setColumn(this._transform,3,[(u=o)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||a.identity$1([]),o&&pu(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,u){this._orientation=tn(o,u),pu(this._transform,this._orientation)}forward(){const o=a.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=a.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=a.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,u){const m=new Float64Array(16);return a.invert(m,this.getWorldToCamera(o,u)),m}getWorldToCameraPosition(o,u,m){const _=this.position;a.scale$2(_,_,-o);const w=new Float64Array(16);return a.fromScaling(w,[m,m,m]),a.translate(w,w,_),w[10]*=u,w}getWorldToCamera(o,u){const m=new Float64Array(16),_=new Float64Array(4),w=this.position;return a.conjugate(_,this._orientation),a.scale$2(w,w,-o),a.fromQuat(m,_),a.translate(m,m,w),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=u,m[9]*=u,m[10]*=u,m[11]*=u,m}getCameraToClipPerspective(o,u,m,_){const w=new Float64Array(16);return a.perspective(w,o,u,m,_),w}getDistanceToElevation(o,u=!1){const m=o===0?0:a.mercatorZfromAltitude(o,u?a.latFromMercatorY(this.position[1]):this.position[1]),_=this.forward();return(m-this.position[2])/_[2]}clone(){return new mu([...this.position],[...this.orientation])}}function wa(f,o){const u=gu(f.projection,f.zoom,f.width,f.height),m=function(w,S,C,k,z){const L=new a.LngLat(C.lng-180*Ao,C.lat),N=new a.LngLat(C.lng+180*Ao,C.lat),W=w.project(L.lng,L.lat),J=w.project(N.lng,N.lat),ne=-Math.atan2(J.y-W.y,J.x-W.x),te=a.MercatorCoordinate.fromLngLat(C);te.y=a.clamp(te.y,-1+Ao,1-Ao);const re=te.toLngLat(),U=w.project(re.lng,re.lat),K=a.MercatorCoordinate.fromLngLat(re);K.x+=Ao;const ae=K.toLngLat(),le=w.project(ae.lng,ae.lat),ye=yu(le.x-U.x,le.y-U.y,ne),xe=a.MercatorCoordinate.fromLngLat(re);xe.y+=Ao;const _e=xe.toLngLat(),Se=w.project(_e.lng,_e.lat),Ee=yu(Se.x-U.x,Se.y-U.y,ne),De=Math.abs(ye.x)/Math.abs(Ee.y),Ye=a.identity([]);a.rotateZ(Ye,Ye,-ne*(1-(z?0:k)));const ke=a.identity([]);return a.scale(ke,ke,[1,1-(1-De)*k,1]),ke[4]=-Ee.x/Ee.y*k,a.rotateZ(ke,ke,ne),a.multiply(ke,Ye,ke),ke}(f.projection,0,f.center,u,o),_=Qp(f);return a.scale(m,m,[_,_,1]),m}function Qp(f){const o=f.projection,u=gu(f.projection,f.zoom,f.width,f.height),m=em(o,f.center),_=em(o,a.LngLat.convert(o.center));return Math.pow(2,m*u+(1-u)*_)}function gu(f,o,u,m,_=1/0){const w=f.range;if(!w)return 0;const S=Math.min(_,Math.max(u,m)),C=Math.log(S/1024)/Math.LN2;return a.smoothstep(w[0]+C,w[1]+C,o)}const Ao=1/4e4;function em(f,o){const u=a.clamp(o.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),m=new a.LngLat(o.lng-180*Ao,u),_=new a.LngLat(o.lng+180*Ao,u),w=f.project(m.lng,u),S=f.project(_.lng,u),C=a.MercatorCoordinate.fromLngLat(m),k=a.MercatorCoordinate.fromLngLat(_),z=S.x-w.x,L=S.y-w.y,N=k.x-C.x,W=k.y-C.y,J=Math.sqrt((N*N+W*W)/(z*z+L*L));return Math.log(J)/Math.LN2}function yu(f,o,u){const m=Math.cos(u),_=Math.sin(u);return{x:f*m-o*_,y:f*_+o*m}}class ba{constructor(o,u,m,_,w,S,C){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=o||0,this._maxZoom=u||22,this._minPitch=m??0,this._maxPitch=_??60,this.setProjection(S),this.setMaxBounds(C),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new fu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new mu,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const o=new ba(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o,u=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(o||m)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const m=!P(u,this.getProjection());return m&&this._calcMatrices(),this.mercatorFromTransition=!1,m}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const u=o!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.Point(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const u=-o*Math.PI/180;var m;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(m=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m),function(_,w,S){var C=w[0],k=w[1],z=w[2],L=w[3],N=Math.sin(S),W=Math.cos(S);_[0]=C*W+z*N,_[1]=k*W+L*N,_[2]=C*-N+z*W,_[3]=k*-N+L*W}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const u=a.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=a.degToRad(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const u=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let _=0,w=0;for(let S=0;S<u.length;S++){const C=new a.Point(u[S][0]*this.width,m+u[S][1]*(this.height-m)),k=o.pointCoordinate(C);if(!k)continue;const z=1/Math.hypot(k[0]-this._camera.position[0],k[1]-this._camera.position[1]);_+=k[3]*z,w+=z}return w===0?NaN:_/w}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*u,_=this._mercatorZfromZoom(o),w=this._mercatorZfromZoom(this._maxZoom),S=Math.max(_-m,w);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let m;m=o.z<this._camera.position[2]?[u.x,u.y,u.z]:[o.x,o.y,o.z];const _=a.length(a.sub([],this._camera.position,m));return a.clamp(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let u=!1;if(o.orientation&&!a.exactEquals(o.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(o.orientation)),o.position){const m=[o.position.x,o.position.y,o.position.z];a.exactEquals$1(m,this._camera.position)||(this._setCameraPosition(m),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,u=new Jp;return u.position=new a.MercatorCoordinate(o[0],o[1],o[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(o){if(!a.length$1(o))return!1;a.normalize$1(o,o);const u=a.transformQuat([],[0,0,-1],o),m=a.transformQuat([],[0,-1,0],o);if(m[2]<0)return!1;const _=$l(u,m);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(o){const u=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;o[2]=a.clamp(o[2],_/m,_/u),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,u,m){this._unmodified=!1,this._edgeInsets.interpolate(o,u,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const u=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(o){const u=[new a.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const m=this.pointCoordinate(new a.Point(0,0)),_=this.pointCoordinate(new a.Point(this.width,0)),w=this.pointCoordinate(new a.Point(this.width,this.height)),S=this.pointCoordinate(new a.Point(0,this.height)),C=Math.floor(Math.min(m.x,_.x,w.x,S.x)),k=Math.floor(Math.max(m.x,_.x,w.x,S.x)),z=1;for(let L=C-z;L<=k+z;L++)L!==0&&u.push(new a.UnwrappedTileID(L,o))}return u}coveringTiles(o){let u=this.coveringZoomLevel(o);const m=u,_=this.elevation&&!o.isTerrainDEM,w=this.projection.name==="mercator";if(o.minzoom!==void 0&&u<o.minzoom)return[];o.maxzoom!==void 0&&u>o.maxzoom&&(u=o.maxzoom);const S=this.locationCoordinate(this.center),C=this.center.lat,k=1<<u,z=[k*S.x,k*S.y,0],L=this.projection.name==="globe",N=!L,W=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,N),J=L?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ne=k*a.mercatorZfromAltitude(1,this.center.lat),te=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),re=[k*J.x,k*J.y,te*(N?1:ne)],U=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),K=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?u:0,ae=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,le=o.isTerrainDEM?-ae:this._elevation?this._elevation.getMinElevationBelowMSL():0,ye=this.projection.isReprojectedInTileSpace?Qp(this):1,xe=Ae=>{const Qe=new a.MercatorCoordinate(Ae.x+25e-6,Ae.y,Ae.z),qe=new a.MercatorCoordinate(Ae.x,Ae.y+25e-6,Ae.z),et=Ae.toLngLat(),Tt=Qe.toLngLat(),At=qe.toLngLat(),_t=this.locationCoordinate(et),Pt=this.locationCoordinate(Tt),Xt=this.locationCoordinate(At),Zt=Math.hypot(Pt.x-_t.x,Pt.y-_t.y),wt=Math.hypot(Xt.x-_t.x,Xt.y-_t.y);return Math.sqrt(Zt*wt)*ye/25e-6},_e=Ae=>{const Ve=ae,Qe=le;return{aabb:a.tileAABB(this,k,0,0,0,Ae,Qe,Ve,this.projection),zoom:0,x:0,y:0,minZ:Qe,maxZ:Ve,wrap:Ae,fullyVisible:!1}},Se=[];let Ee=[];const De=u,Ye=o.reparseOverscaled?m:u,ke=Ae=>Ae*Ae,$e=ke((te-this._centerAltitude)*ne),ze=Ae=>{if(!this._elevation||!Ae.tileID||!w)return;const Ve=this._elevation.getMinMaxForTile(Ae.tileID),Qe=Ae.aabb;Ve?(Qe.min[2]=Ve.min,Qe.max[2]=Ve.max,Qe.center[2]=(Qe.min[2]+Qe.max[2])/2):(Ae.shouldSplit=Ke(Ae),Ae.shouldSplit||(Qe.min[2]=Qe.max[2]=Qe.center[2]=this._centerAltitude))},Ke=Ae=>{if(Ae.zoom<K)return!0;if(Ae.zoom===De)return!1;if(Ae.shouldSplit!=null)return Ae.shouldSplit;const Ve=Ae.aabb.distanceX(re),Qe=Ae.aabb.distanceY(re);let qe=$e,et=1;if(L){qe=ke(Ae.aabb.distanceZ(re));const _t=Math.pow(2,Ae.zoom),Pt=a.latFromMercatorY((Ae.y+1)/_t),Xt=a.latFromMercatorY(Ae.y/_t),Zt=Math.min(Math.max(C,Pt),Xt),wt=a.circumferenceAtLatitude(Zt)/a.circumferenceAtLatitude(C);if(et=Zt===C?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,wt/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&Ae.zoom===De-1&&wt>=.9)return!0}else if(_&&(qe=ke(Ae.aabb.distanceZ(re)*ne)),this.projection.isReprojectedInTileSpace&&m<=5){const _t=Math.pow(2,Ae.zoom),Pt=xe(new a.MercatorCoordinate((Ae.x+.5)/_t,(Ae.y+.5)/_t));et=Pt>.85?1:Pt}const Tt=Ve*Ve+Qe*Qe+qe,At=ke((1<<De-Ae.zoom)*U*et*((_t,Pt)=>{if(Pt*ke(.707)<_t)return 1;const Xt=Math.sqrt(Pt/_t);return Xt/(1.4144271570014144+(Math.pow(1.1,Xt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(qe,$e),Tt));return Tt<At};if(this.renderWorldCopies)for(let Ae=1;Ae<=3;Ae++)Se.push(_e(-Ae)),Se.push(_e(Ae));for(Se.push(_e(0));Se.length>0;){const Ae=Se.pop(),Ve=Ae.x,Qe=Ae.y;let qe=Ae.fullyVisible;if(!qe){const et=Ae.aabb.intersects(W);if(et===0)continue;qe=et===2}if(Ae.zoom!==De&&Ke(Ae))for(let et=0;et<4;et++){const Tt=(Ve<<1)+et%2,At=(Qe<<1)+(et>>1),_t={aabb:w?Ae.aabb.quadrant(et):a.tileAABB(this,k,Ae.zoom+1,Tt,At,Ae.wrap,Ae.minZ,Ae.maxZ,this.projection),zoom:Ae.zoom+1,x:Tt,y:At,wrap:Ae.wrap,fullyVisible:qe,tileID:void 0,shouldSplit:void 0,minZ:Ae.minZ,maxZ:Ae.maxZ};_&&!L&&(_t.tileID=new a.OverscaledTileID(Ae.zoom+1===De?Ye:Ae.zoom+1,Ae.wrap,Ae.zoom+1,Tt,At),ze(_t)),Se.push(_t)}else{const et=Ae.zoom===De?Ye:Ae.zoom;if(o.minzoom&&o.minzoom>et)continue;const Tt=z[0]-(.5+Ve+(Ae.wrap<<Ae.zoom))*(1<<u-Ae.zoom),At=z[1]-.5-Qe,_t=Ae.tileID?Ae.tileID:new a.OverscaledTileID(et,Ae.wrap,Ae.zoom,Ve,Qe);Ee.push({tileID:_t,distanceSq:Tt*Tt+At*At})}}if(this.fogCullDistSq){const Ae=this.fogCullDistSq,Ve=this.horizonLineFromTop();Ee=Ee.filter(Qe=>{const qe=[0,0,0,1],et=[a.EXTENT,a.EXTENT,0,1],Tt=this.calculateFogTileMatrix(Qe.tileID.toUnwrapped());a.transformMat4$1(qe,qe,Tt),a.transformMat4$1(et,et,Tt);const At=a.getAABBPointSquareDist(qe,et);if(At===0)return!0;let _t=!1;const Pt=this._elevation;if(Pt&&At>Ae&&Ve!==0){const Xt=this.calculateProjMatrix(Qe.tileID.toUnwrapped());let Zt;o.isTerrainDEM||(Zt=Pt.getMinMaxForTile(Qe.tileID)),Zt||(Zt={min:le,max:ae});const wt=a.furthestTileCorner(this.rotation),hn=[wt[0]*a.EXTENT,wt[1]*a.EXTENT,Zt.max];a.transformMat4(hn,hn,Xt),_t=(1-hn[1])*this.height*.5<Ve}return At<Ae||_t})}return Ee.sort((Ae,Ve)=>Ae.distanceSq-Ve.distanceSq).map(Ae=>Ae.tileID)}resize(o,u){this.width=o,this.height=u,this.pixelsToGLUnits=[2/o,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const u=a.clamp(o.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),m=this.projection.project(o.lng,u);return new a.Point(m.x*this.worldSize,m.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,u){let m,_;const w=this.centerPoint;if(this.projection.name==="globe"){const C=this.worldSize;m=(u.x-w.x)/C,_=(u.y-w.y)/C}else{const C=this.pointCoordinate(u),k=this.pointCoordinate(w);m=C.x-k.x,_=C.y-k.y}const S=this.locationCoordinate(o);this.setLocation(new a.MercatorCoordinate(S.x-m,S.y-_))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,u){const m=u?a.mercatorZfromAltitude(u,o.lat):void 0,_=this.projection.project(o.lng,o.lat);return new a.MercatorCoordinate(_.x,_.y,m)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,u){const m=u??this._centerAltitude,_=[o.x,o.y,0,1],w=[o.x,o.y,1,1];a.transformMat4$1(_,_,this.pixelMatrixInverse),a.transformMat4$1(w,w,this.pixelMatrixInverse);const S=w[3];a.scale$1(_,_,1/_[3]),a.scale$1(w,w,1/S);const C=_[2],k=w[2];return{p0:_,p1:w,t:C===k?0:(m-C)/(k-C)}}screenPointToMercatorRay(o){const u=[o.x,o.y,0,1],m=[o.x,o.y,1,1];return a.transformMat4$1(u,u,this.pixelMatrixInverse),a.transformMat4$1(m,m,this.pixelMatrixInverse),a.scale$1(u,u,1/u[3]),a.scale$1(m,m,1/m[3]),u[2]=a.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,m[2]=a.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,a.scale$1(u,u,1/this.worldSize),a.scale$1(m,m,1/this.worldSize),new a.Ray([u[0],u[1],u[2]],a.normalize([],a.sub([],m,u)))}rayIntersectionCoordinate(o){const{p0:u,p1:m,t:_}=o,w=a.mercatorZfromAltitude(u[2],this._center.lat),S=a.mercatorZfromAltitude(m[2],this._center.lat);return new a.MercatorCoordinate(a.number(u[0],m[0],_)/this.worldSize,a.number(u[1],m[1],_)/this.worldSize,a.number(w,S,_))}pointCoordinate(o,u=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,u)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let u=this.projection.pointCoordinate3D(this,o.x,o.y);if(u)return new a.MercatorCoordinate(u[0],u[1],u[2]);let m=0,_=this.horizonLineFromTop();if(o.y>_)return this.pointCoordinate(o);const w=.02*_,S=o.clone();for(let C=0;C<10&&_-m>w;C++){S.y=a.number(m,_,.66);const k=this.projection.pointCoordinate3D(this,S.x,S.y);k?(_=S.y,u=k):m=S.y}return u?new a.MercatorCoordinate(u[0],u[1],u[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(o);const u=this.pointCoordinate(o);return u.y>=0&&u.y<=1}_coordinatePoint(o,u){const m=u&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,_=[o.x*this.worldSize,o.y*this.worldSize,m+o.toAltitude(),1];return a.transformMat4$1(_,_,this.pixelMatrix),_[3]>0?new a.Point(_[0]/_[3],_[1]/_[3]):new a.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:u}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,w=this.pointLocation3D(new a.Point(u,o)),S=this.pointLocation3D(new a.Point(_,o)),C=this.pointLocation3D(new a.Point(_,m)),k=this.pointLocation3D(new a.Point(u,m));let z=Math.min(w.lng,S.lng,C.lng,k.lng),L=Math.max(w.lng,S.lng,C.lng,k.lng),N=Math.min(w.lat,S.lat,C.lat,k.lat),W=Math.max(w.lat,S.lat,C.lat,k.lat);const J=Math.pow(2,-this.zoom)/16*270,ne=this.projection.name==="globe"?1:4,te=(re,U,K,ae,le)=>{const ye=(re+K)/2,xe=(U+ae)/2,_e=new a.Point(ye,xe),{lng:Se,lat:Ee}=this.pointLocation3D(_e),De=Math.max(0,z-Se,N-Ee,Se-L,Ee-W);z=Math.min(z,Se),L=Math.max(L,Se),N=Math.min(N,Ee),W=Math.max(W,Ee),(le<ne||De>J)&&(te(re,U,ye,xe,le+1),te(ye,xe,K,ae,le+1))};if(te(u,o,_,o,1),te(_,o,_,m,1),te(_,m,u,m,1),te(u,m,u,o,1),this.projection.name==="globe"){const[re,U]=a.polesInViewport(this);re?(W=90,L=180,z=-180):U&&(N=-90,L=180,z=-180)}return new a.LngLatBounds(new a.LngLat(z,N),new a.LngLat(L,W))}_getBoundsRectangular(o,u){const{top:m,left:_}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,C=new a.Point(_,m),k=new a.Point(S,m),z=new a.Point(S,w),L=new a.Point(_,w);let N=this.pointCoordinate(C,o),W=this.pointCoordinate(k,o);const J=this.pointCoordinate(z,u),ne=this.pointCoordinate(L,u),te=(re,U)=>(U.y-re.y)/(U.x-re.x);return N.y>1&&W.y>=0?N=new a.MercatorCoordinate((1-ne.y)/te(ne,N)+ne.x,1):N.y<0&&W.y<=1&&(N=new a.MercatorCoordinate(-ne.y/te(ne,N)+ne.x,0)),W.y>1&&N.y>=0?W=new a.MercatorCoordinate((1-J.y)/te(J,W)+J.x,1):W.y<0&&N.y<=1&&(W=new a.MercatorCoordinate(-J.y/te(J,W)+J.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(N)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(J))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=o.visibleDemTiles.reduce((m,_)=>{if(_.dem){const w=_.dem.tree;m.min=Math.min(m.min,w.minimums[0]),m.max=Math.max(m.max,w.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*o.exaggeration(),u.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,m=this.height/2-u*(1-this._horizonShift);return o?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,u){return this.projection.createTileMatrix(this,u,o)}calculateDistanceTileData(o){const u=o.key,m=this._distanceTileDataCache;if(m[u])return m[u];const _=o.canonical,w=1/this.height,S=this.cameraWorldSize,C=S/this.zoomScale(_.z),k=(_.x+Math.pow(2,_.z)*o.wrap)*C,z=_.y*C,L=this.point;L.x*=S/this.worldSize,L.y*=S/this.worldSize;const N=this.angle,W=Math.sin(-N),J=-Math.cos(-N);return m[u]={bearing:[W,J],center:[(L.x-k)*w,(L.y-z)*w],scale:C/a.EXTENT*w},m[u]}calculateFogTileMatrix(o){const u=o.key,m=this._fogTileMatrixCache;if(m[u])return m[u];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return a.multiply(_,this.worldToFogMatrix,_),m[u]=new Float32Array(_),m[u]}calculateProjMatrix(o,u=!1){const m=o.key,_=u?this._alignedProjMatrixCache:this._projMatrixCache;if(_[m])return _[m];const w=this.calculatePosMatrix(o,this.worldSize);return a.multiply(w,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:u?this.alignedProjMatrix:this.projMatrix,w),_[m]=new Float32Array(w),_[m]}calculatePixelsToTileUnitsMatrix(o){const u=o.tileID.key,m=this._pixelsToTileUnitsCache;if(m[u])return m[u];const _=function(w,S){const{scale:C}=w.tileTransform,k=C*a.EXTENT/(w.tileSize*Math.pow(2,S.zoom-w.tileID.overscaledZ+w.tileID.canonical.z));return z=new Float32Array(4),W=(L=S.inverseAdjustmentMatrix)[1],J=L[2],ne=L[3],re=(N=[k,k])[1],z[0]=L[0]*(te=N[0]),z[1]=W*te,z[2]=J*re,z[3]=ne*re,z;var z,L,N,W,J,ne,te,re}(o,this);return m[u]=_,m[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,u=a.fromScaling([],[o,o,o]);return a.multiply(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const u=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(u),_=this._camera.forward(),w=a.mercatorZfromAltitude(1,this._center.lat);m[2]/=w,_[2]/=w,a.normalize(_,_);const S=o.raycast(m,_,o.exaggeration());if(S){const C=a.scaleAndAdd([],m,_,S),k=new a.MercatorCoordinate(C[0],C[1],a.mercatorZfromAltitude(C[2],a.latFromMercatorY(C[1]))),z=(k.z+a.length([k.x-m[0],k.y-m[1],k.z-m[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(z),this._centerAltitude=k.toAltitude(),this._center=this.coordinateLocation(k),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const u=this._elevation,m=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(m),w=u.getAtPointOrZero(new a.MercatorCoordinate(..._)),S=this.pixelsPerMeter/this.worldSize*w,C=this._minimumHeightOverTerrain(),k=_[2]-S;if(k<=C)if(k<0||o){const z=this.locationCoordinate(this._center,this._centerAltitude),L=[_[0],_[1],z.z-_[2]],N=a.length(L);L[2]-=(C-k)/this._pixelsPerMercatorPixel;const W=a.length(L);if(W===0)return;a.scale$2(L,L,N/W*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],z.z*this._pixelsPerMercatorPixel-L[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const W=this.center;return W.lat=a.clamp(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(W.lng=a.clamp(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const u=this._unmodified,{x:m,y:_}=this.point;let w=0,S=m,C=_;const k=this.width/2,z=this.height/2,L=this.worldMinY*this.scale,N=this.worldMaxY*this.scale;if(_-z<L&&(C=L+z),_+z>N&&(C=N-z),N-L<this.height&&(w=Math.max(w,this.height/(N-L)),C=(N+L)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,J=this.worldMaxX*this.scale,ne=this.worldSize/2-(W+J)/2;S=(m+ne+this.worldSize)%this.worldSize-ne,S-k<W&&(S=W+k),S+k>J&&(S=J-k),J-W<this.width&&(w=Math.max(w,this.width/(J-W)),S=(J+W)/2)}S===m&&C===_||(this.center=this.unproject(new a.Point(S,C))),w&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,u=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const m=gu(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,m),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const _=this.projection.zAxisUnit==="meters"?u:1,w=this._camera.getWorldToCamera(this.worldSize,_),S=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);S[8]=2*-o.x/this.width,S[9]=2*o.y/this.height;let C=a.mul([],S,w);if(this.projection.isReprojectedInTileSpace){const xe=this.locationCoordinate(this.center),_e=a.identity([]);a.translate(_e,_e,[xe.x*this.worldSize,xe.y*this.worldSize,0]),a.multiply(_e,_e,wa(this)),a.translate(_e,_e,[-xe.x*this.worldSize,-xe.y*this.worldSize,0]),a.multiply(C,C,_e),this.inverseAdjustmentMatrix=function(Se){const Ee=wa(Se,!0);return Te([],[Ee[0],Ee[1],Ee[4],Ee[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],C,[this.worldSize,this.worldSize,this.worldSize/_,1]),this.projMatrix=C,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const k=a.invert([],S);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(k,this.horizonLineFromTop(),this.height);const z=new Float32Array(16);a.identity(z),a.scale(z,z,[1,-1,1]),a.rotateX(z,z,this._pitch),a.rotateZ(z,z,this.angle);const L=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),N=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;L[8]=2*-o.x/this.width,L[9]=2*(o.y+N)/this.height,this.skyboxMatrix=a.multiply(z,L,z);const W=this.point,J=W.x,ne=W.y,te=this.width%2/2,re=this.height%2/2,U=Math.cos(this.angle),K=Math.sin(this.angle),ae=J-Math.round(J)+U*te+K*re,le=ne-Math.round(ne)+U*re+K*te,ye=new Float64Array(C);if(a.translate(ye,ye,[ae>.5?ae-1:ae,le>.5?le-1:le,0]),this.alignedProjMatrix=ye,C=a.create(),a.scale(C,C,[this.width/2,-this.height/2,1]),a.translate(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=a.create(),a.scale(C,C,[1,-1,1]),a.translate(C,C,[-1,-1,0]),a.scale(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},C=a.invert(new Float64Array(16),this.pixelMatrix),!C)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=C,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const xe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(xe,xe,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=C;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,m=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,w=[o,o,u];a.scale$2(w,w,_),a.scale$2(m,m,-1),a.multiply$2(m,m,w);const S=a.create();a.translate(S,S,m),a.scale(S,S,w),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,u,_)}_computeCameraPosition(o){const u=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),_=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-o/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-m[0]*w,_.y/this.worldSize-m[1]*w,o/this.worldSize*this._centerAltitude-m[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],_=o[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(w=Math.min((u-m)/_,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,o,w),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,u=this._camera.forward(),{pitch:m,bearing:_}=this._camera.getPitchBearing(),w=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),C=Math.max((o[2]-w)/Math.cos(m),S),k=this._zoomFromMercatorZ(C);a.scaleAndAdd(o,o,u,C),this._pitch=a.clamp(m,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(_,-Math.PI,Math.PI),this._setZoom(a.clamp(k,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let u=0,m=a.GLOBE_ZOOM_THRESHOLD_MAX,_=0,w=1/0;for(;m-u>1e-6&&m>u;){const S=u+.5*(m-u),C=this.tileSize*Math.pow(2,S),k=this.getCameraToCenterDistance(this.projection,S,C),z=this.scaleZoom(k/(o*this.tileSize)),L=Math.abs(S-z);L<w&&(w=L,_=S),S<z?u=S:m=S}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,u){const m=Math.min(o.x,u.x),_=Math.max(o.x,u.x),w=Math.min(o.y,u.y),S=Math.max(o.y,u.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const C=[new a.Point(m,w),new a.Point(_,S),new a.Point(m,S),new a.Point(_,w)],k=this.renderWorldCopies?-3:0,z=this.renderWorldCopies?4:1;for(const L of C){const N=this.pointRayIntersection(L);if(N.t<0)return!0;const W=this.rayIntersectionCoordinate(N);if(W.x<k||W.y<0||W.x>z||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.Point(0,0),new a.Point(this.width,this.height))}zoomDeltaToMovement(o,u){const m=a.length(a.sub([],this._camera.position,o)),_=this._zoomFromMercatorZ(m)+u;return m-this._mercatorZfromZoom(_)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([u,m,_],w){const S=[u,m,_,1];a.transformMat4$1(S,S,w);const C=S[3]=Math.max(S[3],1e-6);return S[0]/=C,S[1]/=C,S[2]/=C,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.Point(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,o))}}getCameraToCenterDistance(o,u=this.zoom,m=this.worldSize){const _=gu(o,u,this.width,this.height,1024),w=o.pixelSpaceConversion(this.center.lat,m,_);return .5/Math.tan(.5*this._fov)*this.height*w}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.multiply(o,o,this.globeMatrix),o}}function Ta(f,o){let u=!1,m=null;const _=()=>{m=null,u&&(f(),m=setTimeout(_,o),u=!1)};return()=>(u=!0,m||_(),m)}class gd{constructor(o){this._hashName=o&&encodeURIComponent(o),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ta(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,a.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const u=Gl(o);if(this._hashName){const m=this._hashName;let _=!1;const w=a.window.location.hash.slice(1).split("&").map(S=>{const C=S.split("=")[0];return C===m?(_=!0,`${C}=${u}`):S}).filter(S=>S);return _||w.push(`${m}=${u}`),`#${w.join("&")}`}return`#${u}`}_getCurrentHash(){const o=a.window.location.hash.replace("#","");if(this._hashName){let u;return o.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(u=m)}),(u&&u[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(m=>isNaN(m))){const m=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(u[3]||0):o.getBearing();return o.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:m,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,o)}}function Gl(f,o){const u=f.getCenter(),m=Math.round(100*f.getZoom())/100,_=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,_),S=Math.round(u.lng*w)/w,C=Math.round(u.lat*w)/w,k=f.getBearing(),z=f.getPitch();let L=o?`/${S}/${C}/${m}`:`${m}/${C}/${S}`;return(k||z)&&(L+="/"+Math.round(10*k)/10),z&&(L+=`/${Math.round(z)}`),L}const Wl={linearity:.3,easing:a.bezier(0,0,.3,1)},_u=a.extend({deceleration:2500,maxSpeed:1400},Wl),vu=a.extend({deceleration:20,maxSpeed:1400},Wl),pt=a.extend({deceleration:1e3,maxSpeed:360},Wl),Bi=a.extend({deceleration:1e3,maxSpeed:90},Wl);class tm{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,u=a.exported.now();for(;o.length>0&&u-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)u.zoom+=w.zoomDelta||0,u.bearing+=w.bearingDelta||0,u.pitch+=w.pitchDelta||0,w.panDelta&&u.pan._add(w.panDelta),w.around&&(u.around=w.around),w.pinchAround&&(u.pinchAround=w.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(u.pan.mag()){const w=ql(u.pan.mag(),m,a.extend({},_u,o||{}));_.offset=u.pan.mult(w.amount/u.pan.mag()),_.center=this._map.transform.center,Zl(_,w)}if(u.zoom){const w=ql(u.zoom,m,vu);_.zoom=this._map.transform.zoom+w.amount,Zl(_,w)}if(u.bearing){const w=ql(u.bearing,m,pt);_.bearing=this._map.transform.bearing+a.clamp(w.amount,-179,179),Zl(_,w)}if(u.pitch){const w=ql(u.pitch,m,Bi);_.pitch=this._map.transform.pitch+w.amount,Zl(_,w)}if(_.zoom||_.bearing){const w=u.pinchAround===void 0?u.around:u.pinchAround;_.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function Zl(f,o){(!f.duration||f.duration<o.duration)&&(f.duration=o.duration,f.easing=o.easing)}function ql(f,o,u){const{maxSpeed:m,linearity:_,deceleration:w}=u,S=a.clamp(f*_/(o/1e3),-m,m),C=Math.abs(S)/(w*_);return{easing:u.easing,duration:1e3*C,amount:S*(C/2)}}class vr extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,m,_={}){const w=Ue(u.getCanvasContainer(),m),S=u.unproject(w);super(o,a.extend({point:w,lngLat:S,originalEvent:m},_)),this._defaultPrevented=!1,this.target=u}}class Hl extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,m){const _=o==="touchend"?m.changedTouches:m.touches,w=Ge(u.getCanvasContainer(),_),S=w.map(k=>u.unproject(k)),C=w.reduce((k,z,L,N)=>k.add(z.div(N.length)),new a.Point(0,0));super(o,{points:w,point:C,lngLats:S,lngLat:u.unproject(C),originalEvent:m}),this._defaultPrevented=!1}}class xu extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,m){super(o,{originalEvent:m}),this._defaultPrevented=!1}}class yd{constructor(o,u){this._map=o,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new xu(o.type,this._map,o))}mousedown(o,u){return this._mousedownPos=u,this._firePreventable(new vr(o.type,this._map,o))}mouseup(o){this._map.fire(new vr(o.type,this._map,o))}preclick(o){const u=a.extend({},o);u.type="preclick",this._map.fire(new vr(u.type,this._map,u))}click(o,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(o),this._map.fire(new vr(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new vr(o.type,this._map,o))}mouseover(o){this._map.fire(new vr(o.type,this._map,o))}mouseout(o){this._map.fire(new vr(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Hl(o.type,this._map,o))}touchmove(o){this._map.fire(new Hl(o.type,this._map,o))}touchend(o){this._map.fire(new Hl(o.type,this._map,o))}touchcancel(o){this._map.fire(new Hl(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wu{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new vr(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new vr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new vr(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class nm{constructor(o,u){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,u){this.isEnabled()&&o.shiftKey&&o.button===0&&(H(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(o,u){if(!this._active)return;const m=u,_=this._startPos,w=this._lastPos;if(!_||!w||w.equals(m)||!this._box&&m.dist(_)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=j("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const S=Math.min(_.x,m.x),C=Math.max(_.x,m.x),k=Math.min(_.y,m.y),z=Math.max(_.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${k}px)`,this._box.style.width=C-S+"px",this._box.style.height=z-k+"px")})}mouseupWindow(o,u){if(!this._active)return;const m=this._startPos,_=u;if(m&&o.button===0){if(this.reset(),Ce(),m.x!==_.x||m.y!==_.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:w=>w.fitScreenCoordinates(m,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Y(),delete this._startPos,delete this._lastPos}_fireEvent(o,u){return this._map.fire(new a.Event(o,{originalEvent:u}))}}function bu(f,o){const u={};for(let m=0;m<f.length;m++)u[f[m].identifier]=o[m];return u}class Ea{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,u,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),m.length===this.numTouches&&(this.centroid=function(_){const w=new a.Point(0,0);for(const S of _)w._add(S);return w.div(_.length)}(u),this.touches=bu(m,u)))}touchmove(o,u,m){if(this.aborted||!this.centroid)return;const _=bu(m,u);for(const w in this.touches){const S=_[w];(!S||S.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(o,u,m){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class _d{constructor(o){this.singleTap=new Ea(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,u,m){this.singleTap.touchstart(o,u,m)}touchmove(o,u,m){this.singleTap.touchmove(o,u,m)}touchend(o,u,m){const _=this.singleTap.touchend(o,u,m);if(_){const w=o.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(_)<30;if(w&&S||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class M_{constructor(){this._zoomIn=new _d({numTouches:1,numTaps:2}),this._zoomOut=new _d({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,u,m){this._zoomIn.touchstart(o,u,m),this._zoomOut.touchstart(o,u,m)}touchmove(o,u,m){this._zoomIn.touchmove(o,u,m),this._zoomOut.touchmove(o,u,m)}touchend(o,u,m){const _=this._zoomIn.touchend(o,u,m),w=this._zoomOut.touchend(o,u,m);return _?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(_)},{originalEvent:o})}):w?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const rm={0:1,2:2};class Sa{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,u){return!1}_move(o,u){return{}}mousedown(o,u){if(this._lastPoint)return;const m=je(o);this._correctButton(o,m)&&(this._lastPoint=u,this._eventButton=m)}mousemoveWindow(o,u){const m=this._lastPoint;if(m){if(o.preventDefault(),this._eventButton!=null&&function(_,w){const S=rm[w];return _.buttons===void 0||(_.buttons&S)!==S}(o,this._eventButton))this.reset();else if(this._moved||!(u.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(m,u)}}mouseupWindow(o){this._lastPoint&&je(o)===this._eventButton&&(this._moved&&Ce(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vd extends Sa{mousedown(o,u){super.mousedown(o,u),this._lastPoint&&(this._active=!0)}_correctButton(o,u){return u===0&&!o.ctrlKey}_move(o,u){return{around:u,panDelta:u.sub(o)}}}class xd extends Sa{_correctButton(o,u){return u===0&&o.ctrlKey||u===2}_move(o,u){const m=.8*(u.x-o.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(o){o.preventDefault()}}class wd extends Sa{_correctButton(o,u){return u===0&&o.ctrlKey||u===2}_move(o,u){const m=-.5*(u.y-o.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(o){o.preventDefault()}}class Tu{constructor(o,u){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)}touchstart(o,u,m){return this._calculateTransform(o,u,m)}touchmove(o,u,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,u,m)}}touchend(o,u,m){this._calculateTransform(o,u,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,u,m){m.length>0&&(this._active=!0);const _=bu(m,u),w=new a.Point(0,0),S=new a.Point(0,0);let C=0;for(const z in _){const L=_[z],N=this._touches[z];N&&(w._add(L),S._add(L.sub(N)),C++,_[z]=L)}if(this._touches=_,C<this._minTouches||!S.mag())return;const k=S.div(C);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(C),panDelta:k}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=j("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Xl{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,u,m){return{}}touchstart(o,u,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([u[0],u[1]]))}touchmove(o,u,m){const _=this._firstTwoTouches;if(!_)return;o.preventDefault();const[w,S]=_,C=Kl(m,u,w),k=Kl(m,u,S);if(!C||!k)return;const z=this._aroundCenter?null:C.add(k).div(2);return this._move([C,k],z,o)}touchend(o,u,m){if(!this._firstTwoTouches)return;const[_,w]=this._firstTwoTouches,S=Kl(m,u,_),C=Kl(m,u,w);S&&C||(this._active&&Ce(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Kl(f,o,u){for(let m=0;m<f.length;m++)if(f[m].identifier===u)return o[m]}function bd(f,o){return Math.log(f/o)/Math.LN2}class im extends Xl{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,u){const m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(bd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:bd(this._distance,m),pinchAround:u}}}function Td(f,o){return 180*f.angleWith(o)/Math.PI}class om extends Xl{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,u){const m=this._vector;if(this._vector=o[0].sub(o[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Td(this._vector,m),pinchAround:u}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const u=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const _=Td(o,m);return Math.abs(_)<u}}function es(f){return Math.abs(f.y)>Math.abs(f.x)}class sm extends Xl{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,es(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,u,m){const _=this._lastPoints;if(!_)return;const w=o[0].sub(_[0]),S=o[1].sub(_[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(w,S,m.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5})}gestureBeginsVertically(o,u,m){if(this._valid!==void 0)return this._valid;const _=o.mag()>=2,w=u.mag()>=2;if(!_&&!w)return;if(!_||!w)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const S=o.y>0==u.y>0;return es(o)&&es(u)&&S}}const am={panStep:100,bearingStep:15,pitchStep:10};class k_{constructor(){const o=am;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let u=0,m=0,_=0,w=0,S=0;switch(o.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:o.shiftKey?m=-1:(o.preventDefault(),w=-1);break;case 39:o.shiftKey?m=1:(o.preventDefault(),w=1);break;case 38:o.shiftKey?_=1:(o.preventDefault(),S=-1);break;case 40:o.shiftKey?_=-1:(o.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(m=0,_=0),{cameraAnimation:C=>{const k=C.getZoom();C.easeTo({duration:300,easeId:"keyboardHandler",easing:lm,zoom:u?Math.round(k)+u*(o.shiftKey?2:1):k,bearing:C.getBearing()+m*this._bearingStep,pitch:C.getPitch()+_*this._pitchStep,offset:[-w*this._panStep,-S*this._panStep],center:C.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function lm(f){return f*(2-f)}const Ed=4.000244140625;class cm{constructor(o,u){this._map=o,this._el=o.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=o.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const m=a.exported.now(),_=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,u!==0&&u%Ed==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(_*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),o.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=o,this._delta-=u,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=Ue(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>Ed?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&z!==0&&(z=1/z);const L=u(),N=Math.pow(2,L),W=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):N;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(W*z))),this._type==="wheel"&&(this._startZoom=L,this._easing=this._smoothOutEasing(200)),this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:u(),_=this._startZoom,w=this._easing;let S,C=!1;if(this._type==="wheel"&&_&&w){const k=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),z=w(k);S=a.number(_,m,z),k<1?this._frameId||(this._frameId=!0):C=!0}else S=m,C=!0;return this._active=!0,C&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!C,zoomDelta:S-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let u=a.ease;if(this._prevEase){const m=this._prevEase,_=(a.exported.now()-m.start)/m.duration,w=m.easing(_+.01)-m.easing(_),S=.27/Math.sqrt(w*w+1e-4)*.01,C=Math.sqrt(.0729-S*S);u=a.bezier(S,C,.25,1)}return this._prevEase={start:a.exported.now(),duration:o,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=j("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class um{constructor(o,u){this._clickZoom=o,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class zr{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,u){return o.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(o.shiftKey?-1:1),around:m.unproject(u)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class I_{constructor(){this._tap=new _d({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,u,m){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=u[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(o,u,m))}touchmove(o,u,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const _=u[0],w=_.y-this._swipePoint.y;return this._swipePoint=_,o.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(o,u,m)}touchend(o,u,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(o,u,m)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hm{constructor(o,u,m){this._el=o,this._mousePan=u,this._touchPan=m}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class A_{constructor(o,u,m){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=u,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class D_{constructor(o,u,m,_){this._el=o,this._touchZoom=u,this._touchRotate=m,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ei=f=>f.zoom||f.drag||f.pitch||f.rotate;class dm extends a.Event{}class L_{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,u){const m=a.sub([],u,o);this.radius=a.length(m[2]<0?a.div([],m,this.constants):[m[0],m[1],0])}projectRay(o){a.div(o,o,this.constants),a.normalize(o,o),a.mul$1(o,o,this.constants);const u=a.scale$2([],o,this.radius);if(u[2]>0){const m=a.scale$2([],[0,0,1],a.dot(u,[0,0,1])),_=a.scale$2([],a.normalize([],[u[0],u[1],0]),this.radius),w=a.add([],u,a.scale$2([],a.sub([],a.add([],_,m),u),2));u[0]=w[0],u[1]=w[1]}return u}}function ji(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class ro{constructor(o,u){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new tm(o),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new L_,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),a.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[_,w,S]of this._listeners)_.addEventListener(w,_===a.window.document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[o,u,m]of this._listeners)o.removeEventListener(u,o===a.window.document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(o){const u=this._map,m=u.getCanvasContainer();this._add("mapEvent",new yd(u,o));const _=u.boxZoom=new nm(u,o);this._add("boxZoom",_);const w=new M_,S=new zr;u.doubleClickZoom=new um(S,w),this._add("tapZoom",w),this._add("clickZoom",S);const C=new I_;this._add("tapDragZoom",C);const k=u.touchPitch=new sm(u);this._add("touchPitch",k);const z=new xd(o),L=new wd(o);u.dragRotate=new A_(o,z,L),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);const N=new vd(o),W=new Tu(u,o);u.dragPan=new hm(m,N,W),this._add("mousePan",N),this._add("touchPan",W,["touchZoom","touchRotate"]);const J=new om,ne=new im;u.touchZoomRotate=new D_(m,ne,J,C),this._add("touchRotate",J,["touchPan","touchZoom"]),this._add("touchZoom",ne,["touchPan","touchRotate"]),this._add("blockableMapEvent",new wu(u));const te=u.scrollZoom=new cm(u,this);this._add("scrollZoom",te,["mousePan"]);const re=u.keyboard=new k_;this._add("keyboard",re);for(const U of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[U]&&u[U].enable(o[U])}_add(o,u,m){this._handlers.push({handlerName:o,handler:u,allowed:m}),this._handlersById[o]=u}stop(o){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ei(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,u,m){for(const _ in o)if(_!==m&&(!u||u.indexOf(_)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const u=[];for(const m of o)this._el.contains(m.target)&&u.push(m);return u}handleEvent(o,u){this._updatingCamera=!0;const m=o.type==="renderFrame",_=m?void 0:o,w={needsRenderFrame:!1},S={},C={},k=o.touches?this._getMapTouches(o.touches):void 0,z=k?Ge(this._el,k):m?void 0:Ue(this._el,o);for(const{handlerName:W,handler:J,allowed:ne}of this._handlers){if(!J.isEnabled())continue;let te;this._blockedByActive(C,ne,W)?J.reset():J[u||o.type]&&(te=J[u||o.type](o,z,k),this.mergeHandlerResult(w,S,te,W,_),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||J.isActive())&&(C[W]=J)}const L={};for(const W in this._previousActiveHandlers)C[W]||(L[W]=_);this._previousActiveHandlers=C,(Object.keys(L).length||ji(w))&&(this._changes.push([w,S,L]),this._triggerRenderFrame()),(Object.keys(C).length||ji(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=w;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))}mergeHandlerResult(o,u,m,_,w){if(!m)return;a.extend(o,m);const S={handlerName:_,originalEvent:m.originalEvent||w};m.zoomDelta!==void 0&&(u.zoom=S),m.panDelta!==void 0&&(u.drag=S),m.pitchDelta!==void 0&&(u.pitch=S),m.bearingDelta!==void 0&&(u.rotate=S)}_applyChanges(){const o={},u={},m={};for(const[_,w,S]of this._changes)_.panDelta&&(o.panDelta=(o.panDelta||new a.Point(0,0))._add(_.panDelta)),_.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(o.around=_.around),_.aroundCoord!==void 0&&(o.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(o.pinchAround=_.pinchAround),_.noInertia&&(o.noInertia=_.noInertia),a.extend(u,w),a.extend(m,S);this._updateMapTransform(o,u,m),this._changes=[]}_updateMapTransform(o,u,m){const _=this._map,w=_.transform,S=K=>[K.x,K.y,K.z];if((K=>{const ae=this._eventsInProgress.drag;return ae&&!this._handlersById[ae.handlerName].isActive()})()&&!ji(o)){const K=w.zoom;w.cameraElevationReference="sea",w.recenterOnTerrain(),w.cameraElevationReference="ground",K!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&_._stop(!0),!ji(o))return void this._fireEvents(u,m,!0);let{panDelta:C,zoomDelta:k,bearingDelta:z,pitchDelta:L,around:N,aroundCoord:W,pinchAround:J}=o;w._isCameraConstrained&&(k>0&&(k=0),w._isCameraConstrained=!1),J!==void 0&&(N=J),(k||(K=>u[K]&&!this._eventsInProgress[K])("drag"))&&N&&(this._dragOrigin=S(w.pointCoordinate3D(N)),this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",_._stop(!0),N=N||_.transform.centerPoint,z&&(w.bearing+=z),L&&(w.pitch+=L),w._updateCameraState();const ne=[0,0,0];if(C)if(w.projection.name==="mercator"){const K=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(N).dir),ae=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(N.sub(C)).dir);ne[0]=ae[0]-K[0],ne[1]=ae[1]-K[1]}else{const K=w.pointCoordinate(N);if(w.projection.name==="globe"){C=C.rotate(-w.angle);const ae=w._pixelsPerMercatorPixel/w.worldSize;ne[0]=-C.x*a.mercatorScale(a.latFromMercatorY(K.y))*ae,ne[1]=-C.y*a.mercatorScale(w.center.lat)*ae}else{const ae=w.pointCoordinate(N.sub(C));K&&ae&&(ne[0]=ae.x-K.x,ne[1]=ae.y-K.y)}}const te=w.zoom,re=[0,0,0];if(k){const K=S(W||w.pointCoordinate3D(N)),ae={dir:a.normalize([],a.sub([],K,w._camera.position))};if(ae.dir[2]<0){const le=w.zoomDeltaToMovement(K,k);a.scale$2(re,ae.dir,le)}}const U=a.add(ne,ne,re);w._translateCameraConstrained(U),k&&Math.abs(w.zoom-te)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(u,m,!0)}_fireEvents(o,u,m){const _=Ei(this._eventsInProgress),w=Ei(o),S={};for(const L in o){const{originalEvent:N}=o[L];this._eventsInProgress[L]||(S[`${L}start`]=N),this._eventsInProgress[L]=o[L]}!_&&w&&this._fireEvent("movestart",w.originalEvent);for(const L in S)this._fireEvent(L,S[L]);w&&this._fireEvent("move",w.originalEvent);for(const L in o){const{originalEvent:N}=o[L];this._fireEvent(L,N)}const C={};let k;for(const L in this._eventsInProgress){const{handlerName:N,originalEvent:W}=this._eventsInProgress[L];this._handlersById[N].isActive()||(delete this._eventsInProgress[L],k=u[N]||W,C[`${L}end`]=k)}for(const L in C)this._fireEvent(L,C[L]);const z=Ei(this._eventsInProgress);if(m&&(_||w)&&!z){this._updatingCamera=!0;const L=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;L?(N(L.bearing||this._map.getBearing())&&(L.bearing=0),this._map.easeTo(L,{originalEvent:k})):(this._map.fire(new a.Event("moveend",{originalEvent:k})),N(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,u){this._map.fire(new a.Event(o,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new dm("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Is="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Eu extends a.Evented{constructor(o,u){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,u){return this.jumpTo({center:o},u)}panBy(o,u,m){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},u),m)}panTo(o,u,m){return this.easeTo(a.extend({center:o},u),m)}getZoom(){return this.transform.zoom}setZoom(o,u){return this.jumpTo({zoom:o},u),this}zoomTo(o,u,m){return this.easeTo(a.extend({zoom:o},u),m)}zoomIn(o,u){return this.zoomTo(this.getZoom()+1,o,u),this}zoomOut(o,u){return this.zoomTo(this.getZoom()-1,o,u),this}getBearing(){return this.transform.bearing}setBearing(o,u){return this.jumpTo({bearing:o},u),this}getPadding(){return this.transform.padding}setPadding(o,u){return this.jumpTo({padding:o},u),this}rotateTo(o,u,m){return this.easeTo(a.extend({bearing:o},u),m)}resetNorth(o,u){return this.rotateTo(0,a.extend({duration:1e3},o),u),this}resetNorthPitch(o,u){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),u),this}snapToNorth(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this}getPitch(){return this.transform.pitch}setPitch(o,u){return this.jumpTo({pitch:o},u),this}cameraForBounds(o,u){o=a.LngLatBounds.convert(o);const m=u&&u.bearing||0,_=u&&u.pitch||0,w=o.getNorthWest(),S=o.getSouthEast();return this._cameraForBounds(this.transform,w,S,m,_,u)}_extendCameraOptions(o){const u={top:0,bottom:0,right:0,left:0};if(typeof(o=a.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const m=o.padding;o.padding={top:m,bottom:m,right:m,left:m}}return o.padding=a.extend(u,o.padding),o}_minimumAABBFrustumDistance(o,u){const m=u.max[0]-u.min[0],_=u.max[1]-u.min[1];return m/_>o.aspect?m/(2*Math.tan(.5*o.fovX)*o.aspect):_/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,u,m,_,w,S){const C=o.clone(),k=this._extendCameraOptions(S);C.bearing=_,C.pitch=w;const z=a.LngLat.convert(u),L=a.LngLat.convert(m),N=.5*(z.lat+L.lat),W=.5*(z.lng+L.lng),J=a.latLngToECEF(N,W),ne=a.normalize([],J),te=a.normalize([],a.cross([],ne,[0,1,0])),re=a.cross([],te,ne),U=[te[0],te[1],te[2],0,re[0],re[1],re[2],0,ne[0],ne[1],ne[2],0,0,0,0,1],K=[J,a.latLngToECEF(z.lat,z.lng),a.latLngToECEF(L.lat,z.lng),a.latLngToECEF(L.lat,L.lng),a.latLngToECEF(z.lat,L.lng),a.latLngToECEF(N,z.lng),a.latLngToECEF(N,L.lng),a.latLngToECEF(z.lat,W),a.latLngToECEF(L.lat,W)];let ae=a.Aabb.fromPoints(K.map(qe=>[a.dot(te,qe),a.dot(re,qe),a.dot(ne,qe)]));const le=a.transformMat4([],ae.center,U);a.squaredLength(le)===0&&a.set(le,0,0,1),a.normalize(le,le),a.scale$2(le,le,a.GLOBE_RADIUS),C.center=a.ecefToLatLng(le);const ye=C.getWorldToCameraMatrix(),xe=a.invert(new Float64Array(16),ye);ae=a.Aabb.applyTransform(ae,a.multiply([],ye,U)),a.transformMat4(le,le,ye);const _e=.5*(ae.max[2]-ae.min[2]),Se=this._minimumAABBFrustumDistance(C,ae),Ee=a.scale$2([],[0,0,1],_e),De=a.add(Ee,le,Ee),Ye=Se+(C.pitch===0?0:a.distance(le,De)),ke=C.globeCenterInViewSpace,$e=a.sub([],le,[ke[0],ke[1],ke[2]]);a.normalize($e,$e),a.scale$2($e,$e,Ye);const ze=a.add([],le,$e);a.transformMat4(ze,ze,xe);const Ke=a.earthRadius/a.GLOBE_RADIUS,Ae=a.length(ze),Ve=a.mercatorZfromAltitude(Math.max(Ae*Ke-a.earthRadius,Number.EPSILON),0),Qe=Math.min(C.zoomFromMercatorZAdjusted(Ve),k.maxZoom);return Qe>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(C.setProjection({name:"mercator"}),C.zoom=Qe,this._cameraForBounds(C,u,m,_,w,S)):{center:C.center,zoom:Qe,bearing:_,pitch:w}}queryTerrainElevation(o,u){const m=this.transform.elevation;return m?(u=a.extend({},{exaggerated:!0},u),m.getAtPoint(a.MercatorCoordinate.fromLngLat(o),null,u.exaggerated)):null}_cameraForBounds(o,u,m,_,w,S){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,u,m,_,w,S);const C=o.clone(),k=this._extendCameraOptions(S),z=C.padding;C.bearing=_,C.pitch=w;const L=a.LngLat.convert(u),N=a.LngLat.convert(m),W=new a.LngLat(L.lng,N.lat),J=new a.LngLat(N.lng,L.lat),ne=C.project(L),te=C.project(N),re=this.queryTerrainElevation(L),U=this.queryTerrainElevation(N),K=this.queryTerrainElevation(W),ae=this.queryTerrainElevation(J),le=[[ne.x,ne.y,Math.min(re||0,U||0,K||0,ae||0)],[te.x,te.y,Math.max(re||0,U||0,K||0,ae||0)]];let ye=a.Aabb.fromPoints(le);const xe=C.getWorldToCameraMatrix(),_e=a.invert(new Float64Array(16),xe);ye=a.Aabb.applyTransform(ye,xe);const Se=a.sub([],ye.max,ye.min),Ee=z.left||0,De=z.right||0,Ye=z.bottom||0,ke=z.top||0,{left:$e,right:ze,top:Ke,bottom:Ae}=k.padding,Ve=.5*(Ee+De),Qe=.5*(ke+Ye),qe=Math.min(C.scaleZoom(C.scale*Math.min((C.width-(Ee+De+$e+ze))/Se[0],(C.height-(Ye+ke+Ae+Ke))/Se[1])),k.maxZoom),et=C.scale/C.zoomScale(qe);ye=new a.Aabb([ye.min[0]-($e+Ve)*et,ye.min[1]-(Ae+Qe)*et,ye.min[2]],[ye.max[0]+(ze+Ve)*et,ye.max[1]+(Ke+Qe)*et,ye.max[2]]);const Tt=.5*Se[2],At=this._minimumAABBFrustumDistance(C,ye),_t=[0,0,1,0];a.transformMat4$1(_t,_t,xe),a.normalize$2(_t,_t);const Pt=a.scale$2([],_t,At+Tt),Xt=a.add([],ye.center,Pt),Zt=(typeof k.offset.x=="number"&&typeof k.offset.y=="number"?new a.Point(k.offset.x,k.offset.y):a.Point.convert(k.offset)).rotate(-a.degToRad(_));ye.center[0]-=Zt.x*et,ye.center[1]+=Zt.y*et,a.transformMat4(ye.center,ye.center,_e),a.transformMat4(Xt,Xt,_e);const wt=[ye.center[0],ye.center[1],Xt[2]*C.pixelsPerMeter];a.scale$2(wt,wt,1/C.worldSize);const hn=a.lngFromMercatorX(wt[0]),fn=a.latFromMercatorY(wt[1]),pn=Math.min(C._zoomFromMercatorZ(wt[2]),k.maxZoom),mn=new a.LngLat(hn,fn);return C.mercatorFromTransition&&pn<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(C.setProjection({name:"globe"}),C.zoom=pn,this._cameraForBounds(C,u,m,_,w,S)):{center:mn,zoom:pn,bearing:_,pitch:w}}fitBounds(o,u,m){const _=this.cameraForBounds(o,u);return this._fitInternal(_,u,m)}fitScreenCoordinates(o,u,m,_,w){const S=a.Point.convert(o),C=a.Point.convert(u),k=new a.Point(Math.min(S.x,C.x),Math.min(S.y,C.y)),z=new a.Point(Math.max(S.x,C.x),Math.max(S.y,C.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(S,C))return this;const L=this.transform.pointLocation3D(k),N=this.transform.pointLocation3D(z),W=this.transform.pointLocation3D(new a.Point(k.x,z.y)),J=this.transform.pointLocation3D(new a.Point(z.x,k.y)),ne=[Math.min(L.lng,N.lng,W.lng,J.lng),Math.min(L.lat,N.lat,W.lat,J.lat)],te=[Math.max(L.lng,N.lng,W.lng,J.lng),Math.max(L.lat,N.lat,W.lat,J.lat)],re=_&&_.pitch?_.pitch:this.getPitch(),U=this._cameraForBounds(this.transform,ne,te,m,re,_);return this._fitInternal(U,_,w)}_fitInternal(o,u,m){return o?(delete(u=a.extend(o,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this}jumpTo(o,u){this.stop();const m=o.preloadOnly?this.transform.clone():this.transform;let _=!1,w=!1,S=!1;return"zoom"in o&&m.zoom!==+o.zoom&&(_=!0,m.zoom=+o.zoom),o.center!==void 0&&(m.center=a.LngLat.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(w=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(S=!0,m.pitch=+o.pitch),o.padding==null||m.isPaddingEqual(o.padding)||(m.padding=o.padding),o.preloadOnly?(this._preloadTiles(m),this):(this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),_&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),w&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),S&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Is),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,u){const m=this.transform;if(!m.projection.supportsFreeCamera)return a.warnOnce(Is),this;this.stop();const _=m.zoom,w=m.pitch,S=m.bearing;m.setFreeCameraOptions(o);const C=_!==m.zoom,k=w!==m.pitch,z=S!==m.bearing;return this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),C&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),z&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),k&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u)),this}easeTo(o,u){this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const m=this.transform,_=this.getZoom(),w=this.getBearing(),S=this.getPitch(),C=this.getPadding(),k="zoom"in o?+o.zoom:_,z="bearing"in o?this._normalizeBearing(o.bearing,w):w,L="pitch"in o?+o.pitch:S,N="padding"in o?o.padding:m.padding,W=a.Point.convert(o.offset);let J,ne,te;if(m.projection.name==="globe"){const Ee=a.MercatorCoordinate.fromLngLat(m.center),De=W.rotate(-m.angle);Ee.x+=De.x/m.worldSize,Ee.y+=De.y/m.worldSize;const Ye=Ee.toLngLat(),ke=a.LngLat.convert(o.center||Ye);this._normalizeCenter(ke),J=m.centerPoint.add(De),ne=new a.Point(Ee.x,Ee.y).mult(m.worldSize),te=new a.Point(a.mercatorXfromLng(ke.lng),a.mercatorYfromLat(ke.lat)).mult(m.worldSize).sub(ne)}else{J=m.centerPoint.add(W);const Ee=m.pointLocation(J),De=a.LngLat.convert(o.center||Ee);this._normalizeCenter(De),ne=m.project(Ee),te=m.project(De).sub(ne)}const re=m.zoomScale(k-_);let U,K;o.around&&(U=a.LngLat.convert(o.around),K=m.locationPoint(U));const ae=this._zooming||k!==_,le=this._rotating||w!==z,ye=this._pitching||L!==S,xe=!m.isPaddingEqual(N),_e=Ee=>De=>{if(ae&&(Ee.zoom=a.number(_,k,De)),le&&(Ee.bearing=a.number(w,z,De)),ye&&(Ee.pitch=a.number(S,L,De)),xe&&(Ee.interpolatePadding(C,N,De),J=Ee.centerPoint.add(W)),U)Ee.setLocationAtPoint(U,K);else{const Ye=Ee.zoomScale(Ee.zoom-_),ke=k>_?Math.min(2,re):Math.max(.5,re),$e=Math.pow(ke,1-De),ze=Ee.unproject(ne.add(te.mult(De*$e)).mult(Ye));Ee.setLocationAtPoint(Ee.renderWorldCopies?ze.wrap():ze,J)}return o.preloadOnly||this._fireMoveEvents(u),Ee};if(o.preloadOnly){const Ee=this._emulate(_e,o.duration,m);return this._preloadTiles(Ee),this}const Se={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ae,this._rotating=le,this._pitching=ye,this._padding=xe,this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,Se),this._ease(_e(m),Ee=>{m.recenterOnTerrain(),this._afterEase(u,Ee)},o),this}_prepareEase(o,u,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||m.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!m.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new a.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))}_afterEase(o,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,_=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new a.Event("zoomend",o)),_&&this.fire(new a.Event("rotateend",o)),w&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}flyTo(o,u){if(this._prefersReducedMotion(o)){const qe=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(qe,u)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);const m=this.transform,_=this.getZoom(),w=this.getBearing(),S=this.getPitch(),C=this.getPadding(),k="zoom"in o?a.clamp(+o.zoom,m.minZoom,m.maxZoom):_,z="bearing"in o?this._normalizeBearing(o.bearing,w):w,L="pitch"in o?+o.pitch:S,N="padding"in o?o.padding:m.padding,W=m.zoomScale(k-_),J=a.Point.convert(o.offset);let ne=m.centerPoint.add(J);const te=m.pointLocation(ne),re=a.LngLat.convert(o.center||te);this._normalizeCenter(re);const U=m.project(te),K=m.project(re).sub(U);let ae=o.curve;const le=Math.max(m.width,m.height),ye=le/W,xe=K.mag();if("minZoom"in o){const qe=a.clamp(Math.min(o.minZoom,_,k),m.minZoom,m.maxZoom),et=le/m.zoomScale(qe-_);ae=Math.sqrt(et/xe*2)}const _e=ae*ae;function Se(qe){const et=(ye*ye-le*le+(qe?-1:1)*_e*_e*xe*xe)/(2*(qe?ye:le)*_e*xe);return Math.log(Math.sqrt(et*et+1)-et)}function Ee(qe){return(Math.exp(qe)-Math.exp(-qe))/2}function De(qe){return(Math.exp(qe)+Math.exp(-qe))/2}const Ye=Se(0);let ke=function(qe){return De(Ye)/De(Ye+ae*qe)},$e=function(qe){return le*((De(Ye)*(Ee(et=Ye+ae*qe)/De(et))-Ee(Ye))/_e)/xe;var et},ze=(Se(1)-Ye)/ae;if(Math.abs(xe)<1e-6||!isFinite(ze)){if(Math.abs(le-ye)<1e-6)return this.easeTo(o,u);const qe=ye<le?-1:1;ze=Math.abs(Math.log(ye/le))/ae,$e=function(){return 0},ke=function(et){return Math.exp(qe*ae*et)}}o.duration="duration"in o?+o.duration:1e3*ze/("screenSpeed"in o?+o.screenSpeed/ae:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const Ke=w!==z,Ae=L!==S,Ve=!m.isPaddingEqual(N),Qe=qe=>et=>{const Tt=et*ze,At=1/ke(Tt);qe.zoom=et===1?k:_+qe.scaleZoom(At),Ke&&(qe.bearing=a.number(w,z,et)),Ae&&(qe.pitch=a.number(S,L,et)),Ve&&(qe.interpolatePadding(C,N,et),ne=qe.centerPoint.add(J));const _t=et===1?re:qe.unproject(U.add(K.mult($e(Tt))).mult(At));return qe.setLocationAtPoint(qe.renderWorldCopies?_t.wrap():_t,ne),qe._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(u),qe};if(o.preloadOnly){const qe=this._emulate(Qe,o.duration,m);return this._preloadTiles(qe),this}return this._zooming=!0,this._rotating=Ke,this._pitching=Ae,this._padding=Ve,this._prepareEase(u,!1),this._ease(Qe(m),()=>this._afterEase(u),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,u)}if(!o){const m=this.handlers;m&&m.stop(!1)}return this}_ease(o,u,m){m.animate===!1||m.duration===0?(o(1),u()):(this._easeStart=a.exported.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,u){o=a.wrap(o,-180,180);const m=Math.abs(o-u);return Math.abs(o-360-u)<m&&(o-=360),Math.abs(o+360-u)<m&&(o+=360),o}_normalizeCenter(o){const u=this.transform;if(!u.renderWorldCopies||u.maxBounds)return;const m=o.lng-u.center.lng;o.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&a.exported.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,u,m){const _=Math.ceil(15*u/1e3),w=[],S=o(m.clone());for(let C=0;C<=_;C++){const k=S(C/_);w.push(k.clone())}return w}}class gt{constructor(o={}){this.options=o,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const u=this.options&&this.options.compact;return this._map=o,this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=j("button","mapboxgl-ctrl-attrib-button",this._container),j("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=j("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,u){const m=this._map._getUIString(`AttributionControl.${u}`);o.setAttribute("aria-label",m),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",m)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(o){const m=u.reduce((_,w,S)=>(w.value&&(_+=`${w.key}=${w.value}${S<u.length-1?"&":""}`),_),"?");o.href=`${a.config.FEEDBACK_URL}/${m}#${Gl(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const u=this._map.style._sourceCaches;for(const _ in u){const w=u[_];if(w.used){const S=w.getSource();S.attribution&&o.indexOf(S.attribution)<0&&o.push(S.attribution)}}o.sort((_,w)=>_.length-w.length),o=o.filter((_,w)=>{for(let S=w+1;S<o.length;S++)if(o[S].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const m=o.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,o.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Sd{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=j("div","mapboxgl-ctrl");const u=j("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const u in o){const m=o[u].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const u=o[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class Cd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const u=++this._id;return this._queue.push({callback:o,id:u,cancelled:!1}),u}remove(o){const u=this._currentlyRunning,m=u?this._queue.concat(u):this._queue;for(const _ of m)if(_.id===o)return void(_.cancelled=!0)}run(o=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const m of u)if(!m.cancelled&&(m.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Ca(f,o,u){if(f=new a.LngLat(f.lng,f.lat),o){const m=new a.LngLat(f.lng-360,f.lat),_=new a.LngLat(f.lng+360,f.lat),w=360*Math.ceil(Math.abs(f.lng-u.center.lng)/360),S=u.locationPoint(f).distSqr(o),C=o.x<0||o.y<0||o.x>u.width||o.y>u.height;u.locationPoint(m).distSqr(o)<S&&(C||Math.abs(m.lng-u.center.lng)<w)?f=m:u.locationPoint(_).distSqr(o)<S&&(C||Math.abs(_.lng-u.center.lng)<w)&&(f=_)}for(;Math.abs(f.lng-u.center.lng)>180;){const m=u.locationPoint(f);if(m.x>=0&&m.y>=0&&m.x<=u.width&&m.y<=u.height)break;f.lng>u.center.lng?f.lng-=360:f.lng+=360}return f}const As={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class dt extends a.Evented{constructor(o,u){if(super(),(o instanceof a.window.HTMLElement||u)&&(o=a.extend({element:o},u)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=j("div");const _=41,w=27,S=Z("svg",{display:"block",height:_*this._scale+"px",width:w*this._scale+"px",viewBox:`0 0 ${w} ${_}`},this._element),C=Z("radialGradient",{id:"shadowGradient"},Z("defs",{},S));Z("stop",{offset:"10%","stop-opacity":.4},C),Z("stop",{offset:"100%","stop-opacity":.05},C),Z("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},S),Z("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},S),Z("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},S),Z("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},S),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",_=>{_.preventDefault()}),this._element.addEventListener("mousedown",_=>{_.preventDefault()});const m=this._element.classList;for(const _ in As)m.remove(`mapboxgl-marker-anchor-${_}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const u=o.code,m=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(o){const u=o.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,u=this._pos;if(!o||!u)return!1;const m=o.unproject(u),_=o.getFreeCameraOptions();if(!_.position)return!1;const w=_.position.toLngLat();return w.distanceTo(m)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const u=this._pos;if(!u||u.x<0||u.x>o.transform.width||u.y<0||u.y>o.transform.height)return void this._clearFadeTimer();const m=o.unproject(u);let _;o._showingGlobe()&&a.isLngLatBehindGlobe(o.transform,this._lngLat)?_=0:(_=1-o._queryFogOpacity(m),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${As[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const o=this._pos,u=this._map,m=this.getPitchAlignment();if(!u||!o||m!=="map")return"";if(!u._showingGlobe()){const k=u.getPitch();return k?`rotateX(${k}deg)`:""}const _=a.radToDeg(a.globeTiltAtLngLat(u.transform,this._lngLat)),w=o.sub(a.globeCenterToScreenPoint(u.transform)),S=Math.abs(w.x)+Math.abs(w.y);if(S===0)return"";const C=_/S;return`rotateX(${-w.y*C}deg) rotateY(${w.x*C}deg)`}_calculateZTransform(){const o=this._pos,u=this._map;if(!u||!o)return"";let m=0;const _=this.getRotationAlignment();if(_==="map")if(u._showingGlobe()){const w=u.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),S=u.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(w);m=a.radToDeg(Math.atan2(S.y,S.x))-90}else m=-u.getBearing();else if(_==="horizon"){const w=a.smoothstep(4,6,u.getZoom()),S=a.globeCenterToScreenPoint(u.transform);S.y+=w*u.transform.height;const C=o.sub(S),k=a.radToDeg(Math.atan2(C.y,C.x));m=(k>90?k-270:k+90)*(1-w)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(o){a.window.cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Ca(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat),o===!0?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=a.Point.convert(o),this._update(),this}_onMove(o){const u=this._map;if(!u)return;const m=this._pointerdownPos,_=this._positionDelta;if(m&&_){if(!this._isDragging){const w=this._clickTolerance||u._clickTolerance;if(o.point.dist(m)<w)return;this._isDragging=!0}this._pos=o.point.sub(_),this._lngLat=u.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(o){const u=this._map,m=this._pos;u&&m&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(m),this._pointerdownPos=o.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const u=this._map;return u&&(o?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Pd={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},z_=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function fm(f=new a.Point(0,0),o="bottom"){if(typeof f=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(o){case"top":return new a.Point(0,f);case"top-left":return new a.Point(u,u);case"top-right":return new a.Point(-u,u);case"bottom":return new a.Point(0,-f);case"bottom-left":return new a.Point(u,-u);case"bottom-right":return new a.Point(-u,-u);case"left":return new a.Point(f,0);case"right":return new a.Point(-f,0)}return new a.Point(0,0)}return f instanceof a.Point||Array.isArray(f)?a.Point.convert(f):a.Point.convert(f[o]||[0,0])}class Md{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const u=a.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,u,m){this._start=this.getValue(u),this._end=o,this._startTime=u,this._endTime=u+m}}const pm={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},mm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},R_={showCompass:!0,showZoom:!0,visualizePitch:!1};class O_{constructor(o,u,m=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new xd({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,m&&(this.mousePitch=new wd({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(o,u){this.mouseRotate.mousedown(o,u),this.mousePitch&&this.mousePitch.mousedown(o,u),H()}move(o,u){const m=this.map,_=this.mouseRotate.mousemoveWindow(o,u),w=_&&_.bearingDelta;if(w&&m.setBearing(m.getBearing()+w),this.mousePitch){const S=this.mousePitch.mousemoveWindow(o,u),C=S&&S.pitchDelta;C&&m.setPitch(m.getPitch()+C)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Y(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(a.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),Ue(this.element,o)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,Ue(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ge(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=Ge(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const kd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Id={maxWidth:100,unit:"metric"},Ad={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Pa={version:a.version,supported:A,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Eu{constructor(f){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),(f=a.extend({},mm,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(f.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ba(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._useWebGL2=f.useWebGL2,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._optimizeForTerrain=f.optimizeForTerrain,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new Cd,this._domRenderTaskQueue=new Cd,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},pm,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Md(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,typeof f.container=="string"){if(this._container=a.window.document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new ro(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this._hash=f.hash&&new gd(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,a.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),f.attributionControl&&this.addControl(new gt({customAttribution:f.customAttribution})),this._logoControl=new Sd,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new a.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new a.Event(`${o.dataType}dataloading`,o))})}_getMapId(){return this._mapId}addControl(f,o){if(o===void 0&&(o=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=f.onAdd(this);this._controls.push(f);const m=this._controlPositions[o];return o.indexOf("bottom")!==-1?m.insertBefore(u,m.firstChild):m.appendChild(u),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(f);return o>-1&&this._controls.splice(o,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new a.Event("movestart",f)).fire(new a.Event("move",f)),this.fire(new a.Event("resize",f)),o&&this.fire(new a.Event("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(a.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?a.window.navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(o=>o==="auto"?a.window.navigator.language:o):f}setLanguage(f){const o=this._parseLanguage(f);if(!this.style||o===this._language)return this;this._language=o,this.style._reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,o=f.projection.name;let u;o==="globe"&&f.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(f.setMercatorFromTransition(),u=!0):o==="mercator"&&f.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(f.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,o){return this._updateProjection(f||o||{name:"mercator"})}_updateProjection(f){let o;if(o=f.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),o){this.painter.clearBackgroundTiles();for(const u in this.style._sourceCaches)this.style._sourceCaches[u].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(f){return this.transform.locationPoint3D(a.LngLat.convert(f))}unproject(f){return this.transform.pointLocation3D(a.Point.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,o,u){if(f==="mouseenter"||f==="mouseover"){let m=!1;const _=S=>{const C=o.filter(z=>this.getLayer(z)),k=C.length?this.queryRenderedFeatures(S.point,{layers:C}):[];k.length?m||(m=!0,u.call(this,new vr(f,this,S.originalEvent,{features:k}))):m=!1},w=()=>{m=!1};return{layers:new Set(o),listener:u,delegates:{mousemove:_,mouseout:w}}}if(f==="mouseleave"||f==="mouseout"){let m=!1;const _=S=>{const C=o.filter(k=>this.getLayer(k));(C.length?this.queryRenderedFeatures(S.point,{layers:C}):[]).length?m=!0:m&&(m=!1,u.call(this,new vr(f,this,S.originalEvent)))},w=S=>{m&&(m=!1,u.call(this,new vr(f,this,S.originalEvent)))};return{layers:new Set(o),listener:u,delegates:{mousemove:_,mouseout:w}}}{const m=_=>{const w=o.filter(C=>this.getLayer(C)),S=w.length?this.queryRenderedFeatures(_.point,{layers:w}):[];S.length&&(_.features=S,u.call(this,_),delete _.features)};return{layers:new Set(o),listener:u,delegates:{[f]:m}}}}on(f,o,u){if(u===void 0)return super.on(f,o);Array.isArray(o)||(o=[o]);const m=this._createDelegatedListener(f,o,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(m);for(const _ in m.delegates)this.on(_,m.delegates[_]);return this}once(f,o,u){if(u===void 0)return super.once(f,o);Array.isArray(o)||(o=[o]);const m=this._createDelegatedListener(f,o,u);for(const _ in m.delegates)this.once(_,m.delegates[_]);return this}off(f,o,u){if(u===void 0)return super.off(f,o);o=new Set(Array.isArray(o)?o:[o]);const m=(w,S)=>{if(w.size!==S.size)return!1;for(const C of w)if(!S.has(C))return!1;return!0},_=this._delegatedListeners?this._delegatedListeners[f]:void 0;return _&&(w=>{for(let S=0;S<w.length;S++){const C=w[S];if(C.listener===u&&m(C.layers,o)){for(const k in C.delegates)this.off(k,C.delegates[k]);return w.splice(S,1),this}}})(_),this}queryRenderedFeatures(f,o){return this.style?(o!==void 0||f===void 0||f instanceof a.Point||Array.isArray(f)||(o=f,f=void 0),this.style.queryRenderedFeatures(f=f||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(f,o){return this.style.querySourceFeatures(f,o)}isPointOnSurface(f){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&a.warnOnce(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.Point.convert(f))}setStyle(f,o){return(o=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&f?(this._diffStyle(f,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(f,o))}_getUIString(f){const o=this._locale[f];if(o==null)throw new Error(`Missing UI string '${f}'`);return o}_updateStyle(f,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f&&(this.style=new to(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f):this.style.loadJSON(f)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new to(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,o){if(typeof f=="string"){const u=this._requestManager.normalizeStyleURL(f),m=this._requestManager.transformRequest(u,a.ResourceType.Style);a.getJSON(m,(_,w)=>{_?this.fire(new a.ErrorEvent(_)):w&&this._updateDiff(w,o)})}else typeof f=="object"&&this._updateDiff(f,o)}_updateDiff(f,o){try{this.style.setState(f)&&this._update(!0)}catch(u){a.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(f,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(f,o){return this._lazyInitEmptyStyle(),this.style.addSource(f,o),this._update(!0)}isSourceLoaded(f){return!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){const f=this.style&&this.style._sourceCaches;for(const o in f){const u=f[o]._tiles;for(const m in u){const _=u[m];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(f,o,u){this._lazyInitEmptyStyle(),this.style.addSourceType(f,o,u)}removeSource(f){return this.style.removeSource(f),this._updateTerrain(),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,o,{pixelRatio:u=1,sdf:m=!1,stretchX:_,stretchY:w,content:S}={}){if(this._lazyInitEmptyStyle(),o instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&o instanceof a.window.ImageBitmap){const{width:C,height:k,data:z}=a.exported.getImageData(o);this.style.addImage(f,{data:new a.RGBAImage({width:C,height:k},z),pixelRatio:u,stretchX:_,stretchY:w,content:S,sdf:m,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:C,height:k}=o,z=o;this.style.addImage(f,{data:new a.RGBAImage({width:C,height:k},new Uint8Array(z.data)),pixelRatio:u,stretchX:_,stretchY:w,content:S,sdf:m,version:0,userImage:z}),z.onAdd&&z.onAdd(this,f)}}updateImage(f,o){const u=this.style.getImage(f);if(!u)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=o instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&o instanceof a.window.ImageBitmap?a.exported.getImageData(o):o,{width:_,height:w}=m;_!==void 0&&w!==void 0?_===u.data.width&&w===u.data.height?(u.data.replace(m.data,!(o instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&o instanceof a.window.ImageBitmap)),this.style.updateImage(f,u)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${_}, ${w})
                must be that same as the previous version of the image
                (${u.data.width}, ${u.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,o){a.getImage(this._requestManager.transformRequest(f,a.ResourceType.Image),(u,m)=>{o(u,m instanceof a.window.HTMLImageElement?a.exported.getImageData(m):m)})}listImages(){return this.style.listImages()}addLayer(f,o){return this._lazyInitEmptyStyle(),this.style.addLayer(f,o),this._update(!0)}moveLayer(f,o){return this.style.moveLayer(f,o),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,o,u){return this.style.setLayerZoomRange(f,o,u),this._update(!0)}setFilter(f,o,u={}){return this.style.setFilter(f,o,u),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,o,u,m={}){return this.style.setPaintProperty(f,o,u,m),this._update(!0)}getPaintProperty(f,o){return this.style.getPaintProperty(f,o)}setLayoutProperty(f,o,u,m={}){return this.style.setLayoutProperty(f,o,u,m),this._update(!0)}getLayoutProperty(f,o){return this.style.getLayoutProperty(f,o)}setLight(f,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(f),this.transform):0}setFeatureState(f,o){return this.style.setFeatureState(f,o),this._update()}removeFeatureState(f,o){return this.style.removeFeatureState(f,o),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let u,m,_,w=this._container;for(;w&&(!m||!_);){const S=a.window.getComputedStyle(w).transform;S&&S!=="none"&&(u=S.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(m=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(_=u[3])),w=w.parentElement}this._containerWidth=m?Math.abs(f/m):f,this._containerHeight=_?Math.abs(o/_):o}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=j("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=j("div","mapboxgl-canvas-container",f);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=j("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=j("div","mapboxgl-control-container",f),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{m[_]=j("div",`mapboxgl-ctrl-${_}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,o){const u=a.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(f),this._canvas.height=u*Math.ceil(o),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${o}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const o=this._markers.indexOf(f);o!==-1&&this._markers.splice(o,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const o=this._popups.indexOf(f);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const f=a.extend({},A.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._useWebGL2&&this._canvas.getContext("webgl2",f),u=o||this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);u?(this._useWebGL2&&!o&&a.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),a.storeAuthState(u,!0),this.painter=new xa(u,this.transform,!!o),this.on("data",m=>{m.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(u)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let o;const u=this.painter.context.extTimerQuery,m=a.exported.now();if(this.listens("gpu-timing-frame")&&(o=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const _=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const C=this.transform.zoom,k=this.transform.pitch,z=a.exported.now(),L=new a.EvaluationParameters(C,{now:z,fadeDuration:_,pitch:k,transition:this.style.getTransition()});this.style.update(L)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let w=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),w=this._updateAverageElevation(m),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):w=this._updateAverageElevation(m),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,_,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const C=a.exported.now()-m;u.endQueryEXT(u.TIME_ELAPSED_EXT,o),setTimeout(()=>{const k=u.getQueryObjectEXT(o,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(o),this.fire(new a.Event("gpu-timing-frame",{cpuTime:C,gpuTime:k})),a.window.performance.mark("frame-gpu",{startTime:m,detail:{gpuTime:k}})},50)}if(this.listens("gpu-timing-layer")){const C=this.painter.collectGpuTimers();setTimeout(()=>{const k=this.painter.queryGpuTimers(C);this.fire(new a.Event("gpu-timing-layer",{layerTimes:k}))},50)}if(this.listens("gpu-timing-deferred-render")){const C=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const k=this.painter.queryGpuTimeDeferredRender(C);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:k}))},50)}const S=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(S||this._repaint)this.triggerRepaint();else{const C=!this.isMoving()&&this.loaded();if(C&&(w=this._updateAverageElevation(m,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),C&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const k=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:k})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||S||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const o of this._markers)f&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!f||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(f,o=!1){const u=m=>(this.transform.averageElevation=m,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);if((o||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const m=this.transform.averageElevation;let _=this.transform.sampleAverageElevation(),w=!1;this.transform.elevation&&(w=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(_)?_=0:this._averageElevationLastSampledAt=f;const S=Math.abs(m-_);if(S>1){if(this._isInitialLoad||w)return this._averageElevation.jumpTo(_),u(_);this._averageElevation.easeTo(_,f,300)}else if(S>1e-4)return this._averageElevation.jumpTo(_),u(_)}return!!this._averageElevation.isEasing(f)&&u(this._averageElevation.getValue(f))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===a.AUTH_ERR_MSG||f.status===401)){const o=this.painter.context.gl;a.storeAuthState(o,!1),this._logoControl instanceof Sd&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const u=this.painter.context.gl,m=u.createFramebuffer();function _(w){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,w,0);const S=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,S),S}return u.bindFramebuffer(u.FRAMEBUFFER,m),this._canvasPixelComparison(_(f),o.canvasCopies.map(_),o.timeStamps)}_canvasPixelComparison(f,o,u){let m=u[1]-u[0];const _=f.length/4;for(let w=0;w<o.length;w++){const S=o[w];let C=0;for(let k=0;k<S.length;k+=4)S[k]===f[k]&&S[k+1]===f[k+1]&&S[k+2]===f[k+2]&&S[k+3]===f[k+3]&&(C+=1);m+=(u[w+2]-u[w+1])*(1-C/_)}return m}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=a.exported.frame(o=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(o)}))}_preloadTiles(f){const o=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(o,(u,m)=>u._preloadTiles(f,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){a.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,f&&this._update())}_setCacheLimits(f,o){a.setCacheLimits(f,o)}get version(){return a.version}},NavigationControl:class{constructor(f){this.options=a.extend({},R_,f),this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),j("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),j("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:o}):u.resetNorth({},{originalEvent:o}))}),this._compassIcon=j("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const o=f.getZoom(),u=o===f.getMaxZoom(),m=o===f.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new O_(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,o){const u=j("button",f,this._container);return u.type="button",u.addEventListener("click",o),u}_setButtonTitle(f,o){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${o}`);f.setAttribute("aria-label",u),f.firstElementChild&&f.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends a.Evented{constructor(f){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},kd,f),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ta(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const o=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,f(u)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(u=>o(u.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(f){const o=this._map.getMaxBounds(),u=f.coords;return!!o&&(u.longitude<o.getWest()||u.longitude>o.getEast()||u.latitude<o.getSouth()||u.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",f)),this._finish()}}_updateCamera(f){const o=new a.LngLat(f.coords.longitude,f.coords.latitude),u=f.coords.accuracy,m=this._map.getBearing(),_=a.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(u),_,{geolocateSource:!0})}_updateMarker(f){if(f){const o=new a.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,o=a.mercatorZfromAltitude(1,f._center.lat)*f.worldSize,u=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=j("button","mapboxgl-ctrl-geolocate",this._container),j("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=j("div","mapboxgl-user-location"),this._dotElement.appendChild(j("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(j("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new dt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=j("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new dt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:gt,ScaleControl:class{constructor(f){this.options=a.extend({},Id,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,o=this._map,u=o._containerHeight/2,m=o._containerWidth/2-f/2,_=o.unproject([m,u]),w=o.unproject([m+f,u]),S=_.distanceTo(w);if(this.options.unit==="imperial"){const C=3.2808*S;C>5280?this._setScale(f,C/5280,"mile"):this._setScale(f,C,"foot")}else this.options.unit==="nautical"?this._setScale(f,S/1852,"nautical-mile"):S>=1e3?this._setScale(f,S/1e3,"kilometer"):this._setScale(f,S,"meter")}_setScale(f,o,u){this._map._requestDomTask(()=>{const m=function(w){const S=Math.pow(10,`${Math.floor(w)}`.length-1);let C=w/S;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(k){const z=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*z)/z}(C),S*C}(o),_=m/o;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(m):`${m}&nbsp;${Ad[u]}`,this._container.style.width=f*_+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof a.window.HTMLElement?this._container=f.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=j("button","mapboxgl-ctrl-fullscreen",this._controlContainer);j("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(f){super(),this.options=a.extend(Object.create(Pd),f),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=a.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(a.window.document.createTextNode(f))}setHTML(f){const o=a.window.document.createDocumentFragment(),u=a.window.document.createElement("body");let m;for(u.innerHTML=f;m=u.firstChild,m;)o.appendChild(m);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=j("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(f),this.options.closeButton){const u=this._closeButton=j("button","mapboxgl-popup-close-button",o);u.type="button",u.setAttribute("aria-label","Close popup"),u.setAttribute("aria-hidden","true"),u.innerHTML="&#215;",u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let o;return this._classList.delete(f)?o=!1:(this._classList.add(f),o=!0),this._updateClassList(),o}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const o=this._map,u=this._container,m=this._pos;if(!o||!u||!m)return"bottom";const _=u.offsetWidth,w=u.offsetHeight,S=m.x<_/2,C=m.x>o.transform.width-_/2;if(m.y+f<w)return S?"top-left":C?"top-right":"top";if(m.y>o.transform.height-w){if(S)return"bottom-left";if(C)return"bottom-right"}return S?"left":C?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),f.className=o.join(" ")}_update(f){const o=this._map,u=this._content;if(!o||!this._lngLat&&!this._trackPointer||!u)return;let m=this._container;if(m||(m=this._container=j("div","mapboxgl-popup",o.getContainer()),this._tip=j("div","mapboxgl-popup-tip",m),m.appendChild(u)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ca(this._lngLat,this._pos,o.transform)),!this._trackPointer||f){const _=this._pos=this._trackPointer&&f?f:o.project(this._lngLat),w=fm(this.options.offset),S=this._anchor=this._getAnchor(w.y),C=fm(this.options.offset,S),k=_.add(C).round();o._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${As[S]} translate(${k.x}px,${k.y}px)`)})}if(!this._marker&&o._showingGlobe()){const _=a.isLngLatBehindGlobe(o.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(z_);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:dt,Style:to,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:Jp,Evented:a.Evented,config:a.config,prewarm:function(){ca().acquire(Ji)},clearPrewarmedResources:function(){const f=Ur;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(Ji),Ur=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(f){a.config.ACCESS_TOKEN=f},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(f){a.config.API_URL=f},get workerCount(){return yr.workerCount},set workerCount(f){yr.workerCount=f},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){a.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){a.clearTileCache(f)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return Pa});var E=g;return E})})(JA);var JV=JA.exports;const d1=f1(JV);d1.accessToken="your-mapbox-token";function QV({location:e}){const n=Q.useRef(null),s=Q.useRef(null);return Q.useEffect(()=>{if(!s.current)return s.current=new d1.Map({container:n.current,style:"mapbox://styles/mapbox/streets-v12",center:[e.lng,e.lat],zoom:13}),new d1.Marker().setLngLat([e.lng,e.lat]).addTo(s.current),()=>{var l;return(l=s.current)==null?void 0:l.remove()}},[e]),ee.jsx("div",{ref:n,className:"w-full h-full rounded-lg"})}function Ly(e){"@babel/helpers - typeof";return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ly(e)}function Bc(e){if(e===null||e===!0||e===!1)return NaN;var n=Number(e);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}function _i(e,n){if(n.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+n.length+" present")}function _s(e){_i(1,arguments);var n=Object.prototype.toString.call(e);return e instanceof Date||Ly(e)==="object"&&n==="[object Date]"?new Date(e.getTime()):typeof e=="number"||n==="[object Number]"?new Date(e):((typeof e=="string"||n==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function e$(e,n){_i(2,arguments);var s=_s(e).getTime(),l=Bc(n);return new Date(s+l)}var t$={};function f_(){return t$}function n$(e){var n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),e.getTime()-n.getTime()}function r$(e){return _i(1,arguments),e instanceof Date||Ly(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function i$(e){if(_i(1,arguments),!r$(e)&&typeof e!="number")return!1;var n=_s(e);return!isNaN(Number(n))}function o$(e,n){_i(2,arguments);var s=Bc(n);return e$(e,-s)}var s$=864e5;function a$(e){_i(1,arguments);var n=_s(e),s=n.getTime();n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0);var l=n.getTime(),d=s-l;return Math.floor(d/s$)+1}function zy(e){_i(1,arguments);var n=1,s=_s(e),l=s.getUTCDay(),d=(l<n?7:0)+l-n;return s.setUTCDate(s.getUTCDate()-d),s.setUTCHours(0,0,0,0),s}function e3(e){_i(1,arguments);var n=_s(e),s=n.getUTCFullYear(),l=new Date(0);l.setUTCFullYear(s+1,0,4),l.setUTCHours(0,0,0,0);var d=zy(l),g=new Date(0);g.setUTCFullYear(s,0,4),g.setUTCHours(0,0,0,0);var x=zy(g);return n.getTime()>=d.getTime()?s+1:n.getTime()>=x.getTime()?s:s-1}function l$(e){_i(1,arguments);var n=e3(e),s=new Date(0);s.setUTCFullYear(n,0,4),s.setUTCHours(0,0,0,0);var l=zy(s);return l}var c$=6048e5;function u$(e){_i(1,arguments);var n=_s(e),s=zy(n).getTime()-l$(n).getTime();return Math.round(s/c$)+1}function Ry(e,n){var s,l,d,g,x,E,a,P;_i(1,arguments);var A=f_(),R=Bc((s=(l=(d=(g=n==null?void 0:n.weekStartsOn)!==null&&g!==void 0?g:n==null||(x=n.locale)===null||x===void 0||(E=x.options)===null||E===void 0?void 0:E.weekStartsOn)!==null&&d!==void 0?d:A.weekStartsOn)!==null&&l!==void 0?l:(a=A.locale)===null||a===void 0||(P=a.options)===null||P===void 0?void 0:P.weekStartsOn)!==null&&s!==void 0?s:0);if(!(R>=0&&R<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var F=_s(e),j=F.getUTCDay(),Z=(j<R?7:0)+j-R;return F.setUTCDate(F.getUTCDate()-Z),F.setUTCHours(0,0,0,0),F}function t3(e,n){var s,l,d,g,x,E,a,P;_i(1,arguments);var A=_s(e),R=A.getUTCFullYear(),F=f_(),j=Bc((s=(l=(d=(g=n==null?void 0:n.firstWeekContainsDate)!==null&&g!==void 0?g:n==null||(x=n.locale)===null||x===void 0||(E=x.options)===null||E===void 0?void 0:E.firstWeekContainsDate)!==null&&d!==void 0?d:F.firstWeekContainsDate)!==null&&l!==void 0?l:(a=F.locale)===null||a===void 0||(P=a.options)===null||P===void 0?void 0:P.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(j>=1&&j<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var Z=new Date(0);Z.setUTCFullYear(R+1,0,j),Z.setUTCHours(0,0,0,0);var se=Ry(Z,n),ve=new Date(0);ve.setUTCFullYear(R,0,j),ve.setUTCHours(0,0,0,0);var X=Ry(ve,n);return A.getTime()>=se.getTime()?R+1:A.getTime()>=X.getTime()?R:R-1}function h$(e,n){var s,l,d,g,x,E,a,P;_i(1,arguments);var A=f_(),R=Bc((s=(l=(d=(g=n==null?void 0:n.firstWeekContainsDate)!==null&&g!==void 0?g:n==null||(x=n.locale)===null||x===void 0||(E=x.options)===null||E===void 0?void 0:E.firstWeekContainsDate)!==null&&d!==void 0?d:A.firstWeekContainsDate)!==null&&l!==void 0?l:(a=A.locale)===null||a===void 0||(P=a.options)===null||P===void 0?void 0:P.firstWeekContainsDate)!==null&&s!==void 0?s:1),F=t3(e,n),j=new Date(0);j.setUTCFullYear(F,0,R),j.setUTCHours(0,0,0,0);var Z=Ry(j,n);return Z}var d$=6048e5;function f$(e,n){_i(1,arguments);var s=_s(e),l=Ry(s,n).getTime()-h$(s,n).getTime();return Math.round(l/d$)+1}function kn(e,n){for(var s=e<0?"-":"",l=Math.abs(e).toString();l.length<n;)l="0"+l;return s+l}var Na={y:function(n,s){var l=n.getUTCFullYear(),d=l>0?l:1-l;return kn(s==="yy"?d%100:d,s.length)},M:function(n,s){var l=n.getUTCMonth();return s==="M"?String(l+1):kn(l+1,2)},d:function(n,s){return kn(n.getUTCDate(),s.length)},a:function(n,s){var l=n.getUTCHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return l.toUpperCase();case"aaa":return l;case"aaaaa":return l[0];case"aaaa":default:return l==="am"?"a.m.":"p.m."}},h:function(n,s){return kn(n.getUTCHours()%12||12,s.length)},H:function(n,s){return kn(n.getUTCHours(),s.length)},m:function(n,s){return kn(n.getUTCMinutes(),s.length)},s:function(n,s){return kn(n.getUTCSeconds(),s.length)},S:function(n,s){var l=s.length,d=n.getUTCMilliseconds(),g=Math.floor(d*Math.pow(10,l-3));return kn(g,s.length)}},Qu={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},p$={G:function(n,s,l){var d=n.getUTCFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return l.era(d,{width:"abbreviated"});case"GGGGG":return l.era(d,{width:"narrow"});case"GGGG":default:return l.era(d,{width:"wide"})}},y:function(n,s,l){if(s==="yo"){var d=n.getUTCFullYear(),g=d>0?d:1-d;return l.ordinalNumber(g,{unit:"year"})}return Na.y(n,s)},Y:function(n,s,l,d){var g=t3(n,d),x=g>0?g:1-g;if(s==="YY"){var E=x%100;return kn(E,2)}return s==="Yo"?l.ordinalNumber(x,{unit:"year"}):kn(x,s.length)},R:function(n,s){var l=e3(n);return kn(l,s.length)},u:function(n,s){var l=n.getUTCFullYear();return kn(l,s.length)},Q:function(n,s,l){var d=Math.ceil((n.getUTCMonth()+1)/3);switch(s){case"Q":return String(d);case"QQ":return kn(d,2);case"Qo":return l.ordinalNumber(d,{unit:"quarter"});case"QQQ":return l.quarter(d,{width:"abbreviated",context:"formatting"});case"QQQQQ":return l.quarter(d,{width:"narrow",context:"formatting"});case"QQQQ":default:return l.quarter(d,{width:"wide",context:"formatting"})}},q:function(n,s,l){var d=Math.ceil((n.getUTCMonth()+1)/3);switch(s){case"q":return String(d);case"qq":return kn(d,2);case"qo":return l.ordinalNumber(d,{unit:"quarter"});case"qqq":return l.quarter(d,{width:"abbreviated",context:"standalone"});case"qqqqq":return l.quarter(d,{width:"narrow",context:"standalone"});case"qqqq":default:return l.quarter(d,{width:"wide",context:"standalone"})}},M:function(n,s,l){var d=n.getUTCMonth();switch(s){case"M":case"MM":return Na.M(n,s);case"Mo":return l.ordinalNumber(d+1,{unit:"month"});case"MMM":return l.month(d,{width:"abbreviated",context:"formatting"});case"MMMMM":return l.month(d,{width:"narrow",context:"formatting"});case"MMMM":default:return l.month(d,{width:"wide",context:"formatting"})}},L:function(n,s,l){var d=n.getUTCMonth();switch(s){case"L":return String(d+1);case"LL":return kn(d+1,2);case"Lo":return l.ordinalNumber(d+1,{unit:"month"});case"LLL":return l.month(d,{width:"abbreviated",context:"standalone"});case"LLLLL":return l.month(d,{width:"narrow",context:"standalone"});case"LLLL":default:return l.month(d,{width:"wide",context:"standalone"})}},w:function(n,s,l,d){var g=f$(n,d);return s==="wo"?l.ordinalNumber(g,{unit:"week"}):kn(g,s.length)},I:function(n,s,l){var d=u$(n);return s==="Io"?l.ordinalNumber(d,{unit:"week"}):kn(d,s.length)},d:function(n,s,l){return s==="do"?l.ordinalNumber(n.getUTCDate(),{unit:"date"}):Na.d(n,s)},D:function(n,s,l){var d=a$(n);return s==="Do"?l.ordinalNumber(d,{unit:"dayOfYear"}):kn(d,s.length)},E:function(n,s,l){var d=n.getUTCDay();switch(s){case"E":case"EE":case"EEE":return l.day(d,{width:"abbreviated",context:"formatting"});case"EEEEE":return l.day(d,{width:"narrow",context:"formatting"});case"EEEEEE":return l.day(d,{width:"short",context:"formatting"});case"EEEE":default:return l.day(d,{width:"wide",context:"formatting"})}},e:function(n,s,l,d){var g=n.getUTCDay(),x=(g-d.weekStartsOn+8)%7||7;switch(s){case"e":return String(x);case"ee":return kn(x,2);case"eo":return l.ordinalNumber(x,{unit:"day"});case"eee":return l.day(g,{width:"abbreviated",context:"formatting"});case"eeeee":return l.day(g,{width:"narrow",context:"formatting"});case"eeeeee":return l.day(g,{width:"short",context:"formatting"});case"eeee":default:return l.day(g,{width:"wide",context:"formatting"})}},c:function(n,s,l,d){var g=n.getUTCDay(),x=(g-d.weekStartsOn+8)%7||7;switch(s){case"c":return String(x);case"cc":return kn(x,s.length);case"co":return l.ordinalNumber(x,{unit:"day"});case"ccc":return l.day(g,{width:"abbreviated",context:"standalone"});case"ccccc":return l.day(g,{width:"narrow",context:"standalone"});case"cccccc":return l.day(g,{width:"short",context:"standalone"});case"cccc":default:return l.day(g,{width:"wide",context:"standalone"})}},i:function(n,s,l){var d=n.getUTCDay(),g=d===0?7:d;switch(s){case"i":return String(g);case"ii":return kn(g,s.length);case"io":return l.ordinalNumber(g,{unit:"day"});case"iii":return l.day(d,{width:"abbreviated",context:"formatting"});case"iiiii":return l.day(d,{width:"narrow",context:"formatting"});case"iiiiii":return l.day(d,{width:"short",context:"formatting"});case"iiii":default:return l.day(d,{width:"wide",context:"formatting"})}},a:function(n,s,l){var d=n.getUTCHours(),g=d/12>=1?"pm":"am";switch(s){case"a":case"aa":return l.dayPeriod(g,{width:"abbreviated",context:"formatting"});case"aaa":return l.dayPeriod(g,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return l.dayPeriod(g,{width:"narrow",context:"formatting"});case"aaaa":default:return l.dayPeriod(g,{width:"wide",context:"formatting"})}},b:function(n,s,l){var d=n.getUTCHours(),g;switch(d===12?g=Qu.noon:d===0?g=Qu.midnight:g=d/12>=1?"pm":"am",s){case"b":case"bb":return l.dayPeriod(g,{width:"abbreviated",context:"formatting"});case"bbb":return l.dayPeriod(g,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return l.dayPeriod(g,{width:"narrow",context:"formatting"});case"bbbb":default:return l.dayPeriod(g,{width:"wide",context:"formatting"})}},B:function(n,s,l){var d=n.getUTCHours(),g;switch(d>=17?g=Qu.evening:d>=12?g=Qu.afternoon:d>=4?g=Qu.morning:g=Qu.night,s){case"B":case"BB":case"BBB":return l.dayPeriod(g,{width:"abbreviated",context:"formatting"});case"BBBBB":return l.dayPeriod(g,{width:"narrow",context:"formatting"});case"BBBB":default:return l.dayPeriod(g,{width:"wide",context:"formatting"})}},h:function(n,s,l){if(s==="ho"){var d=n.getUTCHours()%12;return d===0&&(d=12),l.ordinalNumber(d,{unit:"hour"})}return Na.h(n,s)},H:function(n,s,l){return s==="Ho"?l.ordinalNumber(n.getUTCHours(),{unit:"hour"}):Na.H(n,s)},K:function(n,s,l){var d=n.getUTCHours()%12;return s==="Ko"?l.ordinalNumber(d,{unit:"hour"}):kn(d,s.length)},k:function(n,s,l){var d=n.getUTCHours();return d===0&&(d=24),s==="ko"?l.ordinalNumber(d,{unit:"hour"}):kn(d,s.length)},m:function(n,s,l){return s==="mo"?l.ordinalNumber(n.getUTCMinutes(),{unit:"minute"}):Na.m(n,s)},s:function(n,s,l){return s==="so"?l.ordinalNumber(n.getUTCSeconds(),{unit:"second"}):Na.s(n,s)},S:function(n,s){return Na.S(n,s)},X:function(n,s,l,d){var g=d._originalDate||n,x=g.getTimezoneOffset();if(x===0)return"Z";switch(s){case"X":return _P(x);case"XXXX":case"XX":return _c(x);case"XXXXX":case"XXX":default:return _c(x,":")}},x:function(n,s,l,d){var g=d._originalDate||n,x=g.getTimezoneOffset();switch(s){case"x":return _P(x);case"xxxx":case"xx":return _c(x);case"xxxxx":case"xxx":default:return _c(x,":")}},O:function(n,s,l,d){var g=d._originalDate||n,x=g.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+yP(x,":");case"OOOO":default:return"GMT"+_c(x,":")}},z:function(n,s,l,d){var g=d._originalDate||n,x=g.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+yP(x,":");case"zzzz":default:return"GMT"+_c(x,":")}},t:function(n,s,l,d){var g=d._originalDate||n,x=Math.floor(g.getTime()/1e3);return kn(x,s.length)},T:function(n,s,l,d){var g=d._originalDate||n,x=g.getTime();return kn(x,s.length)}};function yP(e,n){var s=e>0?"-":"+",l=Math.abs(e),d=Math.floor(l/60),g=l%60;if(g===0)return s+String(d);var x=n;return s+String(d)+x+kn(g,2)}function _P(e,n){if(e%60===0){var s=e>0?"-":"+";return s+kn(Math.abs(e)/60,2)}return _c(e,n)}function _c(e,n){var s=n||"",l=e>0?"-":"+",d=Math.abs(e),g=kn(Math.floor(d/60),2),x=kn(d%60,2);return l+g+s+x}var vP=function(n,s){switch(n){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},n3=function(n,s){switch(n){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},m$=function(n,s){var l=n.match(/(P+)(p+)?/)||[],d=l[1],g=l[2];if(!g)return vP(n,s);var x;switch(d){case"P":x=s.dateTime({width:"short"});break;case"PP":x=s.dateTime({width:"medium"});break;case"PPP":x=s.dateTime({width:"long"});break;case"PPPP":default:x=s.dateTime({width:"full"});break}return x.replace("{{date}}",vP(d,s)).replace("{{time}}",n3(g,s))},g$={p:n3,P:m$},y$=["D","DD"],_$=["YY","YYYY"];function v$(e){return y$.indexOf(e)!==-1}function x$(e){return _$.indexOf(e)!==-1}function xP(e,n,s){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(n,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(n,"`) for formatting years to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(n,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(n,"`) for formatting days of the month to the input `").concat(s,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var w$={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},b$=function(n,s,l){var d,g=w$[n];return typeof g=="string"?d=g:s===1?d=g.one:d=g.other.replace("{{count}}",s.toString()),l!=null&&l.addSuffix?l.comparison&&l.comparison>0?"in "+d:d+" ago":d};function $0(e){return function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=n.width?String(n.width):e.defaultWidth,l=e.formats[s]||e.formats[e.defaultWidth];return l}}var T$={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},E$={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},S$={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},C$={date:$0({formats:T$,defaultWidth:"full"}),time:$0({formats:E$,defaultWidth:"full"}),dateTime:$0({formats:S$,defaultWidth:"full"})},P$={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},M$=function(n,s,l,d){return P$[n]};function Cf(e){return function(n,s){var l=s!=null&&s.context?String(s.context):"standalone",d;if(l==="formatting"&&e.formattingValues){var g=e.defaultFormattingWidth||e.defaultWidth,x=s!=null&&s.width?String(s.width):g;d=e.formattingValues[x]||e.formattingValues[g]}else{var E=e.defaultWidth,a=s!=null&&s.width?String(s.width):e.defaultWidth;d=e.values[a]||e.values[E]}var P=e.argumentCallback?e.argumentCallback(n):n;return d[P]}}var k$={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},I$={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},A$={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},D$={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},L$={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},z$={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},R$=function(n,s){var l=Number(n),d=l%100;if(d>20||d<10)switch(d%10){case 1:return l+"st";case 2:return l+"nd";case 3:return l+"rd"}return l+"th"},O$={ordinalNumber:R$,era:Cf({values:k$,defaultWidth:"wide"}),quarter:Cf({values:I$,defaultWidth:"wide",argumentCallback:function(n){return n-1}}),month:Cf({values:A$,defaultWidth:"wide"}),day:Cf({values:D$,defaultWidth:"wide"}),dayPeriod:Cf({values:L$,defaultWidth:"wide",formattingValues:z$,defaultFormattingWidth:"wide"})};function Pf(e){return function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=s.width,d=l&&e.matchPatterns[l]||e.matchPatterns[e.defaultMatchWidth],g=n.match(d);if(!g)return null;var x=g[0],E=l&&e.parsePatterns[l]||e.parsePatterns[e.defaultParseWidth],a=Array.isArray(E)?B$(E,function(R){return R.test(x)}):F$(E,function(R){return R.test(x)}),P;P=e.valueCallback?e.valueCallback(a):a,P=s.valueCallback?s.valueCallback(P):P;var A=n.slice(x.length);return{value:P,rest:A}}}function F$(e,n){for(var s in e)if(e.hasOwnProperty(s)&&n(e[s]))return s}function B$(e,n){for(var s=0;s<e.length;s++)if(n(e[s]))return s}function j$(e){return function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=n.match(e.matchPattern);if(!l)return null;var d=l[0],g=n.match(e.parsePattern);if(!g)return null;var x=e.valueCallback?e.valueCallback(g[0]):g[0];x=s.valueCallback?s.valueCallback(x):x;var E=n.slice(d.length);return{value:x,rest:E}}}var N$=/^(\d+)(th|st|nd|rd)?/i,U$=/\d+/i,V$={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},$$={any:[/^b/i,/^(a|c)/i]},G$={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},W$={any:[/1/i,/2/i,/3/i,/4/i]},Z$={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},q$={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},H$={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},X$={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},K$={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Y$={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},J$={ordinalNumber:j$({matchPattern:N$,parsePattern:U$,valueCallback:function(n){return parseInt(n,10)}}),era:Pf({matchPatterns:V$,defaultMatchWidth:"wide",parsePatterns:$$,defaultParseWidth:"any"}),quarter:Pf({matchPatterns:G$,defaultMatchWidth:"wide",parsePatterns:W$,defaultParseWidth:"any",valueCallback:function(n){return n+1}}),month:Pf({matchPatterns:Z$,defaultMatchWidth:"wide",parsePatterns:q$,defaultParseWidth:"any"}),day:Pf({matchPatterns:H$,defaultMatchWidth:"wide",parsePatterns:X$,defaultParseWidth:"any"}),dayPeriod:Pf({matchPatterns:K$,defaultMatchWidth:"any",parsePatterns:Y$,defaultParseWidth:"any"})},Q$={code:"en-US",formatDistance:b$,formatLong:C$,formatRelative:M$,localize:O$,match:J$,options:{weekStartsOn:0,firstWeekContainsDate:1}},e8=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,t8=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,n8=/^'([^]*?)'?$/,r8=/''/g,i8=/[a-zA-Z]/;function o8(e,n,s){var l,d,g,x,E,a,P,A,R,F,j,Z,se,ve;_i(2,arguments);var X=String(n),H=f_(),Y=(l=(d=void 0)!==null&&d!==void 0?d:H.locale)!==null&&l!==void 0?l:Q$,fe=Bc((g=(x=(E=(a=void 0)!==null&&a!==void 0?a:void 0)!==null&&E!==void 0?E:H.firstWeekContainsDate)!==null&&x!==void 0?x:(P=H.locale)===null||P===void 0||(A=P.options)===null||A===void 0?void 0:A.firstWeekContainsDate)!==null&&g!==void 0?g:1);if(!(fe>=1&&fe<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var Ce=Bc((R=(F=(j=(Z=void 0)!==null&&Z!==void 0?Z:void 0)!==null&&j!==void 0?j:H.weekStartsOn)!==null&&F!==void 0?F:(se=H.locale)===null||se===void 0||(ve=se.options)===null||ve===void 0?void 0:ve.weekStartsOn)!==null&&R!==void 0?R:0);if(!(Ce>=0&&Ce<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!Y.localize)throw new RangeError("locale must contain localize property");if(!Y.formatLong)throw new RangeError("locale must contain formatLong property");var Ue=_s(e);if(!i$(Ue))throw new RangeError("Invalid time value");var Ge=n$(Ue),je=o$(Ue,Ge),nt={firstWeekContainsDate:fe,weekStartsOn:Ce,locale:Y,_originalDate:Ue},Te=X.match(t8).map(function(mt){var Dt=mt[0];if(Dt==="p"||Dt==="P"){var xt=g$[Dt];return xt(mt,Y.formatLong)}return mt}).join("").match(e8).map(function(mt){if(mt==="''")return"'";var Dt=mt[0];if(Dt==="'")return s8(mt);var xt=p$[Dt];if(xt)return x$(mt)&&xP(mt,n,String(e)),v$(mt)&&xP(mt,n,String(e)),xt(je,mt,Y.localize,nt);if(Dt.match(i8))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Dt+"`");return mt}).join("");return Te}function s8(e){var n=e.match(n8);return n?n[1].replace(r8,"'"):e}const a8=[{id:1,author:"John Doe",rating:5,date:new Date("2023-12-01"),content:"Excellent service! Very professional and knowledgeable. Fixed my computer issues quickly.",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=32"},{id:2,author:"Jane Smith",rating:4,date:new Date("2023-11-28"),content:"Good service overall. Slightly expensive but worth the quality.",avatar:"https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=32"}];function l8({providerId:e}){return ee.jsx("div",{className:"space-y-6",children:a8.map(n=>ee.jsxs("div",{className:"border-b pb-6",children:[ee.jsxs("div",{className:"flex items-center mb-4",children:[ee.jsx("img",{src:n.avatar,alt:n.author,className:"w-10 h-10 rounded-full mr-4"}),ee.jsxs("div",{children:[ee.jsx("h4",{className:"font-medium",children:n.author}),ee.jsxs("div",{className:"flex items-center",children:[[...Array(5)].map((s,l)=>ee.jsx(qw,{className:`w-4 h-4 ${l<n.rating?"text-yellow-400":"text-gray-300"}`},l)),ee.jsx("span",{className:"ml-2 text-sm text-gray-500",children:o8(n.date,"MMM d, yyyy")})]})]})]}),ee.jsx("p",{className:"text-gray-600",children:n.content})]},n.id))})}function c8({provider:e}){const{isAuthenticated:n,loginWithRedirect:s}=r_(),[l,d]=Q.useState(""),[g,x]=Q.useState(""),[E,a]=Q.useState(""),P=A=>{if(A.preventDefault(),!n){s();return}Q4.success("Booking request sent successfully!")};return ee.jsxs("form",{onSubmit:P,className:"space-y-4",children:[ee.jsxs("div",{children:[ee.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Service"}),ee.jsxs("select",{value:E,onChange:A=>a(A.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0,children:[ee.jsx("option",{value:"",children:"Select a service"}),e.services.map((A,R)=>ee.jsxs("option",{value:A.name,children:[A.name," (",A.price,")"]},R))]})]}),ee.jsxs("div",{children:[ee.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),ee.jsxs("div",{className:"relative",children:[ee.jsx("input",{type:"date",value:l,onChange:A=>d(A.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0}),ee.jsx(zw,{className:"absolute right-3 top-2.5 w-5 h-5 text-gray-400"})]})]}),ee.jsxs("div",{children:[ee.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time"}),ee.jsxs("div",{className:"relative",children:[ee.jsx("input",{type:"time",value:g,onChange:A=>x(A.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0}),ee.jsx(Rw,{className:"absolute right-3 top-2.5 w-5 h-5 text-gray-400"})]})]}),ee.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:n?"Book Now":"Sign in to Book"})]})}function u8(){const{id:e}=Vk(),[n,s]=Q.useState(0),l={id:e,name:"Expert Tech Solutions",type:"Computer Service",rating:4.8,reviews:156,image:"https://images.unsplash.com/photo-1531482615713-2afd69097998?w=500",coverImage:"https://images.unsplash.com/photo-1604754742629-3e5728249d73?w=1920",address:"123 Tech Street, Downtown",phone:"+1 234-567-8900",hours:"Mon-Sat: 9AM-6PM",experience:"12 years",description:"Expert Tech Solutions provides professional computer repair and IT services with over 12 years of experience. We specialize in hardware repairs, software troubleshooting, and network solutions.",services:[{name:"Computer Repair",price:"from $49"},{name:"Virus Removal",price:"$89"},{name:"Data Recovery",price:"from $129"},{name:"Network Setup",price:"$99"}],location:{lat:40.7128,lng:-74.006}};return ee.jsxs("div",{children:[ee.jsxs("div",{className:"h-64 md:h-96 relative",children:[ee.jsx("img",{src:l.coverImage,alt:l.name,className:"w-full h-full object-cover"}),ee.jsx("div",{className:"absolute inset-0 bg-black/50"})]}),ee.jsx("div",{className:"container mx-auto px-6 py-8",children:ee.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[ee.jsx("div",{className:"md:col-span-2",children:ee.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[ee.jsxs("div",{className:"flex items-center mb-6",children:[ee.jsx("img",{src:l.image,alt:l.name,className:"w-24 h-24 rounded-lg object-cover mr-6"}),ee.jsxs("div",{children:[ee.jsx("h1",{className:"text-2xl font-bold mb-2",children:l.name}),ee.jsx("p",{className:"text-gray-600 mb-2",children:l.type}),ee.jsxs("div",{className:"flex items-center",children:[ee.jsx(qw,{className:"w-5 h-5 text-yellow-400"}),ee.jsx("span",{className:"ml-1 font-semibold",children:l.rating}),ee.jsxs("span",{className:"ml-1 text-gray-600",children:["(",l.reviews," reviews)"]})]})]})]}),ee.jsx("div",{className:"border-t pt-6",children:ee.jsxs(Pn.Group,{onChange:s,children:[ee.jsx(Pn.List,{className:"flex space-x-4 border-b",children:["About","Services","Reviews","Location"].map((d,g)=>ee.jsx(Pn,{className:({selected:x})=>`pb-4 px-4 text-sm font-medium border-b-2 ${x?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:d},d))}),ee.jsxs(Pn.Panels,{className:"mt-6",children:[ee.jsx(Pn.Panel,{children:ee.jsx("p",{className:"text-gray-600",children:l.description})}),ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"space-y-4",children:l.services.map((d,g)=>ee.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg",children:[ee.jsx("span",{className:"font-medium",children:d.name}),ee.jsx("span",{className:"text-blue-600 font-semibold",children:d.price})]},g))})}),ee.jsx(Pn.Panel,{children:ee.jsx(l8,{providerId:e})}),ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"h-96",children:ee.jsx(QV,{location:l.location})})})]})]})})]})}),ee.jsx("div",{children:ee.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 sticky top-6",children:[ee.jsxs("div",{className:"space-y-4 mb-6",children:[ee.jsxs("div",{className:"flex items-center",children:[ee.jsx(UV,{className:"w-5 h-5 text-gray-400 mr-2"}),ee.jsx("span",{children:l.address})]}),ee.jsxs("div",{className:"flex items-center",children:[ee.jsx($V,{className:"w-5 h-5 text-gray-400 mr-2"}),ee.jsx("span",{children:l.phone})]}),ee.jsxs("div",{className:"flex items-center",children:[ee.jsx(jV,{className:"w-5 h-5 text-gray-400 mr-2"}),ee.jsx("span",{children:l.hours})]})]}),ee.jsx(c8,{provider:l})]})})]})})]})}function h8(){const{user:e,isAuthenticated:n,isLoading:s}=r_(),[l,d]=Q.useState(0),g=[{id:1,service:"Computer Repair",provider:"Expert Tech Solutions",date:"2023-12-20",time:"14:00",status:"Confirmed",location:"123 Tech Street, Downtown"}];return s?ee.jsx("div",{className:"min-h-screen flex items-center justify-center",children:ee.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):n?ee.jsxs("div",{className:"container mx-auto px-6 py-8",children:[ee.jsxs("div",{className:"flex items-center mb-8",children:[ee.jsx("img",{src:e.picture,alt:e.name,className:"w-16 h-16 rounded-full mr-4"}),ee.jsxs("div",{children:[ee.jsx("h1",{className:"text-2xl font-bold",children:e.name}),ee.jsx("p",{className:"text-gray-600",children:e.email})]})]}),ee.jsxs(Pn.Group,{onChange:d,children:[ee.jsx(Pn.List,{className:"flex space-x-4 border-b mb-6",children:["Bookings","Favorites","Settings"].map((x,E)=>ee.jsx(Pn,{className:({selected:a})=>`pb-4 px-4 text-sm font-medium border-b-2 ${a?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:x},x))}),ee.jsxs(Pn.Panels,{children:[ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"space-y-6",children:g.map(x=>ee.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[ee.jsxs("div",{className:"flex justify-between items-start mb-4",children:[ee.jsxs("div",{children:[ee.jsx("h3",{className:"text-xl font-semibold mb-2",children:x.service}),ee.jsx("p",{className:"text-gray-600",children:x.provider})]}),ee.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:x.status})]}),ee.jsxs("div",{className:"space-y-2 text-gray-600",children:[ee.jsxs("div",{className:"flex items-center",children:[ee.jsx(zw,{className:"w-5 h-5 mr-2"}),ee.jsx("span",{children:x.date})]}),ee.jsxs("div",{className:"flex items-center",children:[ee.jsx(Rw,{className:"w-5 h-5 mr-2"}),ee.jsx("span",{children:x.time})]}),ee.jsxs("div",{className:"flex items-center",children:[ee.jsx(Ow,{className:"w-5 h-5 mr-2"}),ee.jsx("span",{children:x.location})]})]})]},x.id))})}),ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"text-center text-gray-600 py-12",children:ee.jsx("p",{children:"No favorite providers yet"})})}),ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"max-w-lg",children:ee.jsxs("div",{className:"space-y-6",children:[ee.jsxs("div",{children:[ee.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),ee.jsx("input",{type:"text",defaultValue:e.name,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),ee.jsxs("div",{children:[ee.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),ee.jsx("input",{type:"email",defaultValue:e.email,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),ee.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Save Changes"})]})})})]})]})]}):ee.jsx("div",{className:"min-h-screen flex items-center justify-center",children:ee.jsxs("div",{className:"text-center",children:[ee.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Please sign in to view your dashboard"}),ee.jsx("p",{className:"text-gray-600",children:"You need to be logged in to access this page."})]})})}function d8(){const{isAuthenticated:e,isLoading:n}=r_(),[s,l]=Q.useState(0),d=[{name:"Total Users",value:"2,543",icon:V6},{name:"Active Providers",value:"487",icon:f6},{name:"Bookings Today",value:"156",icon:w6}];return n?ee.jsx("div",{className:"min-h-screen flex items-center justify-center",children:ee.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?ee.jsxs("div",{className:"container mx-auto px-6 py-8",children:[ee.jsx("h1",{className:"text-2xl font-bold mb-8",children:"Admin Dashboard"}),ee.jsx("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:d.map(g=>ee.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:ee.jsxs("div",{className:"flex items-center",children:[ee.jsx("div",{className:"p-3 rounded-lg bg-blue-100 mr-4",children:ee.jsx(g.icon,{className:"w-6 h-6 text-blue-600"})}),ee.jsxs("div",{children:[ee.jsx("p",{className:"text-gray-600",children:g.name}),ee.jsx("p",{className:"text-2xl font-bold",children:g.value})]})]})},g.name))}),ee.jsxs(Pn.Group,{onChange:l,children:[ee.jsx(Pn.List,{className:"flex space-x-4 border-b mb-6",children:["Providers","Users","Bookings"].map((g,x)=>ee.jsx(Pn,{className:({selected:E})=>`pb-4 px-4 text-sm font-medium border-b-2 ${E?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:g},g))}),ee.jsxs(Pn.Panels,{children:[ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"bg-white rounded-lg shadow-md",children:ee.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[ee.jsx("thead",{className:"bg-gray-50",children:ee.jsxs("tr",{children:[ee.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Provider"}),ee.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),ee.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),ee.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),ee.jsx("tbody",{className:"bg-white divide-y divide-gray-200"})]})})}),ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"bg-white rounded-lg shadow-md"})}),ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"bg-white rounded-lg shadow-md"})})]})]})]}):ee.jsx("div",{className:"min-h-screen flex items-center justify-center",children:ee.jsxs("div",{className:"text-center",children:[ee.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Admin Access Required"}),ee.jsx("p",{className:"text-gray-600",children:"Please sign in with an admin account."})]})})}function f8(){const{isAuthenticated:e,isLoading:n}=r_(),[s,l]=Q.useState(0),d=[{name:"Total Bookings",value:"156",icon:zw},{name:"Revenue",value:"$12,426",icon:v6},{name:"Rating",value:"4.8",icon:B6}];return n?ee.jsx("div",{className:"min-h-screen flex items-center justify-center",children:ee.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?ee.jsxs("div",{className:"container mx-auto px-6 py-8",children:[ee.jsx("h1",{className:"text-2xl font-bold mb-8",children:"Provider Dashboard"}),ee.jsx("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:d.map(g=>ee.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:ee.jsxs("div",{className:"flex items-center",children:[ee.jsx("div",{className:"p-3 rounded-lg bg-blue-100 mr-4",children:ee.jsx(g.icon,{className:"w-6 h-6 text-blue-600"})}),ee.jsxs("div",{children:[ee.jsx("p",{className:"text-gray-600",children:g.name}),ee.jsx("p",{className:"text-2xl font-bold",children:g.value})]})]})},g.name))}),ee.jsxs(Pn.Group,{onChange:l,children:[ee.jsx(Pn.List,{className:"flex space-x-4 border-b mb-6",children:["Bookings","Services","Reviews","Settings"].map((g,x)=>ee.jsx(Pn,{className:({selected:E})=>`pb-4 px-4 text-sm font-medium border-b-2 ${E?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:g},g))}),ee.jsxs(Pn.Panels,{children:[ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"bg-white rounded-lg shadow-md"})}),ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:ee.jsx("div",{className:"space-y-6"})})}),ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"bg-white rounded-lg shadow-md"})}),ee.jsx(Pn.Panel,{children:ee.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:ee.jsx("div",{className:"max-w-lg space-y-6"})})})]})]})]}):ee.jsx("div",{className:"min-h-screen flex items-center justify-center",children:ee.jsxs("div",{className:"text-center",children:[ee.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Provider Access Required"}),ee.jsx("p",{className:"text-gray-600",children:"Please sign in with a provider account."})]})})}const p8=new bO;function m8(){return ee.jsx(l4,{domain:void 0,clientId:void 0,authorizationParams:{redirect_uri:window.location.origin},children:ee.jsx(PO,{client:p8,children:ee.jsxs("div",{className:"min-h-screen flex flex-col",children:[ee.jsx(eF,{}),ee.jsx("main",{className:"flex-grow",children:ee.jsxs(Z5,{children:[ee.jsx(Ua,{path:"/",element:ee.jsx(XV,{})}),ee.jsx(Ua,{path:"/contact",element:ee.jsx(KV,{})}),ee.jsx(Ua,{path:"/services/:category",element:ee.jsx(YV,{})}),ee.jsx(Ua,{path:"/provider/:id",element:ee.jsx(u8,{})}),ee.jsx(Ua,{path:"/dashboard",element:ee.jsx(h8,{})}),ee.jsx(Ua,{path:"/admin",element:ee.jsx(d8,{})}),ee.jsx(Ua,{path:"/provider-dashboard",element:ee.jsx(f8,{})})]})}),ee.jsx(tF,{}),ee.jsx(J4,{position:"top-right"})]})})})}W0.createRoot(document.getElementById("root")).render(ee.jsx(An.StrictMode,{children:ee.jsx(Q5,{children:ee.jsx(m8,{})})}));
